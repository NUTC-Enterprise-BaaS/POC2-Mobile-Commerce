FD40.plugin("utils",function($){!function(){var Bloop=function(items){this.items=items,this.start=0,this.end=items.length-1,this.node=null,this.stopped=!1};$.extend(Bloop.prototype,{isLooping:function(){return this.stopped?!1:Math.abs(this.start-this.end)>1?(this.node=Math.floor((this.start+this.end)/2),!0):!1},flip:function(flip){flip?this.end=this.node-1:this.start=this.node+1},stop:function(){this.stop=!0}}),$.Bloop=function(items){return new Bloop(items)}}(),$.Chunk=function(array,options){$.isArray(array)&&(array=[]);
var options=$.extend({},{size:256,every:1e3},options),self=$.extend($.Deferred(),{size:options.size,every:options.every,from:0,to:array.length,process:function(callback){return self.process.fn=callback,self},chunkStart:function(callback){return self.chunkStart.fn=callback,self},chunkEnd:function(callback){return self.chunkEnd.fn=callback,self},start:function(){return self.stopped=!1,self.iterate(),self},iterate:function(){if(!self.stopped){var iterator=self.process.fn;if(iterator){self.to=from.size+self.size;
var max=array.length;self.to>max&&(self.to=max);var range={from:self.from,to:self.to};for(self.chunkStart.fn&&self.chunkStart.fn.call(self,range.from,range.to);self.from<self.to&&!self.stopped;)iterator.call(self,array[self.from]),self.from++;return self.chunkEnd.fn&&self.chunkEnd.fn.call(self,range.from,range.to),self.completed=self.from>=array.length-1,self.completed?self.resolveWith(self):self.nextIteration=setTimeout(self.iterate,self.every),self}}},pause:function(){return self.stopped=!0,clearTimeout(self.nextIteration),self
},restart:function(){return"rejected"===self.state()?self:(self.from=0,self.start(),self)},stop:function(){return self.pause(),self.rejectWith(self,[self.from]),self}});return self},function(isFunction){var Enqueue=function(){this.lastId=0};Enqueue.prototype.queue=function(filter){var self=this,id=$.uid();return self.lastId=id,function(){if(self.lastId===id){var args=arguments,args=isFunction(filter)?filter.apply(this,args):args;return isFunction(self.fn)?self.fn.apply(this,args):args}}},$.Enqueue=function(fn){var self=new Enqueue;
isFunction(fn)&&(self.fn=fn);var func=$.proxy(self.queue,self);return func.reset=function(){self.lastId=0},func}}($.isFunction),function(){var consoleMethod={error:"error",warning:"warn",success:"log",info:"info"};$.Exception=function(exception){var args=arguments,simple=1==args.length,hasData=3==args.length;return exception=$.isPlainObject(exception)?exception:{type:simple?"error":args[0],message:simple?args[0]:args[1]},hasData&&$.extend(exception,args[2]),"development"==$.environment&&console[consoleMethod[exception.type]](exception.message,exception),exception
}}(),$.IE=function(){var ua=navigator.userAgent;if(ua.match(/MSIE 9/))return 9;if(ua.match(/MSIE 10/))return 10;if(ua.match(/rv:11/i))return 11;for(var undef,v=3,div=document.createElement("div"),all=div.getElementsByTagName("i");v++,div.innerHTML="<!--[if gt IE "+v+"]><i></i><![endif]-->",all[0];);return v>4?v:undef}(),$.Task=function(props){var task=$.extend($.Deferred(),{data:{},list:[],add:function(name){var item=$.extend($.Deferred(),{name:name,item:item});return task.list.push(item),item},process:function(){return task._promise||(task._promise=$.when.apply($,task.list).then(task.resolve,task.reject,task.progress)),task
}},props);return task},function(){var Threads=function(options){this.threads=[],this.threadCount=0,this.threadLimit=options.threadLimit||1,this.threadDelay=options.threadDelay||0};$.extend(Threads.prototype,{add:function(thread,type){$.isFunction(thread)&&(thread.type=type||"normal","deferred"==type&&(thread.deferred=$.Deferred().always($.proxy(this.next,this))),this.threads.push(thread),this.run())},addDeferred:function(thread){return this.add(thread,"deferred")},next:function(){this.threadCount--,this.run()
},run:function(){var self=this;setTimeout(function(){if(!(self.threads.length<1)&&self.threadCount<self.threadLimit){self.threadCount++;var thread=self.threads.shift();try{thread.call(thread,thread.deferred)}catch(e){console.error(e)}!thread.deferred&&self.next()}},self.threadDelay)}}),$.Threads=function(options){return new Threads(options)}}(),$.callback=function(func,persist){if($.isFunction(func)){var funcName=$.uid("cb");return window[funcName]=function(){return persist||delete window[funcName],func.apply(null,arguments)
},funcName}if($.isString(func))switch(func){case"destroy":var funcName=persist;delete window[funcName]}},$.fn.checkList=function(options){var defaultOptions={checkbox:".checkbox",masterCheckbox:".master-checkbox",check:function(){},uncheck:function(){},change:function(){}},options=$.extend({},defaultOptions,options),checkList=this,checkboxes=checkList.find(options.checkbox),masterCheckbox=checkList.find(options.masterCheckbox),disableChangeEvent=!1,change=function(){if(!disableChangeEvent){var checked=checkboxes.filter(":checked"),unchecked=checkboxes.not(":checked");
checked.length<1&&masterCheckbox.removeAttr("checked"),checked.length==checkboxes.length&&masterCheckbox.prop("checked",!0),options.change.call(checkList,checked,unchecked)}};return checkboxes.checked(function(){options.check.apply(checkList),change()},function(){options.uncheck.apply(checkList),change()}),masterCheckbox.checked(function(){disableChangeEvent=!0,checkboxes.checked(!0),disableChangeEvent=!1,change()},function(){disableChangeEvent=!0,checkboxes.checked(!1),disableChangeEvent=!1,change()}),change(),this
},$.fn.switchClass=function(classname,delimiter){var delimiter=delimiter||"-",prefix=classname.split(delimiter)[0]+delimiter,length=prefix.length;return this.each(function(){var $el=$(this),classnames=$.map(($el.attr("class")||"").split(" "),function(classname){return classname.slice(0,length)==prefix||""==classname?null:classname});classnames.push(classname),$el.attr("class",classnames.join(" "))})},$.fn.activateClass=function(className){return this.prevObject.removeClass(className),$(this).addClass(className)
},function(){var hexToRgb=function(hex){var hex=parseInt(hex.indexOf("#")>-1?hex.substring(1):hex,16);return{r:hex>>16,g:(65280&hex)>>8,b:255&hex}},hexToHsb=function(hex){return rgbToHsb(hexToRgb(hex))},rgbToHsb=function(rgb){var hsb={h:0,s:0,b:0},min=Math.min(rgb.r,rgb.g,rgb.b),max=Math.max(rgb.r,rgb.g,rgb.b),delta=max-min;return hsb.b=max,hsb.s=0!=max?255*delta/max:0,0!=hsb.s?(hsb.h=rgb.r==max?(rgb.g-rgb.b)/delta:rgb.g==max?2+(rgb.b-rgb.r)/delta:4+(rgb.r-rgb.g)/delta,hsb.h*=60):hsb.h=360,hsb.h<0&&(hsb.h+=360),hsb.s*=100/255,hsb.b*=100/255,hsb
},hsbToRgb=function(hsb){var rgb={},h=hsb.h,s=255*hsb.s/100,v=255*hsb.b/100;if(0==s)rgb.r=rgb.g=rgb.b=v;else{var t1=v,t2=(255-s)*v/255,t3=(t1-t2)*(h%60)/60;360==h&&(h=0),60>h?(rgb.r=t1,rgb.b=t2,rgb.g=t2+t3):120>h?(rgb.g=t1,rgb.b=t2,rgb.r=t1-t3):180>h?(rgb.g=t1,rgb.r=t2,rgb.b=t2+t3):240>h?(rgb.b=t1,rgb.r=t2,rgb.g=t1-t3):300>h?(rgb.b=t1,rgb.g=t2,rgb.r=t2+t3):360>h?(rgb.r=t1,rgb.g=t2,rgb.b=t1-t3):(rgb.r=0,rgb.g=0,rgb.b=0)}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}},rgbToHex=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];
return $.each(hex,function(nr,val){1==val.length&&(hex[nr]="0"+val)}),hex.join("")},hsbToHex=function(hsb){return rgbToHex(hsbToRgb(hsb))},fixHsb=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))}},fixRgb=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))}},fixHex=function(hex){var len=6-hex.length;if(3==len)for(var chr,chars=hex.split(""),hex="";chr=chars.shift();)hex+=chr+chr;
else for(;len--;)hex="0"+hex;return hex.replace(/[^A-Fa-f0-9]/g,"0"),hex};$.extend($,{hexToRgb:hexToRgb,hexToHsb:hexToHsb,rgbToHsb:rgbToHsb,hsbToRgb:hsbToRgb,rgbToHex:rgbToHex,hsbToHex:hsbToHex,fixHsb:fixHsb,fixRgb:fixRgb,fixHex:fixHex})}(),$.fn.htmlData=function(prefix,nested){var parts,nested=void 0===nested?!0:nested,re=new RegExp("^data-"+(prefix?prefix+"-":"")+"(.*)","i"),data={};return $.each(this[0].attributes,function(i,attr){if(attr.specified&&(parts=attr.name.match(re))&&parts[1])if(nested){var i,prop,props=parts[1].split("-"),obj=data;
for(max=props.length-1,i=0;max>=i;i++)prop=props[i],i==max?obj[prop]=attr.value:(!obj[prop]&&(obj[prop]={}),obj=obj[prop])}else data[parts[1]]=attr.value}),data},$.fn.defineData=function(name,value){return void 0===this.data(name)&&this.data(name,value),this},$.deletes=function(obj,props){$.each(props,function(i,prop){delete obj[prop]})},$.fn.disabled=function(state){return void 0===state?this.is(":disabled")||this.hasClass("disabled"):this.prop("disabled",!!state).toggleClass("disabled",!!state)},$.fn.enabled=function(state){return void 0===state?!this.disabled():this.disabled(!state)
},$.distinct=function(items){var uniqueElements=$.unique;if(!(items.length<1)){if(items[0].nodeType)return uniqueElements.apply(this,arguments);if("object"==typeof items[0]){var unique=Math.random(),uniqueObjects=[];return $.each(items,function(i){items[i][unique]||(uniqueObjects.push(items[i]),items[i][unique]=!0)}),$.each(uniqueObjects,function(i){delete uniqueObjects[i][unique]}),uniqueObjects}return $.grep(items,function(item,i){return $.inArray(item,items)===i})}},$.fn.tagName=function(){return(this[0]||{}).tagName
},$.create=function(tagName){return $(document.createElement(tagName))},$.fn.editable=function(editable){return $.isUndefined(editable)?"true"===this.prop("contenteditable"):(this.prop("contenteditable",editable),editable===!1&&this.removeAttr("contenteditable"),this)},$.download=function(src){return $("<iframe>").hide().appendTo("body").bind("load",function(){$(this).remove()}).attr("src",src)},$.ns=function(event,ns){return event.split(" ").join(ns+" ")+ns},$.getPointerPosition=function(event){return event.type.match("touch")?{x:event.originalEvent.changedTouches[0].pageX,y:event.originalEvent.changedTouches[0].pageY}:{x:event.pageX,y:event.pageY}
},function(){var instance="___eventable",publicMethods=["on","off","fire"],getEventName=function(name){return name.split(".")[0]},Eventable=function(mode){this.fnList={},this.events={},this.mode=mode};$.extend(Eventable.prototype,{createEvent:function(name){return this.events[name]=$.Callbacks(this.mode)},on:function(name,fn){if(!name||!$.isFunction(fn))return this;var fnList=this.fnList;(fnList[name]||(fnList[name]=[])).push(fn);var basename=getEventName(name);return(this.events[basename]||this.createEvent(basename)).add(fn),this
},off:function(name){if(!name)return this;var basename=getEventName(name),event=this.events[basename];if(!event)return this;var removeCallbacks=function(fnList){$.each(fnList,function(i,fn){event.remove(fn)})};return basename!==name?$.each(this.fnList,function(name,fnList){name.indexOf(basename)>-1&&removeCallbacks(fnList)}):removeCallbacks(this.fnList[name]),this},fire:function(name){var event=this.events[name];if(event)return event.fire.apply(event,$.makeArray(arguments).slice(1)),this},destroy:function(){for(name in this.events)this.events[name].disable()
}}),$.eventable=function(obj,mode){var eventable=obj[instance];return eventable&&"destroy"===mode?(eventable.destroy(),$.deletes(obj,publicMethods),delete obj[instance]):(eventable=obj[instance]=new Eventable(mode),obj.on=$.proxy(eventable.on,eventable),obj.off=$.proxy(eventable.off,eventable),obj.fire=$.proxy(eventable.fire,eventable),obj)}}(),$.fn.checkList=function(options){var defaultOptions={checkbox:".checkbox",masterCheckbox:".master-checkbox",check:function(){},uncheck:function(){},change:function(){}},options=$.extend({},defaultOptions,options),checkList=this,checkboxes=checkList.find(options.checkbox),masterCheckbox=checkList.find(options.masterCheckbox),disableChangeEvent=!1,change=function(){if(!disableChangeEvent){var checked=checkboxes.filter(":checked"),unchecked=checkboxes.not(":checked");
checked.length<1&&masterCheckbox.removeAttr("checked"),checked.length==checkboxes.length&&masterCheckbox.prop("checked",!0),options.change.call(checkList,checked,unchecked)}};return checkboxes.checked(function(){options.check.apply(checkList),change()},function(){options.uncheck.apply(checkList),change()}),masterCheckbox.checked(function(){disableChangeEvent=!0,checkboxes.checked(!0),disableChangeEvent=!1,change()},function(){disableChangeEvent=!0,checkboxes.checked(!1),disableChangeEvent=!1,change()}),change(),this
},$.fn.checked=function(checked,unchecked){return arguments.length<1?this.is(":checked"):(this.each(function(){var input=$(this);return"boolean"==typeof checked?void input.attr("checked",checked).trigger("change"):void((input.is("input[type=checkbox]")||input.is("input[type=radio]"))&&input.off("change.checked").on("change.checked",function(){try{return input.is(":checked")?checked.apply(input):unchecked.apply(input)}catch(e){}}))}),this)},$.fn.locate=function(key){var prefix="data";return $.each(this[0].attributes,function(i,attr){return attr.specified&&"$"===attr.value?(prefix=attr.name,!1):void 0
}),this.find("["+prefix+"-"+key.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},function(){var props=["overflow","overflow-x","overflow-y"];$.fn.noscroll=function(lock){return void 0===lock&&(lock=!0),this.each(function(){var el=$(this),overflow=el.data("noscroll");!overflow&&lock&&(overflow={},$.each(props,function(i,prop){overflow[prop]=el.css(prop)}),el.data("noscroll",overflow)),lock?$.each(props,function(i,prop){el.css(prop,"hidden")}):overflow&&el.css(overflow)})}}(),$.fn.visible=function(partial){var $t=$(this),$w=$(window);
if(!($t.length<1)){var viewTop=$w.scrollTop(),viewBottom=viewTop+$w.height(),_top=$t.offset().top,_bottom=_top+$t.height(),compareTop=partial===!0?_bottom:_top,compareBottom=partial===!0?_top:_bottom;return viewBottom>=compareBottom&&compareTop>=viewTop}},$.fn.where=$.fn.filterBy=function(key,val,operator){var operator=operator||"=",selector="[data-"+key.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+operator+val+"]";return this.filter(selector)},$.fn.checked=function(checked,unchecked){return arguments.length<1?this.is(":checked"):(this.each(function(){var input=$(this);
return"boolean"==typeof checked?void input.attr("checked",checked).trigger("change"):void((input.is("input[type=checkbox]")||input.is("input[type=radio]"))&&input.off("change.checked").on("change.checked",function(){try{return input.is(":checked")?checked.apply(input):unchecked.apply(input)}catch(e){}}))}),this)},$.fn.selectAll=function(){return this.each(function(){this.select()})},$.fn.unselect=function(){return this.each(function(){var input=this,value=input.value;input.value+=" ",input.value=value})},$.fn.toObject=$.fn.serializeObject=function(){var obj={};
return $.each($(this).serializeArray(),function(i,prop){obj.hasOwnProperty(prop.name)?($.isArray(obj[prop.name])||(obj[prop.name]=[obj[prop.name]]),obj[prop.name].push(prop.value)):obj[prop.name]=prop.value}),obj},$.fn.toJSON=$.fn.serializeJSON=function(){return JSON.stringify($(this).serializeObject())},$.sanitizeHTML=function(html){return $($.parseHTML(html,document,!0)).toHTML()},$.toHTML=function(str){return $("<div>").html(str).html()},$.fn.toHTML=function(){return $.toHTML(this.clone())},$.toXHTML=function(obj,maintainUppercaseTag){var zz=obj.innerHTML?String(obj.innerHTML):obj,z=zz.match(/(<.+[^>])/g);
if(z)for(var i=0;i<z.length;i+=1){var y,zSaved=z[i],attrRE=/\=[a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+[?\s+|?>]/g;if(z[i]=z[i].replace(/([<|<\/].+?\w+).+[^>]/,function(a){return a}),y=z[i].match(attrRE))for(var j=0,len=y.length;len>j;){var replaceRE=/(\=)([a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+)?([\s+|?>])/g,replacer=function(){var args=Array.prototype.slice.call(arguments);return'="'+(maintainUppercaseTag?args[2]:args[2].toLowerCase())+'"'+args[3]};z[i]=z[i].replace(y[j],y[j].replace(replaceRE,replacer)),j+=1}zz=zz.replace(zSaved,z[i])
}return zz},$.fn.xhtml=function(){return $.IE?$.toXHTML(this[0]):this.html()},$.buildHTML=function(html,keepScripts){if(html instanceof $)return html;var doc=document;if(window.CloudFlare){var iframe=$.buildHTML.iframe;if(!iframe||!iframe.contentDocument){var iframe=$.buildHTML.iframe=document.createElement("iframe");iframe.style.display="none",document.body.appendChild(iframe)}doc=iframe.contentDocument}var html=$.trim(html),scripts=[],fragment=$.buildFragment([html],doc,scripts),nodes=$.merge([],fragment.childNodes);
if(!keepScripts&&scripts.length>0){var script=doc.createElement("script");script.text="try{"+$.callback(function(){$(scripts).remove()})+"();}catch(e){}";for(var node,inserted,i=nodes.length-1;(node=nodes[i--])&&("SCRIPT"===node.nodeName?inserted=nodes.push(script):1===node.nodeType&&(inserted=node.appendChild(script)),!inserted););inserted||nodes.push(script),scripts.push(script)}return $(nodes)},$.intersects=function(a,b){return $.isArray(b)&&(b={top:b.y,left:b.x,bottom:b.y,right:b.x}),b.left<=a.right&&a.left<=b.right&&b.top<=a.bottom&&a.top<=b.bottom
},$.fn.intersectsWith=function(top,left,width,height){var offset=this.offset(),reference={top:offset.top,left:offset.left,bottom:offset.top+(sourceHeight=this.height()),right:offset.left+(sourceWidth=this.width()),width:sourceWidth,height:sourceHeight},subject={top:top,left:left,bottom:top+(height||(height=0)),right:left+(width||(width=0)),width:width,height:height};return $.intersects(reference,subject)?{reference:reference,subject:subject}:!1},$.isDeferred=function(obj){return obj&&$.isFunction(obj.always)
},$.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},$.rotateNumber=function(n,min,max,offset){return void 0===offset&&(offset=0),n+=offset,min>n?n+=max+1:n>max&&(n-=max+1),n},$.regExpEscape=function(str){return str.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(//g,"\\x08")},$.remap=function(to,from,props){return $.each(props,function(i,prop){to[prop]=from[prop]}),obj},function(){var self=$.Ajax=function(options){options.autostart=!1;var ajax=$.ajax(options);return self.queue.addDeferred(function(queue){ajax.send(),setTimeout(queue.resolve,self.interval)
}),ajax};self.queue=$.Threads({threadLimit:1}),self.interval=1200;var version=$.joomla.version.split("."),majorVersion=version[0],minorVersion=version[1];majorVersion>=3&&minorVersion>=2&&(self.interval=0)}(),function(){$.fn.addTransitoryClass=function(classname,duration){var elem=this.addClass(classname);return setTimeout(function(){elem.removeClass(classname)},duration||1),this};var classAfter=function(operation,classname,timer){var elem=this;return setTimeout(function(){elem[operation+"Class"](classname)},timer||50),this
};$.fn.addClassAfter=function(classname,timer){return classAfter.call(this,"add",classname,timer)},$.fn.removeClassAfter=function(classname,timer){return classAfter.call(this,"remove",classname,timer)};var transitionClass=function(toggle,classname,duration,callback){var suffix=toggle?"-in":"-out";return this.addTransitoryClass(classname.replace(/ /g,suffix+" ")+suffix,duration||1e3)[(toggle?"add":"remove")+"ClassAfter"](classname),callback&&setTimeout(callback,duration),this};$.fn.addTransitionClass=function(classname,duration,callback){return transitionClass.call(this,!0,classname,duration,callback)
},$.fn.removeTransitionClass=function(classname,duration,callback){return transitionClass.call(this,!1,classname,duration,callback)}}(),$.trimSeparators=function(keyword,separator,removeDuplicates){var s=separator;return keyword=keyword.replace(new RegExp("^["+s+"\\s]+|["+s+",\\s]+$","g"),"").replace(new RegExp(s+"["+s+"\\s]*"+s,"g"),s).replace(new RegExp("[\\s]+"+s,"g"),s).replace(new RegExp(s+"[\\s]+","g"),s),removeDuplicates&&(keyword=$.distinct(keyword.split(s)).join(s)),keyword},$.uid=function(p,s){return(p?p:"")+Math.random().toString().replace(".","")+(s?s:"")
}});