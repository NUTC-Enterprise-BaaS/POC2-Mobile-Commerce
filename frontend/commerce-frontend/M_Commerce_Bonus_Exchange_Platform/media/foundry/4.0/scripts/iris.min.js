!function(){var moduleFactory=function($){var module=this,jQuery=$,exports=function(){!function($,undef){function testGradientType(){var el,base;nonGradientIE?gradientType="filter":(el=$('<div id="iris-gradtest" />'),base="linear-gradient(top,#fff,#000)",$.each(vendorPrefixes,function(i,val){return el.css("backgroundImage",val+base),el.css("backgroundImage").match("gradient")?(gradientType=i,!1):void 0}),gradientType===!1&&(el.css("background","-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))"),el.css("backgroundImage").match("gradient")&&(gradientType="webkit")),el.remove())
}function createGradient(origin,stops){return origin="top"===origin?"top":"left",stops=$.isArray(stops)?stops:Array.prototype.slice.call(arguments,1),"webkit"===gradientType?legacyWebkitGradient(origin,stops):vendorPrefixes[gradientType]+"linear-gradient("+origin+", "+stops.join(", ")+")"}function stupidIEGradient(origin,stops){var type,self,lastIndex,filter,startPosProp,endPosProp,dimensionProp,template,html;origin="top"===origin?"top":"left",stops=$.isArray(stops)?stops:Array.prototype.slice.call(arguments,1),type="top"===origin?0:1,self=$(this),lastIndex=stops.length-1,filter="filter",startPosProp=1===type?"left":"top",endPosProp=1===type?"right":"bottom",dimensionProp=1===type?"height":"width",template='<div class="iris-ie-gradient-shim" style="position:absolute;'+dimensionProp+":100%;"+startPosProp+":%start%;"+endPosProp+":%end%;"+filter+':%filter%;" data-color:"%color%"></div>',html="","static"===self.css("position")&&self.css({position:"relative"}),stops=fillColorStops(stops),$.each(stops,function(i,startColor){var endColor,endStop,filterVal;
return i===lastIndex?!1:(endColor=stops[i+1],void(startColor.stop!==endColor.stop&&(endStop=100-parseFloat(endColor.stop)+"%",startColor.octoHex=new Color(startColor.color).toIEOctoHex(),endColor.octoHex=new Color(endColor.color).toIEOctoHex(),filterVal="progid:DXImageTransform.Microsoft.Gradient(GradientType="+type+", StartColorStr='"+startColor.octoHex+"', EndColorStr='"+endColor.octoHex+"')",html+=template.replace("%start%",startColor.stop).replace("%end%",endStop).replace("%filter%",filterVal))))}),self.find(".iris-ie-gradient-shim").remove(),$(html).prependTo(self)
}function legacyWebkitGradient(origin,colorList){var stops=[];return origin="top"===origin?"0% 0%,0% 100%,":"0% 100%,100% 100%,",colorList=fillColorStops(colorList),$.each(colorList,function(i,val){stops.push("color-stop("+parseFloat(val.stop)/100+", "+val.color+")")}),"-webkit-gradient(linear,"+origin+stops.join(",")+")"}function fillColorStops(colorList){var colors=[],percs=[],newColorList=[],lastIndex=colorList.length-1;return $.each(colorList,function(index,val){var color=val,perc=!1,match=val.match(/1?[0-9]{1,2}%$/);
match&&(color=val.replace(/\s?1?[0-9]{1,2}%$/,""),perc=match.shift()),colors.push(color),percs.push(perc)}),percs[0]===!1&&(percs[0]="0%"),percs[lastIndex]===!1&&(percs[lastIndex]="100%"),percs=backFillColorStops(percs),$.each(percs,function(i){newColorList[i]={color:colors[i],stop:percs[i]}}),newColorList}function backFillColorStops(stops){var incr,steps,step,firstVal,first=0,last=stops.length-1,i=0,foundFirst=!1;if(stops.length<=2||$.inArray(!1,stops)<0)return stops;for(;i<stops.length-1;)foundFirst||stops[i]!==!1?foundFirst&&stops[i]!==!1&&(last=i,i=stops.length):(first=i-1,foundFirst=!0),i++;
for(steps=last-first,firstVal=parseInt(stops[first].replace("%"),10),incr=(parseFloat(stops[last].replace("%"))-firstVal)/steps,i=first+1,step=1;last>i;)stops[i]=firstVal+step*incr+"%",step++,i++;return backFillColorStops(stops)}var _html,nonGradientIE,gradientType,vendorPrefixes,_css,Iris,UA,isIE,IEVersion;return _html='<div class="iris-picker"><div class="iris-picker-inner"><div class="iris-square"><a class="iris-square-value" href="#"><span class="iris-square-handle ui-slider-handle"></span></a><div class="iris-square-inner iris-square-horiz"></div><div class="iris-square-inner iris-square-vert"></div></div><div class="iris-slider iris-strip"><div class="iris-slider-offset"></div></div></div></div>',UA=navigator.userAgent.toLowerCase(),isIE="Microsoft Internet Explorer"===navigator.appName,IEVersion=isIE?parseFloat(UA.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,nonGradientIE=isIE&&10>IEVersion,gradientType=!1,vendorPrefixes=["-moz-","-webkit-","-o-","-ms-"],_css='.iris-picker{display:block;position:relative}.iris-picker,.iris-picker *{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input+.iris-picker{margin-top:4px}.iris-error{background-color:#ffafaf}.iris-border{border-radius:3px;border:1px solid #aaa;width:200px;background-color:#fff}.iris-picker-inner{position:absolute;top:0;right:0;left:0;bottom:0}.iris-border .iris-picker-inner{top:10px;right:10px;left:10px;bottom:10px}.iris-picker .iris-square-inner{position:absolute;left:0;right:0;top:0;bottom:0}.iris-picker .iris-square,.iris-picker .iris-slider,.iris-picker .iris-square-inner,.iris-picker .iris-palette{border-radius:3px;box-shadow:inset 0 0 5px rgba(0,0,0,.4);height:100%;width:12.5%;float:left;margin-right:5%}.iris-picker .iris-square{width:76%;margin-right:10%;position:relative}.iris-picker .iris-square-inner{width:auto;margin:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-square-inner,.iris-ie-9 .iris-palette{box-shadow:none;border-radius:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-palette{outline:1px solid rgba(0,0,0,.1)}.iris-ie-lt9 .iris-square,.iris-ie-lt9 .iris-slider,.iris-ie-lt9 .iris-square-inner,.iris-ie-lt9 .iris-palette{outline:1px solid #aaa}.iris-ie-lt9 .iris-square .ui-slider-handle{outline:1px solid #aaa;background-color:#fff;-ms-filter:"alpha(Opacity=30)"}.iris-ie-lt9 .iris-square .iris-square-handle{background:0;border:3px solid #fff;-ms-filter:"alpha(Opacity=50)"}.iris-picker .iris-strip{margin-right:0;position:relative}.iris-picker .iris-strip .ui-slider-handle{position:absolute;background:0;margin:0;right:-3px;left:-3px;border:4px solid #aaa;border-width:4px 3px;width:auto;height:6px;border-radius:4px;box-shadow:0 1px 2px rgba(0,0,0,.2);opacity:.9;z-index:5;cursor:ns-resize}.iris-strip .ui-slider-handle:before{content:" ";position:absolute;left:-2px;right:-2px;top:-3px;bottom:-3px;border:2px solid #fff;border-radius:3px}.iris-picker .iris-slider-offset{position:absolute;top:11px;left:0;right:0;bottom:-3px;width:auto;height:auto;background:transparent;border:0;top:none;border-radius:0}.iris-picker .iris-square-handle{background:transparent;border:5px solid #aaa;border-radius:50%;border-color:rgba(128,128,128,.5);box-shadow:none;width:12px;height:12px;position:absolute;left:-10px;top:-10px;cursor:move;opacity:1;z-index:10}.iris-picker .ui-state-focus .iris-square-handle{opacity:.8}.iris-picker .iris-square-handle:hover{border-color:#999}.iris-picker .iris-square-value:focus .iris-square-handle{box-shadow:0 0 2px rgba(0,0,0,.75);opacity:.8}.iris-picker .iris-square-handle:hover::after{border-color:#fff}.iris-picker .iris-square-handle::after{position:absolute;bottom:-4px;right:-4px;left:-4px;top:-4px;border:3px solid #f9f9f9;border-color:rgba(255,255,255,.8);border-radius:50%;content:" "}.iris-picker .iris-square-value{width:8px;height:8px;position:absolute}.iris-ie-lt9 .iris-square-value,.iris-mozilla .iris-square-value{width:1px;height:1px}.iris-palette-container{position:absolute;bottom:0;left:0;margin:0;padding:0}.iris-border .iris-palette-container{left:10px;bottom:10px}.iris-picker .iris-palette{margin:0;cursor:pointer}',nonGradientIE&&7>=IEVersion?($.fn.iris=$.noop,void($.support.iris=!1)):($.support.iris=!0,$.fn.gradient=function(){var args=arguments;
return this.each(function(){nonGradientIE?stupidIEGradient.apply(this,args):$(this).css("backgroundImage",createGradient.apply(this,args))})},$.fn.raninbowGradient=function(origin,args){var opts,template,i,steps;for(origin=origin||"top",opts=$.extend({},{s:100,l:50},args),template="hsl(%h%,"+opts.s+"%,"+opts.l+"%)",i=0,steps=[];360>=i;)steps.push(template.replace("%h%",i)),i+=30;return this.each(function(){$(this).gradient(origin,steps)})},Iris={options:{color:!1,mode:"hsl",controls:{horiz:"s",vert:"l",strip:"h"},hide:!0,border:!0,target:!1,width:200,palettes:!1},_color:"",_palettes:["#000","#fff","#d33","#d93","#ee2","#81d742","#1e73be","#8224e3"],_inited:!1,_defaultHSLControls:{horiz:"s",vert:"l",strip:"h"},_defaultHSVControls:{horiz:"h",vert:"v",strip:"s"},_scale:{h:360,s:100,l:100,v:100},_create:function(){var self=this,el=self.element,color=self.options.color||el.val();
gradientType===!1&&testGradientType(),el.is("input")?(self.picker=self.options.target?$(_html).appendTo(self.options.target):$(_html).insertAfter(el),self._addInputListeners(el)):(el.append(_html),self.picker=el.find(".iris-picker")),isIE?9===IEVersion?self.picker.addClass("iris-ie-9"):8>=IEVersion&&self.picker.addClass("iris-ie-lt9"):UA.indexOf("compatible")<0&&UA.indexOf("khtml")<0&&UA.match(/mozilla/)&&self.picker.addClass("iris-mozilla"),self.options.palettes&&self._addPalettes(),self._color=new Color(color).setHSpace(self.options.mode),self.options.color=self._color.toString(),self.controls={square:self.picker.find(".iris-square"),squareDrag:self.picker.find(".iris-square-value"),horiz:self.picker.find(".iris-square-horiz"),vert:self.picker.find(".iris-square-vert"),strip:self.picker.find(".iris-strip"),stripSlider:self.picker.find(".iris-strip .iris-slider-offset")},"hsv"===self.options.mode&&self._has("l",self.options.controls)?self.options.controls=self._defaultHSVControls:"hsl"===self.options.mode&&self._has("v",self.options.controls)&&(self.options.controls=self._defaultHSLControls),self.hue=self._color.h(),self.options.hide&&self.picker.hide(),self.options.border&&self.picker.addClass("iris-border"),self._initControls(),self.active="external",self._dimensions(),self._change()
},_has:function(needle,haystack){var ret=!1;return $.each(haystack,function(i,v){return needle===v?(ret=!0,!1):void 0}),ret},_addPalettes:function(){var container=$('<div class="iris-palette-container" />'),palette=$('<a class="iris-palette" tabindex="0" />'),colors=$.isArray(this.options.palettes)?this.options.palettes:this._palettes;this.picker.find(".iris-palette-container").length&&(container=this.picker.find(".iris-palette-container").detach().html("")),$.each(colors,function(index,val){palette.clone().data("color",val).css("backgroundColor",val).appendTo(container).height(10).width(10)
}),this.picker.append(container)},_paint:function(){var self=this;self._paintDimension("top","strip"),self._paintDimension("top","vert"),self._paintDimension("left","horiz")},_paintDimension:function(origin,control){var stops,self=this,c=self._color,mode=self.options.mode,color=self._getHSpaceColor(),target=self.controls[control],controlOpts=self.options.controls;if(control!==self.active&&("square"!==self.active||"strip"===control))switch(controlOpts[control]){case"h":if("hsv"===mode){switch(color=c.clone(),control){case"horiz":color[controlOpts.vert](100);
break;case"vert":color[controlOpts.horiz](100);break;case"strip":color.setHSpace("hsl")}stops=color.toHsl()}else stops="strip"===control?{s:color.s,l:color.l}:{s:100,l:color.l};target.raninbowGradient(origin,stops);break;case"s":"hsv"===mode?"vert"===control?stops=[c.clone().a(0).s(0).toCSS("rgba"),c.clone().a(1).s(0).toCSS("rgba")]:"strip"===control?stops=[c.clone().s(100).toCSS("hsl"),c.clone().s(0).toCSS("hsl")]:"horiz"===control&&(stops=["#fff","hsl("+color.h+",100%,50%)"]):stops="vert"===control&&"h"===self.options.controls.horiz?["hsla(0, 0%, "+color.l+"%, 0)","hsla(0, 0%, "+color.l+"%, 1)"]:["hsl("+color.h+",0%,50%)","hsl("+color.h+",100%,50%)"],target.gradient(origin,stops);
break;case"l":stops="strip"===control?["hsl("+color.h+",100%,100%)","hsl("+color.h+", "+color.s+"%,50%)","hsl("+color.h+",100%,0%)"]:["#fff","rgba(255,255,255,0) 50%","rgba(0,0,0,0) 50%","rgba(0,0,0,1)"],target.gradient(origin,stops);break;case"v":stops="strip"===control?[c.clone().v(100).toCSS(),c.clone().v(0).toCSS()]:["rgba(0,0,0,0)","#000"],target.gradient(origin,stops)}},_getHSpaceColor:function(){return"hsv"===this.options.mode?this._color.toHsv():this._color.toHsl()},_dimensions:function(reset){var controlsHeight,paletteMargin,paletteWidth,paletteContainerWidth,self=this,opts=self.options,controls=self.controls,square=controls.square,strip=self.picker.find(".iris-strip"),squareWidth="77.5%",stripWidth="12%",totalPadding=20,innerWidth=opts.border?opts.width-totalPadding:opts.width,paletteCount=$.isArray(opts.palettes)?opts.palettes.length:self._palettes.length;
return reset&&(square.css("width",""),strip.css("width",""),self.picker.css({width:"",height:""})),squareWidth=innerWidth*(parseFloat(squareWidth)/100),stripWidth=innerWidth*(parseFloat(stripWidth)/100),controlsHeight=opts.border?squareWidth+totalPadding:squareWidth,square.width(squareWidth).height(squareWidth),strip.height(squareWidth).width(stripWidth),self.picker.css({width:opts.width,height:controlsHeight}),opts.palettes?(paletteMargin=2*squareWidth/100,paletteContainerWidth=squareWidth-(paletteCount-1)*paletteMargin,paletteWidth=paletteContainerWidth/paletteCount,self.picker.find(".iris-palette").each(function(i){var margin=0===i?0:paletteMargin;
$(this).css({width:paletteWidth,height:paletteWidth,marginLeft:margin})}),self.picker.css("paddingBottom",paletteWidth+paletteMargin),void strip.height(paletteWidth+paletteMargin+squareWidth)):self.picker.css("paddingBottom","")},_addInputListeners:function(input){var self=this,debounceTimeout=100,callback=function(event){var color=new Color(input.val()),val=input.val().replace(/^#/,"");input.removeClass("iris-error"),color.error?""!==val&&input.addClass("iris-error"):color.toString()!==self._color.toString()&&("keyup"===event.type&&val.match(/^[0-9a-fA-F]{3}$/)||self._setOption("color",color.toString()))
};input.on("change",callback).on("keyup",self._debounce(callback,debounceTimeout)),self.options.hide&&input.one("focus",function(){self.show()})},_initControls:function(){var self=this,controls=self.controls,square=controls.square,controlOpts=self.options.controls,stripScale=self._scale[controlOpts.strip];controls.stripSlider.slider({orientation:"vertical",max:stripScale,slide:function(event,ui){self.active="strip","h"===controlOpts.strip&&(ui.value=stripScale-ui.value),self._color[controlOpts.strip](ui.value),self._change.apply(self,arguments)
}}),controls.squareDrag.draggable({containment:"parent",zIndex:1e3,cursor:"move",drag:function(event,ui){self._squareDrag(event,ui)},start:function(){square.addClass("iris-dragging"),$(this).addClass("ui-state-focus")},stop:function(){square.removeClass("iris-dragging"),$(this).removeClass("ui-state-focus")}}).on("mousedown mouseup",function(event){var focusClass="ui-state-focus";event.preventDefault(),"mousedown"===event.type?(self.picker.find("."+focusClass).removeClass(focusClass).blur(),$(this).addClass(focusClass).focus()):$(this).removeClass(focusClass)
}).on("keydown",function(event){var container=controls.square,draggable=controls.squareDrag,position=draggable.position(),distance=self.options.width/100;switch(event.altKey&&(distance*=10),event.keyCode){case 37:position.left-=distance;break;case 38:position.top-=distance;break;case 39:position.left+=distance;break;case 40:position.top+=distance;break;default:return!0}position.left=Math.max(0,Math.min(position.left,container.width())),position.top=Math.max(0,Math.min(position.top,container.height())),draggable.css(position),self._squareDrag(event,{position:position}),event.preventDefault()
}),square.mousedown(function(event){var squareOffset,pos;1===event.which&&$(event.target).is("div")&&(squareOffset=self.controls.square.offset(),pos={top:event.pageY-squareOffset.top,left:event.pageX-squareOffset.left},event.preventDefault(),self._squareDrag(event,{position:pos}),event.target=self.controls.squareDrag.get(0),self.controls.squareDrag.css(pos).trigger(event))}),self.options.palettes&&self._paletteListeners()},_paletteListeners:function(){var self=this;self.picker.find(".iris-palette-container").on("click.palette",".iris-palette",function(){self._color.fromCSS($(this).data("color")),self.active="external",self._change()
}).on("keydown.palette",".iris-palette",function(event){return 13!==event.keyCode&&32!==event.keyCode?!0:(event.stopPropagation(),void $(this).click())})},_squareDrag:function(event,ui){var self=this,controlOpts=self.options.controls,dimensions=self._squareDimensions(),vertVal=Math.round((dimensions.h-ui.position.top)/dimensions.h*self._scale[controlOpts.vert]),horizVal=self._scale[controlOpts.horiz]-Math.round((dimensions.w-ui.position.left)/dimensions.w*self._scale[controlOpts.horiz]);self._color[controlOpts.horiz](horizVal)[controlOpts.vert](vertVal),self.active="square",self._change.apply(self,arguments)
},_setOption:function(key,value){var hexLessColor,newColor,method,self=this,oldValue=self.options[key],doDimensions=!1;switch(self.options[key]=value,key){case"color":value=""+value,hexLessColor=value.replace(/^#/,""),newColor=new Color(value).setHSpace(self.options.mode),newColor.error?self.options[key]=oldValue:(self._color=newColor,self.options.color=self.options[key]=self._color.toString(),self.active="external",self._change());break;case"palettes":doDimensions=!0,value?self._addPalettes():self.picker.find(".iris-palette-container").remove(),oldValue||self._paletteListeners();
break;case"width":doDimensions=!0;break;case"border":doDimensions=!0,method=value?"addClass":"removeClass",self.picker[method]("iris-border");break;case"mode":case"controls":if(oldValue===value)return;return method=self.element,oldValue=self.options,oldValue.hide=!self.picker.is(":visible"),self.destroy(),self.picker.remove(),$(self.element).iris(oldValue)}doDimensions&&self._dimensions(!0)},_squareDimensions:function(forceRefresh){var dimensions,control,square=this.controls.square;return forceRefresh!==undef&&square.data("dimensions")?square.data("dimensions"):(control=this.controls.squareDrag,dimensions={w:square.width(),h:square.height()},square.data("dimensions",dimensions),dimensions)
},_isNonHueControl:function(active,type){return"square"===active&&"h"===this.options.controls.strip?!0:"external"===type||"h"===type&&"strip"===active?!1:!0},_change:function(){var self=this,controls=self.controls,color=self._getHSpaceColor(),actions=["square","strip"],controlOpts=self.options.controls,type=controlOpts[self.active]||"external",oldHue=self.hue;"strip"===self.active?actions=[]:"external"!==self.active&&actions.pop(),$.each(actions,function(index,item){var value,dimensions,cssObj;if(item!==self.active)switch(item){case"strip":value="h"===controlOpts.strip?self._scale[controlOpts.strip]-color[controlOpts.strip]:color[controlOpts.strip],controls.stripSlider.slider("value",value);
break;case"square":dimensions=self._squareDimensions(),cssObj={left:color[controlOpts.horiz]/self._scale[controlOpts.horiz]*dimensions.w,top:dimensions.h-color[controlOpts.vert]/self._scale[controlOpts.vert]*dimensions.h},self.controls.squareDrag.css(cssObj)}}),color.h!==oldHue&&self._isNonHueControl(self.active,type)&&self._color.h(oldHue),self.hue=self._color.h(),self.options.color=self._color.toString(),self._inited&&self._trigger("change",{type:self.active},{color:self._color}),self.element.is(":input")&&!self._color.error&&(self.element.removeClass("iris-error"),self.element.val()!==self._color.toString()&&self.element.val(self._color.toString())),self._paint(),self._inited=!0,self.active=!1
},_debounce:function(func,wait,immediate){var timeout,result;return function(){var later,callNow,context=this,args=arguments;return later=function(){timeout=null,immediate||(result=func.apply(context,args))},callNow=immediate&&!timeout,clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&(result=func.apply(context,args)),result}},show:function(){this.picker.show()},hide:function(){this.picker.hide()},toggle:function(){this.picker.toggle()},color:function(newColor){return newColor===!0?this._color.clone():newColor===undef?this._color.toString():void this.option("color",newColor)
}},$.widget("a8c.iris",Iris),void $('<style id="iris-css">'+_css+"</style>").appendTo("head"))}(jQuery)};exports(),module.resolveWith(exports)};FD40.module("iris",moduleFactory)}();