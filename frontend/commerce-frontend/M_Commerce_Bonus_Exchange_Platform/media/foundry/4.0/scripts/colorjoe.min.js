!function(){var moduleFactory=function(){var module=this,exports=function(){!function(root,factory){"object"==typeof exports?module.exports=factory(require("onecolor")):"function"==typeof define&&define.amd?define(["onecolor"],factory):root.colorjoe=factory(root.one.color)}(this,function(onecolor){function e(type,klass,p){var elem=document.createElement(type);return elem.className=klass,p.appendChild(elem),elem}function partial(fn){var slice=Array.prototype.slice,args=slice.apply(arguments,[1]);return function(){return fn.apply(null,args.concat(slice.apply(arguments)))
}}function labelInput(klass,n,p,maxLen){var d=div(klass,p),l=label(n,d),i=input("text",d,maxLen);return{label:l,input:i}}function label(c,p){var elem=e("label","",p);return elem.innerHTML=c,elem}function input(t,p,maxLen){var elem=e("input","",p);return elem.type=t,maxLen&&(elem.maxLength=maxLen),elem}function X(p,a){p.style.left=clamp(100*a,0,100)+"%"}function Y(p,a){p.style.top=clamp(100*a,0,100)+"%"}function BG(e,c){e.style.background=c}function clamp(a,minValue,maxValue){return Math.min(Math.max(a,minValue),maxValue)
}function currentColor(p){var e1=utils.div("currentColorContainer",p),e=utils.div("currentColor",e1);return{change:function(col){utils.BG(e,col.cssa())}}}function fields(p,joe,o){function done(){joe.done()}function validate(e){e.ctrlKey||e.altKey||!/^[a-zA-Z]$/.test(e.key)||e.preventDefault()}function update(){var col=[cs];elems.forEach(function(o){col.push(o.e.input.value/fac)}),useAlpha||col.push(joe.getAlpha()),joe.set(col)}var cs=o.space,fac=o.limit||255,fix=o.fix>=0?o.fix:0,inputLen=(""+fac).length+fix;
inputLen=fix?inputLen+1:inputLen;var initials=cs.split(""),useAlpha="A"==cs[cs.length-1];if(cs=useAlpha?cs.slice(0,-1):cs,["RGB","HSL","HSV","CMYK"].indexOf(cs)<0)return console.warn("Invalid field names",cs);var c=utils.div("colorFields",p),elems=initials.map(function(n){n=n.toLowerCase();var e=utils.labelInput("color "+n,n,c,inputLen);return e.input.onblur=done,e.input.onkeydown=validate,e.input.onkeyup=update,{name:n,e:e}});return{change:function(col){elems.forEach(function(o){o.e.input.value=(col[o.name]()*fac).toFixed(fix)
})}}}function alpha(p,joe){function done(){joe.done()}function change(p){var val=utils.clamp(p.y,0,1);utils.Y(p.pointer,val),joe.setAlpha(1-val)}var e=drag.slider({parent:p,"class":"oned alpha",cbs:{begin:change,change:change,end:done}});return{change:function(col){utils.Y(e.pointer,1-col.alpha())}}}function hex(p,joe,o){var e=utils.labelInput("hex",o.label||"",p,7);return e.input.value="#",e.input.onkeyup=function(elem){var key=elem.keyCode||elem.which,val=elem.target.value;val="#"==val[0]?val:"#"+val,val=pad(val,7,"0"),13==key&&joe.set(val)
},e.input.onblur=function(elem){joe.set(elem.target.value),joe.done()},{change:function(col){e.input.value="#"==e.input.value[0]?"#":"",e.input.value+=col.hex().slice(1)}}}function close(p,joe,o){var elem=utils.e("a",o["class"]||"close",p);elem.href="#",elem.innerHTML=o.label||"Close",elem.onclick=function(e){e.preventDefault(),joe.hide()}}function pad(a,n,c){for(var ret=a,i=a.length;n>i;i++)ret+=c;return ret}function RGB_BG(e,h){utils.BG(e,new onecolor.HSV(h,1,1).cssa())}function setup(o){function changeXY(p){col=cbs.xy(col,{x:utils.clamp(p.x,0,1),y:utils.clamp(p.y,0,1)},xy,z),changed()
}function changeZ(p){col=cbs.z(col,utils.clamp(p.y,0,1),xy,z),changed()}function changed(skip){skip=isArray(skip)?skip:[];for(var v,li=listeners.change,i=0,len=li.length;len>i;i++)v=li[i],-1==skip.indexOf(v.name)&&v.fn(col)}function done(){if(!previous.equals(col)){for(var i=0,len=listeners.done.length;len>i;i++)listeners.done[i].fn(col);previous=col}}if(!o.e)return console.warn("colorjoe: missing element");var e=isString(o.e)?document.getElementById(o.e):o.e;e.className="colorPicker";var cbs=o.cbs,xy=drag.xyslider({parent:e,"class":"twod",cbs:{begin:changeXY,change:changeXY,end:done}}),z=drag.slider({parent:e,"class":"oned",cbs:{begin:changeZ,change:changeZ,end:done}}),previous=getColor(o.color),col=cbs.init(previous,xy,z),listeners={change:[],done:[]},ob={e:e,done:function(){return done(),this
},update:function(skip){return changed(skip),this},hide:function(){return e.style.display="none",this},show:function(){return e.style.display="",this},get:function(){return col},set:function(c){var oldCol=this.get();return col=cbs.init(getColor(c),xy,z),oldCol.equals(col)||this.update(),this},getAlpha:function(){return col.alpha()},setAlpha:function(v){return col=col.alpha(v),this.update(),this},on:function(evt,cb,name){return"change"==evt||"done"==evt?listeners[evt].push({name:name,fn:cb}):console.warn('Passed invalid evt name "'+evt+'" to colorjoe.on'),this
},removeAllListeners:function(evt){if(evt)delete listeners[evt];else for(var key in listeners)delete listeners[key];return this}};return setupExtras(e,ob,o.extras),changed(),ob}function getColor(c){if(!isDefined(c))return onecolor("#000");if(c.isColor)return c;var ret=onecolor(c);return ret?ret:(isDefined(c)&&console.warn("Passed invalid color to colorjoe, using black instead"),onecolor("#000"))}function setupExtras(p,joe,extras){if(extras){var cbs,name,params,c=utils.div("extras",p);extras.forEach(function(e,i){if(isArray(e)?(name=e[0],params=e.length>1?e[1]:{}):(name=e,params={}),extra=name in colorjoe._extras?colorjoe._extras[name]:null){cbs=extra(c,extraProxy(joe,name+i),params);
for(var k in cbs)joe.on(k,cbs[k],name)}})}}function extraProxy(joe,name){var ret=copy(joe);return ret.update=function(){joe.update([name])},ret}function copy(o){var ret={};for(var k in o)ret[k]=o[k];return ret}function all(cb,a){return a.map(cb).filter(id).length==a.length}function isArray(o){return"[object Array]"===Object.prototype.toString.call(o)}function isString(o){return"string"==typeof o}function isDefined(input){return"undefined"!=typeof input}function isFunction(input){return"function"==typeof input
}function id(a){return a}var drag=function(){function drag(elem,cbs){return elem?void(isTouch()?dragTemplate(elem,cbs,"touchstart","touchmove","touchend"):dragTemplate(elem,cbs,"mousedown","mousemove","mouseup")):void console.warn("drag is missing elem!")}function xyslider(o){var twod=div(o["class"]||"",o.parent),pointer=div("pointer",twod);return div("shape shape1",pointer),div("shape shape2",pointer),div("bg bg1",twod),div("bg bg2",twod),drag(twod,attachPointer(o.cbs,pointer)),{background:twod,pointer:pointer}
}function slider(o){var oned=div(o["class"],o.parent),pointer=div("pointer",oned);return div("shape",pointer),div("bg",oned),drag(oned,attachPointer(o.cbs,pointer)),{background:oned,pointer:pointer}}function attachPointer(cbs,pointer){function wrap(fn){return function(p){p.pointer=pointer,fn(p)}}var ret={};for(var n in cbs)ret[n]=wrap(cbs[n]);return ret}function div(klass,p){return e("div",klass,p)}function e(type,klass,p){var elem=document.createElement(type);return klass&&(elem.className=klass),p.appendChild(elem),elem
}function isTouch(){return"undefined"!=typeof window.ontouchstart}function dragTemplate(elem,cbs,down,move,up){var dragging=!1;cbs=getCbs(cbs);var beginCb=cbs.begin,changeCb=cbs.change,endCb=cbs.end;on(elem,down,function(e){function upHandler(){dragging=!1,off(document,move,moveHandler),off(document,up,upHandler),callCb(endCb,elem,e)}dragging=!0;var moveHandler=partial(callCb,changeCb,elem);on(document,move,moveHandler),on(document,up,upHandler),callCb(beginCb,elem,e)})}function on(elem,evt,handler){elem.addEventListener?elem.addEventListener(evt,handler,!1):elem.attachEvent&&elem.attachEvent("on"+evt,handler)
}function off(elem,evt,handler){elem.removeEventListener?elem.removeEventListener(evt,handler,!1):elem.detachEvent&&elem.detachEvent("on"+evt,handler)}function getCbs(cbs){if(cbs)return{begin:cbs.begin||empty,change:cbs.change||empty,end:cbs.end||empty};var initialOffset,initialPos;return{begin:function(c){initialOffset={x:c.elem.offsetLeft,y:c.elem.offsetTop},initialPos=c.cursor},change:function(c){style(c.elem,"left",initialOffset.x+c.cursor.x-initialPos.x+"px"),style(c.elem,"top",initialOffset.y+c.cursor.y-initialPos.y+"px")
},end:empty}}function style(e,prop,value){e.style[prop]=value}function empty(){}function callCb(cb,elem,e){e.preventDefault();var offset=findPos(elem),width=elem.clientWidth,height=elem.clientHeight,cursor={x:cursorX(elem,e),y:cursorY(elem,e)},x=(cursor.x-offset.x)/width,y=(cursor.y-offset.y)/height;cb({x:isNaN(x)?0:x,y:isNaN(y)?0:y,cursor:cursor,elem:elem,e:e})}function partial(fn){var slice=Array.prototype.slice,args=slice.apply(arguments,[1]);return function(){return fn.apply(null,args.concat(slice.apply(arguments)))
}}function findPos(e){var x=0,y=0;if(e.offsetParent)do x+=e.offsetLeft,y+=e.offsetTop;while(e=e.offsetParent);return{x:x,y:y}}function cursorX(elem,evt){if(isFixed(elem)){var bodyLeft=parseInt(getStyle(document.body,"marginLeft"),10)-calc(elem,"scrollLeft")+window.pageXOffset+elem.style.marginLeft;return evt.clientX-bodyLeft}return evt.pageX?evt.pageX:evt.clientX?evt.clientX+document.body.scrollLeft:void 0}function cursorY(elem,evt){if(isFixed(elem)){var bodyTop=parseInt(getStyle(document.body,"marginTop"),10)-calc(elem,"scrollTop")+window.pageYOffset+elem.style.marginTop;
return evt.clientY-bodyTop}return evt.pageY?evt.pageY:evt.clientY?evt.clientY+document.body.scrollTop:void 0}function calc(element,prop){for(var ret=0;"HTML"!=element.nodeName;)ret+=element[prop],element=element.parentNode;return ret}function isFixed(element){for(;"HTML"!=element.nodeName&&"fixed"!=usedStyle(element,"position");)element=element.parentNode;return"HTML"==element.nodeName?!1:!0}function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(el,"")[cssprop]:el.style[cssprop]
}function usedStyle(element,property){var s;return s=window.getComputedStyle?window.getComputedStyle(element,null):element.currentStyle,s[property]}return drag.xyslider=xyslider,drag.slider=slider,drag}(),div=partial(e,"div"),utils={clamp:clamp,e:e,div:div,partial:partial,labelInput:labelInput,X:X,Y:Y,BG:BG},extras={currentColor:currentColor,fields:fields,hex:hex,alpha:alpha,close:close},colorjoe=function(cbs){return all(isFunction,[cbs.init,cbs.xy,cbs.z])?function(element,initialColor,extras){return setup({e:element,color:initialColor,cbs:cbs,extras:extras})
}:console.warn("colorjoe: missing cb")};colorjoe.rgb=colorjoe({init:function(col,xy,z){var ret=onecolor(col).hsv();return this.xy(ret,{x:ret.saturation(),y:1-ret.value()},xy,z),this.z(ret,ret.hue(),xy,z),ret},xy:function(col,p,xy){return utils.X(xy.pointer,p.x),utils.Y(xy.pointer,p.y),col.saturation(p.x).value(1-p.y)},z:function(col,v,xy,z){return utils.Y(z.pointer,v),RGB_BG(xy.background,v),col.hue(v)}}),colorjoe.hsl=colorjoe({init:function(col,xy,z){var ret=onecolor(col).hsl();return this.xy(ret,{x:ret.hue(),y:1-ret.saturation()},xy,z),this.z(ret,1-ret.lightness(),xy,z),ret
},xy:function(col,p,xy,z){return utils.X(xy.pointer,p.x),utils.Y(xy.pointer,p.y),RGB_BG(z.background,p.x),col.hue(p.x).saturation(1-p.y)},z:function(col,v,xy,z){return utils.Y(z.pointer,v),col.lightness(1-v)}}),colorjoe._extras={},colorjoe.registerExtra=function(name,fn){name in colorjoe._extras&&console.warn('Extra "'+name+'"has been registered already!'),colorjoe._extras[name]=fn};for(var k in extras)colorjoe.registerExtra(k,extras[k]);return colorjoe})};exports(),module.resolveWith(exports)};FD40.module("colorjoe",moduleFactory)
}();