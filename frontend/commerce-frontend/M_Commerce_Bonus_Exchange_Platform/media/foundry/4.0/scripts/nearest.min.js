!function(){var moduleFactory=function($){var module=this,exports=function(){var DIRECTIONS={left:[-1,0],up:[0,-1],right:[1,0],down:[0,1]};$.distance=function(fromItem,toItem,direction){function calcDistance(dx,dy){return Math.floor(Math.sqrt(dx*dx+dy*dy))}direction=DIRECTIONS[direction];var toItemDistance,distanceX,distanceY,fromItemOffset=fromItem.offset(),fromOuterWidth=fromItem.outerWidth(),fromOuterHeight=fromItem.outerHeight(),fromItemLeft=fromItemOffset.left,fromItemTop=fromItemOffset.top,fromItemRight=fromItemLeft+fromOuterWidth,fromItemBottom=fromItemTop+fromOuterHeight,fromItemCenterX=fromItemLeft+fromOuterWidth/2,fromItemCenterY=fromItemTop+fromOuterHeight/2,toItemOffset=toItem.offset(),toOuterWidth=toItem.outerWidth(),toOuterHeight=toItem.outerHeight(),toItemLeft=toItemOffset.left,toItemTop=toItemOffset.top,toItemRight=toItemLeft+toOuterWidth,toItemBottom=toItemTop+toOuterHeight,toItemCenterX=toItemLeft+toOuterWidth/2,toItemCenterY=toItemTop+toOuterHeight/2;
return 0==direction[1]?(direction[0]<0?(fromItemLeft>=toItemRight&&(distanceX=fromItemLeft-toItemRight),fromItemLeft>=toItemCenterX&&(distanceX=void 0!=distanceX?Math.min(distanceX,fromItemLeft-toItemCenterX):fromItemLeft-toItemCenterX),fromItemLeft>=toItemRight&&(distanceX=void 0!=distanceX?Math.min(distanceX,fromItemLeft-toItemRight):fromItemLeft-toItemRight)):(toItemLeft>=fromItemRight&&(distanceX=toItemLeft-fromItemRight),toItemCenterX>=fromItemRight&&(distanceX=void 0!=distanceX?Math.min(distanceX,toItemCenterX-fromItemRight):toItemCenterX-fromItemRight),toItemLeft>fromItemLeft&&(distanceX=void 0!=distanceX?Math.min(distanceX,toItemLeft-fromItemLeft):toItemLeft-fromItemLeft)),distanceY=2*Math.min(Math.abs(fromItemCenterY-toItemTop),Math.abs(fromItemCenterY-toItemCenterY),Math.abs(fromItemCenterY-toItemBottom))):0==direction[0]&&(direction[1]<0?(fromItemTop>=toItemBottom&&(distanceY=fromItemTop-toItemBottom),fromItemTop>=toItemCenterY&&(distanceY=void 0!=distanceY?Math.min(distanceY,fromItemTop-toItemCenterY):fromItemTop-toItemCenterY),fromItemTop>=toItemBottom&&(distanceY=void 0!=distanceY?Math.min(distanceY,fromItemTop-toItemBottom):fromItemTop-toItemBottom)):(toItemTop>=fromItemBottom&&(distanceY=toItemTop-fromItemBottom),toItemCenterY>=fromItemBottom&&(distanceY=void 0!=distanceY?Math.min(distanceY,toItemCenterY-fromItemBottom):toItemCenterY-fromItemBottom),toItemTop>fromItemTop&&(distanceY=void 0!=distanceY?Math.min(distanceY,toItemTop-fromItemTop):toItemTop-fromItemTop)),distanceX=2*Math.min(Math.abs(fromItemCenterX-toItemLeft),Math.abs(fromItemCenterX-toItemCenterX),Math.abs(fromItemCenterX-toItemRight))),toItemDistance=void 0==distanceX||void 0==distanceY?-1:calcDistance(distanceX,distanceY)
},$.fn.nearest=function(items,direction){for(var toItem,itemDistance,fromItem=this,nearestItem=$(),minItemDistance=null,i=-1,max=items.length;++i<max;)toItem=$(items[i]),fromItem[0]!=toItem[0]&&(itemDistance=$.distance(fromItem,toItem,direction),itemDistance>=0&&(null===minItemDistance||minItemDistance>itemDistance)&&(minItemDistance=itemDistance,nearestItem=toItem));return nearestItem}};exports(),module.resolveWith(exports)};FD40.module("nearest",moduleFactory)}();