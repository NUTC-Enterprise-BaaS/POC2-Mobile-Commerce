FD40.installer("EasySocial","definitions",function(a){a.module(["easysocial/admin","easysocial/admin/access/discover","easysocial/progress/progress","easysocial/admin/alerts/discover","easysocial/admin/badges/discover","easysocial/admin/events/approveRecurring","easysocial/admin/events/store","easysocial/admin/events/users","easysocial/admin/grid/grid","easysocial/admin/grid/sort","easysocial/admin/grid/publishing","easysocial/admin/grid/ordering","easysocial/admin/groups/groups","easysocial/admin/groups/users","easysocial/admin/indexer/indexer","easysocial/admin/mailer/mailer","easysocial/admin/maintenance/database","easysocial/admin/maintenance/maintenance","easysocial/admin/migrators/migrator","easysocial/admin/points/discover","easysocial/admin/polls/polls","easysocial/admin/privacy/discover","easysocial/admin/profiles/avatar","easysocial/uploader/uploader","easysocial/uploader/queue","easysocial/admin/profiles/fields","easysocial/field","easysocial/admin/profiles/form","easysocial/utilities/alias","easysocial/admin/profiles/members","easysocial/admin/profiles/profile","easysocial/admin/profiles/profiles","easysocial/admin/regions/form","easysocial/admin/regions/init","easysocial/admin/reports/reporters","easysocial/admin/reports/reports","easysocial/admin/sidebar/sidebar","easysocial/admin/themes/compiler","easysocial/admin/users/form","easysocial/admin/users/privacy","easysocial/admin/users/users","easysocial/albums/album","easysocial/albums/browser","easysocial/albums/editor","easysocial/albums/editor/sortable","easysocial/albums/editor/uploader","easysocial/albums/uploader","easysocial/albums/uploader.item","easysocial/albums/item","easysocial/apps/event/discussions","easysocial/apps/event/guests","easysocial/apps/event/tasks","easysocial/apps/fields/event/description/content","easysocial/apps/fields/event/permalink/content","easysocial/apps/fields/event/permalink/sample_content","easysocial/apps/fields/event/recurring/content","easysocial/apps/fields/event/startend/content","easysocial/apps/fields/event/startend/display","easysocial/apps/fields/group/permalink/content","easysocial/apps/fields/group/permalink/sample_content","easysocial/apps/fields/user/address/content","easysocial/apps/fields/user/address/display_content","easysocial/apps/fields/user/address/maps","easysocial/apps/fields/user/autocomplete/content","easysocial/apps/fields/user/avatar/content","easysocial/apps/fields/user/avatar/sample_content","easysocial/apps/fields/user/checkbox/content","easysocial/apps/fields/user/checkbox/sample_content","easysocial/apps/fields/user/country/content","easysocial/apps/fields/user/country/sample_content","easysocial/apps/fields/user/cover/content","easysocial/apps/fields/user/currency/sample_content","easysocial/apps/fields/user/datetime/content","easysocial/apps/fields/user/datetime/display_content","easysocial/apps/fields/user/datetime/dropdown","easysocial/apps/fields/user/datetime/sample_content","easysocial/apps/fields/user/dropdown/content","easysocial/apps/fields/user/email/content","easysocial/apps/fields/user/file/content","easysocial/apps/fields/user/file/sample_content","easysocial/apps/fields/user/gender/content","easysocial/apps/fields/user/joomla_email/content","easysocial/apps/fields/user/joomla_email/registermini_content","easysocial/apps/fields/user/joomla_email/sample_content","easysocial/apps/fields/user/joomla_fullname/content","easysocial/apps/fields/user/joomla_fullname/sample_content","easysocial/apps/fields/user/joomla_password/content","easysocial/apps/fields/user/joomla_password/registermini_content","easysocial/apps/fields/user/joomla_password/sample_content","easysocial/apps/fields/user/joomla_timezone/content","easysocial/apps/fields/user/joomla_username/content","easysocial/apps/fields/user/joomla_username/registermini_content","easysocial/apps/fields/user/joomla_username/sample_content","easysocial/apps/fields/user/multidropdown/content","easysocial/apps/fields/user/multilist/content","easysocial/apps/fields/user/multitextbox/content","easysocial/apps/fields/user/permalink/content","easysocial/apps/fields/user/permalink/sample_content","easysocial/apps/fields/user/relationship/content","easysocial/site/friends/suggest","easysocial/apps/fields/user/separator/sample","easysocial/apps/fields/user/terms/content","easysocial/apps/fields/user/textarea/content","easysocial/apps/fields/user/textbox/content","easysocial/apps/fields/user/textbox/sample_content","easysocial/apps/fields/user/url/content","easysocial/apps/fields/user/url/sample_content","easysocial/apps/group/feeds","easysocial/apps/group/tasks","easysocial/avatar","easysocial/utilities/webcam","easysocial/cover","easysocial/easysocial","easysocial/site/likes/likes","easysocial/site/reports/reports","easysocial/site/blocks/blocks","easysocial/site/repost/repost","easysocial/site/share/share","easysocial/site/layout/dialog","easysocial/site/layout/responsive","easysocial/site/layout/elements","easysocial/site/photos/photos","easysocial/site/photos/popup","easysocial/site/photos/dialog","easysocial/site/photos/avatar","easysocial/site/users/login","easysocial/site/dashboard/dashboard.guest.login","easysocial/validate","easysocial/site/profile/popbox","easysocial/site/conversations/composer","easysocial/site/privacy/privacy","easysocial/site/locations/popbox","easysocial/site/sidebar/sidebar","easysocial/site/friends/api","easysocial/site/popbox/popbox","easysocial/site/conversations/api","easysocial/site/groups/api","easysocial/site/followers/api","easysocial/site/stream/video","easysocial/oauth/facebook","easysocial/groups/suggest","easysocial/libraries/lightbox","easysocial/locations","easysocial/pagination","easysocial/photos/avatar","easysocial/photos/browser","easysocial/photos/editor","easysocial/photos/item","easysocial/photos/tags","easysocial/photos/tagger","easysocial/photos/navigation","easysocial/prism","easysocial/privacy","easysocial/sharing","easysocial/site/activities/activities","easysocial/site/activities/sidebar","easysocial/site/activities/sidebar.item","easysocial/site/activities/apps","easysocial/site/activities/item","easysocial/site/activities/list","easysocial/site/albums/all","easysocial/site/apps/apps","easysocial/site/badges/badge","easysocial/site/comments/control","easysocial/site/comments/frame","easysocial/site/comments/item","easysocial/site/conversations/conversations","easysocial/site/conversations/mailbox","easysocial/site/conversations/item","easysocial/site/conversations/filter","easysocial/site/conversations/read","easysocial/site/dashboard/apps","easysocial/site/dashboard/dashboard","easysocial/site/dashboard/feeds","easysocial/site/dashboard/sidebar","easysocial/site/stream/filter","easysocial/site/stream/sidebar","easysocial/site/dashboard/groups","easysocial/site/dashboard/events","easysocial/site/events/browser","easysocial/site/events/guestState","easysocial/site/events/buttonState","easysocial/site/events/create","easysocial/site/events/createRecurring","easysocial/site/events/edit","easysocial/site/events/item","easysocial/site/events/update","easysocial/site/explorer","easysocial/site/explorer/uploader","easysocial/site/explorer/popup","easysocial/site/followers/followers","easysocial/site/friends/friends","easysocial/site/friends/list","easysocial/site/friends/item","easysocial/site/groups/groups","easysocial/site/groups/item","easysocial/site/notifications/list","easysocial/site/points/history","easysocial/site/polls/polls","easysocial/site/profile/about","easysocial/site/profile/admintool","easysocial/site/profile/edit","easysocial/site/profile/feeds","easysocial/site/profile/friends","easysocial/site/profile/header","easysocial/site/profile/subscriptions","easysocial/site/profile/miniheader","easysocial/site/profile/notifications","easysocial/site/profile/privacy","easysocial/site/profile/profile","easysocial/site/registrations/registrations","easysocial/site/search/advanced.criteria","easysocial/site/search/map","easysocial/site/search/advanced","easysocial/site/search/advanced.list.group","easysocial/site/search/advanced.list","easysocial/site/search/item","easysocial/site/search/dating","easysocial/site/search/list","easysocial/site/search/search","easysocial/site/search/sidebar","easysocial/site/search/toolbar","easysocial/site/stream/item","easysocial/site/stream/stream","easysocial/site/subscriptions/follow","easysocial/site/system/broadcast","easysocial/site/toolbar/conversations","easysocial/site/toolbar/friends","easysocial/site/toolbar/login","easysocial/site/toolbar/notifications","easysocial/site/toolbar/story","easysocial/site/toolbar/system","easysocial/site/toolbar/profile","easysocial/site/users/popbox","easysocial/site/users/users","easysocial/story","easysocial/story/blog","easysocial/story/broadcast","easysocial/story/event","easysocial/story/files","easysocial/story/friends","easysocial/story/links","easysocial/story/locations","easysocial/story/mood","easysocial/story/photos","easysocial/story/polls","easysocial/story/quickpost","easysocial/story/tasks","easysocial/story/videos","easysocial/stream","easysocial/comment","easysocial/tab","easysocial/toggle","easysocial/uploader/item","easysocial/videos/form","easysocial/videos/item","easysocial/videos/list","easysocial/videos/process"]),a.require.template.loader(["easysocial/site/loading/small","easysocial/site/uploader/queue.item","easysocial/admin/profiles/fields/editor.item","easysocial/admin/profiles/fields/step.item","easysocial/admin/profiles/fields/editor.page","easysocial/admin/profiles/fields/config","easysocial/admin/profiles/fields/dialog.move","easysocial/admin/profiles/dialog.delete.profileavatar","easysocial/site/albums/browser.list.item","easysocial/site/albums/upload.item","easysocial/fields/user/checkbox/item","easysocial/site/friends/suggest.item","easysocial/site/friends/suggest.hint.search","easysocial/site/friends/suggest.hint.empty","easysocial/site/hashtags/suggest.item","easysocial/site/hashtags/suggest.hint.search","easysocial/site/hashtags/suggest.hint.empty","easysocial/site/dialog/default","easysocial/site/photos/popup","easysocial/site/groups/suggest.item","easysocial/site/location/story.suggestion","easysocial/site/photos/tags.item","easysocial/site/photos/tags.menu.item","easysocial/admin/profiles/form.privacy.custom.item","easysocial/site/activities/loadbutton","easysocial/site/explorer/popup","easysocial/site/friends/default.empty","easysocial/site/friends/list.assign","easysocial/site/registration/dialog.error","easysocial/site/search/loadbutton","easysocial/site/stream/loadbutton","easysocial/site/notifications/system.empty","easysocial/site/users/button.following","easysocial/apps/user/links/story/attachment.item","easysocial/apps/user/files/story/attachment.item","easysocial/apps/user/files/story/progress","easysocial/site/links/story/attachment.item","easysocial/apps/group/tasks/story/attachment.item","easysocial/site/likes/item","easysocial/site/uploader/preview"]),a.require.language.loader(["COM_EASYSOCIAL_SCAN_COMPLETED","JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST","COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING","COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED","COM_EASYSOCIAL_INDEXER_REINDEX_RESTART","COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_POLLS_VIEW_POLLS_DIALOG_TITLE","COM_EASYSOCIAL_POLLS_ACTIONS_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_PAGE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_FIELD","COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS","COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES","COM_EASYSOCIAL_FIELDS_INVALID_VALUES","COM_EASYSOCIAL_ASSIGN_BUTTON","COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR","COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE","COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE","COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE","PLG_FIELDS_EVENT_DESCRIPTION_VALIDATION_INPUT_REQUIRED","FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH","FIELDS_EVENT_PERMALINK_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED","FIELDS_USER_DATETIME_LOCAL_TIMEZONE","FIELDS_USER_DATETIME_TIMEZONE_CHECKING","PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_GROUP_PERMALINK_REQUIRED","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS1","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS2","PLG_FIELDS_ADDRESS_PLEASE_ENTER_CITY","PLG_FIELDS_ADDRESS_PLEASE_ENTER_STATE","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ZIP","PLG_FIELDS_ADDRESS_PLEASE_ENTER_COUNTRY","COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT","PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE","PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM","PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED","PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR","PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR","PLG_FIELDS_COVER_VALIDATION_REQUIRED","PLG_FIELDS_DATETIME_VALIDATION_INVALID_DATETIME_FORMAT","PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME","PLG_FIELDS_DATETIME_DAY","PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE","PLG_FIELDS_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT","PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED","COM_EASYSOCIAL_WORKING","PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING","PLG_FIELDS_JOOMLA_EMAIL_CHECKING","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT","PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_INTEGER","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_SYMBOLS","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_UPPERCASE","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT","PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG","PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE","PLG_FIELDS_JOOMLA_USERNAME_CHECKING","PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME","PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD","PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE","PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD","PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_PERMALINK_REQUIRED","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT","PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM","PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE","PLG_FIELDS_TERMS_VALIDATION_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT","PLG_FIELDS_URL_VALIDATION_EMPTY_URL","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_PUBLIC","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_MEMBER","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIENDS_OF_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_ONLY_ME","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_CUSTOM","COM_EASYSOCIAL_AT_LOCATION","COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_LOG_LOAD_PREVIOUS_STREAM_ITEMS","COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_LOADING","COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_DELETING","COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR","COM_EASYSOCIAL_LIKES_LIKE","COM_EASYSOCIAL_LIKES_UNLIKE","COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL","COM_EASYSOCIAL_COMMENTS_STATUS_SAVING","COM_EASYSOCIAL_COMMENTS_STATUS_SAVED","COM_EASYSOCIAL_NO_BUTTON","COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY","COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY","COM_EASYSOCIAL_EVENTS_GUEST_PENDING","COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION","COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME","COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL","COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE","COM_EASYSOCIAL_FRIENDS_CANCEL_REQUEST_DIALOG_CANCELLED","COM_EASYSOCIAL_FRIENDS_DIALOG_CANCEL_REQUEST","COM_EASYSOCIAL_YES_CANCEL_MY_REQUEST_BUTTON","COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE","COM_EASYSOCIAL_ADVANCED_SEARCH_ADDRESS_DISTANCE_NOTICE","COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS","COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE","COM_EASYSOCIAL_SUBSCRIPTION_INFO","COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED","COM_EASYSOCIAL_STREAM_META_JOINER","COM_EASYSOCIAL_STORY_SUBMIT_ERROR","COM_EASYSOCIAL_STORY_CONTENT_EMPTY","COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER","COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA","COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME","COM_EASYSOCIAL_STREAM_STORY_WITH","COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER","COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER","COM_EASYSOCIAL_AND","COM_EASYSOCIAL_MOOD_FEELING_CUSTOM","COM_EASYSOCIAL_VIDEOS_STORY_SELECT_CATEGORY","COM_EASYSOCIAL_VIDEOS_STORY_ENTER_VIDEO","COM_EASYSOCIAL_VIDEOS_STORY_PROCESSING_VIDEO","COM_EASYSOCIAL_VIDEOS_STORY_CLICK_INSERT_VIDEO","COM_EASYSOCIAL_VIDEOS_STORY_NO_VIDEO_DETECTED","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBSCRIBE","COM_EASYSOCIAL_STREAM_DIALOG_FEED","COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"]),function(){var b=["easysocial/imgareaselect/default"],c=a.stylesheet({content:""})?"resolve":"reject";
a.each(b,function(b,d){a.require.stylesheet.loader(d)[c]()})}()}),FD40.installer("EasySocial","scripts",function(){EasySocial.module("admin",function(){var b=this;EasySocial.require().library("uniform","chosen","flot").done(function(a){a(".uniform, .check :checkbox, .radio :radio, input:file[data-uniform], .usergroups :checkbox").uniform(),a("[data-chosen]").chosen({disable_search:!0}),a("[data-chosen-search]").chosen({disable_search:!1}),a("[data-sidebar-menu-toggle]").on("click",function(){var b=a(this).parent("li"),c=b.find("ul"),d=a(this).parent("li").hasClass("active");
d?(b.removeClass("active"),c.removeClass("in")):(b.addClass("active"),c.addClass("in"))}),b.resolve()})}),EasySocial.module("admin/access/discover",function(){var b=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(a){EasySocial.Controller("Access.Discover",{defaultOptions:{files:[],progressController:null,"{progressBar}":".discoverProgress","{results}":"[data-access-discovery-result]"}},function(b){return{init:function(){b.options.progressController=b.progressBar().addController(EasySocial.Controller.Progress),a.Joomla("submitbutton",function(a){"discover"==a&&b.startDiscovering()
})},reset:function(){b.results().html(""),b.options.progressController.reset()},addLog:function(c){a("<tr></tr>").append(a("<td></td>").html(c)).appendTo(b.results())},startDiscovering:function(){b.reset(),EasySocial.ajax("admin/controllers/access/scanFiles").done(function(c,d){b.reset(),b.options.files=c,b.options.files.length>0?(b.options.progressController.begin(b.options.files.length),b.addLog(d),b.startIterating()):(b.options.progressController.begin(1),b.options.progressController.completed("Discover Completed"),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")))
})},startIterating:function(){var c=b.options.files.shift();EasySocial.ajax("admin/controllers/access/installFile",{file:c}).always(function(c){b.options.files.length>0?(b.options.progressController.touch("..."),b.addLog(c),b.startIterating()):(b.options.progressController.touch("..."),b.addLog(c),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")))})}}}),b.resolve()})}),EasySocial.module("progress/progress",function(){var b=this;EasySocial.Controller("Progress",{defaultOptions:{current:0,eachWidth:null,total:null,progressClass:"progress progress-info progress-striped","{progressBar}":".bar","{progressResult}":".progress-result",view:{}}},function(a){return{init:function(){},reset:function(){a.options.current=0,a.eachWidth=null,a.total=null,a.progressBar().css("width","0%").html("")
},begin:function(b){a.options.total=b,a.options.eachWidth=100/b,b>0&&a.element.addClass(a.options.progressClass).show()},touch:function(){a.options.current+=a.options.eachWidth,a.options.current>100&&(a.options.current=100),a.progressBar().css("width",a.options.current+"%"),a.progressResult().html(Math.round(a.options.current)+"%")},completed:function(){a.options.current=100,a.progressBar().css("width",a.options.current+"%"),a.progressResult().html(Math.round(a.options.current)+"%")}}}),b.resolve()}),EasySocial.module("admin/alerts/discover",function(){var b=this;
EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(a){EasySocial.Controller("Alerts.Discover",{defaultOptions:{files:[],progressController:null,"{progressBar}":"[data-alerts-discovery-progress]","{results}":"[data-alerts-discovery-result]"}},function(b){return{init:function(){b.initProgressBar(),a.Joomla("submitbutton",function(a){"discover"==a&&b.startDiscovering()})},startDiscovering:function(){b.reset(),EasySocial.ajax("admin/controllers/alerts/discoverFiles",{}).done(function(a,c){b.reset(),b.options.files=a,b.options.files.length>0&&(b.options.progressController.begin(b.options.files.length),b.addLog(c),b.startIterating())
})},reset:function(){b.results().html(""),b.options.progressController.reset()},initProgressBar:function(){b.progressBar().implement(EasySocial.Controller.Progress),b.options.progressController=b.progressBar().controller()},addLog:function(c){a("<tr>").append(a("<td>").html(c)).appendTo(b.results())},startIterating:function(){var c=b.options.files.shift();EasySocial.ajax("admin/controllers/alerts/scan",{file:c}).always(function(c,d){b.options.files.length>0?(b.options.progressController.touch("..."),b.addLog(d),b.startIterating()):(b.options.progressController.touch("..."),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")))
})}}}),b.resolve()})}),EasySocial.module("admin/badges/discover",function(){var b=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(a){EasySocial.Controller("Badges.Discover",{defaultOptions:{files:[],progressController:null,"{progressBar}":"[data-badgesDiscover-progress]","{results}":"[data-badgesDiscover-result]","{viewLog}":"[data-badgesDiscover-viewLog]"}},function(b){return{init:function(){b.initProgressBar(),b.initLogging(),a.Joomla("submitbutton",function(a){"discover"==a&&b.startDiscovering()
})},reset:function(){b.results().html(""),b.initLogging(),b.options.progressController.reset()},initLogging:function(){b.viewLog().hide()},initProgressBar:function(){b.progressBar().implement(EasySocial.Controller.Progress),b.options.progressController=b.progressBar().controller()},addLog:function(c){a("<tr>").append(a("<td>").html(c)).appendTo(b.results())},startIterating:function(){var c=b.options.files.shift();EasySocial.ajax("admin/controllers/badges/scan",{file:c}).always(function(c,d){b.options.files.length>0?(b.options.progressController.touch("..."),b.addLog(d),b.startIterating()):(b.options.progressController.touch("..."),b.addLog(d),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")),b.viewLog().show())
})},startDiscovering:function(){b.reset(),EasySocial.ajax("admin/controllers/badges/discoverFiles",{}).done(function(c,d){b.options.files=c,b.options.files.length>0?(b.options.progressController.begin(b.options.files.length),b.addLog(d),b.startIterating()):(b.options.progressController.begin(1),b.options.progressController.completed("Discover Completed"),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")))})},"{viewLog} click":function(){b.results().toggle()}}}),b.resolve()})}),EasySocial.module("admin/events/approveRecurring",function(a){var b=this;
EasySocial.Controller("Events.ApproveRecurring",{defaultOptions:{postdatas:{},schedules:{},eventids:[],"{progress}":"[data-progress-bar]","{form}":"[data-form]"}},function(b){return{init:function(){var c=0;a.each(b.options.schedules,function(a,b){c+=b.length}),b.total=c,b.startCreate()},total:0,doneCounter:0,eventCounter:0,createCounter:0,updateProgressBar:function(){var a=Math.ceil(b.doneCounter/b.total*100);b.progress().css({width:a+"%"})},startCreate:function(){return void 0===b.options.eventids[b.eventCounter]?b.completed():(b.create().done(function(){b.doneCounter++,b.createCounter++,void 0===b.options.schedules[b.options.eventids[b.eventCounter]][b.createCounter]&&(b.eventCounter++,b.createCounter=0),b.updateProgressBar(),b.startCreate()
}).fail(function(a,b){console.log(a,b)}),void 0)},create:function(){var a=b.options.eventids[b.eventCounter],c=b.options.schedules[a][b.createCounter],d=b.options.postdatas[a];return EasySocial.ajax("admin/controllers/events/createRecurring",{eventId:a,datetime:c,postdata:d})},completed:function(){b.progress().parent().removeClass("progress-info").addClass("progress-success"),b.form().submit()}}}),b.resolve()}),EasySocial.module("admin/events/store",function(a){var b=this;EasySocial.Controller("Events.Update",{defaultOptions:{postdata:{},updateids:[],schedule:[],eventId:null,"{progress}":"[data-progress-bar]","{form}":"[data-form]"}},function(b){return{init:function(){b.startUpdate()
},updateCounter:0,createCounter:0,updateProgressBar:function(){var a=Math.ceil((b.updateCounter+b.createCounter)/(b.options.updateids.length+b.options.schedule.length)*100);b.progress().css({width:a+"%"})},startUpdate:function(){return void 0===b.options.updateids[b.updateCounter]?b.startCreate():(b.update(b.options.updateids[b.updateCounter]).done(function(){b.updateCounter++,b.updateProgressBar(),b.startUpdate()}).fail(function(a,b){console.log(a,b)}),void 0)},update:function(c){var d=a.extend({},b.options.postdata,{id:c,applyRecurring:1});
return EasySocial.ajax("admin/controllers/events/store",d)},startCreate:function(){return void 0===b.options.schedule[b.createCounter]?b.completed():(b.create(b.options.schedule[b.createCounter]).done(function(){b.createCounter++,b.updateProgressBar(),b.startCreate()}).fail(function(a,b){console.log(a,b)}),void 0)},create:function(a){return EasySocial.ajax("admin/controllers/events/createRecurring",{eventId:b.options.eventId,datetime:a,postdata:b.options.postdata})},completed:function(){b.progress().parent().removeClass("progress-info").addClass("progress-success"),b.form().submit()
}}}),b.resolve()}),EasySocial.module("admin/events/users",function(){var b=this;EasySocial.require().language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST").done(function(a){EasySocial.Controller("Events.Users",{defaultOptions:{eventid:null,"{inviteGuest}":"[data-event-invite-guest]","{removeGuest}":"[data-event-remove-guest]","{approveGuest}":"[data-event-approve-guest]","{promoteGuest}":"[data-event-promote-guest]","{demoteGuest}":"[data-event-demote-guest]"}},function(b){return{init:function(){},"{inviteGuest} click":function(){var d={};
window.inviteGuests=function(a){a.state?d[a.id]=a:delete d[a.id]};var e=function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/events/confirmInviteGuests",{guests:d,eventid:b.options.eventid}),bindings:{"{submitButton} click":function(){this.inviteGuestsForm().submit()}}})};EasySocial.dialog({content:EasySocial.ajax("admin/views/events/inviteGuests"),bindings:{"{submitButton} click":function(){e()}}})},"{removeGuest} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["removeGuests"])
},"{approveGuest} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["approveGuests"])},"{promoteGuest} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["promoteGuests"])},"{demoteGuest} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["demoteGuests"])
}}}),b.resolve()})}),EasySocial.module("admin/grid/grid",function(){var b=this;EasySocial.require().script("admin/grid/sort","admin/grid/publishing").done(function(a){EasySocial.Controller("Grid",{defaultOptions:{"{sortColumns}":"[data-table-grid-sort]","{ordering}":"[data-table-grid-ordering]","{saveorder}":"[data-table-grid-saveorder]","{direction}":"[data-table-grid-direction]","{task}":"[data-table-grid-task]","{searchInput}":"[data-table-grid-search-input]","{search}":"[data-table-grid-search]","{resetSearch}":"[data-table-grid-search-reset]","{checkAll}":"[data-table-grid-checkall]","{checkboxes}":"[data-table-grid-id]","{publishItems}":"[data-table-grid-publishing]","{itemRow}":"tr","{boxChecked}":"[data-table-grid-box-checked]","{filters}":"[data-table-grid-filter]"}},function(b){return{init:function(){b.implementSortable(),b.implementPublishing()
},"{filters} change":function(){b.setTask(""),b.submitForm()},"{search} click":function(){b.submitForm()},"{saveorder} click":function(){b.setTask("saveorder"),b.checkAll().click(),b.submitForm()},"{resetSearch} click":function(){b.searchInput().val(""),b.submitForm()},submitForm:function(){b.element.submit()},setTask:function(a){b.task().val(a)},setOrdering:function(a){b.ordering().val(a)},setDirection:function(a){b.direction().val(a)},setTotalChecked:function(a){b.boxChecked().val(a)},toggleSelectRow:function(b){var c=b.find("input[name=cid\\[\\]]");
1==a(c).prop("checked")?a(c).prop("checked",!1):a(c).prop("checked",!0)},selectRow:function(b){var c=b.find("input[name=cid\\[\\]]");a(c).prop("checked",!0)},implementSortable:function(){b.sortColumns().implement(EasySocial.Controller.Grid.Sort,{"{parent}":b})},implementPublishing:function(){b.publishItems().implement(EasySocial.Controller.Grid.Publishing,{"{parent}":b})},"{checkAll} change":function(c){b.checkboxes().prop("checked",a(c).is(":checked"));var e=a(c).is(":checked")?b.checkboxes().length:0;b.setTotalChecked(e)
}}}),b.resolve()})}),EasySocial.module("admin/grid/sort",function(){var b=this;EasySocial.Controller("Grid.Sort",{defaultOptions:{items:"[data-grid-sort-item]"}},function(a){return{init:function(){},"{self} click":function(){var b=a.element.data("direction"),c=a.element.data("sort");a.parent.setOrdering(c),a.parent.setDirection(b),a.parent.setTask(""),a.parent.submitForm()}}}),b.resolve()}),EasySocial.module("admin/grid/publishing",function(){var b=this;EasySocial.Controller("Grid.Publishing",{defaultOptions:{}},function(a){return{init:function(){},"{self} click":function(){var c=a.element.parents("tr"),d=a.element.data("task");
a.parent.selectRow(c),a.parent.setTask(d),a.parent.submitForm()}}}),b.resolve()}),EasySocial.module("admin/grid/ordering",function(a){var b=this;EasySocial.Controller("Grid.Ordering",{defaultOptions:{"{moveUp}":"[data-grid-order-up]","{moveDown}":"[data-grid-order-down]",row:null}},function(b){return{init:function(){b.options.row=b.element.parents("tr")},selectRow:function(){var c=b.options.row.find("input[name=cid\\[\\]]");a(c).prop("checked",!0)},"{moveUp} click":function(){b.selectRow(),a.Joomla("submitform",["moveUp"])
},"{moveDown} click":function(){b.selectRow(),a.Joomla("submitform",["moveDown"])}}}),b.resolve()}),EasySocial.module("admin/groups/groups",function(){var b=this;EasySocial.require().library("expanding").done(function(){EasySocial.Controller("Groups.Pending.Item",{defaultOptions:{"{approve}":"[data-pending-approve]","{reject}":"[data-pending-reject]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},"{approve} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/approveGroup",{ids:a.options.id})})
},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/rejectGroup",{ids:a.options.id})})}}}),b.resolve()})}),EasySocial.module("admin/groups/users",function(){var b=this;EasySocial.require().language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST").done(function(a){EasySocial.Controller("Groups.Users",{defaultOptions:{groupid:null,"{addMember}":"[data-group-add-member]","{removeMember}":"[data-group-remove-member]","{approveMember}":"[data-group-approve-member]","{promoteMember}":"[data-group-promote-member]","{demoteMember}":"[data-group-demote-member]"}},function(b){return{init:function(){},"{addMember} click":function(){var d={};
window.addMembers=function(a){a.state?d[a.id]=a:delete d[a.id]};var e=function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/confirmAddMembers",{members:d,groupid:b.options.groupid}),bindings:{"{submitButton} click":function(){this.addMembersForm().submit()}}})};EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/addMembers"),bindings:{"{submitButton} click":function(){e()}}})},"{removeMember} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["removeMembers"])
},"{approveMember} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["publishUser"])},"{promoteMember} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["promoteMembers"])},"{demoteMember} click":function(){0==document.adminForm.boxchecked.value?alert(a.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):a.Joomla("submitform",["demoteMembers"])
}}}),b.resolve()})}),EasySocial.module("admin/indexer/indexer",function(){var b=this;EasySocial.require().language("COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING","COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED","COM_EASYSOCIAL_INDEXER_REINDEX_RESTART").view("site/loading/small").done(function(a){EasySocial.Controller("Indexer",{defaultOptions:{"{startButton}":"[data-start-button]","{indexerBar}":"[data-indexer-bar]","{indexerResult}":"[data-indexer-result]","{indexerMessage}":"[data-indexer-message]","{resultsButton}":"[data-results-button]",view:{loadingContent:"site/loading/small"}}},function(b){return{init:function(){},"{startButton} click":function(){b.runIndex(0),b.indexerMessage().html(a.language("COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING")),b.indexerMessage().show(),b.startButton().hide()
},runIndex:function(a){EasySocial.ajax("admin/controllers/indexer/indexing",{max:a},{beforeSend:function(){}}).done(function(a,c){0>a&&(c="100"),b.updateProgress(c),a>=0&&b.runIndex(a)}).fail(function(a){b.setMessage(a)}).always(function(){})},updateProgress:function(c){b.indexerBar().css("width",c+"%"),b.indexerResult().html(c+"%"),100==c&&(b.indexerMessage().html(a.language("COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED")),b.startButton().html(a.language("COM_EASYSOCIAL_INDEXER_REINDEX_RESTART")),b.startButton().show(),b.resultsButton().removeClass("hide"))
}}}),b.resolve()})}),EasySocial.module("admin/mailer/mailer",function(){var b=this;EasySocial.Controller("Mailer",{defaultOptions:{"{item}":"[data-mailer-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Mailer.Item)}}}),EasySocial.Controller("Mailer.Item",{defaultOptions:{"{preview}":"[data-mailer-item-preview]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},"{preview} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/mailer/preview",{id:a.options.id})})
}}}),b.resolve()}),EasySocial.module("admin/maintenance/database",function(a){var b=this;EasySocial.Controller("Maintenance.Database",{defaultOptions:{"{start}":"[data-start]","{progress}":"[data-progress]","{progressBox}":"[data-progress-box]","{progressBar}":"[data-progress-bar]","{progressPercentage}":"[data-progress-percentage]"}},function(a){return{init:function(){},"{start} click":function(b){b.hide(),a.progress().show(),a.process()},counter:0,versions:[],process:function(){a.getStats().done(function(b){a.versions=b,a.execute()
})},getStats:function(){return EasySocial.ajax("admin/controllers/maintenance/getDatabaseStats")},execute:function(){return void 0===a.versions[a.counter]?a.completed():(EasySocial.ajax("admin/controllers/maintenance/synchronizeDatabase",{version:a.versions[a.counter]}).done(function(){a.counter++;var b=Math.floor(a.counter/a.versions.length*100)+"%";a.progressBar().css("width",b),a.progressPercentage().text(b),a.execute()}),void 0)},completed:function(){a.progressBar().css("width","100%"),a.progressPercentage().text("100%"),a.progressBox().removeClass("progress-info").addClass("progress-success")
}}}),a("[data-base]").addController("EasySocial.Controller.Maintenance.Database"),b.resolve()}),EasySocial.module("admin/maintenance/maintenance",function(){var b=this;EasySocial.Controller("Maintenance.Execute",{defaultOptions:{"{row}":"[data-row]"}},function(a){return{init:function(){a.runscript()},counter:0,success:0,fail:0,runscript:function(){var b=a.row().eq(a.counter);if(0===b.length)return a.completed();var c=b.data("key");EasySocial.ajax("admin/controllers/maintenance/runscript",{key:c}).done(function(){a.setStatus(b,1),a.success++
}).fail(function(){a.setStatus(b,0),a.fail++}).always(function(){a.counter++,a.runscript()})},completed:function(){a.fail<1&&(window.location="index.php?option=com_easysocial&view=maintenance&success="+a.success)},setStatus:function(a,b){var c=a.find("[data-status]"),d=a.find("[data-icon]"),e=["label-danger","label-success","label-warning"],f=["fa-exclamation-triangle","fa-check","fa-wrench"];for(i=0;3>i;i++)c.toggleClass(e[i],b==i),d.toggleClass(f[i],b==i)}}}),b.resolve()}),EasySocial.module("admin/migrators/migrator",function(){var b=this;
EasySocial.require().script("progress/progress").done(function(a){EasySocial.Controller("Migrators.Migrator",{defaultOptions:{component:null,processState:0,progressController:null,mapping:null,updateconfig:0,"{initiateButton}":"[data-initiate-migration]","{progressBar}":".discoverProgress","{results}":".scannedResult","{viewLog}":".viewLog","{customFieldsMap}":"[data-custom-fields-map]","{resultForm}":"[data-migration-result]","{startWidget}":"[data-start-widget]","{fieldItem}":"[data-field-item]","{startMigrationButton}":"[data-start-migration]","{rows}":"[data-row-item]","{selection}":"[data-field-item]","{jomsocialBackButton}":"[data-jomsocial-back-button]"}},function(b){return{init:function(){b.initProgressBar(),b.initLogging()
},showCustomFields:function(){b.startWidget().slideUp(),b.customFieldsMap().slideDown()},showResultForm:function(){b.customFieldsMap().slideUp(),"com_community"!=b.options.component&&b.startWidget().slideUp(),b.resultForm().slideDown()},startMigration:function(){b.showResultForm(),1!=b.options.processState&&(b.options.processState=1,b.reset(),EasySocial.ajax("admin/controllers/migrators/check",{component:b.options.component}).done(function(a){a.isvalid?(b.options.progressController.begin(a.count),b.startIterating("")):(b.results().show(),b.addLog("Error: "+a.message),b.options.processState=0)
}))},reset:function(){b.results().html(""),b.initLogging(),b.options.progressController.reset()},initLogging:function(){b.viewLog().hide()},initProgressBar:function(){b.progressBar().implement(EasySocial.Controller.Progress),b.options.progressController=b.progressBar().controller()},addLog:function(c){a("<li>").html(c).appendTo(b.results())},startIterating:function(c){null==b.options.mapping&&b.selection().length>0&&(b.options.mapping=a("#adminForm").serializeArray()),EasySocial.ajax("admin/controllers/migrators/process",{component:b.options.component,item:c,mapping:b.options.mapping,updateconfig:b.options.updateconfig}).always(function(a,c){b.options.updateconfig=c,a["continue"]?(b.options.progressController.touch("Discovering..."),b.addLog(a.message),b.startIterating(a.item)):(b.options.progressController.touch("Discover Completed"),b.addLog(a.message),b.addLog("migration process completed."),b.viewLog().show(),b.jomsocialBackButton().show(),b.options.processState=0)
})},"{fieldItem} change":function(b){var c=a(b).val();""==c?a(b).parents("[data-row-item]").removeClass("success").addClass("error"):a(b).parents("[data-row-item]").removeClass("error").addClass("success")},"{startMigrationButton} click":function(){b.selection().length>0&&b.selection().each(function(b,c){""==a(c).val()?a(c).parents("[data-row-item]").removeClass("success").addClass("error"):a(c).parents("[data-row-item]").removeClass("error").addClass("success")});var c=b.rows().hasClass("error");c?EasySocial.dialog({content:EasySocial.ajax("admin/views/migrators/confirmMigration"),bindings:{"{submitButton} click":function(){b.startMigration(),EasySocial.dialog().close()
}}}):b.startMigration()},"{initiateButton} click":function(){b.showCustomFields()},"{viewLog} click":function(){b.results().toggle()}}}),b.resolve()})}),EasySocial.module("admin/points/discover",function(){var b=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(a){EasySocial.Controller("Points.Discover",{defaultOptions:{files:[],progressController:null,"{progressBar}":".discoverProgress","{results}":"[data-points-discovery-result]"}},function(b){return{init:function(){b.initProgressBar(),a.Joomla("submitbutton",function(a){"discover"==a&&b.startDiscovering()
})},reset:function(){b.results().html(""),b.options.progressController.reset()},initProgressBar:function(){b.progressBar().implement(EasySocial.Controller.Progress),b.options.progressController=b.progressBar().controller()},addLog:function(c){a("<tr>").append(a("<td>").html(c)).appendTo(b.results())},startIterating:function(){var c=b.options.files.shift();EasySocial.ajax("admin/controllers/points/scan",{file:c}).always(function(c,d){b.options.files.length>0?(b.options.progressController.touch("..."),b.addLog(d),b.startIterating()):(b.options.progressController.touch("..."),b.addLog(d),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")))
})},startDiscovering:function(){b.reset(),EasySocial.ajax("admin/controllers/points/discoverFiles",{}).done(function(c,d){b.reset(),b.options.files=c,b.options.files.length>0?(b.options.progressController.begin(b.options.files.length),b.addLog(d),b.startIterating()):(b.options.progressController.begin(1),b.options.progressController.completed("Discover Completed"),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")))})}}}),b.resolve()})}),EasySocial.module("admin/polls/polls",function(){var b=this;EasySocial.require().language("COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_POLLS_VIEW_POLLS_DIALOG_TITLE","COM_EASYSOCIAL_POLLS_ACTIONS_DIALOG_TITLE").done(function(a){EasySocial.Controller("Polls",{defaultOptions:{"{item}":"[data-poll-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Polls.Item)
}}}),EasySocial.Controller("Polls.Item",{defaultOptions:{"{action}":"[data-polls-item-view-actions]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.extension=b.element.data("extension"),b.options.uid=b.element.data("uid"),b.options.type=b.element.data("type")},"{action} click":function(){EasySocial.dialog({title:a.language("COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE"),content:"<div>Perform some actions on the item</div>",width:500,height:250,buttons:[{name:a.language("COM_EASYSOCIAL_CLOSE_BUTTON"),classNames:"btn btn-es",click:function(){EasySocial.dialog().close()
}}]})}}}),b.resolve()})}),EasySocial.module("admin/privacy/discover",function(){var b=this;EasySocial.require().script("progress/progress").done(function(a){EasySocial.Controller("Privacy.Discover",{defaultOptions:{files:[],progressController:null,"{startButton}":".scanRules","{progressBar}":".discoverProgress","{results}":".scannedResult","{viewLog}":".viewLog",view:{}}},function(b){return{init:function(){b.initProgressBar(),b.initLogging()},reset:function(){b.results().html(""),b.initLogging(),b.options.progressController.reset()
},initLogging:function(){b.viewLog().hide()},initProgressBar:function(){b.progressBar().implement(EasySocial.Controller.Progress),b.options.progressController=b.progressBar().controller()},addLog:function(c){a("<li>").html(c).appendTo(b.results())},startIterating:function(){var a=b.options.files.shift();EasySocial.ajax("admin/controllers/privacy/scan",{file:a}).always(function(a){b.options.files.length>0?(b.options.progressController.touch("Discovering..."),b.addLog("Scanned "+a.file+" : "+a.rules.length+" rules installed."),b.startIterating()):(b.options.progressController.touch("Discover Completed"),b.addLog("Scanned "+a.file+" : "+a.rules.length+" rules installed."),b.addLog("Scanning completed."),b.viewLog().show(),b.startButton().removeAttr("disabled"))
})},"{startButton} click":function(){b.reset(),b.startButton().attr("disabled","disabled"),EasySocial.ajax("admin/controllers/privacy/discoverFiles",{}).done(function(c){b.options.files=c,b.options.files.length>0?(b.options.progressController.begin(b.options.files.length),b.results().hide(),b.addLog("Found a total of "+c.length+" rules file in the site."),b.startIterating()):(b.options.progressController.begin(1),b.options.progressController.completed("Discover Completed"),b.addLog(a.language("COM_EASYSOCIAL_SCAN_COMPLETED")),b.startButton().removeAttr("disabled"))
})},"{viewLog} click":function(){b.results().toggle()}}}),b.resolve()})}),EasySocial.module("admin/profiles/avatar",function(a){var b=this;EasySocial.require().script("uploader/uploader").done(function(){EasySocial.Controller("Profiles.Avatar",{defaultOptions:{token:null,"{fileUploader}":"[data-profile-avatars-uploader]","{startUploadButton}":"[data-profile-avatars-startupload]","{avatarList}":"[data-profile-avatars-list]","{avatarEmpty}":"[data-profile-avatars-empty]","{avatarItem}":"[data-profile-avatars-item]","{messagePlaceholder}":"[data-profile-avatars-message]","{removeFile}":".removeFile","{clearUploadedItems}":"[data-uploader-clear]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.initUploader(),b.initAvatar()
},initUploader:function(){b.fileUploader().implement(EasySocial.Controller.Uploader,{url:a.indexUrl+"?option=com_easysocial&namespace=admin/controllers/profiles/uploadDefaultAvatars&"+b.options.token+"=1&tmpl=component&format=ajax&uid="+b.options.id})},initAvatar:function(){b.avatarItem().implement("EasySocial.Controller.Profiles.Avatar.Item",{"{parent}":b,items:b.avatarItem})},addMessage:function(a){b.clearMessage(),b.setMessage(a)},"{removeFile} click":function(c){var e=a(c).parents("li").attr("id");b.fileUploader().controller().removeItem(e)
},"{startUploadButton} click":function(){var a=b.fileUploader().controller();a.startUpload()},"{fileUploader} UploadProgress":function(b,c,d){var e=d.percent,f="#"+d.id,g=a(f).find(".progressBar");g.show(),g.find(".bar").css("width",e+"%")},"{fileUploader} FileUploaded":function(a,c,d,e){if(void 0!=e[0]){var f=e[0].data[0];b.avatarEmpty().hide(),b.avatarList().prepend(f),b.clearUploadedItems().show(),b.initAvatar()}},"{clearUploadedItems} click":function(){var a=b.fileUploader().controller();a.reset(),b.clearUploadedItems().hide()
}}}),EasySocial.Controller("Profiles.Avatar.Item",{defaultOptions:{id:null,"{deleteLink}":"[data-avatar-delete]","{setDefaultAvatar}":"[data-avatar-default]"}},function(b){return{init:function(){b.options.id=b.element.data("id")},"{setDefaultAvatar} click":function(){EasySocial.ajax("admin/controllers/avatars/setDefault",{id:b.options.id}).done(function(a){b.parent.avatarItem().removeClass("default"),b.element.addClass("default"),b.parent.addMessage(a)})},"{deleteLink} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/profiles/confirmDeleteAvatar"),bindings:{"{deleteButton} click":function(c){a(c).addClass("btn-loading"),EasySocial.ajax("admin/controllers/avatars/delete",{id:b.options.id}).done(function(a){b.element.remove(),0==b.parent.avatarList().children().length&&b.parent.avatarEmpty().show(),b.parent.addMessage(a),EasySocial.dialog().close()
})}}})}}}),b.resolve()})}),EasySocial.module("uploader/uploader",function(a){var b=this;EasySocial.require().library("plupload").view("site/uploader/queue.item").script("uploader/queue").done(function(){EasySocial.Controller("Uploader",{defaults:{url:a.indexUrl+"?option=com_easysocial&controller=uploader&task=uploadTemporary&format=json&tmpl=component&"+EasySocial.token()+"=1",uploaded:[],query:"",plupload:"",dropArea:"uploaderDragDrop",extensionsAllowed:"jpg,jpeg,png,gif",temporaryUpload:!1,files:[],"{uploaderForm}":"[data-uploader-form]","{uploadButton}":"[data-uploader-browse]","{uploadArea}":".uploadArea","{queue}":"[data-uploaderQueue]","{queueItem}":"[data-uploaderQueue-item]","{emptyFiles}":"[data-uploader-empty]","{removeFile}":"[data-uploaderQueue-remove]","{uploadCounter}":".uploadCounter",view:{queueItem:"site/uploader/queue.item"}}},function(b,c){return{init:function(){b.queue().implement(EasySocial.Controller.Uploader.Queue),c.temporaryUpload&&(c.url=a.indexUrl+"?option=com_easysocial&controller=uploader&task=uploadTemporary&format=json&tmpl=component&"+EasySocial.token()+"=1"),""!=c.query&&(c.url=c.url+"&"+c.query),b.uploaderForm().implement("plupload",{settings:{url:c.url,drop_element:c.dropArea,filters:[{title:"Allowed File Type",extensions:c.extensionsAllowed}]},"{uploader}":"[data-uploader-form]","{uploadButton}":"[data-uploader-browse]"},function(){c.plupload=this.plupload
})},createFileItem:function(d){a.each(d,function(d,e){e.size=b.formatSize(e.size);var f=b.view.queueItem({file:e,temporaryUpload:b.options.temporaryUpload});a(f).implement(EasySocial.Controller.Uploader.Queue.Item,{"{uploader}":b}),c.files.push(e),b.emptyFiles().hide(),b.queue().append(f)})},formatSize:function(a){var b=parseInt(a/1024);return b},reset:function(){b.queueItem().remove()},removeItem:function(c){var d=a("#"+c),e=a(d).find("input[name=upload-id\\[\\]]").val();EasySocial.ajax("site/controllers/uploader/delete",{id:e}).done(function(){a("#"+c).remove(),b.options.plupload.removeFile(b.options.plupload.getFile(c))
})},startUpload:function(){b.upload()},upload:function(){b.options.plupload.files.length>0&&(b.options.uploading=!0,b.options.plupload.start())},hasFiles:function(){return b.options.files.length>0},"{uploaderForm} FilesAdded":function(a,d,e,f){b.createFileItem(f),c.temporaryUpload&&b.startUpload()},"{uploaderForm} UploadProgress":function(a,c,d,e){e&&b.queueItem("#"+e.id).trigger("UploadProgress",e)},"{uploaderForm} FileUploaded":function(a,c,d,e,f){b.queueItem("#"+e.id).trigger("FileUploaded",[e,f])},"{uploaderForm} UploadComplete":function(){b.options.uploading=!1
},"{uploaderForm} Error":function(a,c,d,e){b.clearMessage();var f={message:e.message,type:"error"};b.setMessage(f)},"{uploaderForm} FileError":function(a,c,d,e,f){var g={message:f.message,type:"error"};b.setMessage(g),b.queueItem("#"+e.id).trigger("FileError",[e,f])}}}),b.resolve()})}),EasySocial.module("uploader/queue",function(){var b=this;EasySocial.require().view("site/uploader/queue.item").done(function(a){EasySocial.Controller("Uploader.Queue",{defaults:{"{item}":"[data-uploaderQueue-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Uploader.Queue.Item)
}}}),EasySocial.Controller("Uploader.Queue.Item",{defaultOptions:{"{delete}":"[data-uploaderQueue-remove]","{progress}":"[data-uploaderQueue-progress]","{progressBar}":"[data-uploaderQueue-progressBar]","{status}":"[data-uploaderQueue-status]","{id}":"[data-uploaderQueue-id]"}},function(b){return{init:function(){b.uploader.options.temporaryUpload&&(b.idTemplate=b.id().toHTML(),b.id().remove())},"{delete} click":function(){b.uploader.removeItem(b.element.attr("id"))},"{self} FileUploaded":function(c,d,e,f){b.uploader.options.temporaryUpload&&a.buildHTML(b.idTemplate).val(f.id).appendTo(b.element),5==e.status&&(b.element.addClass("is-done"),b.status().html("Done"))
},"{self} UploadProgress":function(a,c,d){b.status().html(d.percent+"%"),b.progressBar().css("width",d.percent+"%")},"{self} FileError":function(){b.element.removeClass("is-done is-queue").addClass("is-error"),b.progress().removeClass("progress-danger progress-success progress-info progress-warning").addClass("progress-danger"),b.status().html("Error")}}}),b.resolve()})}),EasySocial.module("admin/profiles/fields",function(a){var b=this;EasySocial.require().library("ui/draggable","ui/sortable","ui/droppable").script("field").view("admin/profiles/fields/editor.item","admin/profiles/fields/step.item","admin/profiles/fields/editor.page","admin/profiles/fields/config","admin/profiles/fields/dialog.move").language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_PAGE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_FIELD","COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS","COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES","COM_EASYSOCIAL_FIELDS_INVALID_VALUES").done(function(){var c,d,e,f,g,h={},i={},j={},k={},l={},m={pages:[],fields:[]};
EasySocial.Controller("Fields",{defaultOptions:{id:0,group:null,"{wrap}":"[data-fields-wrap]","{browser}":"[data-fields-browser]","{editor}":"[data-fields-editor]","{steps}":"[data-fields-steps]","{config}":"[data-fields-config]","{saveForm}":"[data-fields-save]",view:{config:"admin/profiles/fields/config"}}},function(b){return{init:function(){c=b,b.options.id=b.element.data("id"),d=b.addPlugin("browser"),e=b.addPlugin("editor"),f=b.addPlugin("steps");var g=[d.state,e.state,f.state];a.when.apply(null,g).done(function(){c.trigger("controllersReady")
}),a(".profileForm").on("save",function(a,c,d){var e=b.save(c);d.push(e)})},changed:!1,customFieldChanged:function(){b.changed=!0},"{window} beforeunload":function(){return b.changed?a.language("COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES"):void 0},"{saveForm} click":function(){b.save()},save:function(d){var h=a.Deferred();if(b.element.find("input,select").not(b.saveForm()).prop("disabled",!0),b.saveForm().val(""),"savecopy"===d&&(b.changed=!0),!b.changed)return h.resolve(),h;if(c.trigger("saving"),g&&g.state&&!g.checkConfig())return EasySocial.dialog({content:a.language("COM_EASYSOCIAL_FIELDS_INVALID_VALUES")}),h.reject(),h;
j=a.extend(!0,{},i);var k=[];if(a.each(f.step(),function(b,c){c=a(c);var d=e.getPage(c.data("id"));k.push(d._export())}),a._.keys(j).length>0)return c.trigger("saved",[!1]),EasySocial.dialog({content:a.language("COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS")}),h.reject(),h;c.changed=!1;var l={data:k,deleted:m};return b.injectSaveData(l),h.resolve(),h},injectSaveData:function(a){a=JSON.stringify(a),b.saveForm().val(a)},updateResult:function(b){a.each(b,function(a,b){var c=f.step().eq(a),d=c.data("id"),g=e.getPage(d);
f.updateResult(a,b.id),g.updateResult(d,b)})},"{self} doneConfiguring":function(){b.element.removeClass("editting")},loadConfiguration:function(c,d){b.element.addClass("editting");var e=a(b.view.config());g=e.addController("EasySocial.Controller.Fields.Config",{controller:{item:c}}),"page"===d?c.pageHeader().append(e):c.element.append(e),b.element.trigger("loadingConfig",[d])}}}),EasySocial.Controller("Fields.Browser",{defaultOptions:{"{browser}":"[data-fields-browser]","{mandatory}":"[data-fields-browser-group-mandatory]","{unique}":"[data-fields-browser-group-unique]","{standard}":"[data-fields-browser-group-standard]","{list}":"[data-fields-browser-list]","{item}":"[data-fields-browser-item]",affixClass:"es-browser-affix"}},function(b){return{state:a.Deferred(),init:function(){b.registerApps(),b.ready(),b.affixHandler(),b.initAffix()
},ready:function(){b.state.resolve()},"{parent} controllersReady":function(){var a=f.getCurrentStep().data("id");b.initDraggable(a)},"{parent} pageChanged":function(a,c,d,e){b.item().draggable("destroy"),b.initDraggable(e)},"{parent} pageAdded":function(a,c,d,e){b.item().draggable("destroy"),b.initDraggable(e)},initDraggable:function(a){b.item().draggable({revert:"invalid",helper:"clone",connectToSortable:"[data-fields-editor-page-items-"+a+"]"})},affixHandler:function(){var c=a(window),d=b.parent.wrap(),e=d.offset().top,f=c.scrollTop();
f>e&&!b.browser().hasClass(b.options.affixClass)&&b.browser().addClass(b.options.affixClass),e>=f&&b.browser().hasClass(b.options.affixClass)&&b.browser().removeClass(b.options.affixClass)},initAffix:function(){a(window).scroll(b.affixHandler)},registerApps:function(){a.each(b.item(),function(b,c){c=a(c);var d=c.data("id");h[d]={id:d,element:c.data("element"),title:c.data("title"),params:c.data("params"),core:c.data("core"),unique:c.data("unique"),item:c},c.data("core")&&(i[d]=h[d])})},checkout:function(a){void 0!==j[a]&&delete j[a]
},"{item} click":function(a){var b=e.currentPage(),c=a.data("id");b.addNewField(c)},"{parent} fieldAdded":function(a,c,d){var e=h[d];if(e&&e.core){e.item.hide();var f=b.mandatory().find(b.item.selector).filter(":visible");b.mandatory().toggle(f.length>0)}if(e&&e.unique){e.item.hide();var f=b.unique().find(b.item.selector).filter(":visible");b.unique().toggle(f.length>0)}},"{parent} fieldDeleted":function(a,c,d){var f=h[d];return f&&f.core?(f.item.show(),b.mandatory().show(),void 0):f&&f.unique?(f.item.show(),b.unique().show(),void 0):void 0
}}}),EasySocial.Controller("Fields.Config",{defaultOptions:{"{config}":"[data-fields-config]","{header}":"[data-fields-config-header]","{close}":"[data-fields-config-close]","{form}":"[data-fields-config-form]","{param}":"[data-fields-config-param]","{tabnav}":"[data-fields-config-tab-nav]","{tabcontent}":"[data-fields-config-tab-content]","{done}":"[data-fields-config-done]"}},function(b){return{init:function(){},state:!1,load:function(d){if(b.state=!0,d.find("[data-fields-config-param-choices]").addController("EasySocial.Controller.Config.Choices",{controller:{item:b.item}}),d.find("h4").hide(),b.header().html(d.find("h4").html()),b.form().html(d),b.item.options.newfield&&b.param("[data-fields-config-param-field-unique_key]").attr("disabled",!0).val(a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST")),b.tabnav().length>0){var e=b.tabnav().find('a[data-tabname="core"]');
e.length>0?e.tab("show"):b.tabnav().find("a:first").tab("show")}b.populateConfig();var f=b.element.height();c.wrap().css("padding-bottom",f+"px"),c.trigger("configLoaded")},"{close} click":function(){b.closeConfig()},"{done} click":function(){b.closeConfig()},closeConfig:function(){var d=b.populateConfig(),e=b.checkConfig(d);e?(b.item.updateHtml(b.form().html()),b.item.content().trigger("onConfigSave",[d]),b.element.remove(),g=null,c.trigger("doneConfiguring")):EasySocial.dialog({content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES"),width:400,height:100})
},"{parent} loadingConfig":function(c,d,e){if(void 0!==e&&"field"!=e){var f=a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_"+e.toUpperCase());b.header().html(f)}b.config().show(),b.close().hide(),b.form().html(a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING"))},"{parent} configLoaded":function(){b.close().show()},"{param} change":function(a){b.paramChanged(a)},"{param} keyup":function(a){b.paramChanged(a)},paramChanged:function(a){var d=a.data("name"),e=b.getConfigValue(d),f=b.item.appParams[d];
"boolean"===f.type&&(e=!!e),b.item.fieldItem().trigger("onConfigChange",[d,e]),c.customFieldChanged()},getConfigValue:function(c){var d=b.item.appParams[c],e=b.param().filterBy("name",c);if(0===e.length)return void 0;var f="";switch(d.type){case"choices":f=[],a.each(e.find("li"),function(b,c){c=a(c);var d=c.find("[data-fields-config-param-choice-title]"),e=c.find("[data-fields-config-param-choice-value]"),g=c.find("[data-fields-config-param-choice-default]");f.push({id:c.data("id"),title:d.val(),value:e.val(),"default":g.val()}),d.attr("value",d.val()),e.attr("value",e.val()),g.attr("value",g.val())
});break;case"boolean":var g=e.val();f="true"===g||"1"===g||1===g?1:0,e.attr("value",f);break;case"checkbox":f=[],a.each(d.option,function(a,b){var c=e.filter("[data-fields-config-param-option-"+b.value+"]");c.length>0&&c.is(":checked")?(f.push(b.value),c.attr("checked","checked")):c.removeAttr("checked")});break;case"list":case"select":case"dropdown":f=e.length>0?e.val():d["default"]||"",e.find("option").prop("selected",!1),e.find('option[value="'+f+'"]').prop("selected",!0);break;case"input":case"text":default:f=e.length>0?e.val():d["default"]||"",e.attr("value",f)
}return f},populateConfig:function(){var c={};return a.each(b.item.appParams,function(a){var e=b.getConfigValue(a);return void 0===e?!1:(c[a]=e,void 0)}),b.item.trigger("onPopulateConfig",[c]),c},checkConfig:function(c){void 0===c&&(c=b.populateConfig());var d=!0;return a.each(c,function(c,e){var f=b.item.appParams[c];switch(f.type){case"choices":var g=[];a.each(e,function(b,c){return a.isEmpty(c.value)&&!a.isEmpty(c.title)&&(c.value=c.title.toLowerCase().replace(" ","")),!a.isEmpty(c.value)&&a.inArray(c.value,g)>-1?(d=!1,!1):(g.push(c.value),void 0)
})}return d===!1?!1:void 0}),d},"{parent} fieldDeleted":function(){b.state&&c.trigger("doneConfiguring")},"{parent} pageDeleted":function(){b.state&&c.trigger("doneConfiguring")},"{parent} pageAdded":function(){b.state&&c.trigger("doneConfiguring")},"{parent} pageChanged":function(){b.state&&c.trigger("doneConfiguring")}}}),EasySocial.Controller("Fields.Steps",{defaultOptions:{"{steps}":"[data-fields-step]","{step}":"[data-fields-step-item]","{stepLink}":"[data-fields-step-item-link]","{add}":"[data-fields-step-add]",view:{stepItem:"admin/profiles/fields/step.item"}}},function(b){return{state:a.Deferred(),init:function(){b.ready()
},ready:function(){b.state.resolve()},"{parent} controllersReady":function(){b.initSort()},initSort:function(){b.steps().sortable({items:b.step.selector,placeholder:"ui-state-highlight",cursor:"move",helper:"clone",forceHelperSize:!0,stop:function(){a(".tooltip-es").remove(),c.customFieldChanged()}})},"{parent} pageDeleted":function(a,c,d){b.deleteStep(d),f.step().length>0&&f.stepLink(":first").tab("show")},"{step} click":function(a){if(!a.hasClass("active")){var d=a.data("id");c.trigger("pageChanged",[e.getPage(d),d])
}},"{add} click":function(){var c=a.uid("step");b.addStep(c),e.addPage(c),b.stepLink(":last").tab("show")},addStep:function(a){b.add().before(b.view.stepItem({uid:a}))},getStep:function(a){return b.step().filterBy("id",a)},getStepLink:function(a){return b.stepLink().filterBy("id",a)},deleteStep:function(a){b.getStep(a).remove()},getCurrentStep:function(){return b.step(".active")},currentStepIndex:function(){return b.step().index(b.step(".active"))+1},updateResult:function(a,c){var d=b.step(":eq("+a+")");if(d.data("id")!=c){var e=d.data("id");
d.removeAttr("data-fields-step-item-"+e),d.attr("data-fields-step-item-"+c,!0),d.data("id",c),d.attr("data-id",c);var f=b.stepLink().eq(a);f.removeAttr("data-fields-step-item-link-"+e),f.attr("data-fields-step-item-link-"+c,!0),f.attr("href","#formStep_"+c)}},toObject:function(){var c=[];return a.each(b.stepLink(),function(b,d){d=a(d),c.push({uid:d.data("id"),title:d.text(),description:d.attr("data-original-title")})}),c}}}),EasySocial.Controller("Fields.Editor",{defaultOptions:{"{editor}":"[data-fields-editor]","{page}":"[data-fields-editor-page]","{items}":"[data-fields-editor-page-items]","{item}":"[data-fields-editor-page-item]",view:{editorPage:"admin/profiles/fields/editor.page"}}},function(b){return{state:a.Deferred(),init:function(){b.ready()
},ready:function(){b.state.resolve()},"{parent} controllersReady":function(){b.page().addController("EasySocial.Controller.Fields.Editor.Page")},currentPage:function(){return b.page(".active").controller()},addPage:function(a){var d=b.view.editorPage({uid:a});d.addController("EasySocial.Controller.Fields.Editor.Page",{uid:a,newpage:!0}),b.editor().append(d),b.page().trigger("pageAdded",[d,a]),c.customFieldChanged()},getPage:function(a){return b.page().filterBy("id",a).controller()},"{parent} saving":function(){b.element.addClass("saving")
},"{parent} saved":function(a,c,d){b.element.removeClass("saving")}}}),EasySocial.Controller("Fields.Editor.Page",{defaultOptions:{pageid:0,uid:0,newpage:!1,"{items}":"[data-fields-editor-page-items]","{item}":"[data-fields-editor-page-item]","{pageHeader}":"[data-fields-editor-page-header]","{content}":"[data-fields-editor-page-header]","{fieldItem}":"[data-fields-editor-page-header]","{pageTitle}":"[data-fields-editor-page-title]","{pageDescription}":"[data-fields-editor-page-description]","{inputTitle}":"[data-fields-editor-page-title-input]","{inputDescription}":"[data-fields-editor-page-description-input]","{pageVisibleRegistration}":"[data-fields-editor-page-visible-registration]","{pageVisibleEdit}":"[data-fields-editor-page-visible-edit]","{pageVisibleView}":"[data-fields-editor-page-visible-view]","{pageDelete}":"[data-fields-editor-page-delete]","{pageEdit}":"[data-fields-editor-page-edit]","{pageInfo}":"[data-fields-editor-page-info]","{pageInfoDone}":"[data-fields-editor-page-done]",view:{editorItem:"admin/profiles/fields/editor.item"}}},function(b){return{init:function(){b.options.newpage||(b.options.uid=b.options.pageid=b.element.data("id")),b.registerPage(),b.item().addController("EasySocial.Controller.Fields.Editor.Item",{pageid:b.options.uid}),b.checkPageDeleteButton(),b.initSort()
},fields:{},getStep:function(){return f.getStep(b.options.uid)},registerPage:function(){l[b.options.uid]=b},initSort:function(){b.items().sortable({items:b.item.selector,handle:"[data-fields-editor-page-item-handle]",placeholder:"ui-state-highlight",cursor:"move",helper:"clone",forceHelperSize:!0,stop:function(a,e){if(e.item.is(d.item.selector)){var f=e.item.data("id"),g=b.createPlaceholder();e.item.replaceWith(g),b.createNewField(f,g)}c.customFieldChanged()}})},addNewField:function(d){var e=b.createPlaceholder();
b.items().append(e),a.scrollTo(e,200),b.createNewField(d,e),c.customFieldChanged()},createPlaceholder:function(){var c=a.uid("newfield"),d=b.view.editorItem({uid:c});return d},createNewField:function(d,e){c.trigger("fieldAdded",[d]),b.getFieldHtml(d).done(function(c){c=a.parseHTML(c,document,!0),c=a(c),e.replaceWith(c);var f=c.filter('[data-appid="'+d+'"]');f.addController("EasySocial.Controller.Fields.Editor.Item",{controller:{page:b},appid:d,pageid:b.options.uid,newfield:!0})}).fail(function(a){e.html(a)})
},getFieldHtml:function(b){var d=a.Deferred();return void 0===h[b].html?EasySocial.ajax("admin/controllers/fields/renderSample",{appid:b,profileid:c.options.id,group:c.options.group}).done(function(a){h[b].html=a,d.resolve(a)}).fail(function(a){d.reject(a)}):d.resolve(h[b].html),d},"{pageHeader} click":function(c,d){var e=a(d.target);if(e.not("[data-fields-editor-page-delete]")&&!c.hasClass("editting")){if(g&&g.state){var f=g.checkConfig();if(!f)return EasySocial.dialog({content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES"),width:400,height:100}),void 0;
g.closeConfig()}b.loadConfiguration()}},loadConfiguration:function(){c.loadConfiguration(b,"page"),b.pageHeader().addClass("editting"),b.getPageConfig().done(function(){var c=a(b.html);g.load(c)}).fail(function(a){g.load(a)})},updateHtml:function(a){b.html=a},getPageConfig:function(){var c=a.Deferred();return a.isEmptyObject(b.params)?EasySocial.ajax("admin/controllers/fields/renderPageConfig",{pageid:b.options.pageid}).done(function(a,d,e){b.params=a,b.values=d,b.html=e,b.appParams=a,c.resolve()}).fail(function(a){c.reject(a)
}):c.resolve(),c},getConfigValues:function(){return b.values},"{fieldItem} onConfigChange":function(a,d,e,g){b.values[e]=g;var h=f.getStepLink(b.options.uid);"title"===e&&(h.text(g),b.pageTitle().html(g)),"description"===e&&(h.attr("data-original-title",g),b.pageDescription().html(g)),c.customFieldChanged()},"{pageDelete} click":function(c){if(c.enabled()){if(c.disabled(!0),1==e.page().length)return c.enabled(!0),!1;EasySocial.dialog({width:400,height:150,title:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE"),content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION"),showOverlay:!1,buttons:[{name:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL"),classNames:"btn btn-es",click:function(){c.enabled(!0),EasySocial.dialog().close()
}},{name:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM"),classNames:"btn btn-es-danger",click:function(){EasySocial.dialog().update({content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING")}),b.deletePage(),EasySocial.dialog().close()}}]})}},deletePage:function(){b.item().trigger("pageDeleted"),c.trigger("pageDeleted",[b.options.uid]),delete l[b.options.uid],b.options.newpage||m.pages.push(b.options.uid),b.element.remove(),a.each(e.page(),function(b,c){a(c).controller().checkPageDeleteButton()
}),c.customFieldChanged()},_export:function(){var c=[];a.each(b.item(),function(b,d){d=a(d).controller(),void 0!==d&&c.push(d._export())});var d={fields:c,newpage:b.options.newpage,id:b.options.uid};if(void 0!==b.values)var d=a.extend(d,b.values);return d},updateResult:function(c,d){b.options.newpage&&(b.element.attr("id","formStep_"+d.id),b.element.removeAttr("data-fields-editor-page-"+c),b.element.attr("data-fields-editor-page-"+d.id,!0),b.options.pageid=b.options.uid=d.id,l[d.id]=a.extend(!0,{},l[c]),delete l[c],b.options.newpage=!1),void 0!==d.fields&&a.each(d.fields,function(a,c){var d=b.item().eq(a).controller();
d.updateResult(c)})},"{self} pageAdded":function(){b.checkPageDeleteButton(),c.customFieldChanged()},checkPageDeleteButton:function(){e.page().length>1?b.pageDelete().show():b.pageDelete().hide()},"{parent} loadingConfig":function(){b.pageHeader().removeClass("editting"),b.item().removeClass("editting")},"{parent} doneConfiguring":function(){b.pageHeader().removeClass("editting"),b.item().removeClass("editting")}}}),EasySocial.Controller("Fields.Editor.Item",{defaultOptions:{appid:0,fieldid:0,pageid:0,newfield:!1,"{edit}":"[data-fields-editor-page-item-edit]","{deleteButton}":"[data-fields-editor-page-item-delete]","{moveButton}":"[data-fields-editor-page-item-move]","{content}":"[data-fields-editor-page-item-content]","{fieldItem}":"[data-field]","{config}":"[data-fields-config]","{closeConfig}":"[data-fields-config-close]",view:{moveDialog:"admin/profiles/fields/dialog.move"}}},function(b){return{app:{},field:{id:0,appid:0,params:{}},state:a.Deferred(),appParams:{},init:function(){0==b.options.appid&&void 0!==b.element.data("appid")&&(b.options.appid=b.element.data("appid")),void 0!==h[b.options.appid]&&(b.app=h[b.options.appid]),0==b.options.fieldid&&void 0!==b.element.data("id")&&(b.options.fieldid=b.element.data("id")),b.registerFields(),b.uniqueid=a.uid(b.app.id+"_"),b.loadedInit()
},registerFields:function(){0!=b.options.fieldid&&(k[b.options.fieldid]={id:b.options.fieldid,appid:b.options.appid,params:b.field.params||{}},b.field=k[b.options.fieldid])},loadedInit:function(){b.element.addController("EasySocial.Controller.Field.Base",{mode:"sample",element:b.app.element}),b.content().addController("EasySocial.Controller.Fields.Editor.Item.Config")},_export:function(){d.checkout(b.options.appid);var c={fieldid:b.options.fieldid,appid:b.options.appid,newfield:b.options.newfield};return c=a.extend(c,b.expandConfig(b.field.params))
},"{self} click":function(c,d){var e=a(d.target);if(!(e.is(b.deleteButton.selector)||e.is(b.moveButton.selector)||e.is(b.config.selector)||e.is(b.closeConfig.selector)||c.hasClass("editting"))){if(g&&g.state){var f=g.checkConfig();if(!f)return EasySocial.dialog({content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES"),width:400,height:100}),void 0;g.closeConfig()}b.loadConfiguration()}},loadConfiguration:function(){c.loadConfiguration(b,"field"),b.element.addClass("editting"),b.getAppParams().done(function(){var c=a(b.field.html);
g.load(c)}).fail(function(){})},updateHtml:function(a){b.field.html=a},getAppParams:function(){var c=a.Deferred();return b.field.html?c.resolve():EasySocial.ajax("admin/controllers/fields/renderConfiguration",{appid:b.options.appid,fieldid:b.options.fieldid}).done(function(a,d,e){b.app.params=a,b.field.params=d,b.field.html=e,b.populateAppParams(),c.resolve()}).fail(function(a){c.reject(a)}),c},populateAppParams:function(){a.each(b.app.params,function(c,d){a.each(d.fields,function(c,d){d.subfields?a.each(d.subfields,function(a,d){b.appParams[c+"_"+a]=d
}):b.appParams[c]=d})})},getConfigValues:function(){return b.field.params},expandConfig:function(){var c={params:{},choices:{}};return a.each(b.field.params,function(a,d){var e=b.appParams[a];if(!e)return!1;var f="choices"==e.type?"choices":"params";c[f][a]=d}),b.options.newfield&&(c.params.unique_key=""),c},"{moveButton} click":function(d){var g=f.toObject(),h=d.parents(e.page.selector).data("id"),i=[];a.each(g,function(a,b){b.uid!=h&&i.push(b)}),EasySocial.dialog({content:b.view.moveDialog(!0,{pages:i}),selectors:{"{selection}":"[data-move-selection]","{confirmButton}":"[data-move-confirm]","{cancelButton}":"[data-move-cancel]"},bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()
},"{confirmButton} click":function(){var a=this.selection().val(),d=e.getPage(a);d.items().append(b.element),c.customFieldChanged(),EasySocial.dialog().close()}}})},"{deleteButton} click":function(c){c.enabled()&&(c.disabled(!0),EasySocial.dialog({width:400,height:150,title:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE"),content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION"),showOverlay:!1,buttons:[{name:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL"),classNames:"btn btn-es btn-sm",click:function(){c.enabled(!0),EasySocial.dialog().close()
}},{name:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM"),classNames:"btn btn-es-danger btn-sm",click:function(){EasySocial.dialog().update({content:a.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING")}),b.deleteField(),EasySocial.dialog().close()}}]}))},deleteField:function(){c.trigger("fieldDeleted",[b.options.appid,b.options.fieldid]),b.options.newfield||(delete k[b.options.fieldid],m.fields.push(b.options.fieldid)),b.element.remove(),c.customFieldChanged()
},"{self} pageDeleted":function(){b.deleteField()},"{content} onConfigChange":function(a,c,d,e){b.field.params[d]=e},"{self} onPopulateConfig":function(a,c,d){b.field.params=d},updateResult:function(c){b.field.params.unique_key=c.unique_key,b.itemParam("[data-fields-config-param-field-unique_key]").val(c.unique_key),b.options.newfield&&(b.options.newfield=!1,b.options.fieldid=c.fieldid,b.element.data("id",c.fieldid),b.itemParam("[data-fields-editor-page-item-param-field-unique_key]").removeAttr("disabled"),b.registerFields()),void 0!==c.choices&&a.each(c.choices,function(c,d){var e=b.itemParam("[data-fields-config-param-field-"+c+"]");
a.each(d,function(a,b){var c=e.find("li").eq(a);c.data("id")||(c.attr("data-id",b.id),c.data("id",b.id))})})}}}),EasySocial.Controller("Config.Choices",{defaultOptions:{"{choiceItems}":"[data-fields-config-param-choice]",unique:1}},function(b){return{init:function(){b.options.unique=void 0!==b.element.data("unique")?b.element.data("unique"):1,b.choiceItems().implement(EasySocial.Controller.Config.Choices.Choice,{controller:{item:b.item,choices:b}}),b.initSortable()},initSortable:function(){b.element.sortable({items:b.choiceItems.selector,placeholder:"ui-state-highlight",cursor:"move",forceHelperSize:!0,handle:"[data-fields-config-param-choice-drag]",stop:function(){a(".tooltip-es").remove(),c.customFieldChanged()
}})}}}),EasySocial.Controller("Config.Choices.Choice",{defaultOptions:{"{choiceValue}":"[data-fields-config-param-choice-value]","{choiceTitle}":"[data-fields-config-param-choice-title]","{choiceDefault}":"[data-fields-config-param-choice-default]","{addChoice}":"[data-fields-config-param-choice-add]","{removeChoice}":"[data-fields-config-param-choice-remove]","{setDefault}":"[data-fields-config-param-choice-setdefault]","{defaultIcon}":"[data-fields-config-param-choice-defaulticon]"}},function(b){return{init:function(){},"{choiceTitle} keyup":a._.debounce(function(a){var e=b.element.index();
b.item.fieldItem().trigger("onChoiceTitleChanged",[e,a.val()]),c.customFieldChanged()},500),"{choiceValue} keyup":a._.debounce(function(a){var e=b.element.index();b.item.fieldItem().trigger("onChoiceValueChanged",[e,a.val()]),c.customFieldChanged()},500),"{addChoice} click":function(){var a=b.element.clone(),d=a.find('input[type="text"]');d.attr("value",""),d.val("");var e=a.find('input[type="hidden"]');e.attr("value",0),e.val(0);var f=a.find("[data-fields-config-param-choice-defaulticon]");f.removeClass("es-state-featured").addClass("es-state-default"),a.attr("data-id",0),a.data("id",0),a.implement(EasySocial.Controller.Config.Choices.Choice,{controller:{item:b.item,choices:b.choices}}),b.element.after(a);
var g=a.index();b.item.fieldItem().trigger("onChoiceAdded",[g]),c.customFieldChanged()},"{removeChoice} click":function(){var d=b.choices.choiceItems().length-1;if(d>=1){var e=b.element.index();b.item.fieldItem().trigger("onChoiceRemoved",[e]),b.element.remove(),a(".tooltip-es").remove()}c.customFieldChanged()},"{setDefault} click":function(){{var a=b.element.index();b.choiceTitle().val(),b.choiceValue().val()}b.choices.choiceItems().trigger("toggleDefault",[a]),b.item.fieldItem().trigger("onChoiceToggleDefault",[a,parseInt(b.choiceDefault().val())]),c.customFieldChanged()
},"{self} toggleDefault":function(a,c,d){var e=b.element.index(),f=parseInt(b.choiceDefault().val());e===d?f?(b.defaultIcon().removeClass("es-state-featured").addClass("es-state-default"),b.choiceDefault().val(0)):(b.defaultIcon().removeClass("es-state-default").addClass("es-state-featured"),b.choiceDefault().val(1)):b.choices.options.unique&&(b.defaultIcon().removeClass("es-state-featured").addClass("es-state-default"),b.choiceDefault().val(0))}}}),EasySocial.Controller("Fields.Editor.Item.Config",{defaultOptions:{"{required}":"[data-required]","{title}":"[data-title]","{description}":"[data-description]","{displayTitle}":"[data-display-title]","{displayDescription}":"[data-display-description]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"display_title":a.displayTitle().toggle(!!e);
break;case"title":a.title().text(e);break;case"display_description":a.displayDescription().toggle(!!e);break;case"description":a.description().text(e);break;case"required":a.required().toggle(!!e)}}}}),b.resolve()})}),EasySocial.module("field",function(a){var b=this;EasySocial.Controller("Field.Base",{defaultOptions:{regPrefix:"easysocial/",modPrefix:"field.",ctrlPrefix:"EasySocial.Controller.Field.",fieldname:"",element:null,id:null,required:!1,mode:"edit","{field}":"[data-field]","{content}":"[data-content]","{notice}":"[data-check-notice]"}},function(b){return{init:function(){b.options.fieldname=b.element.data("fieldname"),b.options.element=b.options.element||b.element.data("element"),b.options.id=b.element.data("id"),b.options.required=!!b.element.data("required"),b.initMode(),b.notice().text().trim().length>0&&(b.content().popover({animation:!1,content:b.notice().text().trim(),html:!0,placement:"left-top",trigger:"manual",container:"body",template:'<div id="fd" class="fd-popover es es-field-error"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'}),b.content().popover("show"))
},initMode:function(){switch(b.options.mode){case"registermini":b.field().trigger("onRegisterMini");break;case"register":b.field().trigger("onRegister");break;case"edit":b.field().trigger("onEdit");break;case"adminedit":b.field().trigger("onAdminEdit");break;case"sample":b.field().trigger("onSample");break;case"display":b.field().trigger("onDisplay")}},"{field} error":function(c,d,e,f){e=void 0!==e?e:!0,a.isString(e)&&(f=e,e=!0),a.isBoolean(e)&&b.field().toggleClass("has-error",e),void 0!==f&&(b.content().popover({animation:!1,content:f,html:!0,placement:"left-top",trigger:"manual",container:"body",template:'<div id="fd" class="fd-popover es es-field-error"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'}),b.content().popover("show"))
},"{field} clear":function(){b.field().removeClass("has-error"),b.field().removeClass("is-loading"),b.content().popover("destroy")},"{self} show":function(){b.field().trigger("onShow")},"{field} loading":function(a,c,d){b.field().addClass("is-loading"),b.notice().html(d)},"{field} loaded":function(){b.field().removeClass("is-loading")}}}),b.resolve()}),EasySocial.module("admin/profiles/form",function(){var b=this;EasySocial.require().script("utilities/alias").done(function(a){EasySocial.Controller("Profiles.Profile",{defaultOptions:{id:null,hasAvatar:!1,defaultAvatar:null,"{profileAvatar}":"[data-profile-avatar]","{profileAvatarImage}":"[data-profile-avatar-image]","{profileAvatarRemoveWrap}":"[data-profile-avatar-remove-wrap]","{profileAvatarRemoveButton}":"[data-profile-avatar-remove-button]","{profileAvatarUpload}":"[data-profile-avatar-upload]"}},function(b){return{init:function(){b.element.addController("EasySocial.Controller.Utilities.Alias",{"{source}":"#title","{target}":"#alias"}),b.options.hasAvatar=b.profileAvatar().data("hasavatar"),b.options.defaultAvatar=b.profileAvatar().data("defaultavatar")
},"{profileAvatarUpload} change":function(c){var d=c.val();a.isEmpty(d)?b.options.hasAvatar||b.profileAvatarRemoveWrap().hide():b.profileAvatarRemoveWrap().show()},"{profileAvatarRemoveButton} click":function(){return b.options.hasAvatar?(EasySocial.dialog({content:EasySocial.ajax("admin/views/profiles/confirmRemoveProfileAvatar"),bindings:{"{deleteButton} click":function(){EasySocial.ajax("admin/controllers/profiles/deleteProfileAvatar",{id:b.options.id}).done(function(){b.profileAvatarImage().attr("src",b.options.defaultAvatar),b.profileAvatarRemoveWrap().hide(),b.options.hasAvatar=!1,EasySocial.dialog().close()
})}}}),void 0):(b.profileAvatarUpload().val("").trigger("change"),void 0)}}}),b.resolve()})}),EasySocial.module("utilities/alias",function(){var b=this;EasySocial.Controller("Utilities.Alias",{defaultOptions:{"{target}":"","{source}":""}},function(a){return{init:function(){},convertToPermalink:function(a){return a.replace(/\s/g,"-").replace(/[^\w/-]/g,"").toLowerCase()},"{source} keyup":function(){var d=a.convertToPermalink(a.source().val());a.target().val(d)},"{target} keyup":function(){var d=a.convertToPermalink(a.target().val());
a.target().val(d)}}}),b.resolve()}),EasySocial.module("admin/profiles/members",function(){var b=this;EasySocial.require().language("COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_ASSIGN_BUTTON","COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE").done(function(a){EasySocial.Controller("Profiles.Members",{defaultOptions:{"{addUser}":"[data-profiles-addUser]","{row}":"[data-profiles-members-row]"}},function(b){return{init:function(){b.options.id=b.element.data("id")},"{memberList} userSelected":function(a,c,d){EasySocial.ajax("admin/controllers/profiles/insertMember",{id:d,profile_id:b.options.id}).done(function(a){b.row().append(a),EasySocial.dialog().close()
})},"{addUser} click":function(){var c=a.callback(function(a){b.addPlugin("memberList",a)}),d=a.indexUrl+"?option=com_easysocial&view=users&tmpl=component&callback="+c;EasySocial.dialog({title:a.language("COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE"),content:d,showOverlay:!1,width:700,height:600,buttons:[{name:a.language("COM_EASYSOCIAL_CANCEL_BUTTON"),classNames:"btn btn-es",click:function(){EasySocial.dialog().close()}}]})}}}),b.resolve()})}),EasySocial.module("admin/profiles/profile",function(){var b=this;
EasySocial.require().script("utilities/alias").view("admin/profiles/dialog.delete.profileavatar").language("COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR").done(function(a){EasySocial.Controller("Profiles.Profile",{defaultOptions:{id:null,hasAvatar:!1,defaultAvatar:null,"{profileAvatar}":"[data-profile-avatar]","{profileAvatarImage}":"[data-profile-avatar-image]","{profileAvatarRemoveWrap}":"[data-profile-avatar-remove-wrap]","{profileAvatarRemoveButton}":"[data-profile-avatar-remove-button]","{profileAvatarUpload}":"[data-profile-avatar-upload]",view:{deleteProfileAvatar:"admin/profiles/dialog.delete.profileavatar"}}},function(b){return{init:function(){b.element.addController("EasySocial.Controller.Utilities.Alias",{"{source}":"#title","{target}":"#alias"}),b.options.hasAvatar=b.profileAvatar().data("hasavatar"),b.options.defaultAvatar=b.profileAvatar().data("defaultavatar")
},"{profileAvatarUpload} change":function(c){var d=c.val();a.isEmpty(d)?b.options.hasAvatar||b.profileAvatarRemoveWrap().hide():b.profileAvatarRemoveWrap().show()},"{profileAvatarRemoveButton} click":function(){b.options.hasAvatar?EasySocial.dialog({content:b.view.deleteProfileAvatar(!0),bindings:{"{deleteButton} click":function(){var c=this.parent;c.loading(!0),EasySocial.ajax("admin/controllers/profiles/deleteProfileAvatar",{id:b.options.id}).done(function(){c.loading(!1),c.close(),b.profileAvatarImage().attr("src",b.options.defaultAvatar),b.profileAvatarRemoveWrap().hide(),b.profileAvatarRemoveButton().text(a.language("COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR")),b.options.hasAvatar=!1
})}}}):b.profileAvatarUpload().val("").trigger("change")}}}),b.resolve()})}),EasySocial.module("admin/profiles/profiles",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Profiles",{defaultOptions:{"{updateOrdering}":"[data-profiles-update-ordering]","{item}":"[data-profiles-item]",view:{deleteConfirmation:"admin/profiles/dialog.delete.confirm"}}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Profiles.Item)},"{updateOrdering} click":function(){a("[data-table-checkall]").prop("checked",!0).trigger("change"),a.Joomla("submitform",["updateOrdering"])
}}}),EasySocial.Controller("Profiles.Item",{defaultOptions:{"{insertLink}":"[data-profile-insert]"}},function(a){return{init:function(){a.options.title=a.element.data("title"),a.options.id=a.element.data("id")},"{insertLink} click":function(){a.trigger("profileSelected",[a.options.id,a.options.title])}}}),b.resolve()})}),EasySocial.module("admin/regions/form",function(a){var b=this;EasySocial.require().language("COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE").done(function(){a.template("easysocial/parents.select",'<select name="parent_uid" data-parent-uid></select>'),a.template("easysocial/parents.option",'<option value="[%= uid %]">[%= name %]</option>'),EasySocial.Controller("Regions.Form",{defaultOptions:{"{type}":"[data-type]","{parentBase}":"[data-parent-base]","{parentContent}":"[data-parent-content]","{parentUid}":"[data-parent-uid]","{parentType}":"[data-parent-type]",view:{parentsSelect:"parents.select",parentsOption:"parents.option"}}},function(b){return{init:function(){b.element.find('input[type="text"]').prop("disabled",!b.type().val()),b.element.find('[data-bs-toggle="radio-buttons"]').toggleClass("disabled",!b.type().val()),a.Joomla("submitbutton",function(c){return"cancel"==c?(window.location="index.php?option=com_easysocial&view=regions",!1):(b.validate()?a.Joomla("submitform",[c]):alert(a.language("COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE")),void 0)
})},"{type} change":function(c){var d=c.find(":selected").data("parent");b.parentType().val(d),b.element.find('input[type="text"]').prop("disabled",!c.val()),b.element.find('[data-bs-toggle="radio-buttons"]').toggleClass("disabled",!c.val()),d?(b.parentBase().show(),!b.parentContent().data("loaded")&&b.getParents(d).done(function(c){var d=a(b.view.parentsSelect());a.each(c,function(a,c){b.view.parentsOption({uid:c.uid,name:c.name}).appendTo(d)}),b.parentContent().html(d)})):b.parentBase().hide()},getParents:a.memoize(function(a){return EasySocial.ajax("admin/controllers/regions/getParents",{type:a})
}),validate:function(){return b.type().val()&&b.element.find('input[name="name"]').val()&&b.element.find('input[name="code"]').val()}}}),b.resolve()})}),EasySocial.module("admin/regions/init",function(a){var b=this;EasySocial.Controller("Region.Init",{defaultOptions:{callback:function(){},"{startButton}":"[data-start]","{table}":"[data-table]","{tableBody}":"[data-table-body]","{row}":"[data-table-row]"}},function(b){return{init:function(){b.row().addController("EasySocial.Controller.Region.Init.Row")},"{startButton} click":function(c){c.hide(),b.table().show(),b.counter=0,b.progress=a.Deferred().done(function(){b.options.callback()
}),b.process()},process:function(){var a=b.row().eq(b.counter);return 0===a.length?b.progress.resolve():(a.show(),EasySocial.ajax("admin/controllers/regions/initialise",{key:a.data("key")}).done(function(){a.trigger("updateStatus",[1]),b.counter++,b.process()}),void 0)}}}),EasySocial.Controller("Region.Init.Row",{defaultOptions:{"{title}":"[data-row-title]","{status}":"[data-row-status]","{icon}":"[data-row-icon]"}},function(a){return{init:function(){},statuses:["label-danger","label-success","label-warning"],icons:["fa-exclamation-triangle","fa-check","fa-wrench"],"{self} updateStatus":function(b,c,d){var e=a.status(),f=a.icon();
for(i=0;3>i;i++)e.toggleClass(a.statuses[i],d==i),f.toggleClass(a.icons[i],d==i)}}}),b.resolve()}),EasySocial.module("admin/reports/reporters",function(){var b=this;EasySocial.Controller("Reports.Reporters",{defaultOptions:{"{item}":"[data-reporters-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Reports.Reporters.Item,{"{parent}":a})}}}),EasySocial.Controller("Reports.Reporters.Item",{defaultOptions:{"{removeItem}":"[data-remove-item]"}},function(a){return{init:function(){a.options.id=a.element.data("id")
},"{removeItem} click":function(){a.parent.clearMessage(),EasySocial.ajax("admin/controllers/reports/removeItem",{id:a.options.id}).done(function(b){a.parent.setMessage(b.message,b.type),a.element.remove()})}}}),b.resolve()}),EasySocial.module("admin/reports/reports",function(){var b=this;EasySocial.require().language("COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE","COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE").done(function(a){EasySocial.Controller("Reports",{defaultOptions:{"{item}":"[data-reports-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Reports.Item)
}}}),EasySocial.Controller("Reports.Item",{defaultOptions:{"{action}":"[data-reports-item-view-actions]","{viewReports}":"[data-reports-item-view-reports]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.extension=b.element.data("extension"),b.options.uid=b.element.data("uid"),b.options.type=b.element.data("type")},"{viewReports} click":function(){EasySocial.dialog({title:a.language("COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE"),content:EasySocial.ajax("admin/controllers/reports/getReporters",{id:b.options.id}),width:600,height:450})
},"{action} click":function(){EasySocial.dialog({title:a.language("COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE"),content:"<div>Perform some actions on the item</div>",width:500,height:250,buttons:[{name:a.language("COM_EASYSOCIAL_CLOSE_BUTTON"),classNames:"btn btn-es",click:function(){EasySocial.dialog().close()}}]})}}}),b.resolve()})}),EasySocial.module("admin/sidebar/sidebar",function(){var b=this;EasySocial.require().done(function(){EasySocial.Controller("Sidebar.Sidebar",{defaultOptions:{intervalPendingUsers:5e3,"{usersBadge}":".menu-user > a .badge","{pendingUsersBadge}":".menu-user .menu-ies-vcard > .badge"}},function(a){return{init:function(){a.checkPendingUsers()
},monitorPendingUsers:function(){a.options.state=setTimeout(a.checkPendingUsers,a.options.intervalPendingUsers)},checkPendingUsers:function(){a.stopMonitorPendingUsers(),setTimeout(function(){EasySocial.ajax("admin/controllers/users/getTotalPending").done(function(b){b>0?(a.usersBadge().html(b),a.pendingUsersBadge().html(b)):a.usersBadge().html(""),a.monitorPendingUsers()})},a.options.intervalPendingUsers)},stopMonitorPendingUsers:function(){clearTimeout(a.options.state)}}}),b.resolve()})}),EasySocial.module("admin/themes/compiler",function(a){var b=this;
a.fn.at=function(a){return this.find("[data-"+a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},a.template("easysocial/compiler/detail",'<tr class="[%= type %]"><td>[%= timestamp %]</td><td width="100%">[%= message %]</td></tr>'),EasySocial.Controller("Themes.Compiler",{defaultOptions:{view:{detail:"compiler/detail"},"{section}":"[data-section]","{compileButton}":"[data-compile-button]","{minifyButton}":"[data-minify-button]","{buildButton}":"[data-build-button]","{filesButton}":"[data-files-button]","{purgeButton}":"[data-purge-button]","{resetButton}":"[data-reset-button]","{forceCompileButton}":"[data-force-compile-button]","{clearLogButton}":"[data-clear-log-button]","{toggleLogButton}":"[data-toggle-log-button]","{refreshButton}":"[data-refresh-button]","{refreshSectionButton}":"[data-refresh-section-button]","{buildWithoutMinifyButton}":"[data-build-without-minify-button]","{log}":"[data-log]","{details}":"[data-details]","{status}":"[data-status]","{imports}":"[data-imports]","{progress}":"[data-progress]","{progressBar}":"[data-progress-bar]","{progressStatus}":"[data-progress-status]","{tabItem}":".tab-item"}},function(b,c,d){return{init:function(){b.location=d.data("location"),b.name=d.data("name"),b.override=d.data("override")
},sections:function(){var c=a.map(b.section(),function(c){var d=a(c).data("sectionName"),e=b.sectionId(d);return{id:e,name:d}});return c},sectionId:function(a){return b.location+"-"+b.name+"-"+a},sectionTab:function(a){return b.tabItem({sectionId:b.sectionId(a)}).find("> a")},sectionNameOf:function(a){var c=b.section.of(a),d=c.data("sectionName");return d},getLog:function(a){return a?b.section({sectionName:a}).at("log"):b.log(":first")},addLog:function(c,d){var e=b.getLog(d),f=e.find("tbody");a.isString(c)&&(c={timestamp:new Date,message:c,type:"info"});
var g=c.type;/warning|warn/.test(g)&&(g="warning"),/danger|error|failed|fail/.test(g)&&(g="danger"),/pending|default|primary/.test(g)&&(g="");var h=c.timestamp,i=h instanceof Date?h:new Date(parseFloat(h));h=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds();var j=c.message;b.view.detail({type:g,timestamp:h,message:j}).appendTo(f),f[0].scrollTop=f[0].scrollHeight},appendLog:function(c,d){a.each(c,function(a,c){b.addLog(c,d)})},clearLog:function(a){var c=b.getLog(a),d=c.find("tbody");d.empty(),c.at("timeTotal").data("value",0).html("0s"),c.at("memoryUsage").data("value",0).html("0mb")
},generateLog:function(a,c){b.clearLog(c),b.appendLog(a.details,c);var d=b.getLog(c),e=parseFloat(a.time_total),f=e.toFixed(2)+"s",g=parseInt(a.mem_peak),h=(g/1024/1024).toFixed(2)+"mb";d.at("timeTotal").data("value",e).html(f),d.at("memoryUsage").data("value",g).html(h),b.addLog({type:a.failed?"danger":"success",timestamp:a.time_end,message:a.failed?"Task failed.":"Task completed."},c)},updateLog:function(a,c){var d=b.getLog(c),e=d.at("timeTotal"),f=d.at("memoryUsage");b.appendLog(a.details,c);var g=e.data("value")+parseFloat(a.time_total),h=g.toFixed(2)+"s",i=Math.max(f.data("value"),parseInt(a.mem_peak)),j=(i/1024/1024).toFixed(2)+"mb";
e.data("value",g).html(h),f.data("value",i).html(j)},perform:function(c,d){return EasySocial.ajax("admin/controllers/themes/"+c,a.extend({location:b.location,name:b.name,override:b.override},d))},build:function(a){var c=b.sections(),a=a||"cache",e="cache"==a,f=0,g=c.length-1,h=f+1,i=(g+1)*(e?2:1)+1,j=100,k=!1,n=(b.log(":first"),b.progress(":first"),b.progressBar(":first")),o=b.progressStatus(":first"),p=function(){h++,progressValue=h/i*j,n.show().width(progressValue+"%")},q=function(){var a=c[f],g=(a.id,a.name),h=b.sectionTab(g),i="Compiling section '"+g+"'.";
p(),o.html(i),h.tab("show"),b.compile(g,{force:!0}).done(function(a){b.updateLog(a.task)}).fail(function(a){b.updateLog(a.task),k=!0}).always(function(){if(e){var a="Minifying section '"+g+"'.";p(),o.html(a),b.minify(g).done(function(a){b.updateLog(a.task)}).fail(function(a){b.updateLog(a.task),k=!0}).always(function(){r()})}else r()})},r=function(){return g>f++?q():(s(),void 0)},s=function(){o.html("Building stylesheets."),p();var c;b.perform("build",{preset:a}).done(function(a){b.status(":first").replaceWith(a.status),c=a.task
}).fail(function(a){c=a.task}).always(function(){c||(c={failed:!0,details:[],time_end:new Date}),b.updateLog(c),b.addLog({type:c.failed?"danger":"success",timestamp:c.time_end,message:c.failed?"Build failed.":"Build completed."}),o.html("Build completed!"),n.width("100%"),d.removeClass("is-busy")})};n.hide().width("0%"),d.addClass("is-busy"),b.clearLog(),c.length>0?(b.addLog("Compiling all sections."),q()):s()},minify:function(c,d){var e=b.perform("minify",a.extend({section:c},d));return b.trigger("minify",[c,e]),e
},"{self} minify":function(a,c,d,e){var f=b.section({sectionName:d}),g=f.at("progressStatus"),h=f.at("progressBar"),i="Minifying section '"+d+"'.";f.addClass("is-busy"),g.html(i),h.hide().width("0%").show().width("100%"),e.done(function(a){f.at("imports").replaceWith(a.imports),f.at("status").replaceWith(a.status),b.appendLog(a.task.details,d),b.addLog({type:e.failed?"danger":"success",timestamp:a.task.time_end,message:e.failed?"Task failed.":"Task completed."},d)}).always(function(){f.removeClass("is-busy")
})},compile:function(c,d){var e=b.perform("compile",a.extend({section:c},d));return b.trigger("compile",[c,e]),e},"{self} compile":function(a,c,d,e){var f=b.section({sectionName:d}),g=f.at("progressStatus"),h=f.at("progressBar"),i="Compiling section '"+d+"'.";f.addClass("is-busy"),g.html(i),h.hide().width("0%").show().width("100%"),b.clearLog(d),b.addLog(i,d),e.done(function(a){f.at("imports").replaceWith(a.imports),f.at("status").replaceWith(a.status),b.generateLog(a.task,d)}).fail(function(a){b.generateLog(a.task,d)
}).always(function(){f.removeClass("is-busy")})},purge:function(){var c=(b.progress(":first"),b.progressBar(":first")),e=b.progressStatus(":first");d.addClass("is-busy"),b.clearLog(),c.hide().width("0%").show().width("100%"),e.html("Purging cache and log files."),b.perform("purge").done(function(a){b.generateLog(a)}).fail(function(){}).always(function(){d.removeClass("is-busy")})},"{buildButton} click":function(){b.build("cache")},"{buildWithoutMinifyButton} click":function(){b.build("development")},"{compileAllButton} click":function(){},"{compileButton} click":function(a){var c=b.sectionNameOf(a);
return b.compile(c)},"{forceCompileButton} click":function(a){var c=b.sectionNameOf(a);return b.compile(c,{force:!0})},"{minifyButton} click":function(a){var c=b.sectionNameOf(a);return b.minify(c)},"{refreshButton} click":function(){d.addClass("is-busy"),b.progressBar(":first").show().width("100%"),b.progressStatus(":first").html("Refreshing"),EasySocial.ajax("admin/views/themes/compiler",{location:b.location,name:b.name,override:b.override}).done(function(a){d.replaceWith(a)}).fail(function(){alert("Unable to refresh section.")
}).always(function(){d.removeClass("is-busy")})},"{refreshSectionButton} click":function(a){var c=b.sectionNameOf(a),d=b.section({sectionName:c});d.addClass("is-busy"),d.at("progressStatus").html("Refreshing"),EasySocial.ajax("admin/views/themes/section",{location:b.location,name:b.name,override:b.override,section:c}).done(function(a){d.html(a)}).fail(function(){alert("Unable to refresh section.")}).always(function(){d.removeClass("is-busy")})},"{resetButton} click":function(){alert("TODO: Restore to factory default.")
},"{purgeButton} click":function(){b.purge()}}}),b.resolve()}),EasySocial.module("admin/users/form",function(){var b=this;EasySocial.require().script("field").done(function(a){EasySocial.Controller("Users.Form",{defaultOptions:{userid:null,mode:"adminedit","{selectProfile}":"[data-user-select-profile]","{content}":"[data-user-new-content]","{profileTitle}":"[data-profile-title]","{fieldItem}":"[data-profile-adminedit-fields-item]","{tabnav}":"[data-tabnav]","{tabcontent}":"[data-tabcontent]","{stepnav}":"[data-stepnav]","{stepcontent}":"[data-stepcontent]",view:{loading:"site/loading/large"}}},function(b){return{init:function(){window.selectedProfile=b.selectedProfile,b.fieldItem().addController("EasySocial.Controller.Field.Base",{userid:b.options.userid,mode:b.options.mode})
},selectedProfile:function(a){EasySocial.dialog().close(),window.location.href="index.php?option=com_easysocial&view=users&layout=form&profileId="+a},"{selectProfile} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/profiles/browse")})},errorFields:[],"{fieldItem} error":function(c){var e=c.data("id");a.inArray(e,b.errorFields)<0&&b.errorFields.push(e);var f=c.parents(b.stepcontent.selector).data("for");b.stepnav().filterBy("for",f).trigger("error");var g=c.parents(b.tabcontent.selector).data("for");
b.tabnav().filterBy("for",g).trigger("error")},"{fieldItem} clear":function(c){var e=c.data("id");b.errorFields=a.without(b.errorFields,e);var f=c.parents(b.stepcontent.selector).data("for");b.stepnav().filterBy("for",f).trigger("clear");var g=c.parents(b.tabcontent.selector).data("for");b.tabnav().filterBy("for",g).trigger("clear")},"{stepnav} error":function(a){a.addClass("error")},"{tabnav} error":function(a){a.addClass("error")},"{stepnav} clear":function(a){b.errorFields.length<1&&a.removeClass("error")
},"{tabnav} clear":function(a){b.errorFields.length<1&&a.removeClass("error")},"{stepnav} click":function(a){var c=a.data("for");b.stepcontent().filterBy("for",c).find(b.fieldItem.selector).trigger("show")}}}),b.resolve()})}),EasySocial.module("admin/users/privacy",function(){var b=this;EasySocial.require().library("textboxlist").view("site/loading/small").done(function(a){EasySocial.Controller("Profile.Privacy",{defaultOptions:{userId:"","{privacyItem}":"[data-privacy-item]","{privacyForm}":"[data-profile-privacy-form]",view:{loading:"site/loading/small"}}},function(a){return{init:function(){a.privacyItem().implement(EasySocial.Controller.Profile.Privacy.Item,{"{parent}":a})
}}}),EasySocial.Controller("Profile.Privacy.Item",{defaultOptions:{"{selection}":"[data-privacy-select]","{hiddenCustom}":"[data-hidden-custom]","{customForm}":"[data-privacy-custom-form]","{customTextInput}":"[data-textfield]","{customItems}":"input[]","{customHideBtn}":"[data-privacy-custom-hide-button]","{customInputItem}":"[data-textboxlist-item]","{customEditBtn}":"[data-privacy-custom-edit-button]"}},function(b){return{init:function(){b.customTextInput().textboxlist({component:"es",unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:2,cache:!1,query:function(a){var c=b.getTaggedUsers(),d=EasySocial.ajax("site/views/privacy/getfriends",{q:a,userid:b.parent.options.userId,exclude:c});
return d}}}}),b.textboxlistLib=b.customTextInput().textboxlist("controller")},getTaggedUsers:function(){var c=[],d=b.customInputItem();return d.length>0&&a.each(d,function(b,d){c.push(a(d).data("id"))}),c},"{customTextInput} addItem":function(a,c,d){var e=b.hiddenCustom().val(),f="";if(""==e)f=d.id;else{var g=e.split(",");g.push(d.id),f=g.join(",")}b.hiddenCustom().val(f)},"{customTextInput} removeItem":function(a,c,d){for(var e=b.hiddenCustom().val(),f="",g=[],h=e.split(","),i=0;i<h.length;i++)h[i]!=d.id&&g.push(h[i]);
f=g.length<=0?"":g.join(","),b.hiddenCustom().val(f)},"{customEditBtn} click":function(){b.customForm().toggle()},"{selection} change":function(a){var c=a.val();"custom"==c?(b.customForm().show(),b.customEditBtn().show()):(b.customForm().hide(),b.customEditBtn().hide())},"{customHideBtn} click":function(){b.customForm().hide(),b.customEditBtn().show(),b.textboxlistLib.autocomplete.hide()}}}),b.resolve()})}),EasySocial.module("admin/users/users",function(){var b=this;EasySocial.require().library("expanding").done(function(a){EasySocial.Controller("Users",{defaultOptions:{"{item}":"[data-user-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Users.Item)
}}}),EasySocial.Controller("Users.Item",{defaultOptions:{"{insertLink}":"[data-user-item-insertLink]"}},function(a){return{init:function(){a.options.name=a.element.data("name"),a.options.avatar=a.element.data("avatar"),a.options.email=a.element.data("email"),a.options.id=a.element.data("id")},"{insertLink} click":function(){a.trigger("userSelected",[a.options.id,a.options.name,a.options.avatar,a.options.email])}}}),EasySocial.Controller("Users.Pending",{defaultOptions:{"{item}":"[data-pending-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Users.Pending.Item)
}}}),EasySocial.Controller("Users.Pending.Item",{defaultOptions:{"{approve}":"[data-pending-approve]","{reject}":"[data-pending-reject]"}},function(b){return{init:function(){b.options.id=b.element.data("id")},"{approve} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/users/confirmApprove",{id:b.options.id}),bindings:{"{approveButton} click":function(){a("[data-users-approve-form]").submit()}}})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/users/confirmReject",{id:b.options.id})})
}}}),b.resolve()})}),EasySocial.module("albums/album",function(a){var b=this;EasySocial.require().library("tinyscrollbar").done(function(){EasySocial.Controller("Albums.Album",{defaultOptions:{"{title}":"[data-album-title]","{count}":"[data-album-count]","{privacy}":"[data-album-privacy]","{cover}":"[data-album-cover]","{coverImage}":"[data-album-cover-image]","{link}":"[data-album-link]","{menu}":"[data-album-menu]","{menuActions}":"[data-album-menu-actions]","{shareButton}":"[data-album-share-button]","{shareContent}":"[data-sharing]","{followButton}":"[data-album-follow-button]","{reportButton}":"[data-album-report-button]","{deleteButton}":"[data-album-delete-button]","{likeButton}":"[data-album-like-button]","{commentButton}":"[data-album-comment-button]","{countsButton}":"[data-album-counts-button]","{commentCount}":"[data-album-comment-count]","{likeCount}":"[data-album-like-count]","{actions}":"[data-item-actions]","{actionContent}":"[data-item-action-content]","{actionCloseButton}":"[data-item-action-close-button]","{actionsMenu}":"[data-item-actions-menu]","{likesHolder}":"[data-album-likes-holder]","{commentsHolder}":"[data-album-comments-holder]","{responseHolder}":"[data-album-response-holder]","{comments}":"[data-comments]"}},function(b){return{init:function(){b.id=b.element.data("album-id"),b.actionContent().tinyscrollbar(),b.actions().hasClass("open")&&(b.loadResponse(),b.element.addClass("show-all"))
},remove:function(){b.element.remove()},"{coverImage} click":function(){window.location=b.link().attr("href")},"{shareButton} click":function(){b.shareContent().show()},"{deleteButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/albums/confirmDelete",{id:b.id})})},like:function(){EasySocial.ajax("site/controllers/albums/like",{id:b.id}).done(function(a){b.likeCount().html(a.count),a.state?b.likeButton().addClass("liked"):b.likeButton().removeClass("liked"),b.likesHolder().html(a.html)
})},loadResponse:function(){var a=b.loadResponse.loader;a&&"rejected"!=a.state()||(b.loadResponse.loader=EasySocial.ajax("site/views/albums/response",{id:b.id}).done(function(a){b.responseHolder().html(a),b.actionContent().removeClass("loading").tinyscrollbar_update()}))},getButton:function(c){var c=a(c),d=b.countsButton(),e=b.commentButton();return c.is(d)||c.parents().filter(d).length>0?d:c.is(e)||c.parents().filter(e).length>0?e:a()},lastButton:a(),"{actions} shown.bs.dropdown":function(a,c,d){b.loadResponse(),b.element.addClass("show-all");
var e=b.actionContent(),f=b.lastButton=b.getButton(d),g=f.position().left+f.width()/2-e.width()/2;e.css("margin-left",g).tinyscrollbar_update()},"{actions} hide.bs.dropdown":function(a,c,d){b.element.removeClass("show-all");var e=b.getButton(d),f=b.lastButton;e.is(f)||setTimeout(function(){e.trigger("click")},0)},"{actionCloseButton} click":function(){b.hideActionContent()},"{likeButton} click":function(){b.like()},"{comments} newCommentSaved":function(){var a=b.comments().controller("EasySocial.Controller.Comments.Stat");
b.commentCount().html(a.total()),b.actionContent().tinyscrollbar_update("bottom")},"{comments} commentDeleted":function(){var a=b.comments().controller("EasySocial.Controller.Comments.Stat");b.commentCount().html(a.total()),b.actionContent().tinyscrollbar_update()},"{actionsMenu} shown.bs.dropdown":function(){b.element.addClass("show-all")},"{actionsMenu} hidden.bs.dropdown":function(){b.element.removeClass("show-all")}}}),b.resolve()})}),EasySocial.module("albums/browser",function(a){var b=this;EasySocial.require().library("history").view("site/albums/browser.list.item").done(function(){EasySocial.Controller("Albums.Browser",{hostname:"browser",defaultOptions:{view:{listItem:"site/albums/browser.list.item"},itemRenderOptions:{},"{sidebar}":"[data-album-browser-sidebar]","{content}":"[data-album-browser-content]","{createAlbumButton}":"[data-album-create-button]","{createAlbumButtonLink}":"[data-album-create-button] > a","{listItemGroup}":"[data-album-list-item-group]","{listItemRegularGroup}":"[data-album-list-item-group=regular]","{listItemCoreGroup}":"[data-album-list-item-group=core]","{listItem}":"[data-album-list-item]","{listItemLink}":"[data-album-list-item] > a","{listItemTitle}":"[data-album-list-item-title]","{listItemCover}":"[data-album-list-item-cover]","{listItemCount}":"[data-album-list-item-count]","{albumItem}":"[data-album-item]","{photoBrowser}":"[data-photo-browser]"}},function(b){return{init:function(){b.albumItem().each(function(){b.addSubscriber(a(this).controller("EasySocial.Controller.Albums.Item"))
})},setLayout:function(a){b.element.hasClass("layout-dialog")||b.element.data("layout",a).switchClass("layout-"+a)},open:function(c){var d=a.makeArray(arguments);b.trigger("contentload",d);var e="view"+a.String.capitalize(c),f=b[e].apply(b,d.slice(1));return f.done(b.displayContent(function(){return b.trigger("contentdisplay",d),arguments})).fail(function(){b.trigger("contentfail",d)}).always(function(){b.trigger("contentcomplete",d)}),f},"{self} contentdisplay":function(a,c,d){/album|albumform/gi.test(d)&&b.setLayout("album"),/photo/gi.test(d)&&b.setLayout("photo")
},displayContent:a.Enqueue(function(c){var d=[],e=a(a.buildFragment([c],document,d));b.content().html(e),a(d).remove()}),viewAlbum:function(a){b.listItem().removeClass("active loading");var c=b.getListItem(a).addClass("active loading");"dialog"!==b.element.data("layout")&&c.find("> a").route();var d=EasySocial.ajax("site/views/albums/item",{id:a,renderOptions:b.options.itemRenderOptions}).fail(function(){}).always(function(){c.removeClass("loading")});return d},viewAlbumForm:function(){var c=(b.listItem().removeClass("active loading"),b.view.listItem({}).addClass("active loading new").prependTo(b.listItemRegularGroup())),d=EasySocial.ajax("site/views/albums/form",{uid:b.options.uid,type:b.options.type}).fail(function(){}).always(function(){c.removeClass("loading")
});return d},viewPhoto:function(a){var b=EasySocial.ajax("site/views/photos/item",{id:a,browser:1}).fail(function(){}).always(function(){});return b},"{listItem} click":function(a){if(!a.hasClass("new")){var c=a.data("albumId");b.open("Album",c)}},"{listItemLink} click":function(a,b){b.preventDefault(),a.blur()},"{createAlbumButton} click":function(){b.open("AlbumForm"),"dialog"!==b.element.data("layout")&&b.createAlbumButtonLink().route()},"{createAlbumButtonLink} click":function(a,b){b.preventDefault()},"{albumItem} init.albums.item":function(a,c,d){b.addSubscriber(d)
},getListItem:function(c,d){var e=c?b.listItem().filterBy("albumId",c):b.listItem(".new");return d?e.find(b["listItem"+a.String.capitalize(d)].selector):e},updateListItemCount:function(a,c,d){var e=b.getListItem(a,"count");if(!(e.length<0)){var f;f=d?(parseInt(e.text())||0)+(parseInt(c)||0):c,0>f&&(f=0),e.text(f)}},"{albumItem} albumSave":function(a,c,d){d.done(function(a){b.getListItem().attr("data-album-id",a.id).removeClass("new"),b.getListItem(a.id).find("> a").attr({href:a.permalink,title:a.title}).route(),b.getListItem(a.id,"title").html(a.title)
})},"{albumItem} titleChange":function(c,d,e,f){b.getListItem(f.id,"title").html(a.trim(e)||"&nbsp;")},"{albumItem} coverChange":function(c,d,e,f){b.getListItem(f.id,"cover").css("backgroundImage",a.cssUrl(e.sizes.thumbnail.url))},"{albumItem} coverRemove":function(a,c,d){b.getListItem(d.id,"cover").css("backgroundImage","")},"{albumItem} photoAdd":function(a,c,d,e,f){b.updateListItemCount(f.id,1,!0)},"{albumItem} photoMove":function(a,c,d,e){d.done(function(){b.updateListItemCount(e.album.id,-1,!0)})},"{albumItem} photoDelete":function(a,c,d,e){d.done(function(){b.updateListItemCount(e.album.id,-1,!0)
})},"{photoBrowser} init.photos.browser":function(a,c,d){b.addSubscriber(d)},"{self} contentload":function(){b.listItem(".new").remove()}}}),b.resolve()})}),EasySocial.module("albums/editor",function(a){var b=this;EasySocial.require().script("albums/editor/sortable","albums/editor/uploader").done();var d=EasySocial.Controller("Albums.Editor",{hostname:"editor",defaultOptions:{view:{uploadItem:"site/albums/upload.item"},canReorder:!1,canUpload:!0,"{titleField}":"[data-album-title-field]","{captionField}":"[data-album-caption-field]","{coverField}":"[data-album-cover-field]","{type}":"[data-album-type]","{uid}":"[data-album-uid]","{location}":"[data-album-location]","{locationCaption}":"[data-album-location-caption]","{addLocationButton}":"[data-album-addLocation-button]","{date}":"[data-album-date]","{dateCaption}":"[data-album-date-caption]","{addDateCaption}":"[data-album-addDate-button]","{privacy}":"[data-album-privacy]","{uploadButton}":"[data-album-upload-button]","{deleteButton}":"[data-album-delete-button]","{moreButton}":"[data-album-more-button]","{privacy}":"[data-privacy-hidden]","{privacycustom}":"[data-privacy-custom-hidden]","{uploadItem}":"[data-photo-upload-item]","{dateDay}":"[data-date-day]","{dateMonth}":"[data-date-month]","{dateYear}":"[data-date-year]","{editButton}":"[data-album-edit-button]","{editButtonLink}":"[data-album-edit-button] > a","{doneButton}":"[data-album-done-button]","{doneButtonLink}":"[data-album-done-button] > a","{cancelButton}":"[data-album-cancel-button]","{cancelButtonLink}":"[data-album-cancel-button] > a","{locationWidget}":".es-album-location-form .es-locations","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]"}},function(b){return{init:function(){b.id=b.element.data("album-id");
var c=b.options;c.canReorder&&EasySocial.module("albums/sortable").done(function(a){b.addPlugin("sortable",a)}),c.canUpload&&EasySocial.module("albums/editor/uploader").done(function(a){b.uploader=b.addPlugin("uploader",a)}),b.id?(b.createAlbum.task=a.Deferred().resolve(),b.createStream=0):b.createStream=1},data:function(){var a=b.titleField().val(),c=b.captionField().val(),d=b.formatDate(),e=b.locationCaption().html(),f=b.latitude().val(),g=b.longitude().val(),h=b.privacy().val(),i=b.privacycustom().val();return uid=b.element.data("album-uid"),type=b.element.data("album-type"),{id:b.id,uid:uid,type:type,title:a,caption:c,date:d,address:e,latitude:f,longitude:g,privacy:h,privacycustom:i,createStream:b.createStream}
},createAlbum:function(){var a=b.createAlbum.task;return a||(a=b.createAlbum.task=b.save({createStream:0}).done(function(a){b.deleteButton().disabled(!1),b.element.attr("data-album-id",b.id=a.id)}).fail(function(a,c){b.setMessage(a,c)})),a},save:function(c){b.trigger("beforeAlbumSave",[b]);var d=a.extend(b.data(),c);d.photos=a.map(b.album.photoItem(),function(b){var d=a(b).controller("EasySocial.Controller.Photos.Editor");return d?d.data():null}),b.clearMessage();var e=EasySocial.ajax("site/controllers/albums/store",d);
return b.trigger("albumSave",[e,b]),e},"{self} photoAdd":function(a,c,d,e){b.album.photoItem().length<=1&&b.changeCover(e)},setCover:function(a){var c=EasySocial.ajax("site/controllers/albums/setCover",{albumId:b.id,coverId:a}).done(function(a){b.changeCover(a)}).fail(function(){});return c},removeCover:function(){b.trigger("coverRemove",[b.album])},changeCover:function(a){b.trigger("coverChange",[a,b])},"{self} coverChange":function(c,d,e){b.coverField().removeClass("no-cover").css("backgroundImage",a.cssUrl(e.sizes.thumbnail.url))
},"{self} coverRemove":function(){b.coverField().addClass("no-cover").css("backgroundImage","")},"{editButton} click":function(){b.album.setLayout("form"),b.editButtonLink().route()},"{editButtonLink} click":function(a,b){b.preventDefault()},"{cancelButton} click":function(){b.album.setLayout("item"),b.cancelButtonLink().route()},"{cancelButtonLink} click":function(a,b){b.preventDefault()},"{doneButton} click":function(){b.doneButtonLink().addClass("btn-loading"),b.save().done(function(c,d){b.doneButtonLink().removeClass("btn-loading"),a.buildHTML(d).replaceAll(b.element)
}).progress(function(a,c){b.setMessage(a,c)})},"{doneButtonLink} click":function(a,b){b.preventDefault()},"{deleteButton} click":function(a){a.disabled()||EasySocial.dialog({content:EasySocial.ajax("site/views/albums/confirmDelete",{id:b.id})})},formatDate:function(){var a=b.dateDay().val()||b.dateDay().data("date-default"),c=b.dateMonth().val()||b.dateMonth().data("date-default"),d=b.dateYear().val()||b.dateYear().data("date-default");return d+"-"+c+"-"+a},updateDate:function(){b.date().addClass("has-data");
var c=b.dateDay().val()+" "+a.trim(b.dateMonth().find(":selected").html())+" "+b.dateYear().val();b.dateCaption().html(c)},"{dateDay} keyup":function(){b.updateDate()},"{dateMonth} change":function(){b.updateDate()},"{dateYear} keyup":function(){b.updateDate()},"{titleField} keyup":function(a){b.trigger("titleChange",[a.val(),b])},"{locationWidget} locationChange":function(a,c,d){var e=d.address||d.fulladdress||d.formatted_address;b.locationCaption().html(e),b.location().addClass("has-data")}}});b.resolve(d)
}),EasySocial.module("albums/editor/sortable",function(a){var b=this;EasySocial.require().library("ui/sortable").done(function(){var c=EasySocial.Controller("Albums.Editor.Sortable",{defaultOptions:{}},function(b){return{init:function(){},getPhotoOrdering:function(){var c={};return b.photoItem().each(function(b){var d=a(this).data("photoId");c[d]=b}),c},"{parent.photoItemGroup} sortstart":function(a,c,d){d.item.addClass("dragging"),a.addClass("ordering"),b.setLayout()},"{parent.photoItemGroup} sortchange":function(){b.setLayout()
},"{parent.photoItemGroup} sortstop":function(a,c,d){d.item.removeClass("dragging"),a.removeClass("ordering"),b.setLayout(),EasySocial.ajax("site/controllers/photos/reorder",{id:d.item.controller().id,order:d.item.index()})}}});b.resolve(c)})}),EasySocial.module("albums/editor/uploader",function(a){var b=this;EasySocial.require().script("albums/uploader").view("site/albums/upload.item").done(function(){var c=EasySocial.Controller("Albums.Editor.Uploader",{defaultOptions:{}},function(b){return{init:function(){b.album=b.editor.album;
var a=b.album.options.uploader;b.uploader=b.addPlugin("uploader",EasySocial.Controller.Albums.Uploader,{settings:a,"{uploadButton}":b.editor.uploadButton.selector,"{uploadItemGroup}":b.album.photoItemGroup.selector,"{uploadDropsite}":b.album.content.selector})},setLayout:function(){b.album.setLayout_()},"{self} beforeAlbumSave":function(){b.uploader.stop()},"{self} albumSave":function(c,d,e){e.done(function(c){var d=a.uri(b.uploader.settings("url")).replaceQueryParam("albumId",c.id).toString();b.uploader.settings("url",d)
})},"{self} layoutChange":function(c,d,e){b.uploader.stop(),b.uploader.clear();var f=a.uri(b.uploader.settings("url")).replaceQueryParam("createStream","form"==e?0:1).replaceQueryParam("layout",e).toString();b.uploader.settings("url",f)},"{self} QueueCreated":function(a,c,d){"form"==b.album.currentLayout()&&d.element.addClass("layout-form"),b.setLayout()},startUpload:a.Enqueue(),"{uploader} FilesAdded":function(){b.id?b.uploader.start():b.editor.createAlbum().done(b.startUpload(function(){b.uploader.start()})),b.setLayout()
},"{uploader} FilesRemoved":function(){b.setLayout()},"{uploader} FileUploaded":function(c,d,e,f,g){var h=b.uploader.getItem(f),i=a.buildHTML(g.html),j=g.data;i.addClass("new-item").insertAfter(h.element),setTimeout(function(){i.removeClass("new-item")},1),b.uploader.removeItem(f.id),b.trigger("photoAdd",[i,j,b.album]),b.setLayout()}}});b.resolve(c)})}),EasySocial.module("albums/uploader",function(a){var b=this;EasySocial.require().library("plupload").script("albums/uploader.item").view("site/albums/upload.item").done(function(){EasySocial.Controller("Albums.Uploader",{defaultOptions:{view:{uploadItem:"site/albums/upload.item"},direction:"prepend","{uploadButton}":"[data-upload-button]","{uploadItemGroup}":"[data-upload-item-group]","{uploadItem}":"[data-upload-item]","{uploadDropsite}":"[data-upload-dropsite]"}},function(b,c,d){return{init:function(){var c=b.element;
b.pluploadController=b.element.addController("plupload",a.extend({"{uploadButton}":b.uploadButton.selector,"{uploadDropsite}":b.uploadDropsite.selector},b.options.settings)),b.plupload=b.pluploadController.plupload,a.IE||"html5"!=b.plupload.runtime||c.addClass("can-drop-file"),c.addClass("can-upload")},setLayout:function(){b.uploadItemGroup().toggleClass("no-upload-items",b.uploadItem().length<1)},items:{},getItem:function(c){var d;return a.isString(c)&&(d=c),c&&c.id&&(d=c.id),b.items[d]},createItem:function(a){var e=b.view.uploadItem({file:a}).switchClass("layout-"+(d.data("albumLayout")||"form")).addController("EasySocial.Controller.Albums.Uploader.Item",{"{uploader}":b,file:a});
return e.element["append"==c.direction?"appendTo":"prependTo"](b.uploadItemGroup()),b.items[a.id]=e,b.setLayout(),b.trigger("QueueCreated",[e]),e},settings:function(a,c){var d=b.plupload.settings;return void 0!==c&&(d[a]=c),a?d[a]:d},start:function(){return b.plupload.start()},stop:function(){return b.plupload.stop()},"{self} FilesAdded":function(c,d,e,f){try{f.reverse(),a.each(f,function(a,c){b.getItem(c)||b.createItem(c)})}catch(g){console.error(g)}},"{self} BeforeUpload":function(a,c,d,e){var f=b.getItem(e);
f&&f.setState("preparing")},"{self} UploadFile":function(a,c,d,e){var f=b.getItem(e);f&&f.setState("uploading")},"{self} UploadProgress":function(a,c,d,e){var f=b.getItem(e);f&&(f.setState("uploading"),f.setProgress())},"{self} FileUploaded":function(c,d,e,f,g){var h=b.getItem(f);if(h)return a.isPlainObject(g)?(h.setState("done"),void 0):(h.setState("failed"),void 0)},"{self} FileError":function(a,c,d,e,f){var g=b.getItem(e);g||(g=b.createItem(e)),g.setState("failed"),g.setMessage(f.message)},"{self} Error":function(a,c,d,e){if(e.file){var f=e.file,g=b.getItem(f);
g||(g=b.createItem(f)),g.setState("failed"),g.setMessage(e.message)}},removeItem:function(a){var c=b.getItem(a);c&&(b.plupload.removeFile(c.file()),c.element.remove(),delete b.items[a],b.setLayout())},clear:function(){a.each(b.items,function(a,c){b.plupload.removeFile(c.file()),c.element.remove(),delete b.items[a]}),b.items={}}}}),b.resolve()})}),EasySocial.module("albums/uploader.item",function(a){var b=this;EasySocial.Controller("Albums.Uploader.Item",{defaultOptions:{"{status}":".upload-status","{filename}":".upload-filename","{progressBar}":".upload-progress-bar","{percentage}":".upload-percentage","{filesizeTotal}":".upload-filesize-total","{filesizeLeft}":".upload-filesize-left","{details}":".upload-details","{detailsButton}":".upload-details-button","{removeButton}":".upload-remove-button","{message}":".upload-message"}},function(b){return{init:function(){b.id=b.element.attr("id");
var c=b.file();b.filename().html(c.name),b.setState("pending"),b.setProgress();var d="html4"==b.uploader.plupload.runtime;(a.IE<10||d)&&b.element.addClass("indefinite-progress"),d&&b.element.addClass("no-filesize")},file:function(){var c=b.uploader.plupload.getFile(b.id)||b.options.file;if(c){var d=void 0===c.size||"N/A"==c.size;c.percentage=c.percent+"%",c.filesize=d?"":a.plupload.formatSize(c.size),c.remaining=d?"":a.plupload.formatSize(c.size-(c.loaded||0))}return c},setProgress:function(){var a=b.file(),c=a.percentage;
"100%"==c&&(c="99%"),"0%"==c&&(c="1%"),b.progressBar().width(c),b.percentage().html(c),b.filesizeTotal().html(a.filesize),b.filesizeLeft().html(a.remaining)},setState:function(a){b.element.removeClass("pending preparing uploading failed done").addClass(a),b.state=a},setMessage:function(a){b.detailsButton().attr("data-popbox",a)},"{removeButton} click":function(){b.uploader.removeItem(b.id)}}}),b.resolve()}),EasySocial.module("albums/item",function(a){var b=this;EasySocial.require().script("albums/editor").done(),EasySocial.require().library("masonry").done(function(){EasySocial.Controller("Albums.Item",{hostname:"album",defaultOptions:{tilesPerRow:4,editable:!1,multipleSelection:!1,"{header}":"[data-album-header]","{content}":"[data-album-content]","{footer}":"[data-album-footer]","{info}":"[data-album-info]","{title}":"[data-album-title]","{caption}":"[data-album-caption]","{location}":"[data-album-location]","{date}":"[data-album-date]","{cover}":"[data-album-cover]","{favouriteButton}":"[data-album-favourite-button]","{photoItemGroup}":"[data-photo-item-group]","{photoItem}":"[data-photo-item]","{photoImage}":"[data-photo-image]","{photoImageCss}":"[data-photo-image-css]","{featuredItem}":"[data-photo-item].featured","{featuredImage}":"[data-photo-item].featured [data-photo-image]","{featuredImageCss}":"[data-photo-item].featured [data-photo-image-css]","{uploadItem}":"[data-photo-upload-item]","{moreButton}":"[data-album-more-button]","{viewButton}":"[data-album-view-button]","{share}":"[data-repost-action]","{likes}":"[data-likes-action]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{counterBar}":"[data-stream-counter]"}},function(b,c,d){return{init:function(){b.id=d.data("album-id"),b.nextStart=d.data("album-nextstart")||-1,b.options.editable&&EasySocial.module("albums/editor").done(function(a){b.editor=b.addPlugin("editor",a)
}),b.setLayout(),b.moreButton().show(),b.addSubscriber(b.photoItem().controllers("EasySocial.Controller.Photos.Item"))},"{window} resize":a.debounce(function(){b.setLayout()},250),currentLayout:function(){return d.data("albumLayout")},setLayout_:a.debounce(function(){b.setLayout()},100),setLayout:function(c){var e=b.photoItemGroup(),f=b.currentLayout(),c=c||f,g=b.setLayout.seed,h=g==e.width()&&f==c;hasPhotoItem=b.photoItem().length>0,hasUploadItem=b.uploadItem().length>0,hasItem=hasPhotoItem||hasUploadItem,masonry=a.data(e[0],"masonry"),layout={currentLayout:f,seed:g,intact:h,hasPhotoItem:hasPhotoItem,hasUploadItem:hasUploadItem,hasItem:hasItem,masonry:masonry},h||(d.data("albumLayout",c).switchClass("layout-"+c),b.photoItem().switchClass("layout-"+c),b.setLayout.seed=layout.seed=null,f!==c&&b.trigger("layoutChange",[c,layout])),d.toggleClass("has-photos",hasItem),hasItem||e.css("opacity",1);
var i="set"+a.String.capitalize(c)+"Layout";b[i](layout),b.setLayout.seed=e.width()},setItemLayout:function(a){b.photoItem().attr("data-es-photo-disabled",0);var c=4,e=b.photoItemGroup(),f=d.width(),g=Math.floor(f/c)*c;b.photoItemGroup().width(g),a.masonry?e.masonry("reloadItems").masonry("layout"):e.masonry({columnWidth:".es-photo-item.grid-sizer",itemSelector:b.photoItem.selector+", "+b.uploadItem.selector,isOriginLeft:!b.options.rtl})},setFormLayout:function(a){b.photoItem().attr("data-es-photo-disabled",1),a.masonry&&a.masonry.destroy(),b.clearLayout()
},setDialogLayout:function(){b.photoItem().attr("data-es-photo-disabled",1),layout.masonry&&layout.masonry.destroy(),b.clearLayout()},setThumbnailLayout:function(){},setRowLayout:function(){b.photoItem().attr("data-es-photo-disabled",0),b.clearLayout()},clearLayout:function(){b.photoItemGroup().addClass("no-transition"),b.photoItem.css().remove(),b.photoImage.css().remove(),b.photoImageCss.css().remove(),b.featuredItem.css().remove(),b.featuredImage.css().remove(),b.featuredImageCss.css().remove(),b.uploadItem.css().remove(),b.setLayout.seed=null
},getSelectedItems:function(){var c=b.photoItem(".selected"),d=[];return c.each(function(b,c){d.push(a(c).controller("EasySocial.Controller.Photos.Item").data())}),d},"{photoItem} init.photos.item":function(a,c,d){b.addSubscriber(d)},"{photoItem} destroyed":function(){b.setLayout()},"{photoItem} activate":function(a,c,d){if(d){var e=b.currentLayout();switch(e){case"item":case"row":a.addClass("loading"),b.browser?(b.browser.open("photo",d.id).always(function(){a.removeClass("loading")}),d.imageLink().route()):window.location=d.imageLink().attr("href");
break;case"form":break;case"dialog":var f=b.photoItem(".selected");if(b.options.multipleSelection)a.toggleClass("selected");else{var g=a.hasClass("selected");f.removeClass("selected"),a.toggleClass("selected",!g)}}}},"{photoItem} photoFeature":function(a,c,d){b.setLayout(),d.fail(function(){b.setLayout()})},"{photoItem} photoMove":function(a,c,d,e){b.clearMessage(),d.done(function(){e.element.remove(),b.setLayout(),b.photoItem().length<1&&b.trigger("coverRemove",[b])}).fail(function(a,c){b.setMessage(a,c)})},"{photoItem} photoDelete":function(a,c,d,e){b.clearMessage(),d.done(function(){e.element.remove(),b.setLayout(),b.photoItem().length<1&&b.trigger("coverRemove",[b])
}).fail(function(a,c){b.setMessage(a,c)})},"{self} albumSave":function(a,c,d){d.done(function(a){b.id=a.id})},"{self} coverChange":function(c,d,e){b.cover().css("backgroundImage",a.cssUrl(e.sizes.thumbnail.url))},"{self} coverRemove":function(){b.cover().css("backgroundImage","")},"{viewButton} click":function(a,c){b.browser&&(c.preventDefault(),d.addClass("loading"),b.browser.open("Album",b.id))},"{moreButton} click":function(c){-1!=b.nextStart&&(c.disabled()||(c.toggleClass("loading"),c.disabled(!0),EasySocial.ajax("site/controllers/albums/loadMore",{albumId:b.id,start:b.nextStart,layout:b.currentLayout()}).done(function(d,e){b.nextStart=e;
var f=b.photoItemGroup();a.each(d,function(b,c){a.buildHTML(c).appendTo(f)}),c.toggleClass("loading"),0>e&&c.hide(),b.setLayout()}).always(function(){c.disabled(!1)})))},"{share} create":function(){b.counterBar().removeClass("hide")},"{likes} onLiked":function(){b.counterBar().removeClass("hide")},"{likes} onUnliked":function(){var e=b.likeContent().hasClass("hide"),f=b.repostContent().hasClass("hide");e&&f&&b.counterBar().addClass("hide")},"{favouriteButton} click":function(){EasySocial.ajax("site/controllers/albums/favourite",{id:b.id}).done(function(){b.favouriteButton().toggleClass("is-fav btn-es-primary")
})}}}),b.resolve()})}),EasySocial.module("apps/event/discussions",function(){var b=this;EasySocial.Controller("Events.Item.Discussions",{defaultOptions:{"{filter}":"[data-event-discussions-filter]","{contents}":"[data-event-discussion-contents]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},setContent:function(b){a.contents().removeClass("is-loading"),a.contents().html(b)},setActiveFilter:function(b){a.filter().removeClass("active"),b.addClass("active")},"{filter} click":function(b){var d=b.data("filter");
a.contents().html("&nbsp;").addClass("is-loading"),a.setActiveFilter(b),EasySocial.ajax("apps/event/discussions/controllers/discussion/getDiscussions",{id:a.options.id,filter:d}).done(function(b,c){c?a.contents().addClass("is-empty"):a.contents().removeClass("is-empty"),a.setContent(b)})}}}),EasySocial.Controller("Events.Item.Discussion",{defaultOptions:{"{form}":"[data-reply-form]","{list}":"[data-reply-list]","{replies}":"[data-reply-item]","{repliesWrap}":"[data-replies-wrapper]","{replyCounter}":"[data-reply-count]","{lock}":"[data-discussion-lock]","{unlock}":"[data-discussion-unlock]","{delete}":"[data-discussion-delete]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.eventId=a.element.data("eventid"),a.implementReply(a.replies()),a.form().implement(EasySocial.Controller.Events.Item.Discussion.Form,{"{parent}":a})
},implementReply:function(){a.replies().implement(EasySocial.Controller.Events.Item.Discussion.Reply,{"{parent}":a})},insertReply:function(b){a.element.removeClass("is-unanswered"),a.repliesWrap().removeClass("is-empty"),a.list().append(b),a.implementReply()},updateReplyCounter:function(b){0==b&&a.repliesWrap().addClass("is-empty"),a.replyCounter().html(b)},setResolved:function(){a.element.addClass("is-resolved")},"{unlock} click":function(){EasySocial.ajax("apps/event/discussions/controllers/discussion/unlock",{id:a.options.id}).done(function(){a.element.removeClass("is-locked")
})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/discussions/controllers/discussion/confirmDelete",{id:a.options.id,eventId:a.options.eventId})})},"{lock} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/discussions/controllers/discussion/confirmLock"),bindings:{"{lockButton} click":function(){EasySocial.ajax("apps/event/discussions/controllers/discussion/lock",{id:a.options.id}).done(function(){EasySocial.dialog().close(),a.element.addClass("is-locked")
})}}})}}}),EasySocial.Controller("Events.Item.Discussion.Reply",{defaultOptions:{"{acceptAnswer}":"[data-reply-accept-answer]","{delete}":"[data-reply-delete]","{edit}":"[data-reply-edit]","{cancelEdit}":"[data-reply-edit-cancel]","{update}":"[data-reply-edit-update]","{textarea}":"[data-reply-content]","{content}":"[data-reply-display-content]","{alertDiv}":"div.alert-error"}},function(a){return{init:function(){console.log(a.element),a.options.id=a.element.data("id")},"{acceptAnswer} click":function(){EasySocial.ajax("apps/event/discussions/controllers/reply/accept",{id:a.options.id}).done(function(){a.parent.setResolved()
})},cancelEditing:function(){a.element.removeClass("is-editing")},"{cancelEdit} click":function(){a.cancelEditing()},"{edit} click":function(){a.element.addClass("is-editing")},"{update} click":function(){var b=a.textarea().val();return""==b?(a.element.addClass("is-empty"),a.alertDiv().show(),!1):(EasySocial.ajax("apps/event/discussions/controllers/reply/update",{id:a.options.id,eventId:a.parent.options.eventId,content:b}).done(function(b){a.content().html(b),a.element.removeClass("is-empty"),a.alertDiv().hide(),a.cancelEditing()
}),void 0)},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/discussions/controllers/reply/confirmDelete",{id:a.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/discussions/controllers/reply/delete",{id:a.options.id}).done(function(b){a.parent.updateReplyCounter(b.total_replies),EasySocial.dialog().close(),a.element.remove()})}}})}}}),EasySocial.Controller("Events.Item.Discussion.Form",{defaultOptions:{"{textarea}":"[data-reply-content]","{submitReply}":"[data-reply-submit]"}},function(a){return{init:function(){},"{submitReply} click":function(){var d=a.textarea().val();
return""==d?(a.element.addClass("is-empty"),!1):(EasySocial.ajax("apps/event/discussions/controllers/reply/submit",{id:a.parent.options.id,eventId:a.parent.options.eventId,content:d}).done(function(b){a.parent.insertReply(b),a.textarea().val("")}),void 0)}}}),b.resolve()}),EasySocial.module("apps/event/guests",function(){var b=this;EasySocial.Controller("Events.Item.Guests",{defaultOptions:{"{filters}":"[data-event-guests-filter]","{content}":"[data-event-guests-content]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.items=a.addPlugin("Item")
},"{filters} click":function(b,c){c.preventDefault(),b.route(),a.filters().removeClass("active"),b.addClass("active");var d=b.data("filter");a.content().html("&nbsp;"),a.content().addClass("is-loading"),EasySocial.ajax("apps/event/guests/controllers/events/filterGuests",{id:a.options.id,filter:d}).done(function(b,c){a.content().removeClass("is-loading"),0==c?a.content().addClass("is-empty"):a.content().removeClass("is-empty"),a.content().html(b)})},"{self} emptyGuest":function(){a.content().addClass("is-empty")
}}}),EasySocial.Controller("Events.Item.Guests.Item",{defaultOptions:{"{item}":"[data-event-guest-item]","{promote}":"[data-guest-promote]","{demote}":"[data-guest-demote]","{approve}":"[data-guest-approve]","{reject}":"[data-guest-reject]","{remove}":"[data-guest-remove]"}},function(a){return{init:function(){},getItem:function(b){var c=a.item.of(b);return c},"{approve} click":function(b){var c=a.getItem(b),d=c.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmApproveGuest",{id:d}),bindings:{"{approveButton} click":function(){EasySocial.ajax("site/controllers/events/approveGuest",{id:d}).done(function(){EasySocial.dialog().close(),c.remove(),0===a.item().length&&a.element.trigger("emptyGuest")
})}}})},"{reject} click":function(b){var c=a.getItem(b),d=c.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmRejectGuest",{id:d}),bindings:{"{rejectButton} click":function(){EasySocial.ajax("site/controllers/events/rejectGuest",{id:d}).done(function(){EasySocial.dialog().close(),c.remove(),0===a.item().length&&a.element.trigger("emptyGuest")})}}})},"{promote} click":function(b){var c=a.getItem(b),d=c.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmPromoteGuest",{id:d}),bindings:{"{promoteButton} click":function(){EasySocial.ajax("site/controllers/events/promoteGuest",{id:d}).done(function(){EasySocial.dialog().close(),c.removeClass("is-member").addClass("is-admin")
})}}})},"{demote} click":function(b){var c=a.getItem(b),d=c.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmDemoteGuest",{id:d}),bindings:{"{demoteButton} click":function(){EasySocial.ajax("site/controllers/events/demoteGuest",{id:d}).done(function(){EasySocial.dialog().close(),"admin"==a.parent.filters(".active").data("filter")?(c.remove(),0===a.item().length&&a.element.trigger("emptyGuest")):c.removeClass("is-admin").addClass("is-member")})}}})},"{remove} click":function(b){var d=a.getItem(b),e=d.data("guestId");
EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmRemoveGuest",{id:e}),bindings:{"{removeButton} click":function(){EasySocial.ajax("site/controllers.events/removeGuest",{id:e}).done(function(){EasySocial.dialog().close(),d.remove(),0===a.item().length&&a.element.trigger("emptyGuest")})}}})}}}),b.resolve()}),EasySocial.module("apps/event/tasks",function(a){var b=this;EasySocial.Controller("Events.Apps.Tasks.Milestones.Browse",{defaultOptions:{eventId:null,"{milestone}":"[data-tasks-milestone-item]"}},function(a){return{init:function(){a.options.eventId=a.element.data("eventid"),a.milestone().addController(EasySocial.Controller.Events.Apps.Tasks.Milestones.Item,{"{parent}":a})
}}}),EasySocial.Controller("Events.Apps.Tasks.Milestones.Item",{defaultOptions:{"{complete}":"[data-milestone-mark-complete]","{incomplete}":"[data-milestone-mark-incomplete]","{delete}":"[data-milestone-delete]","{milestone}":"[data-event-tasks-milestone-item]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},"{incomplete} click":function(b){EasySocial.ajax("apps/event/tasks/controllers/milestone/unresolve",{id:a.options.id,eventId:a.parent.options.eventId}).done(function(){a.element.removeClass("is-due").removeClass("is-completed"),b.hide(),a.complete().show()
})},"{complete} click":function(b){EasySocial.ajax("apps/event/tasks/controllers/milestone/resolve",{id:a.options.id,eventId:a.parent.options.eventId}).done(function(){a.element.removeClass("is-due").addClass("is-completed"),b.hide(),a.incomplete().show()})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/tasks/controllers/milestone/confirmDelete",{id:a.options.id,eventId:a.parent.options.eventId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/delete",{id:a.options.id,eventId:a.parent.options.eventId}).done(function(){EasySocial.dialog().close(),a.element.remove()
})}}})}}}),EasySocial.Controller("Events.Apps.Tasks",{defaultOptions:{"{form}":"[data-tasks-form]","{formWrapper}":"[data-tasks-form-wrapper]","{taskList}":"[data-tasks-list]","{item}":"[data-tasks-list-item]","{completedList}":"[data-tasks-completed]","{openCounter}":"[data-tasks-open-counter]","{closedCounter}":"[data-tasks-closed-counter]","{completeMilestone}":"[data-milestone-mark-complete]","{incompleteMilestone}":"[data-milestone-mark-incomplete]","{deleteMilestone}":"[data-milestone-delete]","{wrapper}":"[data-tasks-wrapper]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.eventId=b.element.data("eventid"),b.options.milestoneId=b.element.data("milestoneid"),b.form().addController(EasySocial.Controller.Events.Apps.Tasks.Form,{"{parent}":b}),b.implementItemController()
},implementItemController:function(){b.item().addController(EasySocial.Controller.Events.Apps.Tasks.Item,{"{parent}":b})},updateOpenCounter:function(a){b.openCounter().html(a)},updateClosedCounter:function(a){b.closedCounter().html(a)},insertCompleted:function(c){a(c).appendTo(b.completedList())},insertTask:function(a){b.formWrapper().after(a),b.implementItemController()},"{uncompleteMilestone} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/unresolve",{id:b.options.milestoneId,eventId:b.options.eventId}).done(function(){b.wrapper().removeClass("is-due").removeClass("is-completed")
})},"{completeMilestone} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/resolve",{id:b.options.milestoneId,eventId:b.options.eventId}).done(function(){b.wrapper().removeClass("is-due").addClass("is-completed")})},"{deleteMilestone} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/tasks/controllers/milestone/confirmDelete",{id:b.options.milestoneId,eventId:b.options.eventId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/delete",{id:b.options.id,eventId:b.options.eventId}).done(function(){EasySocial.dialog().close(),window.location=b.options.redirect
})}}})}}}),EasySocial.Controller("Events.Apps.Tasks.Item",{defaultOptions:{"{checkbox}":"[data-item-checkbox]","{delete}":"[data-tasks-item-remove]"}},function(b){return{init:function(){b.options.id=b.element.data("id")},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/tasks/controllers/tasks/confirmDelete",{eventId:b.parent.options.eventId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/tasks/controllers/tasks/delete",{id:b.options.id,eventId:b.parent.options.eventId}).done(function(){EasySocial.dialog().close();
var a=parseInt(b.parent.openCounter().html());b.parent.updateOpenCounter(a-1),b.element.remove()})}}})},"{checkbox} change":function(c){var e=a(c).is(":checked");e?EasySocial.ajax("apps/event/tasks/controllers/tasks/resolve",{id:b.options.id,eventId:b.parent.options.eventId}).done(function(){var a=parseInt(b.parent.openCounter().html());b.parent.updateOpenCounter(a-1);var a=parseInt(b.parent.closedCounter().html());b.parent.updateClosedCounter(a+1),b.parent.insertCompleted(b.element)}):EasySocial.ajax("apps/event/tasks/controllers/tasks/unresolve",{id:b.options.id,eventId:b.parent.options.eventId}).done(function(){var c=parseInt(b.parent.openCounter().html());
b.parent.updateOpenCounter(c+1);var c=parseInt(b.parent.closedCounter().html());b.parent.updateClosedCounter(c-1),b.parent.insertTask(b.element)})}}}),EasySocial.Controller("Events.Apps.Tasks.Form",{defaultOptions:{"{title}":"[data-form-tasks-title]","{create}":"[data-form-tasks-create]","{assignee}":"[data-form-tasks-assignee]","{due}":"[data-form-tasks-due]","{error}":"[data-tasks-form-error]"}},function(a){return{init:function(){},resetForm:function(){a.element[0].reset()},"{title} keyup":function(b,c){13==c.keyCode&&a.create().click()
},"{create} click":function(){return""==a.title().val()?(a.error().removeClass("hide"),!1):(a.error().addClass("hide"),EasySocial.ajax("apps/event/tasks/controllers/tasks/save",{title:a.title().val(),assignee:a.assignee().val(),due:a.due().val(),eventId:a.parent.options.eventId,milestoneId:a.parent.options.milestoneId}).done(function(b){a.resetForm();var c=parseInt(a.parent.openCounter().html());a.parent.updateOpenCounter(c+1),a.parent.insertTask(b)}),void 0)}}}),b.resolve()}),EasySocial.module("apps/fields/event/description/content",function(){var b=this;
EasySocial.require().language("PLG_FIELDS_EVENT_DESCRIPTION_VALIDATION_INPUT_REQUIRED").done(function(a){EasySocial.Controller("Field.Event.Description",{defaultOptions:{required:!1,editor:null,"{input}":"[data-field-description]"}},function(b){return{init:function(){b.editor=b.options.editor},"{input} keyup":function(){b.validateInput()},"{input} blur":function(){b.validateInput()},validateInput:function(){b.clearError();var c=b.editor.getContent();return b.options.required&&a.isEmpty(c)?(b.raiseError(a.language("PLG_FIELDS_EVENT_DESCRIPTION_VALIDATION_INPUT_REQUIRED")),!1):!0
},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onError":function(c,d,e){"required"===e&&b.raiseError(a.language("PLG_FIELDS_EVENT_DESCRIPTION_VALIDATION_INPUT_REQUIRED"))},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())}}}),b.resolve()})}),EasySocial.module("apps/fields/event/permalink/content",function(){var b=this;EasySocial.require().language("FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH","FIELDS_EVENT_PERMALINK_REQUIRED").done(function(a){EasySocial.Controller("Field.Event.Permalink",{defaultOptions:{required:!1,max:0,id:null,clusterid:null,userid:null,"{field}":"[data-field-permalink]","{checkButton}":"[data-permalink-check]","{input}":"[data-permalink-input]","{available}":"[data-permalink-available]"}},function(b){return{state:!1,init:function(){b.options.max=b.field().data("max")
},"{checkButton} click":function(){b.delayedCheck()},"{input} keyup":function(){b.delayedCheck()},delayedCheck:a.debounce(function(){b.checkPermalink()},250),checkPermalink:function(){b.clearError();var c=b.input().val();if(b.available().hide(),b.options.max>0&&c.length>b.options.max)return b.raiseError(a.language("FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH")),!1;if(!a.isEmpty(c)){b.checkButton().addClass("btn-loading");var d=a.Deferred();return EasySocial.ajax("fields/event/permalink/isValid",{id:b.options.id,clusterid:b.options.clusterid,permalink:c}).done(function(){b.clearError(),b.checkButton().removeClass("btn-loading"),b.available().show(),d.resolve()
}).fail(function(a){b.raiseError(a),b.checkButton().removeClass("btn-loading"),b.available().hide(),d.reject()}),d}return b.options.required&&a.isEmpty(c)?(b.available().hide(),b.raiseError(a.language("FIELDS_EVENT_PERMALINK_REQUIRED")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.checkPermalink())}}}),b.resolve()})}),EasySocial.module("apps/fields/event/permalink/sample_content",function(){var b=this;EasySocial.Controller("Field.Permalink.Sample",{defaultOptions:{"{checkPermalink}":"[data-check-permalink]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"check_permalink":a.checkPermalink().toggle(!!e)
}}}}),b.resolve()}),EasySocial.module("apps/fields/event/recurring/content",function(a){var b=this;EasySocial.require().library("datetimepicker").done(function(){EasySocial.Controller("Field.Event.Recurring",{defaultOptions:{id:null,value:{},allday:0,showWarningMessages:0,eventId:null,"{type}":"[data-recurring-type]","{endBlock}":"[data-recurring-end-block]","{picker}":"[data-recurring-end-picker]","{toggle}":"[data-recurring-end-toggle]","{result}":"[data-recurring-end-result]","{dailyBlock}":"[data-recurring-daily-block]","{dailyInput}":"[data-recurring-daily-block] input","{summaryBlock}":"[data-recurring-summary-block]","{scheduleToggle}":"[data-recurring-schedule-toggle]","{scheduleBlock}":"[data-recurring-schedule-block]","{scheduleLoadingBlock}":"[data-recurring-schedule-loading-block]","{deleteRecurringButton}":"[data-recurring-delete]"}},function(b){return{init:function(){b.picker()._datetimepicker({pickTime:!1,component:"es",useCurrent:!1});
var c=b.result().val();if(!a.isEmpty(c)){var d=a.moment(c);b.datetimepicker("setDate",d)}b.calculateTotalRecur()},changed:0,"{window} easysocial.fields.allday.change":function(a,c,d){b.options.allday=d,b.calculateTotalRecur()},"{window} easysocial.fields.startend.start.change":function(){b.calculateTotalRecur()},"{toggle} click":function(){b.picker().focus()},"{picker} dp.change":function(a,c){b.setDateValue(c.date.toDate()),b.detectChanges(),b.calculateTotalRecur()},"{type} change":function(a){var d=a.val();
b.endBlock()["none"===d?"hide":"show"](),b.dailyBlock()["daily"===d?"show":"hide"](),b.detectChanges(),b.calculateTotalRecur()},"{dailyInput} change":function(){b.detectChanges(),b.calculateTotalRecur()},calculateTotalRecur:function(){b.summaryBlock().hide(),b.clearError();var c=a("[data-event-start]").find("[data-datetime]").val(),d=a("[data-event-timezone]").val(),e=b.result().val(),f=b.type().val(),g=[];("none"!=f||b.options.showWarningMessages)&&(a.isEmpty(c)||a.isEmpty(e)||a.isEmpty(f)||(a.each(b.dailyBlock().find("input"),function(b,c){el=a(c),el.is(":checked")&&g.push(el.val())
}),b.scheduleLoadingBlock().show(),b.getTotalRecur({start:c,timezone:d,end:e,type:f,daily:g})))},getTotalRecur:a.debounce(function(a){b.clearError(),EasySocial.ajax("fields/event/recurring/calculateTotalRecur",{id:b.options.id,start:a.start,timezone:a.timezone,allday:b.options.allday,end:a.end,type:a.type,daily:a.daily,eventId:b.options.eventId,changed:b.changed,showWarningMessages:b.options.showWarningMessages}).done(function(a){b.summaryBlock().html(a).show()}).fail(function(a){b.raiseError(a)}).always(function(){b.scheduleLoadingBlock().hide()
})},500),detectChanges:function(){var c=b.result().val(),d=b.type().val(),e=[],f=!1;a.each(b.dailyBlock().find("input"),function(b,c){el=a(c),el.is(":checked")&&e.push(el.val())}),(d!=b.options.value.type||c!=b.options.value.end||e.length!=b.options.value.daily.length)&&(f=!0),a.each(e,function(c,d){return-1==a.inArray(d,b.options.value.daily)?(f=!0,!1):void 0}),a.each(b.options.value.daily,function(b,c){return-1==a.inArray(c,e)?(f=!0,!1):void 0}),b.changed=f?1:0,a(window).trigger("easysocial.fields.recurring.changed",[f])
},"{scheduleToggle} click":function(){b.scheduleBlock().toggle()},"{deleteRecurringButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/events/deleteRecurringDialog",{id:b.options.eventId}),bindings:{"{submitButton} click":function(){var a=this.parent;a.loading(!0),b.deleteRecurring().done(function(){a.loading(!1),a.close(),b.calculateTotalRecur()})}}})},deleteRecurring:function(){return EasySocial.ajax("site/controllers/events/deleteRecurring",{eventId:b.options.eventId})},datetimepicker:function(a,c){return b.picker().data("DateTimePicker")[a](c)
},setDateValue:function(a){b.result().val(a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2)+" "+("00"+a.getHours()).slice(-2)+":"+("00"+a.getMinutes()).slice(-2)+":"+("00"+a.getSeconds()).slice(-2))},"{self} onSubmit":function(a,b,c){c.push(!0)},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")}}}),b.resolve()})}),EasySocial.module("apps/fields/event/startend/content",function(){var b=this,c=EasySocial.options.momentLang;EasySocial.require().library("datetimepicker","moment/"+c).language("FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED").done(function(a){EasySocial.Controller("Field.Event.Startend",{defaultOptions:{dateFormat:"",allowTime:!0,allowTimezone:!0,disallowPast:!1,minuteStepping:15,yearfrom:"",yearto:"",requiredEnd:!1,allday:!1,calendarLanguage:"english",dow:0,"{startForm}":"[data-event-start]","{endForm}":"[data-event-end]","{timezone}":"[data-event-timezone]"}},function(b){return{init:function(){b.options.yearto=a.isEmpty(b.options.yearto)?(new Date).getFullYear()+100:parseInt(b.options.yearto)+1,b.options.yearfrom=b.options.yearfrom||1930,b.startDatetime=b.startForm().addController("EasySocial.Controller.Field.Event.Startend.Form",{"{parent}":b,type:"start"}),b.endDatetime=b.endForm().addController("EasySocial.Controller.Field.Event.Startend.Form",{"{parent}":b,type:"end"})
},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())},validateInput:function(){return b.clearError(),a.isEmpty(b.startDatetime.datetime().val())?(b.raiseError(a.language("FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED")),!1):b.options.requireEnd&&a.isEmpty(b.endDatetime.datetime().val())?(b.raiseError(a.language("FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")}}}),EasySocial.Controller("Field.Event.Startend.Form",{defaultOptions:{type:null,"{picker}":"[data-picker]","{toggle}":"[data-picker-toggle]","{datetime}":"[data-datetime]"}},function(b,d){return{init:function(){b.load()
},"{window} easysocial.fields.startend.start.change":function(){"start"==d.type&&b.parent.endDatetime&&(b.parent.endDatetime.datetimepicker("destroy"),b.parent.endDatetime.load())},"{window} easysocial.fields.allday.change":function(a,c,d){b.datetimepicker("destroy"),b.parent.options.allday=1==d?!0:!1,b.load()},load:function(){var e=new a.moment;if(b.parent.options.disallowPast?e.date(e.date()-1):e.year(b.parent.options.yearfrom),"end"==d.type){var f=b.parent.startDatetime.datetime().val();if(f)var e=a.moment(f),e=e.date(e.date()-1)
}var g=b.parent.options.allowTime&&!b.parent.options.allday,h=b.parent.options.dateFormat;g||(h=h.substr(0,10)),b.picker()._datetimepicker({component:"es",useCurrent:!1,format:h,minDate:e,maxDate:new a.moment({y:b.parent.options.yearto}),icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!1,pickTime:g,minuteStepping:parseInt(b.parent.options.minuteStepping),language:"english"==b.parent.options.calendarLanguage?"en-gb":c,dow:b.parent.options.dow});
var i=b.datetime().val();if(!a.isEmpty(i)){var j=a.moment(i);b.datetimepicker("setDate",j)}},datetimepicker:function(a,c){return b.picker().data("DateTimePicker")[a](c)},"{toggle} click":function(){b.picker().focus()},"{picker} dp.change":function(c,e){b.setDateValue(e.date.toDate()),a(window).trigger("easysocial.fields.startend."+d.type+".change",[e.date])},"{picker} change":function(c){a.isEmpty(c.val())&&b.datetime().val("")},setDateValue:function(a){b.datetime().val(a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2)+" "+("00"+a.getHours()).slice(-2)+":"+("00"+a.getMinutes()).slice(-2)+":"+("00"+a.getSeconds()).slice(-2))
}}}),b.resolve()})}),EasySocial.module("apps/fields/event/startend/display",function(){var b=this;EasySocial.require().library("chosen","popbox").language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE","FIELDS_USER_DATETIME_TIMEZONE_CHECKING").done(function(a){EasySocial.Controller("Field.Event.Startend.Display",{defaultOptions:{id:null,userid:null,"{box}":"[data-startend-box]"}},function(a){return{init:function(){a.box().addController("EasySocial.Controller.Field.Event.Startend.Display.Box",{"{parent}":a})}}}),EasySocial.Controller("Field.Event.Startend.Display.Box",{defaultOptions:{date:null,timezone:null,local:null,"{toggle}":"[data-popbox]","{content}":"[data-popbox-content]","{date}":"[data-date]","{timezone}":"[data-timezone]","{loading}":"[data-loading]"}},function(b){return{init:function(){b.options.timezone=b.timezone().data("timezone"),b.options.date=b.date().data("date-utc"),b.options.local=-(new Date).getTimezoneOffset()/60;
var a=b.content().html(),c=b.toggle().data("popbox-position");b.toggle().popbox({content:a,id:"fd",component:"es",type:"timezone",toggle:"click",position:c}).attr("data-popbox","")},"{toggle} popboxActivate":function(a,c,d){d.tooltip.addController("EasySocial.Controller.Field.Event.Startend.Display.Timezone",{"{parent}":b})},datetime:a.memoize(function(a){return EasySocial.ajax("fields/event/startend/getDatetime",{id:b.parent.options.id,userid:b.parent.options.userid,tz:a,local:b.options.local,datetime:b.options.date})
})}}),EasySocial.Controller("Field.Event.Startend.Display.Timezone",{defaultOptions:{"{timezones}":"[data-timezone-select]","{reset}":"[data-timezone-reset]","{local}":"[data-timezone-local]"}},function(b){return{init:function(){b.timezones().chosen({search_contains:!0})},"{timezones} change":function(c){var e=c.val();b.parent.date().html(a.language("FIELDS_USER_DATETIME_TIMEZONE_CHECKING")),b.parent.timezone().html("local"===e?a.language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE"):e),b.parent.datetime(e).done(function(a){b.parent.date().html(a)
})},"{reset} click":function(){b.setTimezone(b.parent.options.timezone)},"{local} click":function(){b.setTimezone("local")},setTimezone:function(a){b.timezones().val(a).trigger("liszt:updated").trigger("change")}}}),b.resolve()})}),EasySocial.module("apps/fields/group/permalink/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_GROUP_PERMALINK_REQUIRED").done(function(a){EasySocial.Controller("Field.Group.Permalink",{defaultOptions:{required:!1,max:0,id:null,groupid:null,userid:null,"{field}":"[data-field-permalink]","{checkButton}":"[data-permalink-check]","{input}":"[data-permalink-input]","{available}":"[data-permalink-available]"}},function(b){return{state:!1,init:function(){b.options.max=b.field().data("max")
},"{checkButton} click":function(){b.delayedCheck()},"{input} keyup":function(){b.delayedCheck()},delayedCheck:a.debounce(function(){b.checkPermalink()},250),checkPermalink:function(){b.clearError();var c=b.input().val();if(b.available().hide(),b.options.max>0&&c.length>b.options.max)return b.raiseError(a.language("PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH")),!1;if(!a.isEmpty(c)){b.checkButton().addClass("btn-loading");var d=a.Deferred();return EasySocial.ajax("fields/group/permalink/isValid",{id:b.options.id,groupid:b.options.groupid,permalink:c}).done(function(){b.clearError(),b.checkButton().removeClass("btn-loading"),b.available().show(),d.resolve()
}).fail(function(a){b.raiseError(a),b.checkButton().removeClass("btn-loading"),b.available().hide(),d.reject()}),d}return b.options.required&&a.isEmpty(c)?(b.available().hide(),b.raiseError(a.language("PLG_FIELDS_GROUP_PERMALINK_REQUIRED")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.checkPermalink())}}}),b.resolve()})}),EasySocial.module("apps/fields/group/permalink/sample_content",function(){var b=this;EasySocial.Controller("Field.Permalink.Sample",{defaultOptions:{"{checkPermalink}":"[data-check-permalink]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"check_permalink":a.checkPermalink().toggle(!!e)
}}}}),b.resolve()}),EasySocial.module("apps/fields/user/address/content",function(a){var b=this;EasySocial.require().library("gmaps").language("PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS1","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS2","PLG_FIELDS_ADDRESS_PLEASE_ENTER_CITY","PLG_FIELDS_ADDRESS_PLEASE_ENTER_STATE","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ZIP","PLG_FIELDS_ADDRESS_PLEASE_ENTER_COUNTRY").done(function(){EasySocial.Controller("Field.Address",{defaultOptions:{required:{},show:{},"{field}":"[data-field-address]","{address1}":"[data-field-address-address1]","{address2}":"[data-field-address-address2]","{city}":"[data-field-address-city]","{state}":"[data-field-address-state]","{country}":"[data-field-address-country]","{zip}":"[data-field-address-zip]","{required}":"[data-required]","{notice}":"[data-check-notice]"}},function(b){return{init:function(){},fields:["address1","address2","city","state","zip","country"],validateInput:function(){b.clearError();
var c=!1;return b.clearError(),a.each(b.fields,function(d,e){var f=b[e]();f.removeClass("has-error");var g=f.val();a.isEmpty(g)&&b.options.required[e]&&b.options.show[e]&&(f.addClass("has-error"),c||(b.raiseError(a.language("PLG_FIELDS_ADDRESS_PLEASE_ENTER_"+e.toUpperCase())),c=!0))}),!0},"{address1}, {address2}, {zip}, {city}, {state} blur":function(){b.validateInput()},"{country} change":function(c){b.validateInput(),b.state().is("select")&&EasySocial.ajax("fields/user/address/getStates",{id:b.options.id,country:c.val()}).done(function(c){b.state().html(""),a.each(c,function(c,d){a("<option></option>").html(d).val(d).appendTo(b.state())
})})},raiseError:function(a){b.notice().css("color","#a94442").text(a).parent(".controls-error").show()},clearError:function(){b.notice().parent(".controls-error").hide()},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())},"{self} onConfigChange":function(c,d,e,f){var g=["address1","address2","city","zip","state","country"];a.inArray(e,g)>=0&&(b.options.required[e]=!!f),b.required().hide(),a.each(g,function(a,c){return b.options[c]?(b.required().show(),!1):void 0})}}}),b.resolve()})}),EasySocial.module("apps/fields/user/address/display_content",function(a){var b=this;
EasySocial.require().library("gmaps").done(function(){EasySocial.Controller("Field.Address.Display",{defaultOptions:{latitude:null,longitude:null,ratio:1,"{base}":"[data-location-base]","{map}":"[data-location-map]","{mapImage}":"[data-location-map-image]"}},function(b){return{init:function(){var a=b.map();b.options.latitude=a.data("latitude"),b.options.longitude=a.data("longitude"),b.setLayout()},"{window} resize":a.debounce(function(){b.setLayout()},250),navigate:function(c,d){var e=b.mapImage(),h=(Math.floor(e.width()),Math.floor(e.height()),a.GMaps.staticMapURL({size:[1280,1280],lat:c,lng:d,sensor:!0,scale:2,markers:[{lat:c,lng:d}]})),h=h.replace(/http\:|https\:/,"");
a.Image.get(h).done(function(){e.css({backgroundImage:a.cssUrl(h),backgroundSize:"cover",backgroundPosition:"center center"}),b.base().addClass("has-location")}).always(function(){b.base().removeClass("is-loading")})},setLayout:function(){setTimeout(function(){b.options.latitude&&b.options.longitude&&b.navigate(b.options.latitude,b.options.longitude)},1)},"{self} onShow":function(){b.setLayout()}}}),b.resolve()})}),EasySocial.module("apps/fields/user/address/maps",function(a){var b=this;a.template("easysocial/maps.suggestion",'<div class="es-location-suggestion" data-location-suggestion><span class="formatted_address">[%= location.formatted_address %]</span></div>'),EasySocial.require().library("gmaps","placeholder","image").language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT").done(function(){var c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};
EasySocial.Controller("Field.Address.Maps",{defaultOptions:{required:null,zoom:2,latitude:null,longitude:null,address:null,singleLocation:!0,required:!1,ratio:3,"{field}":"[data-field-address]","{base}":"[data-location-base]","{map}":"[data-location-map]","{mapImage}":"[data-location-map-image]","{detectButton}":"[data-location-detect]","{removeButton}":"[data-location-remove]","{form}":"[data-location-form]","{textbox}":"[data-location-textbox]","{textField}":"[data-location-textfield]","{autocomplete}":"[data-location-autocomplete]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-location-suggestion]","{source}":"[data-location-source]",view:{suggestion:"maps.suggestion"}}},function(b){return{init:function(){if(navigator.geolocation&&b.base().addClass("is-detectable"),b.textField().placeholder(),b.textField().removeAttr("disabled"),!a.isEmpty(b.source().val())){var c=JSON.parse(b.source().val());
c.latitude&&c.longitude&&(b.navigate(c.latitude,c.longitude),b.base().addClass("has-location"))}},"{window} resize":a.debounce(function(){var a=JSON.parse(b.source().val());if(a.latitude&&a.longitude){var c=b.mapImage();c.data("width")!==c.width()&&b.navigate(a.latitude,a.longitude)}},250),"{self} onShow":function(){var a=JSON.parse(b.source().val());if(a.latitude&&a.longitude){var c=b.mapImage();c.data("width")!==c.width()&&b.navigate(a.latitude,a.longitude)}},navigate:function(c,d){b.field().css({"max-width":"none"});
var e=b.mapImage(),h=(Math.floor(e.width()),Math.floor(e.height()),a.GMaps.staticMapURL({size:[1280,1280],lat:c,lng:d,sensor:!0,scale:2,markers:[{lat:c,lng:d}]}));a.Image.get(h).done(function(){e.css({backgroundImage:a.cssUrl(h),backgroundSize:"cover",backgroundPosition:"center center"}),b.base().addClass("has-location")}).always(function(){b.base().removeClass("is-loading")})},locations:{},lastQueryAddress:null,results:[],result:null,"{textField} keypress":function(d,e){switch(e.keyCode){case c.UP:var f=a(b.suggestion(".active").prev(b.suggestion.selector)[0]||b.suggestion(":last")[0]);
b.suggestion().removeClass("active"),f.addClass("active").trigger("activate"),b.suggestions().scrollTo(f,{offset:-1*f.height()}),e.preventDefault();break;case c.DOWN:var g=a(b.suggestion(".active").next(b.suggestion.selector)[0]||b.suggestion(":first")[0]);b.suggestion().removeClass("active"),g.addClass("active").trigger("activate"),b.suggestions().scrollTo(g,{offset:-1*g.height()}),e.preventDefault();break;case c.ENTER:var h=b.suggestion(".active"),i=h.data("location");b.set(i),b.hideSuggestions();break;case c.ESCAPE:b.hideSuggestions()
}},"{textField} keyup":function(d,e){switch(e.keyCode){case c.UP:case c.DOWN:case c.LEFT:case c.RIGHT:case c.ENTER:case c.ESCAPE:break;default:var f=a.trim(d.val());""===f&&(b.base().removeClass("has-location"),b.hideSuggestions());var g=b.locations[f];g?(b.lastQueryAddress=f,b.suggest(g)):b.lookup(f)}},lookup:a.debounce(function(c){b.base().addClass("is-busy"),a.GMaps.geocode({address:c,callback:function(a,d){b.base().removeClass("is-busy"),"OK"==d&&(b.locations[c]=a,b.suggest(a),b.lastQueryAddress=c)}})},250),suggest:function(c){var d=b.suggestions();
d.empty(),c.length<0||(b.results=c,a.each(c,function(a,c){b.view.suggestion({location:c}).data("location",c).appendTo(d)}),b.showSuggestions())},showSuggestions:function(){b.focusSuggestion=!0,b.element.find(".es-story-footer").addClass("swap-zindex"),setTimeout(function(){b.autocomplete().addClass("active");var c=a(document),d="click.es.story.location";c.off(d).on(d,function(e){var f=a(e.target).parents().andSelf();f.filter(b.element).length>0||(c.off(d),b.hideSuggestions())})},500)},hideSuggestions:function(){b.focusSuggestion=!1,b.autocomplete().removeClass("active"),a(document).off("click.es.story.location"),setTimeout(function(){b.focusSuggestion||b.element.find(".es-story-footer").removeClass("swap-zindex")
},500)},"{suggestion} activate":function(a){var d=a.data("location");b.navigate(d.geometry.location.lat(),d.geometry.location.lng())},"{suggestion} mouseover":function(a){b.suggestion().removeClass("active"),a.addClass("active").trigger("activate")},"{suggestion} click":function(a){var d=a.data("location");b.set(d),b.hideSuggestions()},set:function(a){b.currentLocation=a;var c=a.geometry.location.lat(),d=a.geometry.location.lng();b.navigate(c,d);var e=a.formatted_address;b.textField().val(e),b.lastQueryAddress=e,b.base().addClass("has-location"),b.result=a;
var f=b.getResult("source");b.source().val(JSON.stringify(f))},unset:function(){b.currentLocation=null,b.textField().val(""),b.mapImage().attr("src",""),b.base().removeClass("has-location"),b.source().val("")},detectTimer:null,"{detectButton} click":function(){b.textbox();b.base().addClass("is-busy"),clearTimeout(b.detectTimer),b.detectTimer=setTimeout(function(){b.base().removeClass("is-busy")},8e3),a.GMaps.geolocate({success:function(c){a.GMaps.geocode({lat:c.coords.latitude,lng:c.coords.longitude,callback:function(a,c){"OK"==c&&(b.suggest(a),b.textField().focus())
}})},error:function(b){var c="";switch(b.code){case 1:c=a.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:c=a.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:c=a.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR")}},always:function(){clearTimeout(b.detectTimer),b.base().removeClass("is-busy")}})},"{removeButton} click":function(){b.unset(),b.hideSuggestions()},getResult:function(c){if(!b.result){if(0===b.results.length)return!1;b.result=b.results[0]}var d=b.result;if(void 0===c)return d;
switch(c){case"coords":return{lat:d.geometry.location.lat(),lng:d.geometry.location.lng()};case"lat":case"latitude":return d.geometry.location.lat();case"lng":case"longitude":return d.geometry.location.lng();case"address":return d.formatted_address;case"viewport":return d.geometry.viewport;case"bounds":return d.geometry.bounds||d.geometry.viewport;case"source":var e={};a.each(d.address_components,function(a,b){b.types[0]&&(e[b.types[0]]=b.long_name)});var f={address1:["street_address","route"],address2:["intersection","colloquial_area","neighborhood","premise","subpremise"],city:["locality","sublocality","sublocality_level_1","sublocality_level_2","sublocality_level_3","sublocality_level_4","sublocality_level_5"],state:["administrative_area_level_1","administrative_area_level_2","administrative_area_level_3"],zip:"postal_code",country:"country"},g={};
a.each(f,function(b,c){return g[b]="",a.isArray(c)?(a.each(c,function(a,c){return void 0!==e[c]?(g[b]=e[c],!1):!0}),!0):(void 0!==e[c]&&(g[b]=e[c]),void 0)});var h=a.extend(g,{components:e,address:d.formatted_address,latitude:d.geometry.location.lat(),longitude:d.geometry.location.lng()});return h}}}}),b.resolve()})}),EasySocial.module("apps/fields/user/autocomplete/content",function(){var b=this;EasySocial.require().library("textboxlist").done(function(a){EasySocial.Controller("Field.Autocomplete",{defaultOptions:{required:!1,id:null,types:null,fieldname:null,actor:null,target:null,selectedItems:[],max:null,exclusive:!0,exclusion:[],minLength:1,highlight:!0,name:"uid[]",type:"","{suggest}":"[data-field-suggest]"}},function(b,c){return{init:function(){c.name=c.fieldname+"[]",b.initSuggest()
},initSuggest:function(){b.suggest().textboxlist({component:"es",name:c.name,max:c.max,plugin:{autocomplete:{exclusive:c.exclusive,minLength:c.minLength,highlight:c.highlight,showLoadingHint:!0,showEmptyHint:!0,query:function(a){var b=EasySocial.ajax("fields/user/autocomplete/suggest",{search:a,id:c.id});return b}}}}).textboxlist("enable")},"{suggest} removeItem":function(b,d,e){var f=a.inArray(e.id.toString(),c.exclusion)>-1;f&&c.exclusion.splice(c.exclusion.indexOf(e.id.toString()),1)},"{suggest} filterMenu":function(b,d,e,f,g,h){var i=h.getAddedItems(),i=a.pluck(i,"id"),j=i.concat(c.exclusion);
f.each(function(){var b=a(this),c=b.data("item"),d=a.inArray(c.id.toString(),j)>-1;b.toggleClass("hidden",d)})}}}),b.resolve()})}),EasySocial.module("apps/fields/user/avatar/content",function(a){var b=this;EasySocial.require().library("image","imgareaselect").stylesheet("imgareaselect/default").language("PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE").done(function(){EasySocial.Controller("Field.Avatar",{defaultOptions:{required:!1,id:0,group:null,origSource:null,defaultAvatar:null,hasAvatar:null,"{field}":"[data-field-avatar]","{gallery}":"[data-field-avatar-gallery]","{galleryList}":"[data-field-avatar-gallery-items]","{galleryItem}":"[data-field-avatar-gallery-item]","{frame}":"[data-field-avatar-frame]","{viewport}":"[data-field-avatar-viewport]","{avatarSource}":"[data-field-avatar-source]","{avatarData}":"[data-field-avatar-data]","{avatarPath}":"[data-field-avatar-path]","{avatarType}":"[data-field-avatar-type]","{avatarName}":"[data-field-avatar-name]","{file}":"[data-field-avatar-file]","{image}":"[data-field-avatar-selected]","{note}":"[data-field-avatar-note]","{actions}":"[data-field-avatar-actions]","{cancel}":"[data-field-avatar-actions-cancel]","{crop}":"[data-field-avatar-actions-crop]","{removeFrame}":"[data-field-avatar-remove]","{remove}":"[data-field-avatar-remove-button]","{revertFrame}":"[data-field-avatar-revert]","{revert}":"[data-field-avatar-revert-button]","{loader}":"[data-field-avatar-loader]"}},function(b){return{init:function(){b.state=!!b.options.hasAvatar
},state:!0,"{file} change":function(c){if(!a.isEmpty(c.val())){var e=c.val().replace(/\\/g,"/").replace(/.*\//,"");c.parents(".input-group").find(":text").val(e),b.state=!1,b.loader().show(),b.frame().hide(),b.file().hide(),b.clearError(),EasySocial.ajax("fields/"+b.options.group+"/avatar/upload",{id:b.options.id,files:c},{type:"iframe"}).done(function(a,c,d){b.avatarName().val(a.name),b.avatarSource().val(c),b.avatarPath().val(d),b.avatarType().val("upload"),b.setLayout(c),b.galleryItem().removeClass("active"),b.removeFrame().hide(),b.revertFrame().hide(),b.state=!0
}).fail(function(a){b.loader().hide(),b.raiseError(a),b.file().show().val(""),b.frame().show()})}},setLayout:function(c){var d=a.Image.get(c),e=b.frame();d.done(function(d,f){e.css("background-image",a.cssUrl(c)),e.addClass("avatar-frame-crop"),e.show(),b.loader().hide(),b.actions().show(),b.note().show(),b.viewport().imgAreaSelect({remove:!0}),b.viewport().show();var g=a.Image.resizeWithin(f.width,f.height,e.width(),e.height()),h=Math.min(g.width,g.height),i=Math.floor((g.width-h)/2),j=Math.floor((g.height-h)/2),k=i+h,l=j+h;
b.viewport().css(g).imgAreaSelect({handles:!0,aspectRatio:"1:1",parent:e,x1:i,y1:j,x2:k,y2:l,onSelectEnd:function(a,c){var d=!("0"==c.width&&"0"==c.height);if(d){var e=JSON.stringify(b.data());b.avatarData().val(e)}}})})},"{cancel} click":function(){b.actions().hide(),b.note().hide(),b.frame().hide(),b.file().show(),b.file().val(""),b.file().parents(".input-group").find(":text").val(""),b.avatarSource().val(""),b.avatarPath().val(""),b.avatarData().val(""),b.avatarType().val(""),b.viewport().hide().imgAreaSelect({remove:!0}),a.isEmpty(b.options.origSource)||b.frame().css("background-image",a.cssUrl(b.options.origSource)).removeClass("avatar-frame-crop").show(),b.options.hasAvatar&&b.removeFrame().show()
},data:function(){var a=b.viewport(),c=a.width(),d=a.height(),e=a.imgAreaSelect({instance:!0}).getSelection(),f={top:e.y1/d,left:e.x1/c,width:e.width/c,height:e.height/d};return f},"{gallery} click":function(){b.galleryList().toggle()},"{galleryItem} click":function(a){if(!a.hasClass("active")){var d=a.data("id");b.galleryItem().removeClass("active"),a.addClass("active"),b.state=!1,b.loader().show(),b.frame().hide(),b.file().hide(),b.file().val(""),b.file().parents(".input-group").find(":text").val(""),b.clearError(),b.avatarType().val("gallery"),b.avatarSource().val(d),EasySocial.ajax("fields/user/avatar/loadDefault",{avatarId:d}).done(function(a){b.frame().css("background-image","url("+a+")"),b.frame().show(),b.frame().removeClass("avatar-frame-crop"),b.loader().hide(),b.viewport().hide(),b.viewport().imgAreaSelect({remove:!0}),b.actions().hide(),b.note().hide(),b.file().show(),b.revertFrame().show(),b.removeFrame().hide(),b.state=!0
})}},"{remove} click":function(){b.avatarType().val("remove"),b.frame().css("background-image",a.cssUrl(b.options.defaultAvatar)),b.removeFrame().hide(),b.options.hasAvatar&&b.revertFrame().show(),b.state=!1},"{revert} click":function(){b.avatarType().val(""),b.frame().css("background-image",a.cssUrl(b.options.origSource)),b.options.hasAvatar&&b.removeFrame().show(),b.revertFrame().hide(),b.galleryItem().removeClass("active"),b.state=!0},"{self} onSubmit":function(c,d,e){b.options.required&&(b.state||b.raiseError(a.language("PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE")),e.push(b.state))
},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")}}}),b.resolve()})}),EasySocial.module("apps/fields/user/avatar/sample_content",function(){var b=this;EasySocial.Controller("Field.Avatar.Sample",{defaultOptions:{"{upload}":"[data-avatar-upload]","{gallery}":"[data-avatar-gallery]","{galleryTitle}":"[data-avatar-gallery-title]","{galleryButton}":"[data-avatar-gallery-button]","{gallerySelection}":"[data-avatar-gallery-selection]"}},function(a){return{"{self} onConfigChange":function(b,c,d,e){switch(d){case"upload":a.upload().toggle(e);
break;case"gallery":a.gallery().toggle(e);break;case"use_gallery_button":a.galleryButton().toggle(e),a.gallerySelection().toggle(!e),a.galleryTitle().toggle(!e)}}}}),b.resolve()}),EasySocial.module("apps/fields/user/checkbox/content",function(a){var b=this;EasySocial.require().language("PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM").done(function(){EasySocial.Controller("Field.Checkbox",{defaultOptions:{required:!1,"{item}":"[data-field-checkbox-item]"}},function(b){return{init:function(){},validateInput:function(){return b.clearError(),b.options.required&&0==b.item(":checked").length?(b.raiseError(),!1):!0
},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM")])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/checkbox/sample_content",function(){var b=this;EasySocial.require().view("fields/user/checkbox/item").done(function(){EasySocial.Controller("Field.Checkbox.Sample",{defaultOptions:{"{checkboxes}":"[data-checkboxes]","{checkbox}":"[data-checkbox]","{checkboxInput}":"[data-checkbox-input]","{checkboxTitle}":"[data-checkbox-title]",view:{sample:"fields/user/checkbox/item"}}},function(a){return{init:function(){},"{self} onChoiceTitleChanged":function(b,c,d,e){a.checkboxTitle().eq(d).text(e)
},"{self} onChoiceValueChanged":function(b,c,d,e){a.checkboxInput().eq(d).val(e)},"{self} onChoiceAdded":function(b,c,d){a.checkbox().eq(d).length>0?a.checkbox().eq(d).before(a.view.sample()):a.checkboxes().append(a.view.sample())},"{self} onChoiceRemoved":function(b,c,d){a.checkbox().eq(d).remove()},"{self} onChoiceToggleDefault":function(b,c,d,e){var f=a.checkboxInput().eq(d);e?f.prop("checked",!0):f.prop("checked",!1)}}}),b.resolve()})}),EasySocial.module("apps/fields/user/country/content",function(a){var b=this;
EasySocial.require().library("textboxlist").language("PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED","PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR","PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR").done(function(){EasySocial.Controller("Field.Country",{defaultOptions:{fieldname:"",required:!1,id:null,min:null,max:null,selecttype:"textboxlist","{field}":"[data-field-country]","{inputTextboxlist}":"[data-country-select-textboxlist]","{inputMultilist}":"[data-country-select-multilist]","{inputCheckbox}":"[data-country-select-checkbox]","{inputCheckboxes}":"[data-country-select-checkbox] input","{inputDropdown}":"[data-country-select-dropdown]"}},function(b){return{init:function(){b.options.max=b.field().data("max"),b.options.min=b.field().data("min"),b.options.selecttype=b.field().data("select-type"),"textboxlist"===b.options.selecttype&&EasySocial.module("field.country/"+b.options.id).done(function(a){b.inputTextboxlist().textboxlist({component:"es",name:b.options.fieldname+"[]",max:b.options.max<1?null:b.options.max,plugin:{autocomplete:{exclusive:!0,query:a}}})
})},"{inputMultilist} change":function(a){return b.options.max>0&&a.val().length>b.options.max?(a.val(b.lastValidSelection?b.lastValidSelection:""),!1):(b.lastValidSelection=a.val(),void 0)},"{inputCheckboxes} change":function(a){var d=b.inputCheckboxes(":checked").length;return b.options.max>0&&d>b.options.max?(a.removeAttr("checked"),!1):void 0},validateInput:function(){var c=null;if("textboxlist"===b.options.selecttype&&(c=b.inputTextboxlist().controller("textboxlist").getAddedItems()),"multilist"===b.options.selecttype&&(c=b.inputMultilist().val()),"checkbox"===b.options.selecttype&&(c=b.inputCheckboxes(":checked")),"dropdown"===b.options.selecttype){var d=b.inputDropdown().val();
a.isEmpty(d)||(c=[d])}var e=c?c.length:0;return b.options.required||0!==e?b.options.required&&1>e?(b.raiseError(a.language("PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED")),!1):b.options.min>0&&e<b.options.min?(b.raiseError(a.language("PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR")),!1):b.options.max>0&&e>b.options.max?(b.raiseError(a.language("PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR")),!1):!0:!0},raiseError:function(a){b.trigger("error",[a])},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())}}}),b.resolve()
})}),EasySocial.module("apps/fields/user/country/sample_content",function(){var b=this;EasySocial.Controller("Field.Country.Sample",{defaultOptions:{"{inputGeneral}":"[data-country-select]","{inputTextboxlist}":"[data-country-select-textboxlist]","{inputMultilist}":"[data-country-select-multilist]","{inputCheckbox}":"[data-country-select-checkbox]","{inputDropdown}":"[data-country-select-dropdown]","{maxMessage}":"[data-country-max-message]","{maxCount}":"[data-country-max-count]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"select_type":a.inputGeneral().hide(),"textboxlist"===e&&a.inputTextboxlist().show(),"multilist"===e&&a.inputMultilist().show(),"checkbox"===e&&a.inputCheckbox().show(),"dropdown"===e&&a.inputDropdown().show();
break;case"multilist_size":a.inputMultilist().attr("size",e);break;case"show_max_message":a.maxMessage().toggle(!!e);break;case"max":a.maxCount().text(e)}}}}),b.resolve()}),EasySocial.module("apps/fields/user/cover/content",function(a){var b=this;EasySocial.require().library("image").language("PLG_FIELDS_COVER_VALIDATION_REQUIRED").done(function(){EasySocial.Controller("Field.Cover",{defaultOptions:{id:0,group:null,required:!1,hasCover:!0,defaultCover:null,ratio:3,"{image}":"[data-field-cover-image]","{data}":"[data-field-cover-data]","{position}":"[data-field-cover-position]","{file}":"[data-field-cover-file]","{note}":"[data-field-cover-note]","{loader}":"[data-field-cover-loader]","{error}":"[data-field-cover-error]","{removeButton}":"[data-field-cover-remove-button]","{revertFrame}":"[data-field-cover-revert]","{revertButton}":"[data-field-cover-revert-button]"}},function(b){return{init:function(){b.setFrame(),b.setLayout(),b.origCover=b.options.hasCover?a.uri(b.image().css("backgroundImage")).extract(0):null,b.origPosition=b.options.hasCover?b.image().css("backgroundPosition"):null
},"{self} onShow":function(){setTimeout(function(){b.setLayout()},1)},setFrame:function(){var a=b.image().width(),c=a/b.options.ratio;b.image().css("height",c)},"{window} resize":a.debounce(function(){b.setFrame()},250),imageLoaders:{},"{file} change":function(c){if(!a.isEmpty(c.val())){var e=c.val().replace(/\\/g,"/").replace(/.*\//,"");c.parents(".input-group").find(":text").val(e),b.loader().show(),b.error().hide(),b.image().hide(),b.note().hide(),b.file().hide(),EasySocial.ajax("fields/"+b.options.group+"/cover/upload",{id:b.options.id,files:c},{type:"iframe"}).done(function(c){var d=JSON.stringify(c);
b.data().val(d);var e=JSON.stringify({x:.5,y:.5});b.position().val(e),b.position().val();{var f=c.large.uri,g=b.imageLoaders;(g[f]||(g[f]=a.Image.get(f))).done(function(a){b.setLayout.image=a,b.file().show(),b.image().show(),b.note().show(),b.loader().hide(),b.revertFrame().hide(),b.removeButton().show(),b.setCover(c.large.uri)})}}).fail(function(a){b.loader().hide(),b.file().show(),b.error().show().html(a)})}},setLayout:function(){var c=b.image(),d=b.setLayout.image;if(d){var h=d.data("width"),i=d.data("height"),j=c.width(),k=c.height(),l=a.Image.resizeProportionate(h,i,j,k,"outer");
b.availableWidth=j-l.width,b.availableHeight=k-l.height,b.setFrame()}else{var e=a.uri(c.css("backgroundImage")).extract(0);if(!e)return;{var f=b.imageLoaders;(f[e]||(f[e]=a.Image.get(e))).done(function(a){b.setLayout.image=a,b.setLayout()})}}},setCover:function(c,d){d=d||"50% 50%",b.image().css({backgroundImage:a.cssUrl(c),backgroundPosition:d}),b.setLayout(),b.image().addClass("cover-move"),b.note().show()},x:.5,y:.5,moveCover:function(a,c,d){d||(d=b.image());var e=b.availableWidth,f=b.availableHeight,g=0==e?0:b.x+(a/e||0),h=0==f?0:b.y+(c/f||0);
0>g&&(g=0),g>1&&(g=1),0>h&&(h=0),h>1&&(h=1),d.css("backgroundPosition",100*(b.x=g)+"% "+100*(b.y=h)+"% ");var i={x:b.x,y:b.y};b.position().val(JSON.stringify(i))},"{image} mousedown":function(c,d){d.target===b.image()[0]&&d.preventDefault();var e=b.image(),f=e.css("backgroundPosition").split(" ");b.x=parseInt(f[0])/100,b.y=parseInt(f[1])/100;var g=d.pageX,h=d.pageY;a(document).on("mousemove.movingCover mouseup.movingCover",function(a){b.moveCover(-1*(g-(g=a.pageX)),-1*(h-(h=a.pageY)),e)}).on("mouseup.movingCover",function(){a(document).off("mousemove.movingCover mouseup.movingCover")
})},"{removeButton} click":function(c){var d=b.data().val();a.isEmpty(d)?b.options.hasCover&&(b.setCover(b.options.defaultCover),b.data().val("delete"),c.hide(),b.revertFrame().show()):(b.origData=d,b.origPosition=b.position().val(),b.data().val(""),b.position().val(""),b.file().val(""),b.file().parents(".input-group").find(":text").val(""),b.options.hasCover?b.setCover(b.origCover):(b.setCover(b.options.defaultCover),b.data().val("delete"),c.hide()))},"{revertButton} click":function(){b.setCover(b.origCover,b.origPosition),b.revertFrame().hide(),b.removeButton().show(),b.data().val(""),b.position().val(""),b.file().val(""),b.file().parents(".input-group").find(":text").val("")
},"{self} onSubmit":function(c,d,e){b.options.required&&!b.options.hasCover&&a.isEmpty(b.data().val())&&(b.raiseError(a.language("PLG_FIELDS_COVER_VALIDATION_REQUIRED")),e.push(!1))},raiseError:function(a){b.trigger("error",[a])}}}),b.resolve()})}),EasySocial.module("apps/fields/user/currency/sample_content",function(){var b=this;EasySocial.Controller("Field.Currency.Sample",{defaultOptions:{}},function(){return{init:function(){},"{self} onConfigChange":function(a,b,c){switch(c){case"format":}}}}),b.resolve()
}),EasySocial.module("apps/fields/user/datetime/content",function(){var b=this;EasySocial.require().library("datetimepicker","chosen","moment/"+EasySocial.options.momentLang).language("PLG_FIELDS_DATETIME_VALIDATION_INVALID_DATETIME_FORMAT","PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME").done(function(a){EasySocial.Controller("Field.Datetime",{defaultOptions:{required:!1,calendarDateFormat:null,yearfrom:null,yearto:null,date:null,lang:null,allowTime:!1,allowTimezone:!1,calendarLanguage:"english","{field}":"[data-field-datetime]","{date}":"[data-field-datetime-select]","{dateValue}":"[data-field-datetime-value]","{timezone}":"[date-field-datetime-timezone]","{form}":"[data-field-datetime-form]","{icon}":"[data-field-datetime-icon]","{clearButton}":"[data-clear]"}},function(b){return{init:function(){if(b.options.yearfrom=b.options.yearfrom||1930,b.options.yearto=a.isEmpty(b.options.yearto)?(new Date).getFullYear()+100:parseInt(b.options.yearto)+1,b.date()._datetimepicker({component:"es",format:b.options.calendarDateFormat,minDate:b.options.yearfrom+"-01-01",maxDate:b.options.yearto+"-12-31",icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!1,pickTime:b.options.allowTime,useCurrent:!1,language:"english"==b.options.calendarLanguage?"en-gb":EasySocial.options.momentLang}),b.options.date=b.dateValue().val(),!a.isEmpty(b.options.date)){var c=a.moment(b.options.date);
b.datetimepicker("setDate",c)}b.options.allowTimezone&&b.timezone().chosen({search_contains:!0})},"{icon} click":function(){b.datetimepicker("show")},"{date} dp.change":function(a,c){b.setDateValue(c.date.toDate()),b.form().addClass("has-datetime"),b.options.allowTime||b.date().blur()},datetimepicker:function(a,c){return b.date().data("DateTimePicker")[a](c)},setDateValue:function(a){b.dateValue().val(a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2)+" "+("00"+a.getHours()).slice(-2)+":"+("00"+a.getMinutes()).slice(-2)+":"+("00"+a.getSeconds()).slice(-2))
},"{date} blur":function(){b.validateCalendar()},validateCalendar:function(){return b.clearError(),b.options.required&&a.isEmpty(b.dateValue().val())?(b.raiseError(a.language("PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.validateCalendar())},"{clearButton} click":function(){b.form().removeClass("has-datetime"),b.datetimepicker("setValue",new a.moment),b.date().val(""),b.dateValue().val("")
}}}),b.resolve()})}),EasySocial.module("apps/fields/user/datetime/display_content",function(){var b=this;EasySocial.require().library("popbox","chosen").language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE").done(function(a){EasySocial.Controller("Field.Datetime.Display",{defaultOptions:{userid:null,date:null,timezone:null,local:null,"{toggle}":"[data-popbox]","{content}":"[data-popbox-content]","{date}":"[data-date]","{timezone}":"[data-timezone]","{loading}":"[data-loading]"}},function(b){return{init:function(){b.options.timezone=b.timezone().data("timezone"),b.options.date=b.date().data("date-utc"),b.datetime(b.options.timezone,b.date().html()),b.options.local=-(new Date).getTimezoneOffset()/60;
var a=b.content().html(),c=b.toggle().data("popbox-position");b.toggle().popbox({content:a,id:"fd",component:"es",type:"timezone",toggle:"click",position:c}).attr("data-popbox","")},"{toggle} popboxActivate":function(c,d,e){a(e.tooltip).addController("EasySocial.Controller.Field.Datetime.Display.Timezone",{"{parent}":b})},data:{},datetime:function(c,d){if(void 0===d){var e=a.Deferred();return void 0===b.data[c]?(b.loading().show(),EasySocial.ajax("fields/user/datetime/getDatetime",{id:b.options.id,userid:b.options.userid,tz:c,local:b.options.local,datetime:b.options.date}).done(function(a){b.loading().hide(),e.resolve(b.datetime(c,a))
})):e.resolve(b.data[c]),e}return b.data[c]=d,d},showDatetime:function(c,d){"local"===c&&(c=a.language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE")),b.timezone().html(c),b.date().html(d)}}}),EasySocial.Controller("Field.Datetime.Display.Timezone",{defaultOptions:{"{timezones}":"[data-timezone-select]","{reset}":"[data-timezone-reset]","{local}":"[data-timezone-local]"}},function(a){return{init:function(){a.timezones().chosen({search_contains:!0})},"{timezones} change":function(b){var d=b.val();a.parent.date().hide(),a.parent.timezone().hide(),a.parent.datetime(d).done(function(b){a.parent.showDatetime(d,b),a.parent.date().show(),a.parent.timezone().show()
})},"{reset} click":function(){a.setTimezone(a.parent.options.timezone)},"{local} click":function(){a.setTimezone("local")},setTimezone:function(b){a.timezones().val(b).trigger("liszt:updated").trigger("change")}}}),b.resolve()})}),EasySocial.module("apps/fields/user/datetime/dropdown",function(a){var b=this;EasySocial.require().language("PLG_FIELDS_DATETIME_DAY").done(function(){EasySocial.Controller("Field.Datetime.Dropdown",{defaultOptions:{required:!1,allowTime:!1,allowTimezone:!1,yearfrom:null,yearto:null,"{dateValue}":"[data-field-datetime-value]","{year}":"[data-field-datetime-year]","{month}":"[data-field-datetime-month]","{day}":"[data-field-datetime-day]","{hour}":"[data-field-datetime-hour]","{minute}":"[data-field-datetime-minute]","{ampm}":"[data-field-datetime-ampm]"}},function(b){return{init:function(){},"{year} change":function(){b.setValue()
},"{month} change":function(){var e=b.year().val(),f=b.month().val();if(""!==e&&""!==f){var g=new Date(e,f,0).getDate(),h=b.day().val();for(""!==h&&(h=Math.min(h,g)),b.day().empty(),b.day().append(a('<option value="">'+a.language("PLG_FIELDS_DATETIME_DAY")+"</option>")),i=1;g>=i;i++)a('<option value="'+i+'">'+i+"</option>").appendTo(b.day());""!==h&&b.day().val(h)}b.setValue()},"{day} change":function(){b.setValue()},"{hour} change":function(){b.setValue()},"{minute} change":function(){b.setValue()},"{ampm} change":function(){b.setValue()
},setValue:function(){var a,c=b.year().val(),d=b.month().val(),e=b.day().val();if(""!==c&&""!==d&&""!==e){if(a=c+"-"+d+"-"+e,b.options.allowTime){var f=b.hour().val(),g=b.minute().val();""!==f&&b.ampm().length>0&&"pm"==b.ampm().val()&&(f=(parseInt(f)+12).toString(),"24"===f&&(f="0")),""===g&&(g="00"),a+=" "+("00"+f).slice(-2)+":"+("00"+g).slice(-2)+":00"}b.dateValue().val(a)}}}}),b.resolve()})}),EasySocial.module("apps/fields/user/datetime/sample_content",function(){var b=this;EasySocial.require().library("ui/datepicker").done(function(){EasySocial.Controller("Field.Datetime.Sample",{defaultOptions:{"{yearPrivacy}":"[data-yearprivacy]","{input}":"[data-field-datetime-select]","{timezone}":"[data-field-datetime-timezone]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"year_privacy":a.yearPrivacy().toggle(e);
break;case"allow_timezone":a.timezone().toggle(e);break;case"placeholder":a.input().attr("placeholder",e)}}}}),b.resolve()})}),EasySocial.module("apps/fields/user/dropdown/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE").done(function(a){EasySocial.Controller("Field.Dropdown",{defaultOptions:{required:null,"{field}":"[data-field-dropdown]","{item}":"[data-field-dropdown-item]","{option}":"[data-field-dropdown-item] option"}},function(b){return{init:function(){},validateInput:function(){return b.clearError(),b.options.required&&a.isEmpty(b.item().val())?(b.raiseError(),!1):!0
},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE")])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){return b.options.required?(d.push(b.validateInput()),void 0):(d.push(!0),void 0)},"{self} onSample":function(){b.option().length<1&&b.item().append(a("<option></option>"))},"{self} onChoiceAdded":function(c,d,e){b.option().eq(e).length>0?b.option().eq(e).before(a("<option></option>")):b.item().append(a("<option></option>"))
},"{self} onChoiceValueChanged":function(a,c,d,e){b.option().eq(d).val(e)},"{self} onChoiceTitleChanged":function(a,c,d,e){b.option().eq(d).text(e)},"{self} onChoiceRemoved":function(a,c,d){b.option().eq(d).remove()},"{self} onChoiceToggleDefault":function(a,c,d,e){b.option().removeAttr("selected"),e&&b.option().eq(d).attr("selected","selected")}}}),b.resolve()})}),EasySocial.module("apps/fields/user/email/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT").done(function(a){EasySocial.Controller("Field.Email",{defaultOptions:{required:!1,regex:0,regexFormat:"",regexModifier:"","{field}":"[data-field-email]","{input}":"[data-field-email-input]"}},function(b){return{init:function(){},validateInput:function(){var c=b.input().val();
if(b.options.required&&a.isEmpty(c))return b.raiseError(a.language("PLG_FIELDS_EMAIL_VALIDATION_REQUIRED")),!1;if(!a.isEmpty(c)&&b.options.regex){var d=new RegExp(b.options.regexFormat,b.options.regexModifier);if(!d.test(c))return b.raiseError(a.language("PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT")),!1}return!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/file/content",function(){var b=this;
EasySocial.require().library("ui/sortable").language("PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED","COM_EASYSOCIAL_WORKING").done(function(a){EasySocial.Controller("Field.File",{defaultOptions:{required:!1,id:null,inputName:"",maxFile:0,"{field}":"[data-field-file]","{list}":"[data-field-file-list]","{item}":"[data-field-file-item]","{add}":"[data-field-file-add]","{dragPlaceholder}":".data-field-file-item-drag","{moveHandle}":"[data-field-file-move]"}},function(b){return{init:function(){b.options.maxFile=b.field().data("maxfile"),b.item().addController("EasySocial.Controller.Field.File.Item",{controller:{parent:b}}),b.initSortable()
},initSortable:function(){b.list().sortable({items:b.item.selector,placeholder:"data-field-file-item-drag",handle:b.moveHandle.selector,forcePlaceholderSize:!0,start:function(a,c){b.dragPlaceholder().width(c.item.find(".file-wrap").width())}})},"{add} click":function(c){if(b.options.maxFile<1||b.item().length<b.options.maxFile){var e=b.item().length,f=a('<div class="data-field-file-item" data-field-file-item></div>');f.data("key",e),f.html(a.language("COM_EASYSOCIAL_WORKING")),f.addController("EasySocial.Controller.Field.File.Item",{controller:{parent:b}}),b.list().append(f),EasySocial.ajax("fields/user/file/getUploadHtml",{id:b.options.id,key:e}).done(function(a){f.html(a)
}),b.options.maxFile>1&&b.item().length>=b.options.maxFile&&c.hide()}},"{item} uploadDone":function(){b.add().click()}}}),EasySocial.Controller("Field.File.Item",{defaultOptions:{required:!1,key:null,"{upload}":"[data-field-file-upload]","{progress}":"[data-field-file-progress]","{delete}":"[data-field-file-delete]","{clear}":"[data-field-file-clear]","{id}":"[data-field-file-id]","{tmp}":"[data-field-file-tmp]"}},function(b){return{init:function(){b.options.key=b.element.data("key")},"{upload} change":function(c){b.element.html(a.language("COM_EASYSOCIAL_WORKING")),EasySocial.ajax("fields/user/file/upload",{id:b.parent.options.id,files:c,key:b.options.key},{type:"iframe"}).done(function(a){b.element.html(a),b.trigger("uploadDone")
}).fail(function(a){b.element.html(a||b.getErrorMsg())})},"{delete} click":function(){var e=b.tmp().val(),f=b.id().val();b.element.html(a.language("COM_EASYSOCIAL_WORKING")),EasySocial.ajax("fields/user/file/delete",{id:b.parent.options.id,key:b.options.key,tmp:e,fileid:f}).done(function(a){b.element.html(a),b.trigger("fileDeleted")}).fail(function(a){b.element.html(a||b.getErrorMsg())})},"{clear} click":function(){b.element.html(a.language("COM_EASYSOCIAL_WORKING")),EasySocial.ajax("fields/user/file/getUploadHtml",{id:b.parent.options.id,key:b.options.key}).done(function(a){b.element.html(a)
})},getErrorMsg:function(){return msg=a('<span class="alert field-file-error">'+a.language("PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED")+'<button class="close" type="button" data-field-file-clear>\xd7</button></span>')}}}),b.resolve()})}),EasySocial.module("apps/fields/user/file/sample_content",function(){var b=this;EasySocial.Controller("Field.File",{defaultOptions:{"{sizeText}":"[data-field-file-size-text]","{size}":"[data-field-file-size]","{add}":"[data-field-file-add]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"size_limit":a.size().text(e);
break;case"show_size_limit":a.sizeText().toggle(!!e);break;case"file_limit":a.add().toggle(1>e||e>1)}}}}),b.resolve()}),EasySocial.module("apps/fields/user/gender/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED").done(function(a){EasySocial.Controller("Field.Gender",{defaultOptions:{required:!1,"{field}":"[data-field-gender]","{selection}":"[data-field-gender-select]"}},function(b){return{init:function(){},validateInput:function(){if(!b.options.required)return!0;
b.clearError();var c=b.selection(":checked").val();return a.isEmpty(c)?(b.raiseError(),!1):!0},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED")])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())},"{selection} click":function(){b.validateInput()}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_email/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING").done(function(a){EasySocial.Controller("Field.Joomla_email",{defaultOptions:{required:!0,id:null,userid:null,reconfirm:!1,event:null,"{input}":"[data-field-email-input]","{confirm}":"[data-field-email-reconfirm-input]","{confirmFrame}":"[data-field-email-reconfirm-frame]"}},function(b){return{init:function(){b.origEmail=b.input().val()
},"{input} blur":function(){var d=b.input().val();b.options.reconfirm&&d!==b.origEmail&&b.confirmFrame().show(),!b.options.reconfirm||d!==b.origEmail||"onEdit"!==b.options.event&&"onAdminEdit"!==b.options.event||b.confirmFrame().hide(),b.validateInput()},"{confirm} blur":function(){b.validateInput()},validateInput:function(){b.clearError();var c=b.input().val();if(a.isEmpty(c))return b.options.required?(b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED")),!1):!0;if(b.options.reconfirm){var d=b.confirm().val();
if(c!==b.origEmail&&a.isEmpty(d))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED")),!1;if(!a.isEmpty(d)&&c!==d)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING")),!1}return b.checkInput().done(function(){b.clearError()}).fail(function(a){b.raiseError(a)})},checkInput:function(){return EasySocial.ajax("fields/user/joomla_email/isValid",{id:b.options.id,userid:b.options.userid,email:b.input().val()})},raiseError:function(a){b.trigger("error",[a])
},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d,e){"onRegisterMini"!==e&&d.push(b.validateInput())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_email/registermini_content",function(a){var b=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING","PLG_FIELDS_JOOMLA_EMAIL_CHECKING","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT").done(function(){EasySocial.Controller("Field.Joomla_email.Mini",{defaultOptions:{require:!0,id:null,"{input}":"#email","{confirm}":"[data-field-email-reconfirm-input]"}},function(b){return{init:function(){b.origEmail=b.input().val()
},"{input} keyup":function(a){a.val().length>0&&b.delayedCheck()},"{confirm} blur":function(){b.checkEmail()},state:!1,delayedCheck:a.debounce(function(){b.checkEmail()},250),checkEmail:function(){b.clearError();var c=b.input().val();if(b.options.required&&0==c.length)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED")),!1;if(!a.isEmpty(c)&&b.options.regex){var d=new RegExp(b.options.regexFormat,b.options.regexModifier);if(!d.test(c))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT")),!1
}if(b.options.reconfirm){var e=b.confirm().val();if(c!==b.origEmail&&a.isEmpty(e))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED")),!1;if(!a.isEmpty(e)&&c!==e)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING")),!1}if(c.length>0){var f=a.Deferred();b.setLoading(a.language("PLG_FIELDS_JOOMLA_EMAIL_CHECKING"));var c=b.input().val();return EasySocial.ajax("fields/user/joomla_email/isValid",{id:b.options.id,userid:0,email:c}).done(function(){b.setLoaded(),f.resolve()
}).fail(function(a){b.setLoaded(),b.raiseError(a),f.reject()}),f}return!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d,e){"onRegisterMini"===e&&(b.options.required||b.input().val().length>0)&&d.push(b.checkEmail())},setLoading:function(a){b.trigger("loading",[a])},setLoaded:function(){b.trigger("loaded")}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_email/sample_content",function(){var b=this;EasySocial.Controller("Field.Joomla_email.Sample",{defaultOptions:{"{confirmEmail}":"[data-field-email-reconfirm-frame]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"reconfirm_email":a.confirmEmail().toggle(e)
}}}}),b.resolve()}),EasySocial.module("apps/fields/user/joomla_fullname/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME").done(function(a){EasySocial.Controller("Field.Joomla_fullname",{defaultOptions:{nameFormat:1,max:0,required:!0,"{field}":"[data-field-joomla_fullname]","{firstName}":"[data-field-jname-first]","{middleName}":"[data-field-jname-middle]","{lastName}":"[data-field-jname-last]","{name}":"[data-field-jname-name]"}},function(b){return{init:function(){b.options.nameFormat=b.field().data("name-format"),b.options.max=b.field().data("max")
},validateInput:function(){return b.clearError(),b.options.required?3==b.options.nameFormat?a.isEmpty(b.name().val())?(b.raiseError(),!1):!0:a.isEmpty(b.firstName().val())?(b.raiseError(),!1):!0:!0},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME")])},clearError:function(){b.trigger("clear")},"{firstName} blur":function(){b.validateInput()},"{name} blur":function(){b.validateInput()},"{self} onError":function(){b.raiseError()},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())
}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_fullname/sample_content",function(){var b=this;EasySocial.Controller("Field.Joomla_fullname.Sample",{defaultOptions:{"{fullnameFormat}":"[data-fullname-format]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"format":a.switchFormat(e)}},switchFormat:function(b){a.fullnameFormat().hide(),a.fullnameFormat().eq(b-1).show()}}}),b.resolve()}),EasySocial.module("apps/fields/user/joomla_password/content",function(a){var b=this;
EasySocial.require().library("passwordstrength").language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_INTEGER","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_SYMBOLS","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_UPPERCASE","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD").done(function(){EasySocial.Controller("Field.Joomla_password",{defaultOptions:{event:null,triggerError:!0,required:!1,passwordStrength:!1,reconfirmPassword:!1,requireOriginal:!1,min:4,max:0,minInteger:0,minSymbol:0,minUpperCase:0,"{field}":"[data-field-joomla_password]","{original}":"[data-field-password-orig]","{input}":"[data-field-password-input]","{reconfirm}":"[data-field-password-confirm]","{pwResetSubmitButton}":"[data-password-reset-submit]","{strength}":"[data-field-password-strength]","{warning}":"[data-field-password-warning]","{reconfirmNotice}":"[data-reconfirmPassword-failed]"}},function(b){return{init:function(){b.options.passwordStrength&&b.initPasswordStrength()
},"{input} keyup":function(){b.validatePassword()},"{input} blur":function(){b.validatePassword()},"{reconfirm} keyup":function(){b.validatePassword()},"{reconfirm} blur":function(){b.validatePassword()},validatePassword:function(){b.clearError();b.input().val(),b.reconfirm().val();return"onRegister"!==b.options.event||b.validatePasswordInput()?"onEdit"!==b.options.event||b.validatePasswordEdit()?b.options.reconfirmPassword&&!b.validatePasswordConfirm()?!1:!0:!1:!1},validatePasswordInput:function(){var c=b.input().val();
if(a.isEmpty(c))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1;if(b.options.min>0&&c.length<b.options.min)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR",b.options.min)),!1;if(b.options.max>0&&c.length>b.options.max)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR",b.options.max)),!1;if(b.options.minInteger>0){var d=c.match(/[0-9]/g);if(!d||d.length<b.options.minInteger)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_INTEGER",b.options.minInteger)),!1
}if(b.options.minSymbol>0){var d=c.match(/[\W]/g);if(!d||d.length<b.options.minSymbol)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_SYMBOLS",b.options.minSymbol)),!1}if(b.options.minUpperCase>0){var d=c.match(/[A-Z]/g);if(!d||d.length<b.options.minUpperCase)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_UPPERCASE",b.options.minUpperCase)),!1}return!0},validatePasswordEdit:function(){var c=b.original().val(),d=b.input().val();return a.isEmpty(d)&&a.isEmpty(c)?!0:a.isEmpty(c)&&b.options.requireOriginal?(b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD")),!1):b.validatePasswordInput()
},validatePasswordConfirm:function(){var c=b.input().val(),d=b.reconfirm().val();if(!a.isEmpty(c)||!a.isEmpty(d)){if(a.isEmpty(c))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1;if(a.isEmpty(d))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD")),!1;if(c!==d)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING")),!1}return!0},initPasswordStrength:function(){b.input().password_strength({container:b.strength.selector,minLength:b.options.min,texts:{1:a.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK"),2:a.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK"),3:a.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL"),4:a.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG"),5:a.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG")},onCheck:function(a){1>=a&&b.strength().removeClass("text-warning").removeClass("text-success").addClass("text-error small help-inline"),a>1&&3>=a&&b.strength().removeClass("text-error").removeClass("text-success").addClass("text-warning small help-inline"),a>=4&&b.strength().removeClass("text-error").removeClass("text-warning").addClass("text-success small help-inline")
}})},raiseError:function(a){b.options.triggerError?b.trigger("error",[a]):(b.warning().show(),b.warning().text(a))},clearError:function(){b.options.triggerError?b.trigger("clear"):(b.warning().hide(),b.warning().text(""))},"{pwResetSubmitButton} click":function(){return b.validatePassword()},"{self} onSubmit":function(a,c,d,e){"onRegisterMini"!==e&&d.push(b.validatePassword())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_password/registermini_content",function(a){var b=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT","PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_INTEGER","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_SYMBOLS","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_UPPERCASE","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING").done(function(){EasySocial.Controller("Field.Joomla_password.Mini",{defaultOptions:{required:!1,reconfirmPassword:!1,min:4,max:0,"{input}":"[data-password]","{reconfirm}":"[data-field-password-confirm]","{reconfirmNotice}":"[data-reconfirmPassword-failed]"}},function(b){return{init:function(){},"{input} keyup":function(){b.checkPassword()
},"{reconfirm} keyup":function(){b.validatePassword()},"{reconfirm} blur":function(){b.validatePassword()},checkPassword:function(){b.clearError();var c=b.input().val();if(b.options.required&&0==c.length)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1;if(b.options.min>0&&c.length<b.options.min)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT")),!1;if(b.options.max>0&&c.length>b.options.max)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG")),!1;
if(b.options.minInteger>0){var d=c.match(/[0-9]/g);if(!d||d.length<b.options.minInteger)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_INTEGER",b.options.minInteger)),!1}if(b.options.minSymbol>0){var d=c.match(/[\W]/g);if(!d||d.length<b.options.minSymbol)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_SYMBOLS",b.options.minSymbol)),!1}if(b.options.minUpperCase>0){var d=c.match(/[A-Z]/g);if(!d||d.length<b.options.minUpperCase)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_UPPERCASE",b.options.minUpperCase)),!1
}return!0},validatePassword:function(){b.clearError();b.input().val(),b.reconfirm().val();return b.options.reconfirmPassword&&!b.validatePasswordConfirm()?!1:!0},validatePasswordConfirm:function(){var c=b.input().val(),d=b.reconfirm().val();if(!a.isEmpty(c)||!a.isEmpty(d)){if(a.isEmpty(c))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1;if(a.isEmpty(d))return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD")),!1;if(c!==d)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING")),!1
}return!0},"{self} onSubmit":function(a,c,d,e){"onRegisterMini"===e&&d.push(b.checkPassword())},clearError:function(){b.trigger("clear")},raiseError:function(a){b.trigger("error",[a])}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_password/sample_content",function(){var b=this;EasySocial.Controller("Field.Joomla_password.Sample",{defaultOptions:{"{confirmPassword}":"[data-password-confirm]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"reconfirm_password":a.confirmPassword().toggle(e)
}}}}),b.resolve()}),EasySocial.module("apps/fields/user/joomla_timezone/content",function(){var b=this;EasySocial.require().library("chosen").language("PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE").done(function(a){EasySocial.Controller("Field.Joomla_timezone",{defaultOptions:{required:!1,"{field}":"[data-field-joomla_timezone]","{input}":"[data-field-joomla_timezone-input]"}},function(b){return{init:function(){b.input().chosen({allow_single_deselect:!0,search_contains:!0})},validateInput:function(){if(!b.options.required)return!0;
b.clearError();var c=b.input().val();return"null"===c||a.isEmpty(c)?(b.raiseError(),!1):!0},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE")])},clearError:function(){b.trigger("clear")},"{input} change":function(){b.validateInput()},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_username/content",function(a){var b=this;EasySocial.Controller("Field.Joomla_username",{defaultOptions:{event:null,id:null,userid:null,"{checkUsernameButton}":"[data-username-check]","{input}":"[data-username-input]","{available}":"[data-username-available]"}},function(b){return{state:!1,init:function(){},"{checkUsernameButton} click":function(){b.delayedCheck()
},"{input} keyup":function(){b.delayedCheck()},delayedCheck:a.debounce(function(){b.checkUsername()},250),checkUsername:function(){b.clearError();var c=a.Deferred();b.checkUsernameButton().addClass("btn-loading");var d=b.input().val();return EasySocial.ajax("fields/user/joomla_username/isValid",{id:b.options.id,userid:b.options.userid,username:d,event:b.options.event}).done(function(){b.checkUsernameButton().removeClass("btn-loading"),b.available().show(),c.resolve()}).fail(function(a){b.raiseError(a),b.checkUsernameButton().removeClass("btn-loading"),b.available().hide(),c.reject()
}),c},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d,e){"onRegisterMini"!==e&&d.push(b.checkUsername())}}}),b.resolve()}),EasySocial.module("apps/fields/user/joomla_username/registermini_content",function(a){var b=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_USERNAME_CHECKING","PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME").done(function(){EasySocial.Controller("Field.Joomla_username.Mini",{defaultOptions:{id:null,required:!1,"{input}":"#joomla_username"}},function(b){return{init:function(){},"{input} keyup":function(a){a.val().length>0&&b.delayedCheck()
},state:!1,delayedCheck:a.debounce(function(){b.checkUsername()},250),checkUsername:function(){var c=b.input().val();if(b.options.required&&0==c.length)return b.raiseError(a.language("PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME")),!1;if(c.length>0){var d=a.Deferred();return b.clearError(),b.setLoading(a.language("PLG_FIELDS_JOOMLA_USERNAME_CHECKING")),EasySocial.ajax("fields/user/joomla_username/isValid",{id:b.options.id,userid:0,username:c}).done(function(){b.setLoaded(),d.resolve()}).fail(function(a){b.setLoaded(),b.raiseError(a),d.reject()
}),d}return!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d,e){"onRegisterMini"===e&&(b.options.required||b.input().val().length>0)&&d.push(b.checkUsername())},setLoading:function(a){b.trigger("loading",[a])},setLoaded:function(){b.trigger("loaded")}}}),b.resolve()})}),EasySocial.module("apps/fields/user/joomla_username/sample_content",function(){var b=this;EasySocial.Controller("Field.Joomla_username.Sample",{defaultOptions:{"{checkUsername}":"[data-check-username]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"check_username":a.checkUsername().toggle(!!e)
}}}}),b.resolve()}),EasySocial.module("apps/fields/user/multidropdown/content",function(a){var b=this;EasySocial.require().library("ui/sortable").language("PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD").done(function(){EasySocial.Controller("Field.Multidropdown",{defaultOptions:{required:!1,id:null,inputName:"",max:0,"{field}":"[data-field-multidropdown]","{list}":"[data-field-multidropdown-list]","{item}":"[data-field-multidropdown-item]","{input}":"[data-field-multidropdown-input]","{add}":"[data-field-multidropdown-add]","{delete}":"[data-field-multidropdown-delete]","{move}":"[data-field-multidropdown-move]"}},function(b){return{init:function(){b.options.max=b.field().data("max"),b.initSortable()
},initSortable:function(){b.list().sortable({items:b.item.selector,handle:b.move.selector})},"{add} click":function(a){if(b.options.max<1||b.item().length<b.options.max){var c=b.item().eq(0).clone();c.find(b.input.selector).attr("value","").val(""),b.list().append(c)}b.options.max>0&&b.item().length>=b.options.max&&a.hide()},"{delete} click":function(a){var c=a.parents(b.item.selector);b.item().length>1?c.remove():c.find(b.input.selector).val(""),b.options.max>0&&b.item().length<b.options.max&&b.add().show()
},"{self} onConfigChange":function(a,c,d,e){switch(d){case"add_button_text":b.add().text(e)}},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD")])},"{self} onSubmit":function(c,d,e){if(!b.options.required)return e.push(!0),void 0;var f=!1;a.each(b.input(),function(b,c){return a.isEmpty(a(c).val())?void 0:(f=!0,!1)}),f||b.raiseError(),e.push(f)}}}),b.resolve()})}),EasySocial.module("apps/fields/user/multilist/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE").done(function(a){EasySocial.Controller("Field.Multilist",{defaultOptions:{required:null,multiple:null,"{field}":"[data-field-multilist]","{item}":"[data-field-multilist-item]","{option}":"[data-field-multilist-item] option"}},function(b){return{init:function(){},validateInput:function(){return b.clearError(),b.options.multiple&&b.item().children(":selected").length<=0?(b.raiseError(),!1):""==b.item().children(":selected").val()?(b.raiseError(),!1):!0
},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE")])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){return b.options.required?(d.push(b.validateInput()),void 0):(d.push(!0),void 0)},"{self} onSample":function(){b.option().length<1&&b.item().append(a("<option></option>"))},"{self} onChoiceAdded":function(c,d,e){b.option().eq(e).length>0?b.option().eq(e).before(a("<option></option>")):b.item().append(a("<option></option>"))
},"{self} onChoiceValueChanged":function(a,c,d,e){b.option().eq(d).val(e)},"{self} onChoiceTitleChanged":function(a,c,d,e){b.option().eq(d).text(e)},"{self} onChoiceRemoved":function(a,c,d){b.option().eq(d).remove()},"{self} onChoiceToggleDefault":function(a,c,d,e){e?b.option().eq(d).attr("selected","selected"):b.option().eq(d).removeAttr("selected")}}}),b.resolve()})}),EasySocial.module("apps/fields/user/multitextbox/content",function(a){var b=this;EasySocial.require().library("ui/sortable").language("PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD").done(function(){EasySocial.Controller("Field.Multitextbox",{defaultOptions:{required:!1,id:null,inputName:"",max:0,"{field}":"[data-field-multitextbox]","{list}":"[data-field-multitextbox-list]","{item}":"[data-field-multitextbox-item]","{input}":"[data-field-multitextbox-input]","{add}":"[data-field-multitextbox-add]","{delete}":"[data-field-multitextbox-delete]","{move}":"[data-field-multitextbox-move]"}},function(b){return{init:function(){b.options.max=b.field().data("max"),b.initSortable()
},initSortable:function(){b.list().sortable({items:b.item.selector,handle:b.move.selector})},"{add} click":function(a){if(b.options.max<1||b.item().length<b.options.max){var c=b.item().eq(0).clone();c.find(b.input.selector).attr("value","").val(""),b.list().append(c)}b.options.max>0&&b.item().length>=b.options.max&&a.hide()},"{delete} click":function(a){var c=a.parents(b.item.selector);b.item().length>1?c.remove():c.find(b.input.selector).val(""),b.options.max>0&&b.item().length<b.options.max&&b.add().show()
},"{self} onConfigChange":function(a,c,d,e){switch(d){case"add_button_text":b.add().text(e)}},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD")])},"{self} onSubmit":function(c,d,e){if(!b.options.required)return e.push(!0),void 0;var f=!1;a.each(b.input(),function(b,c){return a.isEmpty(a(c).val())?void 0:(f=!0,!1)}),f||b.raiseError(),e.push(f)}}}),b.resolve()})}),EasySocial.module("apps/fields/user/permalink/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_PERMALINK_REQUIRED").done(function(a){EasySocial.Controller("Field.Permalink",{defaultOptions:{required:!1,max:0,id:null,userid:null,"{field}":"[data-field-permalink]","{checkButton}":"[data-permalink-check]","{input}":"[data-permalink-input]","{available}":"[data-permalink-available]"}},function(b){return{state:!1,init:function(){b.options.max=b.field().data("max")
},"{checkButton} click":function(){b.delayedCheck()},"{input} keyup":function(){b.delayedCheck()},delayedCheck:a.debounce(function(){b.checkPermalink()},250),checkPermalink:function(){b.clearError();var c=b.input().val();if(b.available().hide(),b.options.max>0&&c.length>b.options.max)return b.raiseError(a.language("PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH")),!1;if(!a.isEmpty(c)){b.checkButton().addClass("btn-loading");var d=a.Deferred();return EasySocial.ajax("fields/user/permalink/isValid",{id:b.options.id,userid:b.options.userid,permalink:c}).done(function(){b.checkButton().removeClass("btn-loading"),b.available().show(),d.resolve()
}).fail(function(a){b.raiseError(a),b.checkButton().removeClass("btn-loading"),b.available().hide(),d.reject()}),d}return b.options.required&&a.isEmpty(c)?(b.available().hide(),b.raiseError(a.language("PLG_FIELDS_PERMALINK_REQUIRED")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.checkPermalink())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/permalink/sample_content",function(){var b=this;EasySocial.Controller("Field.Permalink.Sample",{defaultOptions:{"{checkPermalink}":"[data-check-permalink]"}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"check_permalink":a.checkPermalink().toggle(!!e)
}}}}),b.resolve()}),EasySocial.module("apps/fields/user/relationship/content",function(){var b=this;EasySocial.require().script("site/friends/suggest").language("PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM","PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE","COM_EASYSOCIAL_CANCEL_BUTTON").done(function(a){EasySocial.Controller("Field.Relationship",{defaultOptions:{required:!1,id:null,types:null,fieldname:null,actor:null,target:null,"{field}":"[data-field-relationship]","{display}":"[data-relationship-display]","{form}":"[data-relationship-form]","{confirm}":"[data-relationship-display-confirm]","{pending}":"[data-relationship-display-pending]","{actions}":"[data-relationship-display-actions]","{pendingTitle}":"[data-relationship-pending-title]"}},function(a){return{init:function(){EasySocial.module("field.relationship/"+a.options.id).done(function(b){a.options.types=b
}),a.display().addController("EasySocial.Controller.Field.Relationship.Display",{controller:{parent:a}}),a.addPlugin("form")},"{self} relationshipDeleted":function(){a.confirm().hide(),a.form().show()}}}),EasySocial.Controller("Field.Relationship.Form",{defaultOptions:{origType:null,origTarget:null,origApproved:null,"{form}":"[data-relationship-form]","{type}":"[data-relationship-form-type]","{connectWord}":"[data-relationship-form-connectwords]","{connectWords}":"[data-relationship-form-connectwords] span","{input}":"[data-relationship-form-input]","{target}":"[data-relationship-form-target]","{targetAvatar}":"[data-relationship-form-target-avatar]","{targetName}":"[data-relationship-form-target-name]","{targetPending}":"[data-relationship-form-target-pending]","{targetDelete}":"[data-relationship-form-target-delete]","{textboxlistDelete}":"[data-textboxlist-itemRemoveButton]"}},function(a){return{init:function(){a.input().addController(EasySocial.Controller.Friends.Suggest,{max:1,name:a.parent.options.fieldname+"[target][]"}),a.options.origType=a.form().data("orig-type"),a.options.origTarget=a.form().data("orig-target"),a.options.origApproved=a.form().data("orig-approved")
},"{type} change":function(b){var c=b.val(),d=a.parent.options.types[c].connect,e=a.input().controller("Textboxlist").getAddedItems(),f=e.length>0,g=f?a.target():a.input(),h=f?e[0]:!1;d?(g.show(),f&&a.options.origApproved&&h.id==a.options.origTarget&&c==a.options.origType?a.targetPending().hide():a.targetPending().show()):g.hide(),a.connectWords().hide(),a.connectWords().filterBy("relationship-form-connectword",c).show()},"{input} addItem":function(b,c,d){d.avatar&&a.targetAvatar().attr("src",d.avatar),d.screenName&&a.targetName().text(d.screenName),d.id&&a.targetDelete().data("id",d.id),a.input().hide(),a.target().show(),a.options.origApproved&&d.id==a.options.origTarget&&a.type().val()==a.options.origType?a.targetPending().hide():a.targetPending().show()
},"{targetDelete} click":function(b){var d=b.data("id");a.input().controller("Textboxlist").removeItem(d),a.input().show(),a.target().hide()},"{parent} relationshipApproved":function(b,c,d){a.type().val(d.type);var e={avatar:d.avatar,html:d.name+'<input type="hidden" name="'+a.parent.options.fieldname+'[target][]" value="'+d.id+'"/>',id:d.id,key:d.name,menuHtml:void 0,name:a.parent.options.fieldname+"[target]",screenName:d.name,title:d.name};a.input().controller("Textboxlist").addItem(e),a.connectWords().hide(),a.connectWords().filterBy("relationshipFormConnectword",d.type)
}}}),EasySocial.Controller("Field.Relationship.Display",{defaultOptions:{id:null,"{pendingFrame}":"[data-relationship-display-pending-text]","{loadingFrame}":"[data-relationship-display-loading]","{errorFrame}":"[data-relationship-display-error]","{actionsFrame}":"[data-relationship-display-actions]","{deleteButton}":"[data-relationship-display-actions-delete]","{approveButton}":"[data-relationship-display-actions-approve]","{rejectButton}":"[data-relationship-display-actions-reject]"}},function(b){return{init:function(){b.options.id=b.element.data("id")
},"{deleteButton} click":function(){b.parent.trigger("relationshipDeleted"),b.element.hide()},"{approveButton} click":function(){EasySocial.dialog({width:500,content:a.language("PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM"),selectors:{"{approveButton}":"[data-approve-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{approveButton} click":function(){this.parent.close(),b.approveRelationship()},"{cancelButton} click":function(){this.parent.close()}},buttons:'<button data-cancel-button type="button" class="btn btn-es">'+a.language("COM_EASYSOCIAL_CANCEL_BUTTON")+'</button><button data-approve-button type="button" class="btn btn-es-primary">'+a.language("PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE")+"</button>"})
},approveRelationship:function(){b.actionsFrame().hide(),b.loadingFrame().show(),EasySocial.ajax("fields/user/relationship/approve",{id:b.parent.options.id,relid:b.options.id}).done(function(a){b.parent.display().hide(),b.element.show(),b.element.removeAttr("data-relationship-display-pending"),b.element.attr("data-relationship-display-confirm",""),b.parent.form().before(b.element),b.parent.form().hide(),b.parent.pending().length<1&&b.parent.pendingTitle().hide(),b.loadingFrame().remove(),b.pendingFrame().remove(),b.approveButton().remove(),b.rejectButton().remove(),b.actionsFrame().show(),b.deleteButton().show(),b.parent.trigger("relationshipApproved",[a])
}).fail(function(a){b.loadingFrame().hide(),b.errorFrame().show().find("span").text(a)})},"{rejectButton} click":function(){b.actionsFrame().hide(),b.loadingFrame().show(),EasySocial.ajax("fields/user/relationship/reject",{id:b.parent.options.id,relid:b.options.id}).done(function(){b.element.remove(),b.parent.pending().length<1&&b.parent.pendingTitle().hide()}).fail(function(a){b.parent.trigger("relationshipActionError",[a])})}}}),b.resolve()})}),EasySocial.module("site/friends/suggest",function(){var b=this;
EasySocial.require().view("site/friends/suggest.item").library("textboxlist").language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT").done(function(a){EasySocial.Controller("Friends.Suggest.User",{defaultOptions:{"{addButton}":"[data-friend-suggest-add]","{button}":"[data-friend-suggest-button]"}},function(b,c){return{init:function(){c.uid=b.element.data("uid")},"{addButton} click":function(){EasySocial.ajax("site/controllers/friends/request",{id:c.uid}).done(function(){b.button().html(a.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT"))
}).fail(function(a){EasySocial.dialog({width:450,height:180,content:a.message})})}}}),EasySocial.Controller("Friends.Suggest",{defaultOptions:{max:null,exclusive:!0,exclusion:[],minLength:1,highlight:!0,name:"uid[]",type:"",friendList:!1,friendListName:"",includeSelf:!1,showNonFriend:!1,view:{suggestItem:"site/friends/suggest.item"}}},function(b,c){return{init:function(){b.element.textboxlist({component:"es",name:c.name,max:c.max,plugin:{autocomplete:{exclusive:c.exclusive,minLength:c.minLength,highlight:c.highlight,showLoadingHint:!0,showEmptyHint:!0,query:function(a){var b={search:a,type:c.type,showNonFriend:c.showNonFriend};
return c.includeSelf&&(b.includeme=!0),c.friendList?EasySocial.ajax("site/controllers/friends/suggestWithList",{search:a,inputName:c.name,friendListName:c.friendListName,showNonFriend:c.showNonFriend}):EasySocial.ajax("site/controllers/friends/suggest",b)}}}}).textboxlist("enable")},"{self} filterItem":function(a,d,e){if(!c.friendList){var f=b.view.suggestItem(!0,{item:e,name:b.options.name});return e.title=e.screenName,e.menuHtml=f,e.html=f,e}},"{self} filterMenu":function(d,e,f,g,h,i){if(!c.friendList){var j=i.getAddedItems(),k=a.pluck(j,"id"),k=k.concat(b.options.exclusion);
g.each(function(){var b=a(this),c=b.data("item");b.toggleClass("hidden",a.inArray(c.id.toString(),k)>-1)})}}}}),b.resolve()})}),EasySocial.module("apps/fields/user/separator/sample",function(a){var b=this;EasySocial.Controller("Field.Separator.Sample",{defaultOptions:{"{items}":"[data-separator-type]"}},function(b){return{"{self} onConfigChange":function(c,d,e,f){if("type"==e){var g=a("[data-separator-"+f+"]");b.items().hide(),g.show()}}}}),b.resolve()}),EasySocial.module("apps/fields/user/terms/content",function(){var b=this;
EasySocial.require().language("PLG_FIELDS_TERMS_VALIDATION_REQUIRED").done(function(a){EasySocial.Controller("Field.Terms",{defaultOptions:{event:null,required:!1,"{textbox}":"[data-field-terms-textbox]","{checkbox}":"[data-field-terms-checkbox]"}},function(b){return{init:function(){},validateInput:function(){return b.clearError(),"onAdminEdit"==b.options.event?!0:b.options.required&&!b.checkbox().is(":checked")?(b.raiseError(),!1):!0},"{checkbox} change":function(){b.validateInput()},raiseError:function(){b.trigger("error",[a.language("PLG_FIELDS_TERMS_VALIDATION_REQUIRED")])
},clearError:function(){b.trigger("clear")},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())},"{self} onConfigChange":function(a,c,d,e){switch(d){case"message":b.textbox().val(e)}}}}),b.resolve()})}),EasySocial.module("apps/fields/user/textarea/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG").done(function(a){EasySocial.Controller("Field.Textarea",{defaultOptions:{required:!1,min:0,max:0,"{field}":"[data-field-textarea]","{input}":"[data-field-textarea-input]"}},function(b){return{init:function(){b.options.min=b.field().data("min"),b.options.max=b.field().data("max")
},validateInput:function(){b.clearError();var c=b.input().val();return b.options.required&&a.isEmpty(c)?(b.raiseError(a.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED")),!1):!a.isEmpty(c)&&b.options.min>0&&c.length<b.options.min?(b.raiseError(a.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT")),!1):b.options.max>0&&c.length>b.options.max?(b.raiseError(a.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")
},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())},"{self} onError":function(c,d,e){"required"===e&&b.raiseError(a.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED"))},"{input} keyup":function(){b.validateInput()},"{self} onConfigChange":function(a,c,d,e){switch(d){case"default":b.input().val(e);break;case"placeholder":b.input().attr("placeholder",e);break;case"readonly":e?b.input().attr("readonly","readonly"):b.input().removeAttr("readonly")}}}}),b.resolve()})}),EasySocial.module("apps/fields/user/textbox/content",function(){var b=this;
EasySocial.require().language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT").done(function(a){EasySocial.Controller("Field.Textbox",{defaultOptions:{required:!1,min:0,max:0,"{field}":"[data-field-textbox]","{input}":"[data-field-textbox-input]","{notice}":"[data-check-notice]"}},function(b){return{init:function(){b.options.min=b.field().data("min"),b.options.max=b.field().data("max")
},"{input} keyup":function(){b.validateInput()},"{input} blur":function(){b.validateInput()},validateInput:function(){b.clearError();var c=b.input().val();return b.options.required&&a.isEmpty(c)?(b.raiseError(a.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED")),!1):!a.isEmpty(c)&&b.options.min>0&&c.length<b.options.min?(b.raiseError(a.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT")),!1):b.options.max>0&&c.length>b.options.max?(b.raiseError(a.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG")),!1):!0
},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onError":function(c,d,e){"required"===e&&b.raiseError(a.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED")),"validate"===e&&b.raiseError(a.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT"))},"{self} onSubmit":function(a,c,d){d.push(b.validateInput())}}}),b.resolve()})}),EasySocial.module("apps/fields/user/textbox/sample_content",function(){var b=this;EasySocial.Controller("Field.Textbox.Sample",{defaultOptions:{"{input}":"[data-input]",min:"",max:"",regex_validate:!1,regex_format:"",regex_modifier:""}},function(a){return{init:function(){},"{self} onConfigChange":function(b,c,d,e){switch(d){case"placeholder":a.input().attr("placeholder",e);
break;case"default":a.input().val(e);break;case"readonly":e?a.input().attr("disabled","disabled"):a.input().removeAttr("disabled")}}}}),b.resolve()}),EasySocial.module("apps/fields/user/url/content",function(){var b=this;EasySocial.require().language("PLG_FIELDS_URL_VALIDATION_EMPTY_URL").done(function(a){EasySocial.Controller("Field.Url",{defaultOptions:{required:!1,"{input}":"[data-field-url-input]"}},function(b){return{init:function(){},"{input} blur":function(){b.validateInput()},validateInput:function(){b.clearError();
var c=b.input().val();return b.options.required&&a.isEmpty(c)?(b.raiseError(a.language("PLG_FIELDS_URL_VALIDATION_EMPTY_URL")),!1):!0},raiseError:function(a){b.trigger("error",[a])},clearError:function(){b.trigger("clear")},"{self} onError":function(){b.raiseError(a.language("PLG_FIELDS_URL_VALIDATION_EMPTY_URL"))}}}),b.resolve()})}),EasySocial.module("apps/fields/user/url/sample_content",function(){var b=this;EasySocial.Controller("Field.Url.Sample",{defaultOptions:{"{urlInput}":"[data-url-input]"}},function(a){return{"{self} onConfigChange":function(b,c,d,e){switch(d){case"placeholder":a.urlInput().attr("placeholder",e);
break;case"default":a.urlInput().val(e)}}}}),b.resolve()}),EasySocial.module("apps/group/feeds",function(a){var b=this;EasySocial.Controller("Groups.Apps.Feeds",{defaultOptions:{"{browser}":"[data-feeds-browser]","{sources}":"[data-feeds-sources]","{item}":"[data-feeds-list-item]","{create}":"[data-feeds-create]","{list}":"[data-feeds-list]","{remove}":"[data-feeds-remove]"}},function(b){return{init:function(){b.options.id=b.element.data("groupid"),b.options.appId=b.element.data("appid"),b.list().implement(EasySocial.Controller.Groups.Apps.Feeds.List)
},"{remove} click":function(c){var d=a(c).data("id"),e=b.item.of(c);EasySocial.dialog({content:EasySocial.ajax("apps/group/feeds/controllers/feeds/confirmDelete",{groupId:b.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/feeds/controllers/feeds/delete",{appId:b.options.appId,feedId:d,groupId:b.options.id}).done(function(){e.remove(),0==b.sources().children().length&&b.browser().addClass("is-empty"),EasySocial.dialog().close()})}}})},"{create} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/feeds/controllers/feeds/create",{id:b.options.id}),bindings:{"{saveButton} click":function(){var c=this.title().val(),d=this.url().val(),e=a("[data-feeds-form-notice]");
return e.removeClass("alert alert-error"),e.addClass("hide"),0==c.trim().length?(e.text(a.language("Please enter title.")),e.addClass("alert alert-error"),e.removeClass("hide"),void 0):0==d.trim().length?(e.text(a.language("Please enter URL.")),e.addClass("alert alert-error"),e.removeClass("hide"),void 0):(EasySocial.ajax("apps/group/feeds/controllers/feeds/save",{title:this.title().val(),url:this.url().val(),appId:b.options.appId,groupId:b.options.id}).done(function(a){b.browser().removeClass("is-empty"),b.sources().append(a),EasySocial.dialog().close()
}),void 0)}}})}}}),EasySocial.Controller("Groups.Apps.Feeds.List",{defaultOptions:{"{item}":"[data-feed-item]","{openPreview}":"[data-feed-open]","{preview}":"[data-feed-preview]"}},function(a){return{init:function(){},"{openPreview} click":function(b){var c=a.item.of(b),d=c.find(a.preview.selector);d.hasClass("hide")?(a.preview().addClass("hide"),d.removeClass("hide")):d.addClass("hide")}}}),b.resolve()}),EasySocial.module("apps/group/tasks",function(a){var b=this;EasySocial.Controller("Groups.Apps.Tasks.Milestones.Browse",{defaultOptions:{"{milestone}":"[data-group-tasks-milestone-item]"}},function(a){return{init:function(){a.options.groupId=a.element.data("groupid"),a.milestone().implement(EasySocial.Controller.Groups.Apps.Tasks.Milestones.Item,{"{parent}":a})
}}}),EasySocial.Controller("Groups.Apps.Tasks.Milestones.Item",{defaultOptions:{"{complete}":"[data-milestone-mark-complete]","{uncomplete}":"[data-milestone-mark-uncomplete]","{delete}":"[data-milestone-delete]","{milestone}":"[data-group-tasks-milestone-item]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},"{uncomplete} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/unresolve",{id:a.options.id,groupId:a.parent.options.groupId}).done(function(){a.element.removeClass("is-due").removeClass("is-completed")
})},"{complete} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/resolve",{id:a.options.id,groupId:a.parent.options.groupId}).done(function(){a.element.removeClass("is-due").addClass("is-completed")})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/tasks/controllers/milestone/confirmDelete",{id:a.options.id,groupId:a.parent.options.groupId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/delete",{id:a.options.id,groupId:a.parent.options.groupId}).done(function(){EasySocial.dialog().close(),a.element.remove()
})}}})}}}),EasySocial.Controller("Groups.Apps.Tasks",{defaultOptions:{"{form}":"[data-group-tasks-form]","{formWrapper}":"[data-group-tasks-form-wrapper]","{taskList}":"[data-group-tasks-list]","{item}":"[data-group-tasks-list-item]","{completedList}":"[data-group-tasks-completed]","{openCounter}":"[data-tasks-open-counter]","{closedCounter}":"[data-tasks-closed-counter]","{completeMilestone}":"[data-milestone-mark-complete]","{uncompleteMilestone}":"[data-milestone-mark-uncomplete]","{deleteMilestone}":"[data-milestone-delete]","{wrapper}":"[data-group-tasks-wrapper]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.groupId=b.element.data("groupid"),b.options.milestoneId=b.element.data("milestoneid"),b.form().implement(EasySocial.Controller.Groups.Apps.Tasks.Form,{"{parent}":b}),b.implementItemController()
},implementItemController:function(){b.item().implement(EasySocial.Controller.Groups.Apps.Tasks.Item,{"{parent}":b})},updateOpenCounter:function(a){b.openCounter().html(a)},updateClosedCounter:function(a){b.closedCounter().html(a)},insertCompleted:function(c){a(c).appendTo(b.completedList())},insertTask:function(a){b.formWrapper().after(a),b.implementItemController()},"{uncompleteMilestone} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/unresolve",{id:b.options.milestoneId,groupId:b.options.groupId}).done(function(){b.wrapper().removeClass("is-due").removeClass("is-completed")
})},"{completeMilestone} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/resolve",{id:b.options.milestoneId,groupId:b.options.groupId}).done(function(){b.wrapper().removeClass("is-due").addClass("is-completed")})},"{deleteMilestone} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/tasks/controllers/milestone/confirmDelete",{id:b.options.milestoneId,groupId:b.options.groupId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/delete",{id:b.options.id,groupId:b.options.groupId}).done(function(){EasySocial.dialog().close(),window.location=b.options.redirect
})}}})}}}),EasySocial.Controller("Groups.Apps.Tasks.Item",{defaultOptions:{"{checkbox}":"[data-item-checkbox]","{delete}":"[data-tasks-item-remove]"}},function(b){return{init:function(){b.options.id=b.element.data("id")},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/tasks/controllers/tasks/confirmDelete",{groupId:b.parent.options.groupId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/tasks/controllers/tasks/delete",{id:b.options.id,groupId:b.parent.options.groupId}).done(function(){EasySocial.dialog().close();
var a=parseInt(b.parent.openCounter().html());b.parent.updateOpenCounter(a-1),b.element.remove()})}}})},"{checkbox} change":function(c){var e=a(c).is(":checked");e?EasySocial.ajax("apps/group/tasks/controllers/tasks/resolve",{id:b.options.id,groupId:b.parent.options.groupId}).done(function(){var a=parseInt(b.parent.openCounter().html());b.parent.updateOpenCounter(a-1);var a=parseInt(b.parent.closedCounter().html());b.parent.updateClosedCounter(a+1),b.parent.insertCompleted(b.element)}):EasySocial.ajax("apps/group/tasks/controllers/tasks/unresolve",{id:b.options.id,groupId:b.parent.options.groupId}).done(function(){var c=parseInt(b.parent.openCounter().html());
b.parent.updateOpenCounter(c+1);var c=parseInt(b.parent.closedCounter().html());b.parent.updateClosedCounter(c-1),b.parent.insertTask(b.element)})}}}),EasySocial.Controller("Groups.Apps.Tasks.Form",{defaultOptions:{"{title}":"[data-form-tasks-title]","{create}":"[data-form-tasks-create]","{assignee}":"[data-form-tasks-assignee]","{due}":"[data-form-tasks-due]","{error}":"[data-group-tasks-form-error]"}},function(a){return{init:function(){},resetForm:function(){a.element[0].reset()},"{title} keyup":function(b,c){13==c.keyCode&&a.create().click()
},"{create} click":function(){return""==a.title().val()?(a.error().removeClass("hide"),!1):(a.error().addClass("hide"),EasySocial.ajax("apps/group/tasks/controllers/tasks/save",{title:a.title().val(),assignee:a.assignee().val(),due:a.due().val(),groupId:a.parent.options.groupId,milestoneId:a.parent.options.id}).done(function(b){a.resetForm();var c=parseInt(a.parent.openCounter().html());a.parent.updateOpenCounter(c+1),a.parent.insertTask(b)}),void 0)}}}),b.resolve()}),EasySocial.module("avatar",function(){var b=this;
EasySocial.require().script("utilities/webcam").done(function(a){EasySocial.Controller("Avatar",{defaultOptions:{uid:null,type:null,redirectUrl:null,"{menu}":"[data-avatar-menu]","{takePictureButton}":"[data-avatar-webcam]","{uploadButton}":"[data-avatar-upload-button]","{selectButton}":"[data-avatar-select-button]","{removeButton}":"[data-avatar-remove-button]"}},function(b){return{init:function(){b.hasFlash()},"{uploadButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/avatar/upload",{uid:b.options.uid,type:b.options.type})})
},hasFlash:function(){var a=!1;try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b&&(a=!0)}catch(c){navigator.mimeTypes&&void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(a=!0)}return a},hideWebcamCanvas:function(){a("[data-canvas-webcam]").css("position","absolute").css("left","-9999px")},showWebcamCanvas:function(){a("[data-canvas-webcam]").css("position","relative").css("left","0")},webcamStarted:!1,"{takePictureButton} click":function(){var e,c=0,d=null,f=[],g=document.createElement("canvas");
g.setAttribute("width",320),g.setAttribute("height",240),d=g.getContext("2d"),f=d.getImageData(0,0,320,240),e=function(e){for(var h=e.split(";"),i=f,j=0;320>j;j++){var k=parseInt(h[j]);i.data[c+0]=k>>16&255,i.data[c+1]=k>>8&255,i.data[c+2]=255&k,i.data[c+3]=255,c+=4}c>=307200&&(d.putImageData(i,0,0),EasySocial.ajax("site/views/profile/saveCamPicture",{type:"data",image:g.toDataURL("image/png")}).done(function(c){var d=c.url,e=new Image;preview=a("[data-photo-camera-preview]"),preview.removeClass("hidden"),a(e).attr("src",d).appendTo(preview),a("[data-save-button]").removeClass("hidden"),b.hideWebcamCanvas(),a("[data-capture-button]").addClass("hidden"),a("[data-recapture-button]").removeClass("hidden"),a("[data-photo-filename]").val(c.file)
}),c=0)},b.webcamStarted||EasySocial.dialog({content:EasySocial.ajax("site/views/profile/takePicture",{}),afterHide:function(){b.webcamStarted=!1},bindings:{init:function(){a("[data-canvas-webcam]").webcam({onSave:e,onCapture:function(){webcam.save()},debug:function(a,c){return"notify"==a&&"Camera stopped"==c?(b.webcamStarted=!1,EasySocial.dialog().close(),void 0):void 0}}),b.webcamStarted=!0},"{captureButton} click":function(){webcam.capture()},"{recaptureButton} click":function(){a("[data-capture-button]").removeClass("hidden"),a("[data-recapture-button]").addClass("hidden"),a("[data-save-button]").addClass("hidden"),b.showWebcamCanvas(),preview.find("img").remove(),preview.addClass("hidden")
},"{saveButton} click":function(){file=a("[data-photo-filename]").val(),uid=a("[data-photo-uid]").val(),EasySocial.ajax("site/controllers/photos/createAvatarFromWebcam",{uid:uid,type:"user",file:file}).done(function(){EasySocial.dialog().close(),location.reload()})}}})},"{selectButton} click":function(){EasySocial.photos.selectPhoto({uid:b.options.uid,type:b.options.type,bindings:{"{self} photoSelected":function(a,c,d){var e=d[0];e&&EasySocial.photos.createAvatar(e.id,{uid:b.options.uid,type:b.options.type,redirectUrl:b.options.redirectUrl})
},"{cancelButton} click":function(){this.parent.close()}}})},"{menu} shown.bs.dropdown":function(){b.element.addClass("show-all")},"{menu} hidden.bs.dropdown":function(){b.element.removeClass("show-all")},"{removeButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmRemoveAvatar")})}}}),b.resolve()})}),EasySocial.module("utilities/webcam",function(a){var b=this;!function(a){var b={extern:null,append:!0,width:320,height:240,mode:"callback",swffile:a.rootPath+"/media/com_easysocial/scripts/utilities/jscam.swf",quality:85,debug:function(){},onCapture:function(){},onTick:function(){},onSave:function(){},onLoad:function(){}};
window.webcam=b,a.fn.webcam=function(c){if("object"==typeof c)for(var d in b)void 0!==c[d]&&(b[d]=c[d]);var e='<object id="XwebcamXobjectX" type="application/x-shockwave-flash" data="'+b.swffile+'" width="'+b.width+'" height="'+b.height+'"><param name="movie" value="'+b.swffile+'" /><param name="FlashVars" value="mode='+b.mode+"&amp;quality="+b.quality+'" /><param name="allowScriptAccess" value="always" /></object>';null!==b.extern?a(b.extern)[b.append?"append":"html"](e):this[b.append?"append":"html"](e);var f=3;
(_register=function(){var a=document.getElementById("XwebcamXobjectX");a&&void 0!==a.capture?(b.capture=function(b){try{return a.capture(b)}catch(c){}},b.save=function(b){try{return a.save(b)}catch(c){}},b.setCamera=function(b){try{return a.setCamera(b)}catch(c){}},b.getCameraList=function(){try{return a.getCameraList()}catch(b){}},b.pauseCamera=function(){try{return a.pauseCamera()}catch(b){}},b.resumeCamera=function(){try{return a.resumeCamera()}catch(b){}},b.onLoad()):0==f?b.debug("error","Flash movie not yet registered!"):(f--,window.setTimeout(_register,1e3*(4-f)))
})()}}(a),b.resolve()}),EasySocial.module("cover",function(a){var b=this;EasySocial.require().library("image").done(function(){EasySocial.Controller("Cover",{defaultOptions:{uid:null,type:null,"{image}":"[data-cover-image]","{editButton}":"[data-cover-edit-button]","{doneButton}":"[data-cover-done-button]","{cancelButton}":"[data-cover-cancel-button]","{uploadButton}":"[data-cover-upload-button]","{selectButton}":"[data-cover-select-button]","{removeButton}":"[data-cover-remove-button]","{menu}":"[data-cover-menu]","{flyout}":".es-flyout-content"}},function(b,c,d){return{init:function(){b.setLayout(),b.element.hasClass("editing")&&b.enable()
},"{editButton} click":function(){b.enable(),b.reposition=!0,b.image().css("backgroundPosition",b.element.css("backgroundPosition"))},"{cancelButton} click":function(){b.disable()},reposition:!1,ready:!1,disabled:!0,toggle:function(){b[b.disabled?"enable":"disable"]()},enable:function(){b.setLayout(),b.disabled=!1,b.element.addClass("editing"),d.attr("data-es-photo-disabled",1)},disable:function(){b.reposition=!1,b.disabled=!0,b.element.removeClass("editing"),setTimeout(function(){d.attr("data-es-photo-disabled",0)
},1);var c=a.uri(window.location.href).deleteQueryParam("cover_id").toString();History.pushState({state:0},window.title,c)},imageLoaders:{},setLayout:function(){var c=b.image(),d=b.setLayout.image;if(d){var h=d.data("width"),i=d.data("height"),j=c.width(),k=c.height(),l=a.Image.resizeProportionate(h,i,j,k,"outer");b.availableWidth=j-l.width,b.availableHeight=k-l.height}else{var e=a.uri(c.css("backgroundImage")).extract(0);if(!e)return;{var f=b.imageLoaders;(f[e]||(f[e]=a.Image.get(e))).done(function(a){b.setLayout.image=a,b.setLayout()
})}}},setCover:function(c,d){b.element.addClass("loading"),a.Image.get(d).done(function(){b.image().data("photoId",c).css({backgroundImage:a.cssUrl(d),backgroundPosition:"50% 50%"}),b.x=.5,b.y=.5,b.enable()}).fail(function(){b.disable()}).always(function(){b.element.removeClass("loading")})},drawing:!1,moveCover:function(a,c,d){d||(d=b.image());var e=b.availableWidth,f=b.availableHeight,g=0==e?0:b.x+(a/e||0),h=0==f?0:b.y+(c/f||0);0>g&&(g=0),g>1&&(g=1),0>h&&(h=0),h>1&&(h=1),d.css("backgroundPosition",100*(b.x=g)+"% "+100*(b.y=h)+"% ")
},x:.5,y:.5,"{image} click":function(a,c){b.disabled||c.stopPropagation()},"{image} mousedown":function(c,e){if(!b.disabled&&!b.drawing){e.target===b.image()[0]&&e.preventDefault(),b.drawing=!0,d.addClass("active");var f=b.image(),g=b.image().css("backgroundPosition").split(" ");b.x=parseInt(g[0])/100,b.y=parseInt(g[1])/100;var h=e.pageX,i=e.pageY;a(document).on("mousemove.movingCover mouseup.movingCover",function(a){b.drawing&&b.moveCover(-1*(h-(h=a.pageX)),-1*(i-(i=a.pageY)),f)}).on("mouseup.movingCover",function(){a(document).off("mousemove.movingCover mouseup.movingCover"),d.removeClass("active"),b.drawing=!1
})}},"{image} touchstart":function(c,e){if(!b.disabled&&!b.drawing){b.drawing=!0,d.addClass("active");var f=b.image(),g=b.image().css("backgroundPosition").split(" ");b.x=parseInt(g[0])/100,b.y=parseInt(g[1])/100;var i=(e.originalEvent.targetTouches[0],e.pageX),j=e.pageY;a(document).on("touchmove.movingCover",function(a){if(b.drawing){var c=a.originalEvent.targetTouches[0];b.moveCover(-1*(i-(i=c.pageX)),-1*(j-(j=c.pageY)),f),a.preventDefault()}}).on("touchend.movingCover",function(){a(document).off("touchstart.movingCover touchend.movingCover"),d.removeClass("active"),b.drawing=!1
})}},save:function(){var c=b.image().data("photoId"),e=EasySocial.ajax("site/controllers/cover/create",{uid:b.options.uid,type:b.options.type,id:c,x:b.x,y:b.y,reposition:b.reposition?1:0}).done(function(e){d.attr("data-es-photo",c).css({backgroundImage:a.cssUrl(e.url),backgroundPosition:e.position}).removeClass("no-cover"),b.disable()});return e},"{doneButton} click":function(){b.save()},"{menu} shown.bs.dropdown":function(){b.element.addClass("show-all")},"{menu} hidden.bs.dropdown":function(){b.element.removeClass("show-all")
},"{selectButton} click":function(){d.attr("data-es-photo-disabled",1),EasySocial.photos.selectPhoto({uid:b.options.uid,type:b.options.type,bindings:{"{self} photoSelected":function(a,c,e){var f=e[0];f&&(b.setCover(f.id,f.sizes.large),this.parent.close(),d.attr("data-es-photo-disabled",0))},"{cancelButton} click":function(){this.parent.close(),d.attr("data-es-photo-disabled",0)}}})},"{uploadButton} click":function(){d.attr("data-es-photo-disabled",1),EasySocial.dialog({content:EasySocial.ajax("site/views/cover/uploadDialog",{uid:b.options.uid,type:b.options.type}),bindings:{"{self} upload":function(a,c,d){d.done(function(a){b.setCover(a.id,a.sizes.large.url)
})},"{cancelButton} click":function(){this.parent.close(),d.attr("data-es-photo-disabled",0)}}})},"{removeButton} click":function(){EasySocial.ajax("site/controllers/cover/remove",{uid:b.options.uid,type:b.options.type}).done(function(c){d.css({backgroundImage:a.cssUrl(c),backgroundPosition:"50% 50%"}).addClass("no-cover").removeAttr("data-es-photo"),b.disable()})},"{flyout} click":function(b,c){b.is(a(c.target))&&c.stopPropagation()}}}),b.resolve()})}),EasySocial.require().script("site/likes/likes","site/reports/reports","site/blocks/blocks","site/repost/repost","site/share/share","site/layout/dialog","site/layout/responsive","site/layout/elements","site/photos/photos","site/users/login","site/profile/popbox","site/privacy/privacy","site/locations/popbox","site/sidebar/sidebar","site/friends/api","site/popbox/popbox","site/conversations/api","site/groups/api","site/followers/api","site/stream/video","oauth/facebook").library("history").done(),EasySocial.module("site/likes/likes",function(a){var b=this;
a(document).on("click.es.likes.action","[data-likes-action]",function(){var b=a(this),c={id:b.data("id"),type:b.data("type"),group:b.data("group"),verb:b.data("verb"),streamid:b.data("streamid")},d=c.type+"-"+c.group+"-"+c.id;EasySocial.ajax("site/controllers/likes/toggle",c).done(function(e,f,g,h,i){b.text(f),id=b.data("streamid"),a("[data-likes-"+d+"]").html(e).toggleClass("hide",g).toggle(!g),c.uid=c.id,c.count=i,b.trigger("like"==h?"onLiked":"onUnliked",[c]),"like"==h&&""!=id&&(ids=a("[data-streams-wrapper]").data("excludeids"),newIds="",newIds=""!=ids&&void 0!=ids?ids+","+id:id,a("[data-streams-wrapper]").data("excludeids",newIds))
}).fail(function(a){console.log(a)})}).on("click.es.likes.others","[data-likes-others]",function(){var b=a(this),c=b.parents("[data-likes-content]"),d={uid:c.data("id"),type:c.data("type"),verb:c.data("verb"),group:c.data("group"),exclude:b.data("authors")};EasySocial.dialog({content:EasySocial.ajax("site/controllers/likes/showOthers",d)})}),b.resolve()}),EasySocial.module("site/reports/reports",function(a){a(document).on("click.es.reports.link","[data-reports-link]",function(){var b=a(this),c="url,extension,uid,type,object,title,description".split(","),d={};
a.each(c,function(a,c){d[c]=b.data(c)}),EasySocial.dialog({content:EasySocial.ajax("site/views/reports/confirmReport",{title:d.title,description:d.description}),selectors:{"{message}":"[data-reports-message]","{reportButton}":"[data-report-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{reportButton} click":function(){var a=this.message().val();EasySocial.dialog({content:EasySocial.ajax("site/controllers/reports/store",{url:d.url,extension:d.extension,uid:d.uid,type:d.type,title:d.object,message:a})})
},"{cancelButton} click":function(){EasySocial.dialog().close()}}})}),this.resolve()}),EasySocial.module("site/blocks/blocks",function(a){a(document).on("click.es.blocks.link","[data-blocks-link]",function(){var b=a(this).data("target");EasySocial.dialog({content:EasySocial.ajax("site/views/blocks/confirmBlock",{target:b}),selectors:{"{reason}":"[data-block-reason]","{blockButton}":"[data-block-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{blockButton} click":function(){var a=this.reason().val();
EasySocial.dialog({content:EasySocial.ajax("site/controllers/blocks/store",{target:b,reason:a})})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})}),a(document).on("click.es.unblock.link","[data-unblock-link]",function(){var b=a(this).data("target");EasySocial.dialog({content:EasySocial.ajax("site/views/blocks/confirmUnblock",{target:b}),selectors:{"{unblockButton}":"[data-unblock-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{unblockButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/controllers/blocks/unblock",{target:b}).done(function(){a("[data-blocked-user-"+b+"]").remove()
}),selectors:{"{cancelButton}":"[data-cancel-button]"},bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()}}})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})}),this.resolve()}),EasySocial.module("site/repost/repost",function(a){var b=this;EasySocial.require().view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").library("mentions").done(function(){a(document).on("click.es.repost.action","[data-repost-action]",function(){var b=a(this),c={id:b.data("id"),element:b.data("element"),group:b.data("group"),clusterId:b.data("clusterid"),clusterType:b.data("clustertype")},d=c.element+"-"+c.group+"-"+c.id;
EasySocial.dialog({content:EasySocial.ajax("site/views/repost/form",c),bindings:{init:function(){this.setMentionsLayout()},setMentionsLayout:function(){var b=this.textbox(),c=b.controller("mentions");if(c)return c.cloneLayout(),void 0;var d=this.header();b.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:a.View("easysocial/site/friends/suggest.hint.search"),emptyHint:a.View("easysocial/site/friends/suggest.hint.empty"),data:function(b){var c=a.Deferred();
return EasySocial.ajax("site/controllers/friends/suggest",{search:b}).done(function(b){a.isArray(b)||c.reject();var b=a.map(b,function(b){return b.title=b.screenName,b.type="user",b.menuHtml=a.View("easysocial/site/friends/suggest.item",!0,{item:b,name:"uid[]"}),b});c.resolve(b)}).fail(c.reject),c},use:function(a){return a.type+":"+a.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:a.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:a.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(b){var c=a.Deferred();
return EasySocial.ajax("site/controllers/hashtags/suggest",{search:b}).done(function(b){a.isArray(b)||c.reject();var b=a.map(b,function(b){return b.title="#"+b.title,b.type="hashtag",b.menuHtml=a.View("easysocial/site/hashtags/suggest.item",!0,{item:b,name:"uid[]"}),b});c.resolve(b)}).fail(c.reject),c}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:"left top",at:"left bottom",of:d,collision:"none"},size:{width:function(){return d.outerWidth(!0)
}}}}})},"{sendButton} click":function(){var f=this.parent,g=a.trim(this.repostContent().val());c.content=g;var h=this.textbox().mentions("controller").toArray();c.mentions=a.map(h,function(b){return"hashtag"===b.type&&a.isPlainObject(b.value)&&(b.value=b.value.title.slice(1)),JSON.stringify(b)}),f.loading(!0),EasySocial.ajax("site/controllers/repost/share",c).done(function(c,e,f,g){var c=a.buildHTML(c);actionContent=a("[data-repost-"+d+"]").toggleClass("hide",e).toggle(!e),actionContent.find("span.repost-counter").html(c),b.trigger("create",[g])
}).fail(function(a){f.clearMessage(),f.setMessage(a)}).always(function(){f.loading(!1),f.close()})}}})}),EasySocial.module("repost/authors",function(){this.resolve(function(a){var b=a.button.parents("[data-repost-content]");return data={id:b.data("id"),element:b.data("element")},{content:EasySocial.ajax("site/controllers/repost/getSharers",data),id:"fd",component:"es",type:"repost",position:"bottom-right"}})}),b.resolve()})}),EasySocial.module("site/share/share",function(a){a(document).on("click.es.share.button","[data-es-share-button]",function(){var b=a(this);
EasySocial.dialog({title:b.text(),width:500,content:EasySocial.ajax("site/views/sharing/shareDialog",{url:b.data("url"),title:b.data("title")})})}),this.resolve()}),EasySocial.module("site/layout/dialog",function(){var b=this;EasySocial.require().library("dialog").view("site/dialog/default").done(function(a){EasySocial.dialog=function(b){if(window.parentDialog)return window.parentDialog.update(b);if("string"==typeof b||a.isDeferred(b)){var c=arguments[1];b={content:b,afterShow:a.isFunction(c)?c:a.noop}}var d=a("[id=fd].es-dialog.global");
d.length<1&&(d=a(EasySocial.View("site/dialog/default")).addClass("global").appendTo("body"));var e={showOverlay:!1},b=a.extend(e,b),f=d.controller("Dialog");return f?f.update(b):f=d.addController("Dialog",b),f},b.resolve()})}),EasySocial.module("site/layout/responsive",function(a){var b=this;a(function(){a.responsive(".es-responsive",[{at:2500,switchTo:"extra-wide wide"},{at:1200,switchTo:"wide"},{at:960,switchTo:"wide w960"},{at:818,switchTo:"wide w960 w768"},{at:600,switchTo:"wide w960 w768 w600"},{at:560,switchTo:"wide w960 w768 w600 w480"},{at:480,switchTo:"wide w960 w768 w600 w480 w320"}]),a(document).on("responsive",a.debounce(function(){ESImageRefresh()
},500))}),b.resolve()}),EasySocial.module("site/layout/elements",function(a){function d(){try{return document.createEvent("TouchEvent"),!0}catch(a){return!1}}var b=this,c=!1;a(document).on("click.button.data-bs-api","[data-bs-toggle-value]",function(){var b=a(this),c=b.siblings("[data-bs-toggle-value]"),d=b.parents('[data-bs-toggle="radio-buttons"]');if(!d.hasClass("disabled")&&d.length>0){var e=a(this).data("bs-toggle-value");return b.addClass("active"),c.removeClass("active"),d.find("input[type=hidden]").val(e).trigger("change"),void 0
}});var e=0;window.onmousemove=function(){e++,f()};var f=a.debounce(function(){!c&&e>10?(c=!0,e=0,a(document).on("mouseover.tooltip.data-es-api","[data-es-provide=tooltip]",function(){a(this).tooltip({delay:{show:200,hide:100},animation:!1,template:'<div id="fd" class="es tooltip tooltip-es"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:"body"}).tooltip("show")})):e=0},500);d()||a(document).on("mouseover.tooltip.data-es-api","[data-es-provide=tooltip]",function(){a(this).tooltip({delay:{show:200,hide:100},animation:!1,template:'<div id="fd" class="es tooltip tooltip-es"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:"body"}).tooltip("show")
}),a(document).on("mouseover.popover.data-es-api","[data-es-provide=popover]",function(){a(this).popover({delay:{show:200,hide:100},animation:!1,trigger:"hover",container:"body"}).popover("show")});var g=function(a){return a%400?a%100?a%4?!1:!0:!1:!0};a(document).on("keyup","[data-date-form] [data-date-day]",function(){if(a.trim(a(this).val())){var b=parseInt(a(this).siblings("[data-date-year]").val()||a(this).siblings("[data-date-year]").data("dateDefault")),c=parseInt(a(this).siblings("[data-date-month]").val()||a(this).siblings("[data-date-month]").data("dateDefault")),d=parseInt(a(this).val()||a(this).data("dateDefault")),e=/1|3|5|7|8|10|12/.test(c)?31:30;
2==c&&(e=g(b)?29:28),1>d&&(d=1),d>e&&(d=e),a.isNumeric(d)?a(this).val(d):a(this).val("")}}),a(document).on("keyup","[data-date-form] [data-date-year]",function(){if(a.trim(a(this).val())){var b=parseInt(a(this).val());1>b&&(b=1),a.isNumeric(b)?a(this).val(b):a(this).val("")}}),b.resolve()}),EasySocial.module("site/photos/photos",function(a){var b=this;EasySocial.require().script("site/photos/popup","site/photos/dialog","site/photos/avatar").done(),EasySocial.Controller("Photos",{defaultOptions:{}},function(a){return{init:function(){EasySocial.photos=a,EasySocial.module("site/photos/popup").done(function(b){a.popup=a.addPlugin("popup",b)
}),EasySocial.module("site/photos/dialog").done(function(b){a.dialog=a.addPlugin("dialog",b)}),EasySocial.module("site/photos/avatar").done(function(b){a.avatar=a.addPlugin("avatar",b)})}}}),a(function(){a("body").addController("EasySocial.Controller.Photos")}),b.resolve()}),EasySocial.module("site/photos/popup",function(a){var b=this;a.fn.at=function(a){return this.find("[data-"+a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},EasySocial.require().view("site/photos/popup").done(function(){var c=EasySocial.Controller("Photos.Popup",{defaultOptions:{view:{popup:"site/photos/popup"},"{popup}":"[data-photo-popup]","{viewport}":"[data-popup-viewport]","{handle}":"[data-popup-handle]","{photoGroup}":"[data-es-photo-group]","{photo}":"[data-es-photo]","{photoHeader}":"[data-photo-popup] [data-photo-header]","{photoContent}":"[data-photo-popup] [data-photo-content]","{navButton}":".es-photo-nav-button","{closeButton}":"[data-popup-close-button]","{photoItem}":"[data-photo-popup] [data-photo-item]","{desTagItem}":"[data-photo-des-tag-item]"}},function(b,c,d,e){return{init:function(){e=a("body"),b.bodyOverflow={overflow:e.css("overflow"),overflowX:e.css("overflowX"),overflowY:e.css("overflowY")}
},setLayout:function(){var a=b.popup();if(a.is(":visible")){var c=b.viewport().find("img[data-photo-image]")[0];c&&ESImage(c),e.css({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"});var d=b.photoItem(),f=d.controller("EasySocial.Controller.Photos.Tags");f&&f.setLayout();var g=d.controller("EasySocial.Controller.Photos.Navigation"),h=d.controller("EasySocial.Controller.Photos.Tagger");g&&g[h&&!h.disabled||b.playlist.length<2?"disable":"enable"]()}else e.css(b.bodyOverflow)},"{desTagItem} mouseover":function(a){var d=b.photoItem().controller("EasySocial.Controller.Photos.Tags");
d&&d.getTagItem(a.data("photoDesTagId")).addClass("focus")},"{desTagItem} mouseout":function(a){var d=b.photoItem().controller("EasySocial.Controller.Photos.Tags");d&&d.getTagItem(a.data("photoDesTagId")).removeClass("focus")},"{window} resize":a.debounce(function(){b.setLayout()},250),"{self} responsive":function(){b.setLayout()},playlist:[],show:function(){var c,e=b.popup.node;e||(c=b.view.popup(),e=b.popup.node=c[0]),a.contains(d,e)||(c=a(e).addClass("is-loading").appendTo(d)),c.is(":visible")||(c.show(),a(window).trigger("resize.responsive"),c.trigger("show"))
},hide:function(){b.popup().hide().trigger("hide").detach(),e.css(b.bodyOverflow)},open:function(){var d,e,c=arguments,f=[];if(1===c.length&&(e=c[0],f=[e]),a.isArray(c[0]))f=c[0],e=c[1]||f[0];else if(2===c.length){var d,g=c[0],h=!0;a.isNumeric(g)&&(g="album",h=!1,d=c[0],e=c[1],f=[e]),"photo"==g&&(e=c[1],f=[e]),"album"==g&&EasySocial.ajax("site/controllers/albums/playlist",{albumId:d||c[1]}).done(function(c){b.playlist=a.map(c,function(a){return a.id}),h&&b.display(f[0]),b.setLayout()}).fail(function(){alert("Error. Could not get album playlist."),b.hide()
})}b.playlist=f,b.show(),b.display(e)},handles:{},display:function(c){if(c){var d=b.currentPhotoId;b.currentPhotoId=c;var e=b.handles[c];if(b.handle().detach(),!e){var f=b.popup();return f.addClass("is-loading"),EasySocial.ajax("site/views/photos/item",{id:c,browser:0,popup:1}).done(function(d){var e=a.buildHTML('<div class="es-popup-handle" data-popup-handle>'+d+"</div>");b.handles[c]=e,b.display(c)}).fail(function(){alert("There was a problem loading this photo."),b.display(d)}).always(function(){f.removeClass("is-loading")
}),void 0}b.popup().removeClass("is-loading"),b.viewport().empty().append(e),e instanceof a&&(b.handles[c]=e.filter("[data-popup-handle]")[0]),b.setLayout()}},current:function(){var c=b.currentPhotoId,d=b.playlist,e=a.indexOf(d,c);return 0>e&&(e=0),e},next:function(){var a=b.playlist;if(!(a.length<2)){var c=b.current()+1;c>a.length-1&&(c=0),b.display(a[c])}},prev:function(){var a=b.playlist;if(!(a.length<2)){var c=b.current()-1;0>c&&(c=a.length-1),b.display(a[c])}},"{self} click":function(a,c){c.target===b.popup()[0]&&b.hide()
},"{photo} click":function(c,d){if("1"!=c.attr("data-es-photo-disabled")){var e=a(d.target),f=e.parents().andSelf();if(!(e.filter("[data-es-photo]").length<1&&f.filter("[data-photo-menu], [data-cover-menu]").length>0)){var g=c.attr("data-es-photo"),h=b.photoGroup.of(c);if(!(h.length<0)){d.preventDefault();var i=(h.attr("data-es-photo-group")||"element").split(":"),j=i[0];switch(j){case"album":var k=i[1];b.open(k,g);break;case"photos":var l=i[1].split(",");b.open(l,g);break;case"element":var l=[];h.at("esPhoto").each(function(){l.push(a(this).attr("data-es-photo"))
}),b.open(l,g)}}}}},"{photoItem} directionmove":function(){b.playlist.length<2&&b.navButton().removeClass("active")},"{photoItem} directionstop":function(){},"{photoItem} photoNext":function(){b.next()},"{photoItem} photoPrev":function(){b.prev()},"{photoItem} photoDelete":function(c,d,e){b.playlist.length<2?b.hide():b.next(),b.playlist=a.without(b.playlist,e.id)},"{closeButton} click":function(){b.hide()}}});b.resolve(c)})}),EasySocial.module("site/photos/dialog",function(a){var b=this,c=EasySocial.Controller("Photos.Dialog",{defaultOptions:{}},function(b){return{init:function(){EasySocial.photos.selectPhoto=b.show
},show:function(b){var c=a.Deferred(),d=EasySocial.ajax("site/views/albums/dialog",{uid:b.uid,type:b.type}),e=EasySocial.require().script("albums/browser").done();EasySocial.dialog(a.extend({content:c},b)),a.when(e,d).done(function(){d.done(function(a){c.resolve(a)})})}}});b.resolve(c)}),EasySocial.module("site/photos/avatar",function(a){var b=this,c=EasySocial.Controller("Photos.Avatar",{defaultOptions:{}},function(b){return{init:function(){EasySocial.photos.createAvatar=b.crop},crop:function(b,c){if(void 0!=b){c||(c={});
var d={id:b};c.uid&&(d.uid=c.uid,delete c.uid),c.type&&(d.type=c.type,delete c.type),c.redirect&&(d.redirect=c.redirect,delete c.redirect),EasySocial.dialog(a.extend({content:EasySocial.ajax("site/views/avatar/crop",d)},c))}}}});b.resolve(c)}),EasySocial.module("site/users/login",function(){var b=this;EasySocial.require().library("dialog").script("site/dashboard/dashboard.guest.login").view("site/loading/small").done(function(){EasySocial.login=function(){EasySocial.ajax("site/views/login/form").done(function(a){EasySocial.dialog({content:a,afterShow:function(){this.element.find("[data-guest-login]").addController("EasySocial.Controller.Dashboard.Guest.Login")
}})})},b.resolve()})}),EasySocial.module("site/dashboard/dashboard.guest.login",function(){var b=this;EasySocial.require().script("field","validate").done(function(){EasySocial.Controller("Dashboard.Guest.Login",{defaultOptions:{"{fieldItem}":"[data-registermini-fields-item]","{submit}":"[data-registermini-submit]","{form}":"[data-registermini-form]"}},function(a){return{init:function(){a.fieldItem().addController("EasySocial.Controller.Field.Base",{userid:0,mode:"registermini"})},"{submit} click":function(b){b.enabled()&&(b.disabled(!0),a.form().validate({mode:"onRegisterMini"}).done(function(){b.enabled(!0),a.form().submit()
}).fail(function(){b.enabled(!0)}))}}}),b.resolve()})}),EasySocial.module("validate",function(a){var b=this;a.isController("EasySocial.Controller.Validator")||EasySocial.Controller("Validator",{defaultOptions:{mode:null,checks:["required","validate"],typeAttr:"data-check-type",formatAttr:"data-check-format",modifierAttr:"data-check-modifier",errorTrigger:"onError",submitTrigger:"onSubmit","{container}":"[data-check]","{notice}":"[data-check-notice]","{required}":"[data-check-required]","{validate}":"[data-check-validate]"}},function(b){return{vars:{},register:[],deferreds:[],errors:[],state:a.Deferred(),init:function(){},reset:function(){b.vars={},b.register=[],b.deferreds=[],b.errors=[],b.state=a.Deferred(),b.container().removeClass("error")
},start:function(){return b.reset(),a.each(b.container(),function(c,d){b.vars.container=d=a(d),d.trigger(b.options.submitTrigger,[b.register,b.options.mode]),a.each(b.getFields(),function(c,d){b.vars.field=d=a(d),a.each(b.options.checks,function(a,c){b.vars.check=c,b[c+"Check"]()})})}),a.each(b.register,function(c,d){if(a.isDeferred(d))b.deferreds.push(d);else if(a.isPlainObject(d))a.each(d,function(a,d){return d===!1?(b.errors.push(c),!0):void 0});else if(d===!1)return b.errors.push(c),!0}),b.errors.length>0?b.state.reject():b.deferreds.length>0?a.when.apply(null,b.deferreds).done(function(){b.state.resolve()
}).fail(function(){b.state.reject()}):b.state.resolve(),b.state},getFields:function(){return a.merge(b.vars.container.find(b.required.selector),b.vars.container.find(b.validate.selector))},requiredCheck:function(){if(b.vars.field.is(b.required.selector)){var c=b.vars.field.attr(b.options.typeAttr)||b.vars.field.attr("type")||"text";"text"===c&&""==a.trim(b.vars.field.val())&&b.raiseError(),"checkbox"===c&&b.vars.field.find('input[type="checkbox"]').filter(":checked").length<1&&b.raiseError()}},validateCheck:function(){if(void 0!==b.vars.field.attr(b.options.formatAttr)){var c=b.vars.field.val();
if(a.isEmpty(c))return;var d=b.vars.field.attr(b.options.formatAttr)||"",e=b.vars.field.attr(b.options.modifierAttr)||"",f=new RegExp(d,e);f.test(c)||b.raiseError()}},raiseError:function(){b.vars.container.addClass("has-error"),b.vars.container.trigger(b.options.errorTrigger,[b.vars.check,b.vars.field]),b.register.push(!1)}}}),a.fn.validate=function(a){var b=this;if(b.length>0){var c=this.addController("EasySocial.Controller.Validator",a);return c.start()}return!1},b.resolve()}),EasySocial.module("site/profile/popbox",function(a){var b=this;
EasySocial.require().library("popbox").done(function(){var a=EasySocial.options.lockdown&&!EasySocial.options.guest||!EasySocial.options.lockdown;a&&EasySocial.module("profile/popbox",function(){this.resolve(function(a){var b=a.button.data("userId"),c=a.button.attr("data-popbox-position")||"top-left";return{content:EasySocial.ajax("site/views/profile/popbox",{id:b}),id:"fd",component:"es",type:"profile",position:c}})})}),EasySocial.require().script("site/conversations/composer").done(),EasySocial.Controller("Profile.Popbox",{defaultOptions:{id:null,"{addButton}":"[data-popbox-friends-add]","{friendsButton}":"[data-popbox-friends-friends]","{respondButton}":"[data-popbox-friends-respond]","{requestedButton}":"[data-popbox-friends-requested]","{messageButton}":"[data-popbox-message]","{friendsSubmenu}":"[data-friends-submenu]","{cancelFriend}":"[data-popbox-friends-friends-cancel]","{cancelFriendRequest}":"[data-popbox-friends-requested-cancel]","{approveFriend}":"[data-popbox-friends-respond-approve]","{rejectFriend}":"[data-popbox-friends-respond-reject]"}},function(b){return{init:function(){b.options.id=b.element.find("[data-user-id]").data("userId"),EasySocial.module("site/conversations/composer").done(function(){b.messageButton().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:b.options.id}})
})},"{self} popboxActivate":function(){b.friendsSubmenu().parent().removeClass("open")},"{addButton} click":function(){EasySocial.ajax("site/controllers/friends/request",{id:b.options.id}).done(function(){EasySocial.ajax("site/views/profile/getButton",{button:"button.requested",id:b.options.id}).done(function(a){b.addButton().replaceWith(a)})}).fail(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")})})},"{cancelFriend} click":function(c){var e=a(c).data("friendid");EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmRemoveFriend",{id:b.options.id}),bindings:{"{confirmButton} click":function(){EasySocial.ajax("site/controllers/friends/unfriend",{id:e}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/friendRemoved",{id:b.options.id})}),EasySocial.ajax("site/views/profile/getButton",{button:"button.add"}).done(function(a){b.friendsSubmenu().remove(),b.friendsButton().replaceWith(a)
})})}}})},"{cancelFriendRequest} click":function(c){var e=a(c).data("friendid");EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmCancelRequest",{id:e}),bindings:{"{confirmButton} click":function(){EasySocial.dialog().close(),EasySocial.ajax("site/controllers/friends/cancelRequest",{id:e}).done(function(){EasySocial.ajax("site/views/profile/getButton",{button:"button.add"}).done(function(a){b.friendsSubmenu().remove(),b.requestedButton().replaceWith(a)})})}}})},"{approveFriend} click":function(c){var e=a(c).data("friendid");
EasySocial.ajax("site/controllers/friends/approve",{id:e}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmFriends",{id:b.options.id})}),EasySocial.ajax("site/views/profile/getButton",{button:"button.friends"}).done(function(a){b.friendsSubmenu().remove(),b.respondButton().replaceWith(a)})})},"{rejectFriend} click":function(c){var e=a(c).data("friendid");EasySocial.ajax("site/controllers/friends/reject",{id:e}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/rejected",{id:b.options.id})}),EasySocial.ajax("site/views/profile/getButton",{button:"button.add"}).done(function(a){b.friendsSubmenu().remove(),b.respondButton().replaceWith(a)
})})}}}),a(document).on("mouseover.es.profile.popbox","[data-popbox-tooltip=profile]",function(){a(this).addController("EasySocial.Controller.Profile.Popbox")}),b.resolve()}),EasySocial.module("site/conversations/composer",function(){var b=this;EasySocial.require().library("mentions").script("site/friends/suggest","uploader/uploader").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language("COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE").done(function(a){EasySocial.Controller("Conversations.Composer",{defaultOptions:{attachments:!0,location:!0,showNonFriend:!1,extensionsAllowed:"","{uploader}":"[data-composer-attachment]","{location}":"[data-composer-location]","{editorHeader}":"[data-composer-editor-header]","{editorArea}":"[data-composer-editor-area]","{editor}":"[data-composer-editor]","{friendSuggest}":"[data-friends-suggest]","{recipients}":"input[name=uid\\[\\]],input[name=list_id\\[\\]]","{recipientRow}":"[data-composer-recipients]","{messageRow}":"[data-composer-message]","{submit}":"[data-composer-submit]",view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(b){return{init:function(){b.initSuggest(),b.options.attachments&&b.initUploader(),b.setMentionsLayout()
},resetForm:function(){b.editor().val("")},setMentionsLayout:function(){var c=b.editorArea(),d=c.controller("mentions");if(d)return d.cloneLayout(),void 0;var e=b.editorHeader();c.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:a.View("easysocial/site/friends/suggest.hint.search"),emptyHint:a.View("easysocial/site/friends/suggest.hint.empty"),data:function(c){var d=a.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:c}).done(function(c){a.isArray(c)||d.reject();
var c=a.map(c,function(a){return a.title=a.screenName,a.type="user",a.menuHtml=b.view.suggestItem(!0,{item:a,name:"uid[]"}),a});d.resolve(c)}).fail(d.reject),d},use:function(a){return a.type+":"+a.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!1,searchHint:a.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:a.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(c){var d=a.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:c}).done(function(c){a.isArray(c)||d.reject();
var c=a.map(c,function(a){return a.title="#"+a.title,a.type="hashtag",a.menuHtml=b.view.tagSuggestItem(!0,{item:a,name:"uid[]"}),a});d.resolve(c)}).fail(d.reject),d}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:"left top",at:"left bottom",of:e,collision:"none"},size:{width:function(){return e.width()}}}}})},initUploader:function(){b.uploader().implement(EasySocial.Controller.Uploader,{temporaryUpload:!0,query:"type=conversations",type:"conversations",extensionsAllowed:b.options.extensionsAllowed})
},initSuggest:function(){b.friendSuggest().addController(EasySocial.Controller.Friends.Suggest,{friendList:!0,friendListName:"list_id[]",showNonFriend:b.options.showNonFriend})},initEditor:function(){b.editor().expandingTextarea()},checkErrors:function(){return b.recipients().length<=0?(b.recipientRow().addClass("error"),b.clearMessage(),b.setMessage(a.language("COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS"),"error"),!0):(b.recipientRow().removeClass("error"),""==b.editor().val()?(b.messageRow().addClass("error"),b.clearMessage(),b.setMessage(a.language("COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE"),"error"),!0):(b.messageRow().removeClass("error"),!1))
},"{submit} click":function(c,d){if(d.preventDefault(),b.checkErrors())return!1;if(b.options.attachments){var e=b.uploader().controller();if(e.options.uploading&&e.hasFiles())return!1}var f=b.editorArea().mentions("controller").toArray();a(f).each(function(c,d){a("<input>").attr("type","hidden").attr("name","tags[]").attr("value",JSON.stringify(d)).appendTo(b.element)}),b.element.submit()}}}),EasySocial.Controller("Conversations.Composer.Dialog",{defaultOptions:{recipient:{}}},function(b){return{"{self} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/composer",{id:b.options.recipient.id}),bindings:{"{sendButton} click":function(c){var d=this.parent,e=a("[data-composer-recipient]").val(),f=a("[data-composer-message]").val();
c.disabled(!0),EasySocial.ajax("site/controllers/conversations/store",{uid:e,message:f}).done(function(a){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/sent",{id:b.options.recipient.id}),bindings:{"{viewButton} click":function(){document.location=a}}})}).fail(function(a){d.setMessage(a),c.disabled(!1)})}}})}}}),b.resolve()})}),EasySocial.module("site/privacy/privacy",function(){var b=this;EasySocial.require().library("textboxlist").language("COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_PUBLIC","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_MEMBER","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIENDS_OF_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_ONLY_ME","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_CUSTOM").done(function(a){EasySocial.Controller("Privacy",{defaultOptions:{"{menu}":"[data-privacy-menu]","{privacyItem}":"[data-privacy-item]","{icon}":"[data-privacy-icon]","{button}":"[data-privacy-toggle]","{tooltip}":"[data-original-title]","{key}":"[data-privacy-hidden]"}},function(b){return{init:function(){b.instanceId=a.uid(),b.addPlugin("custom")
},getData:function(b){return a._.pick(b.data(),"uid","utype","value","pid","privacyicon","streamid","pitemid","userid")},"{self} click":function(c,d){var e=a(d.target),f=b.button();e.parents().andSelf().filter(f).length>0&&b.toggle()},"{privacyItem} click":function(a){var c=b.getData(a);b.trigger("privacyChange",[c]),c.preventSave||(b.save(c),b.deactivate())},"{self} privacyChange":function(a,c,d){b.privacyItem().removeClass("active").filter("[data-value="+d.value+"]").addClass("active")},toggle:function(){var a=b.element.hasClass("active");
b[a?"deactivate":"activate"]()},activate:function(){b.element.addClass("active"),b.trigger("activate",[b]),a(window).trigger("activatePrivacy",[b]);var c="click.privacy."+b.instanceId;a(document).on(c,function(d){var e=a(d.target);e.parents().andSelf().filter(b.element).length>0||e.parents("[data-textboxlist-autocomplete]").length>0||e.parents("[data-textboxlist-item]").length>0||(a(document).off(c),b.deactivate())})},deactivate:function(){b.element.removeClass("active"),b.trigger("deactivateAllPrivacy",[b]),a(window).trigger("deactivatePrivacy",[b])
},"{window} activatePrivacy":function(a,c,d){d!==b&&b.deactivate()},save:function(c){b.key().val(c.value),b.icon().attr("class",c.privacyicon),b.trigger("privacySave",[c]),b.element.attr("data-original-title",a.language("COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_"+c.value.toUpperCase())),"ajax"==b.element.data("privacyMode")&&EasySocial.ajax("site/controllers/privacy/update",{uid:c.uid,utype:c.utype,value:c.value,pid:c.pid,custom:c.custom,streamid:c.streamid,userid:c.userid,pitemid:c.pitemid}).done(function(){}).fail(function(){})
}}}),EasySocial.Controller("Privacy.Custom",{defaultOptions:{"{textField}":"[data-textfield]","{saveButton}":"[data-save-button]","{cancelButton}":"[data-cancel-button]","{customItem}":"[data-privacy-item][data-value=custom]","{customKey}":"[data-privacy-custom-hidden]"}},function(b){return{init:function(){b.textField().textboxlist({component:"es",unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:1,cache:!1,query:function(a){var c=b.getIds(),d=EasySocial.ajax("site/views/privacy/getfriends",{q:a,exclude:c});
return d}}}}),b.textboxlist=b.textField().controller("TextboxList")},getIds:function(){var c=b.textField().textboxlist("controller").getAddedItems();return a.map(c,function(a){return a.id})},updateIds:function(){var a=b.getIds();b.customKey().val(a.join(","))},"{parent} privacyChange":function(a,c,d){var e="custom"==d.value;b.element.toggleClass("custom-privacy",e),e?d.preventSave=!0:b.textField().textboxlist("controller").clearItems()},"{parent} privacySave":function(){},"{parent} deactivateAllPrivacy":function(){b.textboxlist.autocomplete.hide()
},"{cancelButton} click":function(){b.element.removeClass("custom-privacy"),b.textboxlist.autocomplete.hide()},"{saveButton} click":function(){var a=b.parent,c=b.customItem(),d=a.getData(c);d.custom=b.customKey().val(),b.parent.save(d),b.parent.deactivate()},"{textField} addItem":function(){b.updateIds()},"{textField} removeItem":function(){b.updateIds()}}}),a(document).on("click.es.privacy","[data-es-privacy-container]",function(){var b=a(this),c="EasySocial.Controller.Privacy";b.hasController(c)||b.addController(c).toggle()
}),b.resolve()})}),EasySocial.module("site/locations/popbox",function(){EasySocial.module("locations/popbox",function(a){this.resolve(function(b){var c=b.button,d=c.data("lat"),e=c.data("lng"),f="//maps.google.com/?q="+d+","+e,g=a('meta[property="foundry:location:language"]').attr("content")||"en",h="//maps.googleapis.com/maps/api/staticmap?size=400x200&sensor=true&zoom=15&center="+d+","+e+"&markers="+d+","+e+"&language="+g;return{id:"fd",component:"es",type:"location",content:'<a href="'+f+'" target="_blank"><img src="'+h+'" width="400" height="200" /></a>'}
})}),this.resolve()}),EasySocial.module("site/sidebar/sidebar",function(a){var b=this;a(document).on("click.es.sidebar","[data-sidebar-toggle]",function(){var b=a(this),c="[data-sidebar]",d=b.siblings(c);d.length<1&&(d=b.closest(c)),d.length<1&&(d=a(c)),d.toggleClass("sidebar-open").trigger("sidebarToggle")}),b.resolve()}),EasySocial.module("site/friends/api",function(a){var b=this;EasySocial.require().library("dialog","popbox").done(function(){a(document).on("click.es.friends.cancel","[data-es-friends-cancel]",function(){var b=a(this),c=b.data("es-friends-id");
EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmCancel"),bindings:{"{confirmButton} click":function(){EasySocial.ajax("site/controllers/friends/cancelRequest",{id:c}).done(function(){EasySocial.dialog().close()})}}})}),a(document).on("click.es.friends.add","[data-es-friends-add]",function(){var b=a(this),c=b.data("es-friends-id"),d=a.Deferred(),e={content:d,id:"fd",component:"es",type:"api-friends",toggle:"click"};b.popbox("destroy"),b.popbox(e),b.popbox("show"),EasySocial.ajax("site/controllers/friends/request",{viewCallback:"popboxRequest",id:c}).done(function(a){d.resolve(a)
})}),b.resolve()})}),EasySocial.module("site/popbox/popbox",function(){var b=this;EasySocial.module("notifications/popbox",function(a){this.resolve(function(b){var c=b.button.data("autoread");return{content:EasySocial.ajax("site/controllers/notifications/getSystemItems",{layout:"popbox.notifications"}).done(function(){c&&(a("[data-notificationSystem-counter]").parents("li").removeClass("has-notice"),a("[data-notificationSystem-counter]").html(0))}),id:"fd",component:"es",type:"notifications",cache:!1}})}),EasySocial.module("conversations/popbox",function(){this.resolve(function(){return{content:EasySocial.ajax("site/controllers/notifications/getConversationItems",{usemax:"1",layout:"popbox.conversations"}),id:"fd",component:"es",type:"notifications",cache:!1}
})}),EasySocial.module("friends/popbox",function(){this.resolve(function(){return{content:EasySocial.ajax("site/controllers/notifications/friendsRequests",{layout:"popbox.friends"}),id:"fd",component:"es",type:"notifications",cache:!1}})}),b.resolve()}),EasySocial.module("site/conversations/api",function(a){var b=this;EasySocial.require().library("dialog").done(function(){a(document).on("click.es.conversations.compose","[data-es-conversations-compose]",function(){var b=a(this),c=b.data("es-conversations-id"),d=b.data("es-conversations-listid");
EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/composer",{id:c,listId:d}),bindings:{"{sendButton} click":function(){var b=a("input[name=recipient\\[\\]]"),e=a("[data-composer-message]").val(),f=new Array,g=this.parent;a(b).each(function(){f.push(a(this).val())}),EasySocial.ajax("site/controllers/conversations/store",{uid:f,message:e}).done(function(a){c&&EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/sent",{id:c}),bindings:{"{viewButton} click":function(){document.location=a
}}}),d&&EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/sentList",{id:d}),bindings:{"{viewButton} click":function(){document.location=a}}})}).fail(function(a){g.setMessage(a)})}}})}),b.resolve()})}),EasySocial.module("site/groups/api",function(a){var b=this;EasySocial.require().library("dialog").done(function(){a(document).on("click.es.groups.join","[data-es-groups-join]",function(){var b=a(this),c=b.data("id");EasySocial.dialog({content:EasySocial.ajax("site/controllers/groups/joinGroup",{api:1,id:c}),bindings:{}})
}),b.resolve()})}),EasySocial.module("site/followers/api",function(a){var b=this;EasySocial.require().library("dialog","popbox").done(function(){a(document).on("click.es.followers.follow","[data-es-followers-follow]",function(){var b=a(this),c=b.data("es-followers-id"),d=a.Deferred(),e=void 0==b.data("es-show-popbox")||"true"==b.data("es-show-popbox")?!0:!1;e&&(b.popbox({content:d,id:"fd",component:"es",type:"followers",toggle:"click"}),b.popbox("show")),EasySocial.ajax("site/controllers/profile/follow",{id:c,type:"user"}).done(function(f){a(b).trigger("following",f),e&&EasySocial.ajax("site/views/profile/popboxFollow",{id:c}).done(function(a){d.resolve(a)
})})}),a(document).on("click.es.followers.unfollow","[data-es-followers-unfollow]",function(){var b=a(this),c=b.data("es-followers-id"),d=a.Deferred();b.popbox({content:d,id:"fd",component:"es",type:"followers",toggle:"click"}),b.popbox("show"),EasySocial.ajax("site/controllers/profile/unfollow",{id:c,type:"user"}).done(function(){EasySocial.ajax("site/views/profile/popboxUnfollow",{id:c}).done(function(a){d.resolve(a)})})}),b.resolve()})}),EasySocial.module("site/stream/video",function(a){a(document).on("click","[data-es-links-embed-item]",function(){var b=a(this),c=a("<div>").html(b.data("es-stream-embed-player")),d='<div class="video-container">'+c.html()+"</div>";
b.replaceWith(d)}),a(document).on("click","[data-es-video-embed]",function(){var b=a(this),c=b.siblings("[data-es-video-embed-player]");b.replaceWith(c),c.removeClass("hide")}),this.resolve()}),EasySocial.module("oauth/facebook",function(a){var b=this;a(document).on("click","[data-oauth-facebook-login]",function(){var b=a(this),c=b.parents("[data-oauth-facebook]"),d="EasySocial.Controller.OAuth.Facebook";c.length<1||c.hasController(d)||c.addController(d,{url:b.data("oauth-facebook-url"),appId:b.data("oauth-facebook-appid")}).openDialog()
}),EasySocial.Controller("OAuth.Facebook",{defaultOptions:{appId:null,url:"","{login}":"[data-oauth-facebook-login]","{revoke}":"[data-oauth-facebook-revoke]","{pushInput}":"[data-oauth-facebook-push]"}},function(b){return{init:function(){},openDialog:function(){var a=b.options.url,c=screen.width/2-150,d=screen.height/2-150;window.open(a,"","scrollbars=no,resizable=no,width=300,height=300,left="+c+",top="+d)},"{pushInput} change":function(c){var d=a(c).val();1==d&&b.options.requestPush&&b.openDialog(b.options.addPublishURL),0==d&&b.openDialog(b.options.revokePublishURL)
},"{login} click":function(){b.openDialog()},"{revoke} click":function(){var a=b.element.data("callback");EasySocial.dialog({content:EasySocial.ajax("site/views/oauth/confirmRevoke",{client:"facebook",callbackUrl:a})})}}}),b.resolve()}),EasySocial.module("groups/suggest",function(){var b=this;EasySocial.require().view("site/groups/suggest.item").library("textboxlist").done(function(a){EasySocial.Controller("Groups.Suggest",{defaultOptions:{max:null,exclusive:!0,exclusion:[],minLength:1,highlight:!0,name:"uid[]",type:"",view:{suggestItem:"site/groups/suggest.item"}}},function(b){return{init:function(){var a=b.options;
b.element.textboxlist({component:"es",name:a.name,max:a.max,plugin:{autocomplete:{exclusive:a.exclusive,minLength:a.minLength,highlight:a.highlight,showLoadingHint:!0,showEmptyHint:!0,query:function(b){var c=EasySocial.ajax("site/controllers/groups/suggest",{search:b,exclusion:a.exclusion});return c}}}}).textboxlist("enable")},"{self} filterItem":function(a,c,d){var e=b.view.suggestItem(!0,{item:d,name:b.options.name});return d.menuHtml=e,d.html=e,d},"{self} filterMenu":function(c,d,e,f,g,h){if(!b.options.friendList){var i=h.getAddedItems(),j=a.pluck(i,"id"),j=j.concat(b.options.exclusion);
f.each(function(){var b=a(this),c=b.data("item");b.toggleClass("hidden",a.inArray(c.id.toString(),j)>-1)})}}}}),b.resolve()})});var b=this;EasySocial.module("libraries/lightbox",function(a){var c=this,d=a;!function(a,c){b.lightbox=c(d)}(this,function(a){function b(b){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=a.extend({},this.constructor.defaults),this.option(b)}return b.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:500,fitImagesInViewport:!0,positionFromTop:50,resizeDuration:700,showImageNumberLabel:!0,wrapAround:!1},b.prototype.option=function(b){a.extend(this.options,b)
},b.prototype.imageCountLabel=function(a,b){return this.options.albumLabel.replace(/%1/g,a).replace(/%2/g,b)},b.prototype.init=function(){this.enable(),this.build()},b.prototype.enable=function(){var b=this;a("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(c){return b.start(a(c.currentTarget)),!1})},b.prototype.build=function(){var b=this;a('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(a("body")),this.$lightbox=a("#lightbox"),this.$overlay=a("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.containerTopPadding=parseInt(this.$container.css("padding-top"),10),this.containerRightPadding=parseInt(this.$container.css("padding-right"),10),this.containerBottomPadding=parseInt(this.$container.css("padding-bottom"),10),this.containerLeftPadding=parseInt(this.$container.css("padding-left"),10),this.$overlay.hide().on("click",function(){return b.end(),!1
}),this.$lightbox.hide().on("click",function(c){return"lightbox"===a(c.target).attr("id")&&b.end(),!1}),this.$outerContainer.on("click",function(c){return"lightbox"===a(c.target).attr("id")&&b.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===b.currentImageIndex?b.changeImage(b.album.length-1):b.changeImage(b.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return b.currentImageIndex===b.album.length-1?b.changeImage(0):b.changeImage(b.currentImageIndex+1),!1
}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return b.end(),!1})},b.prototype.start=function(b){function f(a){c.album.push({link:a.attr("href"),title:a.attr("data-title")||a.attr("title")})}var c=this,d=a(window);d.on("resize",a.proxy(this.sizeOverlay,this)),a("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var h,e=0,g=b.attr("data-lightbox");if(g){h=a(b.prop("tagName")+'[data-lightbox="'+g+'"]');for(var i=0;i<h.length;i=++i)f(a(h[i])),h[i]===b[0]&&(e=i)
}else if("lightbox"===b.attr("rel"))f(b);else{h=a(b.prop("tagName")+'[rel="'+b.attr("rel")+'"]');for(var j=0;j<h.length;j=++j)f(a(h[j])),h[j]===b[0]&&(e=j)}var k=d.scrollTop()+this.options.positionFromTop,l=d.scrollLeft();this.$lightbox.css({top:k+"px",left:l+"px"}).fadeIn(this.options.fadeDuration),this.changeImage(e)},b.prototype.changeImage=function(b){var c=this;this.disableKeyboardNav();var d=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),a(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");
var e=new Image;e.onload=function(){var f,g,h,i,j,k,l;d.attr("src",c.album[b].link),f=a(e),d.width(e.width),d.height(e.height),c.options.fitImagesInViewport&&(l=a(window).width(),k=a(window).height(),j=l-c.containerLeftPadding-c.containerRightPadding-20,i=k-c.containerTopPadding-c.containerBottomPadding-120,c.options.maxWidth&&c.options.maxWidth<j&&(j=c.options.maxWidth),c.options.maxHeight&&c.options.maxHeight<j&&(i=c.options.maxHeight),(e.width>j||e.height>i)&&(e.width/j>e.height/i?(h=j,g=parseInt(e.height/(e.width/h),10),d.width(h),d.height(g)):(g=i,h=parseInt(e.width/(e.height/g),10),d.width(h),d.height(g)))),c.sizeContainer(d.width(),d.height())
},e.src=this.album[b].link,this.currentImageIndex=b},b.prototype.sizeOverlay=function(){this.$overlay.width(a(window).width()).height(a(document).height())},b.prototype.sizeContainer=function(a,b){function h(){c.$lightbox.find(".lb-dataContainer").width(f),c.$lightbox.find(".lb-prevLink").height(g),c.$lightbox.find(".lb-nextLink").height(g),c.showImage()}var c=this,d=this.$outerContainer.outerWidth(),e=this.$outerContainer.outerHeight(),f=a+this.containerLeftPadding+this.containerRightPadding,g=b+this.containerTopPadding+this.containerBottomPadding;
d!==f||e!==g?this.$outerContainer.animate({width:f,height:g},this.options.resizeDuration,"swing",function(){h()}):h()},b.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn("slow"),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},b.prototype.updateNav=function(){var a=!1;try{document.createEvent("TouchEvent"),a=this.options.alwaysShowNavOnTouchDevices?!0:!1}catch(b){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(a&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),a&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),a&&this.$lightbox.find(".lb-next").css("opacity","1"))))
},b.prototype.updateDetails=function(){var b=this;if("undefined"!=typeof this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title&&this.$lightbox.find(".lb-caption").html(this.album[this.currentImageIndex].title).fadeIn("fast").find("a").on("click",function(){void 0!==a(this).attr("target")?window.open(a(this).attr("href"),a(this).attr("target")):location.href=a(this).attr("href")}),this.album.length>1&&this.options.showImageNumberLabel){var c=this.imageCountLabel(this.currentImageIndex+1,this.album.length);
this.$lightbox.find(".lb-number").text(c).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return b.sizeOverlay()})},b.prototype.preloadNeighboringImages=function(){if(this.album.length>this.currentImageIndex+1){var a=new Image;a.src=this.album[this.currentImageIndex+1].link}if(this.currentImageIndex>0){var b=new Image;b.src=this.album[this.currentImageIndex-1].link
}},b.prototype.enableKeyboardNav=function(){a(document).on("keyup.keyboard",a.proxy(this.keyboardAction,this))},b.prototype.disableKeyboardNav=function(){a(document).off(".keyboard")},b.prototype.keyboardAction=function(a){var b=27,c=37,d=39,e=a.keyCode,f=String.fromCharCode(e).toLowerCase();e===b||f.match(/x|o|c/)?this.end():"p"===f||e===c?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):("n"===f||e===d)&&(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))
},b.prototype.end=function(){this.disableKeyboardNav(),a(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),a("select, object, embed").css({visibility:"visible"})},new b}),c.resolve()}),EasySocial.module("locations",function(a){var b=this;EasySocial.require().library("scrollTo","image","gmaps").view("site/location/story.suggestion").language("COM_EASYSOCIAL_AT_LOCATION").done(function(){var c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};
EasySocial.Controller("Locations",{defaultOptions:{view:{suggestion:"site/location/story.suggestion"},map:{lat:0,lng:0},latitude:null,longitude:null,"{textField}":"[data-location-textField]","{detectLocationButton}":"[data-detect-location-button]","{autocomplete}":"[data-location-autocomplete]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-story-location-suggestion]","{mapImage}":"[data-location-map-image]","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]","{removeButton}":"[data-location-remove-button]"}},function(b,d,e){return{init:function(){navigator.geolocation&&b.detectLocationButton().show(),EasySocial.require().library("gmaps").done(function(){b.textField().removeAttr("disabled")
}),setTimeout(function(){d.latitude&&d.longitude&&(b.navigate(d.latitude,d.longitude),b.detectLocationButton().hide())},1)},navigate:function(c,d){var f=b.mapImage(),g=f.width(),h=f.height(),i=a.GMaps.staticMapURL({size:[g,h],lat:c,lng:d,sensor:!0,scale:2,markers:[{lat:c,lng:d}]});a.Image.get(i).done(function(){f.css({backgroundImage:a.cssUrl(i),backgroundSize:"cover",backgroundPosition:"center center"}),e.addClass("has-location")})},locations:{},lastQueryAddress:null,"{textField} keypress":function(d,e){switch(e.keyCode){case c.UP:var f=a(b.suggestion(".active").prev(b.suggestion.selector)[0]||b.suggestion(":last")[0]);
b.suggestion().removeClass("active"),f.addClass("active").trigger("activate"),b.suggestions().scrollTo(f,{offset:-1*f.height()}),e.preventDefault();break;case c.DOWN:var g=a(b.suggestion(".active").next(b.suggestion.selector)[0]||b.suggestion(":first")[0]);b.suggestion().removeClass("active"),g.addClass("active").trigger("activate"),b.suggestions().scrollTo(g,{offset:-1*g.height()}),e.preventDefault();break;case c.ENTER:var h=b.suggestion(".active"),i=h.data("location");b.set(i);break;case c.ESCAPE:}},"{textField} keyup":function(d,e){switch(e.keyCode){case c.UP:case c.DOWN:case c.ENTER:case c.ESCAPE:break;
default:var f=a.trim(d.val());if(f==b.lastQueryAddress)return;var g=b.locations[f];g?(b.suggest(g),b.lastQueryAddress=f):b.lookup(f)}},lookup:a._.debounce(function(a){EasySocial.ajax("site/controllers/location/suggestLocations",{address:a}).done(function(c){b.locations[a]=c,b.suggest(c),b.textField().focus(),b.element.addClass("has-suggested")})},250),suggest:function(c){var d=b.suggestions();d.empty(),a.each(c,function(a,c){b.view.suggestion({location:c}).data("location",c).appendTo(d)}),b.autocomplete().addClass("active")
},"{suggestion} activate":function(a){var d=a.data("location");b.navigate(d.latitude,d.longitude)},"{suggestion} mouseover":function(a){b.suggestion().removeClass("active"),a.addClass("active").trigger("activate")},"{suggestion} click":function(a){var d=a.data("location");b.set(d),b.autocomplete().removeClass("active")},set:function(a){b.currentLocation=a;var c=a.name;b.textField().val(c),b.latitude().val(a.latitude),b.longitude().val(a.longitude),b.detectLocationButton().hide(),b.trigger("locationChange",[a])
},unset:function(){b.currentLocation=null,b.textField().val(""),b.mapImage().attr("src",""),b.element.removeClass("has-location"),b.detectLocationButton().show()},"{detectLocationButton} click":function(){b.map;b.element.addClass("is-busy"),a.GMaps.geolocate({success:function(a){EasySocial.ajax("site/controllers/location/getLocations",{latitude:a.coords.latitude,longitude:a.coords.longitude}).done(function(a){b.element.removeClass("is-busy"),b.element.addClass("has-suggested"),b.suggest(a),b.textField().focus()
})},error:function(){},always:function(){}})},"{removeButton} click":function(){b.unset()},"{story} save":function(a,c,d){var e=b.currentLocation;e&&d.addData(b,{short_address:e.name,formatted_address:e.address,lat:e.latitude,lng:e.longitude})},"{story} clear":function(){b.unset()}}}),b.resolve()})}),EasySocial.module("pagination",function(){var a=this;EasySocial.require().done(function(b){EasySocial.Controller("Pagination",{defaultOptions:{"{pages}":".pageItem","{limitstart}":"#limitstart","{previousItem}":".previousItem","{nextItem}":".nextItem"}},function(a){return{init:function(){a.pages().implement(EasySocial.Controller.Pagination.Page,{pagination:a})
},"{previousItem} click":function(c){var d=b(c).data("limitstart");b(c).hasClass("disabled")||a.submitForm(d)},"{nextItem} click":function(c){var d=b(c).data("limitstart");b(c).hasClass("disabled")||a.submitForm(d)},submitForm:function(c){a.limitstart().val(c),b.Joomla("submitform",[])}}}),EasySocial.Controller("Pagination.Page",{defaultOptions:{pagination:null,limitstart:0}},function(a){return{init:function(){a.options.limitstart=a.element.data("limitstart")},"{self} click":function(){return a.element.hasClass("active")?!1:(a.options.pagination.submitForm(a.options.limitstart),void 0)
}}}),a.resolve()})}),EasySocial.module("photos/avatar",function(a){var b=this;EasySocial.require().library("imgareaselect").stylesheet("imgareaselect/default").done(function(){EasySocial.Controller("Photos.Avatar",{defaultOptions:{view:{selection:"site/photos/avatar.selection"},uid:null,type:null,redirect:!0,redirectUrl:"","{image}":"[data-photo-image]","{viewport}":"[data-photo-avatar-viewport]","{photoId}":"[data-photo-id]","{userId}":"[data-user-id]","{createButton}":"[data-create-button]","{selection}":"[data-selection-box]","{loadingIndicator}":"[data-photos-avatar-loading]"}},function(b){return{init:function(){b.setLayout()
},data:function(){var a=b.viewport(),c=a.width(),d=a.height(),e=a.imgAreaSelect({instance:!0}).getSelection(),f={id:b.photoId().val(),uid:b.options.uid,type:b.options.type,top:e.y1/d,left:e.x1/c,width:e.width/c,height:e.height/d};return f},imageLoaders:{},setLayout:function(){var c=b.image(),d=c.css("backgroundImage").replace(/^url\(['"]?/,"").replace(/['"]?\)$/,""),e=b.imageLoaders,f=e[d]||(b.imageLoaders[d]=a.Image.get(d));f.done(function(d,e){var f=a.Image.resizeWithin(e.width,e.height,c.width(),c.height()),g=Math.min(f.width,f.height),h=Math.floor((f.width-g)/2),i=Math.floor((f.height-g)/2),j=h+g,k=i+g;
b.createButton().enabled(!0),b.viewport().css(f).imgAreaSelect({handles:!0,aspectRatio:"1:1",parent:b.image(),x1:h,y1:i,x2:j,y2:k,onSelectEnd:function(a,c){var d=!("0"==c.width&&"0"==c.height);b.createButton().enabled(d)}})})},"{createButton} click":function(){var c=b.data(),d=EasySocial.ajax("site/controllers/photos/createAvatar",c).done(function(){b.options.redirect&&(window.location=b.options.redirectUrl)}).fail(function(a,c){b.setMessage(a,c)});b.trigger("avatarCreate",[d,c,b])}}}),b.resolve()})}),EasySocial.module("photos/browser",function(a){var b=this;
EasySocial.require().library("history").done(function(){EasySocial.Controller("Photos.Browser",{defaultOptions:{tilesPerRow:4,"{sidebar}":"[data-photo-browser-sidebar]","{content}":"[data-photo-browser-content]","{backButton}":"[data-photo-back-button]","{backButtonLink}":"[data-photo-back-button-link]","{listItemGroup}":"[data-photo-list-item-group]","{listItem}":"[data-photo-list-item]","{listItemLink}":"[data-photo-list-item] > a","{listItemTitle}":"[data-photo-list-item-title]","{listItemCover}":"[data-photo-list-item-cover]","{listItemImage}":"[data-photo-list-item-image]","{featuredListItem}":"[data-photo-list-item].featured","{featuredListItemImage}":"[data-photo-list-item].featured [data-photo-list-item-image]","{photoItem}":"[data-photo-item]"}},function(b){return{init:function(){EasySocial.require().library("masonry").done(function(){b.setLayout()
})},setLayout:function(){var c=b.listItemGroup(),d=a.data(c[0],"masonry");c.width(4*Math.floor(c.width()/4)),d?c.masonry("reloadItems").masonry("layout"):c.masonry({columnWidth:".es-thumb.grid-sizer",itemSelector:b.listItem.selector}),b.setLayout.seed=c.width()},open:function(c){var d=a.makeArray(arguments);b.trigger("contentLoad",d);var e="view"+a.String.capitalize(c),f=b[e].apply(b,d.slice(1));return f.done(b.displayContent(function(){return b.trigger("contentDisplay",d),arguments})).fail(function(){b.trigger("contentFail",d)
}).always(function(){b.trigger("contentComplete",d)}),f},displayContent:a.Enqueue(function(c){var d=[],e=a(a.buildFragment([c],document,d));b.content().html(e),a(d).remove()}),viewPhoto:function(a){var c="active loading",d=b.listItem().removeClass(c).filterBy("photoId",a).addClass(c),e=EasySocial.ajax("site/views/photos/item",{id:a,browser:!1}).fail(function(){}).always(function(){d.removeClass("loading")});return e},"{listItem} click":function(a){var c=a.data("photoId");b.open("Photo",c),a.find("> a").route()
},"{listItemLink} click":function(a,b){b.preventDefault(),a.blur()},"{backButtonLink} click":function(a,c){var d=b.browser;if(d){var e=b.element.data("albumId");d.open("album",e),c.preventDefault(),a.route(),d.setLayout("album"),b.element.remove()}},getListItem:function(c,d){var e=c?b.listItem().filterBy("photoId",c):b.listItem(".new");return d?e.find(b["listItem"+a.String.capitalize(d)].selector):e},getNextListItem:function(a){var c=b.getListItem(a).next(b.listItem.selector);return c.length<1&&(c=b.listItem(":first")),c
},getPrevListItem:function(a){var c=b.getListItem(a).prev(b.listItem.selector);return c.length<1&&(c=b.listItem(":last")),c},removeListItem:function(a,c){var d=b.getListItem(a),e=b.getPrevListItem(a);return d.remove(),b.setLayout(),b.listItem().length<1?(b.element.addClass("loading"),window.location=b.backButtonLink().attr("href")):(c&&e.click(),void 0)},"{photoItem} init.photos.item":function(a,c,d){b.addSubscriber(d)},"{photoItem} photoSave":function(a,c,d){d.done(function(a){b.getListItem(a.id,"title").html(a.title)
})},"{photoItem} photoNext":function(a,c,d){var e=b.getNextListItem(d.id);e.click()},"{photoItem} photoPrev":function(a,c,d){var e=b.getPrevListItem(d.id);e.click()},"{photoItem} photoMove":function(a,c,d,e){d.done(function(){b.removeListItem(e.id,!0)})},"{photoItem} photoDelete":function(a,c,d,e){d.done(function(){b.removeListItem(e.id,!0)})},"{photoItem} photoFeature":function(a,c,d,e,f){var g=b.getListItem(e.id);g.toggleClass("featured",f),b.setLayout(),d.fail(function(){g.toggleClass("featured",!f),b.setLayout()
})},"{sidebar} sidebarToggle":function(){b.setLayout()}}}),b.resolve()})}),EasySocial.module("photos/editor",function(a){var b=this;EasySocial.require().done(function(){var c=EasySocial.Controller("Photos.Editor",{defaultOptions:{view:{uploadItem:"upload.item",photoForm:"site/albums/photo.form"},"{titleField}":"[data-photo-title-field]","{captionField}":"[data-photo-caption-field]","{location}":"[data-photo-location]","{locationCaption}":"[data-photo-location-caption]","{addLocationButton}":"[data-photo-addLocation-button]","{date}":"[data-photo-date]","{dateCaption}":"[data-photo-date-caption]","{addDateCaption}":"[data-photo-adddate-button]","{locationWidget}":".es-photo-location-form .es-locations","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]","{dateDay}":"[name=date-day]","{dateMonth}":"[name=date-month]","{dateYear}":"[name=date-year]","{actionsMenu}":"[data-item-actions-menu]","{featureButton}":"[data-photo-feature-button]","{coverButton}":"[data-photo-cover-button]","{editButton}":"[data-photo-edit-button]","{editButtonLink}":"[data-photo-edit-button] > a","{cancelButton}":"[data-photo-cancel-button]","{doneButton}":"[data-photo-done-button]","{doneButtonLink}":"[data-photo-done-button] > a","{moveButton}":"[data-photo-move-button]","{deleteButton}":"[data-photo-delete-button]","{rotateLeftButton}":"[data-photo-rotateLeft-button]","{rotateRightButton}":"[data-photo-rotateRight-button]","{profileAvatarButton}":"[data-photo-profileAvatar-button]","{profileCoverButton}":"[data-photo-profileCover-button]"}},function(b,c,d){return{init:function(){},data:function(){return{id:b.photo.id,title:b.titleField().val(),caption:b.captionField().val(),date:b.formatDate(),address:b.locationCaption().html(),latitude:b.latitude().val(),longitude:b.longitude().val()}
},save:function(){var a=b.data();b.clearMessage();var c=EasySocial.ajax("site/controllers/photos/update",a).done(function(){b.photo.setLayout("item")}).fail(function(){b.setMessage(message,"error")}).progress(function(a,c){"success"==c&&b.setMessage(a)});return b.trigger("photoSave",[c,b]),c},enable:function(){b.photo.setLayout("form");var a=b.photo.album;a&&d.addClass("active"),b.trigger("enabled",[b])},disable:function(){b.photo.setLayout("item");var a=b.photo.album;a&&d.removeClass("active"),b.trigger("disabled",[b])
},imageLoader:{},setImage:function(c){var d=b.photo.image(),e=b.photo.imageCss(),f=d.data(c+"Src"),g=b.imageLoader[f];return g||(g=a.Image.get(f),b.imageLoader[f]=g),g.done(function(){d.attr("src",f),e.css({backgroundImage:a.cssUrl(f)})}),g},"{featureButton} click":function(a,c){c.stopPropagation();var e=b.photo.element.parents("[data-photo-popup]").length>0||b.photo.element.parents("[data-photo-browser-content]").length>0,f=d.hasClass("featured");d.toggleClass("featured",!f),!e&&b.setImage(f?"thumbnail":"featured");
var g=EasySocial.ajax("site/controllers/photos/feature",{id:b.photo.id}).done(function(b,c){a.toggleClass("btn-es-primary",c)}).fail(function(){d.removeClass("featured"),!e&&b.setImage(f?"featured":"thumbnail")});b.trigger("photoFeature",[g,b.photo,!f])},"{coverButton} click":function(){var a=b.photo.album;a&&a.editor&&a.editor.setCover(b.photo.id)},"{dateDay} keyup":function(){b.updateDate()},"{dateMonth} change":function(){b.updateDate()},"{dateYear} keyup":function(){b.updateDate()},updateDate:function(){setTimeout(function(){b.date().addClass("has-data");
var c=b.dateDay().val()+" "+a.trim(b.dateMonth().find(":selected").text()+" "+b.dateYear().val());b.dateCaption().html(c)},1)},formatDate:function(){var a=b.dateDay().val()||b.dateDay().data("date-default"),c=b.dateMonth().val()||b.dateMonth().data("date-default"),d=b.dateYear().val()||b.dateYear().data("date-default");return d+"-"+c+"-"+a},"{locationWidget} locationChange":function(a,c,d){var e=d.address||d.fulladdress||d.formatted_address;b.locationCaption().html(e),b.location().addClass("has-data")},rotate:function(c){var e=b.photo;
b.rotateLeftButton().disabled(!0),b.rotateRightButton().disabled(!0),e.content().addClass("loading");var f=EasySocial.ajax("site/controllers/photos/rotate",{id:e.id,angle:c}).done(function(c){var f;f=b.photo.album?c.sizes.thumbnail.url:c.sizes.large.url,f+="?"+a.uid(),e.image().attr("src",f),e.imageCss().css({backgroundImage:a.cssUrl(f)}),d.addTransitionClass("rotating-ready",150).removeClass("rotating-right rotating-left")}).fail(function(a,c){b.setMessage(a,c)}).always(function(){e.content().removeClass("loading"),b.rotateLeftButton().disabled(!1),b.rotateRightButton().disabled(!1)
});b.trigger("photoRotate",[f,c,e])},"{rotateRightButton} click":function(){d.addClass("rotating-right"),b.rotate(90)},"{rotateLeftButton} click":function(){d.addClass("rotating-left"),b.rotate(-90)},"{moveButton} click":function(){var a=b.photo,c=EasySocial.dialog({content:EasySocial.ajax("site/views/photos/moveToAnotherAlbum",{id:a.id}),bindings:{"{moveButton} click":function(){var d=this.albumSelection().val(),e=EasySocial.ajax("site/controllers/photos/move",{id:a.id,albumId:d}).always(function(){c.close()
});b.trigger("photoMove",[e,a,d])}}})},"{deleteButton} click":function(){var a=b.photo;EasySocial.dialog({content:EasySocial.ajax("site/views/photos/confirmDelete",{id:a.id}),bindings:{"{deleteButton} click":function(c){var d=this.parent;c.disabled(!0);var e=EasySocial.ajax("site/controllers/photos/delete",{id:a.id}).always(function(){d.close()});b.trigger("photoDelete",[e,a])}}})},"{editButton} click":function(){b.photo.setLayout("form"),b.editButtonLink().route()},"{editButtonLink} click":function(a,b){b.preventDefault()
},"{cancelButton} click":function(){b.photo.setLayout("item"),b.doneButtonLink().route()},"{doneButton} click":function(){b.save().done(function(){b.photo.setLayout("item"),b.doneButtonLink().route()}).fail(function(){})},"{doneButtonLink} click":function(a,b){b.preventDefault()},"{profileAvatarButton} click":function(){EasySocial.photos.createAvatar(b.photo.id)}}});b.resolve(c)})}),EasySocial.module("photos/item",function(a){var b=this;EasySocial.require().script("photos/tags","photos/editor","photos/tagger","photos/navigation").done(),EasySocial.require().library("image").done(function(){var c=EasySocial.Controller("Photos.Item",{hostname:"photo",defaultOptions:{editable:!1,taggable:!1,navigation:!1,"{header}":"[data-photo-header]","{content}":"[data-photo-content]","{footer}":"[data-photo-footer]","{viewport}":"[data-photo-viewport]","{info}":"[data-photo-info]","{title}":"[data-photo-title]","{titleLink}":"[data-photo-title-link]","{caption}":"[data-photo-caption]","{image}":"[data-photo-image]","{imageCss}":"[data-photo-image-css]","{imageLink}":"[data-photo-image-link]","{menu}":"[data-photo-menu]","{actions}":"[data-item-actions]","{actionsMenu}":"[data-item-actions-menu]","{comments}":"[data-comments]","{share}":"[data-repost-action]","{likes}":"[data-likes-action]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{counterBar}":"[data-stream-counter]","{privacy}":"[data-es-privacy-container]","{likeCount}":"[data-photo-like-count]","{commentCount}":"[data-photo-comment-count]","{tagCount}":"[data-photo-tag-count]"}},function(b){return{init:function(){b.id=b.element.data("photoId"),EasySocial.module("photos/tags").done(function(a){b.tags=b.addPlugin("tags",a)
}),b.options.editable&&EasySocial.module("photos/editor").done(function(a){b.editor=b.addPlugin("editor",a)}),b.options.taggable&&EasySocial.module("photos/tagger").done(function(a){b.tagger=b.addPlugin("tagger",a)}),b.options.navigation&&EasySocial.module("photos/navigation").done(function(a){b.navigation=b.addPlugin("navigation",a)})},data:function(){var c=b.image();return{id:b.id,title:a.trim(b.title().text()),caption:a.trim(b.caption().text()),sizes:{thumbnail:c.data("thumbnailSrc"),featured:c.data("featuredSrc"),large:c.data("largeSrc")}}
},setLayout:function(a){b.element.data("photoLayout",a).switchClass("layout-"+a),b.trigger("layoutChange",[a,b])},"{self} click":function(c,d){if(c.data("esPhotoDisabled")){var e=a(d.target),f=b.menu();e.parents().andSelf().filter(f).length>0||b.trigger("activate",[b])}},"{self} photoSave":function(a,c,d){d.done(function(a,c){b.info().replaceWith(c)})},"{self} photoDelete":function(a,c,d){d.done(function(){}).fail(function(a,c){b.setMessage(a,c)})},"{imageLink} click":function(a,b){b.preventDefault()},"{titleLink} click":function(){},"{self} shown.bs.dropdown":function(){b.element.addClass("show-all")
},"{self} hidden.bs.dropdown":function(){b.element.removeClass("show-all")},"{share} create":function(){b.counterBar().removeClass("hide")},"{likes} onLiked":function(){b.counterBar().removeClass("hide"),b.count("like",1,!0)},"{likes} onUnliked":function(){var e=b.likeContent().hasClass("hide"),f=b.repostContent().hasClass("hide");e&&f&&b.counterBar().addClass("hide"),b.count("like",-1,!0)},"{self} tagAdd":function(){b.count("tag",1,!0)},"{self} tagRemove":function(){b.count("tag",-1,!0)},"{comments} newCommentSaved":function(){b.count("comment",1,!0)
},"{comments} commentDeleted":function(){b.count("comment",-1,!0)},"{privacy} activate":function(){setTimeout(function(){b.element.addClass("show-all")},0)},"{privacy} deactivate":function(){b.element.removeClass("show-all")},count:function(c,d,e){var f=b[c+"Count"];if(a.isFunction(f)){var g=f();if(!(g.length<0)){var h;h=e?(parseInt(g.text())||0)+(parseInt(d)||0):d,0>h&&(h=0),g.text(h)}}}}});b.resolve(c)})}),EasySocial.module("photos/tags",function(a){var b=this;EasySocial.require().library("scrollTo").done(),EasySocial.require().done(function(){var c=EasySocial.Controller("Photos.Tags",{hostname:"tags",defaultOptions:{"{viewport}":"[data-photo-tag-viewport]","{tagItem}":"[data-photo-tag-item]","{tagButton}":"[data-photo-tag-button]","{tagLink}":"[data-photo-tag-link]","{infoTagListItemGroup}":"[data-photoinfo-tag-list-item-group]","{infoTagListItem}":"[data-photo-tags-user]","{tagListItemGroup}":"[data-photo-tag-list-item-group]","{tagListItem}":"[data-photo-tag-list-item]","{descTagItem}":"[data-photo-tags-user]"}},function(b){return{init:function(){b.setLayout()
},imageLoaders:{},setLayout:function(c){var d=b.photo.viewport(),e=b.photo.image(),f=e.attr("src"),g=b.imageLoaders,h=g[f]||(b.imageLoaders[f]=a.Image.get(f));h.done(function(){var a=e.offset(),f=d.offset();b.viewport().css({top:a.top-f.top,left:a.left-f.left,width:e.width(),height:e.height()}),c&&c()})},"{window} resize":a.debounce(function(){b.setLayout()},1e3),getTagItem:function(a){return b.tagItem().filterBy("photoTagId",a)},getTagListItem:function(a){return b.tagListItem().filterBy("photoTagId",a)},getInfoTagListItem:function(a){return b.infoTagListItem().filterBy("photoTagId",a)
},getTaggedUsers:function(){var c=[];return b.tagListItem("[data-photo-tag-uid]").each(function(){c.push(a(this).data("photoTagUid"))}),a.uniq(c)},activateTag:function(a){b.getTagItem(a).addClass("active"),b.getTagListItem(a).addClass("active")},deactivateTag:function(a){b.getTagItem(a).removeClass("active"),b.getTagListItem(a).removeClass("active")},"{tagLink} click":function(a,b){b.stopPropagation()},"{tagListItem} click":function(a){var c=(a.hasClass("active")?"deactivate":"activate")+"Tag",d=a.data("photoTagId");
b[c](d)},"{tagListItem} mouseover":function(a){b.getTagItem(a.data("photoTagId")).addClass("focus")},"{tagListItem} mouseout":function(a){b.getTagItem(a.data("photoTagId")).removeClass("focus")},"{descTagItem} mouseover":function(a){b.getTagItem(a.data("photoTagId")).addClass("focus")},"{descTagItem} mouseout":function(a){b.getTagItem(a.data("photoTagId")).removeClass("focus")},"{self} tagCreate":function(a,c,d){d.done(function(){}).always(function(){setTimeout(function(){b.tagListItemGroup().toggleClass("empty-tags",b.tagListItem().length<1)
},1)})},"{self} tagRemove":function(a,c,d,e){d.done(function(){b.getTagItem(e).remove(),b.getTagListItem(e).remove(),b.getInfoTagListItem(e).remove();var a=b.infoTagListItemGroup().children().length;if(0==a&&b.infoTagListItemGroup().html(""),1==a){var c=b.infoTagListItemGroup().children().first(),d=c.text();d=d.replace(",",""),c.text(d)}}).always(function(){b.tagListItemGroup().toggleClass("empty-tags",b.tagListItem().length<1)})},"{self} photoRotate":function(c,d,e){e.done(function(c,d){setTimeout(function(){b.setLayout(function(){var c=b.tagItem();
a.each(d,function(a,b){var d=c.filterBy("photoTagId",b.id);d.css({width:100*b.width+"%",height:100*b.height+"%",top:100*b.top+"%",left:100*b.left+"%"})})})},1)})}}});b.resolve(c)})}),EasySocial.module("photos/tagger",function(a){var b=this,c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.require().library("scrollTo").done(),EasySocial.require().view("site/photos/tags.item","site/photos/tags.menu.item").done(function(){var d=EasySocial.Controller("Photos.Tagger",{hostname:"tagger",defaultOptions:{view:{tagItem:"site/photos/tags.item"},width:100,height:100,drawTolerance:30,"{viewport}":"[data-photo-tag-viewport]","{tagItem}":"[data-photo-tag-item]","{tagSelection}":"[data-photo-tag-item].new","{tagButton}":"[data-photo-tag-button]","{infoTagListItemGroup}":"[data-photoinfo-tag-list-item-group]","{tagListItemGroup}":"[data-photo-tag-list-item-group]","{tagListItem}":"[data-photo-tag-list-item]","{tagRemoveButton}":"[data-photo-tag-remove-button]"}},function(b){return{init:function(){},newTagItem:function(){var a=b.viewport(),c=b.tagItem(".new");
return c.length<1&&(c=b.view.tagItem().addClass("new").appendTo(a),b.addSubscriber(c.addController("EasySocial.Controller.Photos.Tag"))),c},"{tagButton} click":function(a){b[a.data("photoTagButton")||"toggle"]()},disabled:!0,enable:function(){b.photo.imageLink().on("click.tagger",function(a){a.preventDefault()}),b.disabled=!1,b.element.addClass("tagging"),a.scrollTo&&a.scrollTo(b.photo.content(),250,{offset:{top:-100}}),b.trigger("tagEnter")},disable:function(){b.photo.imageLink().off("click.tagger"),b.tagSelection().remove(),b.tagItem(".focus").removeClass("focus"),b.disabled=!0,b.element.removeClass("tagging"),b.trigger("tagLeave")
},toggle:function(){b[b.disabled?"enable":"disable"]()},area:{},calculateArea:function(a,c){a||(a="clip"),c||(c={x:0,y:0});var d=b.viewport(),e=d.offset();e.width=d.width(),e.height=d.height(),e.right=e.width+e.left,e.bottom=e.height+e.top;var f=b.area;f.top=(f.startY<=f.endY?f.startY:f.endY)+c.y,f.left=(f.startX<=f.endX?f.startX:f.endX)+c.x,f.width=Math.abs(f.endX-f.startX),f.height=Math.abs(f.endY-f.startY),f.right=f.width+f.left,f.bottom=f.height+f.top,"clip"==a&&(f.top<=e.top&&(f.top=e.top),f.bottom>=e.bottom&&(f.bottom=e.bottom),f.left<=e.left&&(f.left=e.left),f.right>=e.right&&(f.right=e.right),f.width=f.right-f.left,f.height=f.bottom-f.top),"flip"==a&&(f.top<=e.top&&(f.top=e.top),f.left<=e.left&&(f.left=e.left),f.right>=e.right&&(f.right=e.right,f.left=f.right-f.width),f.bottom>=e.bottom&&(f.bottom=e.bottom,f.top=f.bottom-f.height)),f.pixel={top:f.top-e.top,left:f.left-e.left,width:f.width,height:f.height},f.decimal={top:f.pixel.top/e.height,left:f.pixel.left/e.width,width:f.width/e.width,height:f.height/e.height},f.percentage={top:100*f.decimal.top+"%",left:100*f.decimal.left+"%",width:100*f.decimal.width+"%",height:100*f.decimal.height+"%"};
var g=b.options.drawTolerance;return b.autodraw=f.width<g&&f.height<g,f},setPivot:function(a,c,d){var e=b.area;e[a+"X"]=c,e[a+"Y"]=d},drawing:!1,autodraw:!1,drawTag:function(){var a=b.calculateArea();options=b.options,b.autodraw&&(a.endX=a.startX+options.width,a.endY=a.startY+options.height,b.calculateArea("flip",{x:options.width/-2,y:options.height/-2})),b.newTagItem().css(a.percentage).trigger("focusInput")},"{viewport} mousedown":function(c,d){b.disabled||d.target===c[0]&&(d.preventDefault(),b.tagItem(".focus").removeClass("focus"),b.drawing=!0,b.setPivot("start",d.pageX,d.pageY),a(document).on("mousemove.tagger",function(a){b.drawing&&(b.setPivot("end",a.pageX,a.pageY),b.drawTag())
}).on("mouseup.tagger",function(c){b.setPivot("end",c.pageX,c.pageY),b.drawTag(),a(document).off("mousemove.tagger mouseup.tagger")}))},createTag:function(c){var c=a.extend({photo_id:b.photo.id},c,b.area.decimal),d=EasySocial.ajax("site/controllers/photos/createTag",c);return b.trigger("tagCreate",[d,c,b]),d},removeTag:function(a){var c=EasySocial.ajax("site/controllers/photos/removeTag",{id:a});return b.trigger("tagRemove",[c,a,b]),c},addTag:function(c,d,e,f){var g=a.buildHTML(d).addClass("focus").appendTo(b.viewport()),h=a.buildHTML(e).appendTo(b.tagListItemGroup()),i=b.infoTagListItemGroup().children().length;
0==i&&b.infoTagListItemGroup().append(" - ");a.buildHTML(f).appendTo(b.infoTagListItemGroup());b.trigger("tagAdd",[c,g,h,b])},"{self} avatarEnter":function(){b.tagItem().hide(),b.disable()},"{self} avatarLeave":function(){b.tagItem().show()},"{tagRemoveButton} click":function(a,c){var d=a.data("photoTagId");b.removeTag(d),c.stopPropagation()},"{tagRemoveButton} mouseover":function(){b.viewport().addClass("active")},"{tagRemoveButton} mouseout":function(){b.viewport().removeClass("active")}}});EasySocial.Controller("Photos.Tag",{defaultOptions:{view:{menuItem:"site/photos/tags.menu.item"},"{form}":"[data-photo-tag-form]","{title}":"[data-photo-tag-title]","{removeButton}":"[data-photo-tag-remove-button]","{textField}":"[data-photo-tag-input]","{menu}":"[data-photo-tag-menu]","{menuItem}":"[data-photo-tag-menu-item]"}},function(b){return{init:function(){b.data=b.options.data
},"{self} focusInput":function(){b.textField().focus()},"{textField} keyup":a._.debounce(function(d,e){var f=a.trim(b.textField().val());switch(e.keyCode){case c.UP:case c.DOWN:case c.ENTER:case c.ESCAPE:break;default:var g=b.tagger.photo.tags.getTaggedUsers();EasySocial.ajax("site/controllers/friends/suggestPhotoTagging",{search:f,exclude:g,includeme:"1"}).done(b.render())}},250),"{textField} keypress":function(d,e){var f=a.trim(b.textField().val()),g=b.menuItem(".active");switch(e.keyCode){case c.UP:b.menuItem().removeClass("active"),g.length<1?b.menuItem(":last").addClass("active"):g.prev(b.menuItem.selector).addClass("active"),e.preventDefault();
break;case c.DOWN:b.menuItem().removeClass("active"),g.length<1?b.menuItem(":first").addClass("active"):g.next(b.menuItem.selector).addClass("active"),e.preventDefault();break;case c.ENTER:g.length>0?g.trigger("click"):b.create({type:"label",label:f}),b.menu().hide();break;case c.ESCAPE:b.menu().hide()}},"{menuItem} mouseover":function(a){b.menuItem().removeClass("active"),a.addClass("active")},"{menuItem} mouseout":function(){b.menuItem().removeClass("active")},render:a.Enqueue(function(c){var d=b.menu();return!c||c.length<1?(d.hide(),void 0):(d.empty(),a.each(c,function(a,c){b.view.menuItem({item:c}).data("item",c).appendTo(d),d.show()
}),void 0)}),create:function(c){var d=b.element;b.data=c,b.title().html(c.label),""!==a.trim(c.label)&&b.tagger.createTag(c).done(function(a,c,d,e){b.tagger.addTag(a,c,d,e),b.element.remove()}).fail(function(a){alert(a.message),d.remove()})},remove:function(){var a=b.element,c=(b.data||{}).id;return c?(b.tagger.removeTag(c).done(function(){a.remove()}),void 0):a.remove()},"{menuItem} click":function(a){var c=a.data("item");b.create({uid:c.id,type:"person",label:c.screenName})},"{removeButton} click":function(){b.remove()
}}}),b.resolve(d)})}),EasySocial.module("photos/navigation",function(a){a.fn.intersectsWith=function(a,b,c,d){var e=this.offset(),f={top:e.top,left:e.left,bottom:e.top+(sourceHeight=this.height()),right:e.left+(sourceWidth=this.width()),width:sourceWidth,height:sourceHeight},g={top:a,left:b,bottom:a+(d||(d=0)),right:b+(c||(c=0)),width:c,height:d},h=f.left<=g.right&&g.left<=f.right&&f.top<=g.bottom&&g.top<=f.bottom;return h?{reference:f,subject:g}:!1};var b=this,c=EasySocial.Controller("Photos.Navigation",{hostname:"navigation",defaultOptions:{"{navButton}":".es-photo-nav-button","{nextButton}":"[data-photo-next-button]","{prevButton}":"[data-photo-prev-button]"}},function(b){return{init:function(){b.setDirection(window.esPhotosNavigationLastDirection)
},disabled:!1,disable:function(){b.disabled=!0,b.navButton().addClass("disabled")},enable:function(){b.disabled=!1,b.navButton().removeClass("disabled")},setDirection:function(a){b.navButton().removeClass("active"),window.esPhotosNavigationLastDirection=b.currentDirection=a,a&&b[a+"Button"]().addClass("active")},"{window} mousemove":function(c,d){if(!(b.disabled||(b.setDirection(null),b.photo.trigger("directionstop"),a(d.target).parents().filter(b.photo.content.selector).length<1))){var e=b.photo.content().intersectsWith(d.pageY,d.pageX);
if(e){var f=e.subject.left<e.reference.right-e.reference.width/2?"prev":"next";b.setDirection(f),b.photo.trigger("directionmove",[e,f])}}},"{self} tagEnter":function(){b.disable()},"{self} tagLeave":function(){b.enable()},"{self} click":function(c,d){if(!(b.disabled||a(d.target).parents().filter(b.photo.content.selector).length<1)){var e=b.currentDirection;e&&b.trigger("photo"+a.String.capitalize(e),[b.photo])}},"{self} photoNext":function(){},"{self} photoPrev":function(){}}});b.resolve(c)}),EasySocial.module("prism",function(){var b=this;
!function(){var a=/\blang(?:uage)?-(?!\*)(\w+)\b/i,b=self.Prism={util:{type:function(a){return Object.prototype.toString.call(a).match(/\[object (\w+)\]/)[1]},clone:function(a){var c=b.util.type(a);switch(c){case"Object":var d={};for(var e in a)a.hasOwnProperty(e)&&(d[e]=b.util.clone(a[e]));return d;case"Array":return a.slice()}return a}},languages:{extend:function(a,c){var d=b.util.clone(b.languages[a]);for(var e in c)d[e]=c[e];return d},insertBefore:function(a,c,d,e){e=e||b.languages;var f=e[a],g={};for(var h in f)if(f.hasOwnProperty(h)){if(h==c)for(var i in d)d.hasOwnProperty(i)&&(g[i]=d[i]);
g[h]=f[h]}return e[a]=g},DFS:function(a,c){for(var d in a)c.call(a,d,a[d]),"Object"===b.util.type(a)&&b.languages.DFS(a[d],c)}},highlightAll:function(a,c){for(var f,d=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'),e=0;f=d[e++];)b.highlightElement(f,a===!0,c)},highlightElement:function(d,e,f){for(var g,h,i=d;i&&!a.test(i.className);)i=i.parentNode;if(i&&(g=(i.className.match(a)||[,""])[1],h=b.languages[g]),h){d.className=d.className.replace(a,"").replace(/\s+/g," ")+" language-"+g,i=d.parentNode,/pre/i.test(i.nodeName)&&(i.className=i.className.replace(a,"").replace(/\s+/g," ")+" language-"+g);
var j=d.textContent;if(j){j=j.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ");var k={element:d,language:g,grammar:h,code:j};if(b.hooks.run("before-highlight",k),e&&self.Worker){var l=new Worker(b.filename);l.onmessage=function(a){k.highlightedCode=c.stringify(JSON.parse(a.data),g),b.hooks.run("before-insert",k),k.element.innerHTML=k.highlightedCode,f&&f.call(k.element),b.hooks.run("after-highlight",k)},l.postMessage(JSON.stringify({language:k.language,code:k.code}))}else k.highlightedCode=b.highlight(k.code,k.grammar,k.language),b.hooks.run("before-insert",k),k.element.innerHTML=k.highlightedCode,f&&f.call(d),b.hooks.run("after-highlight",k)
}}},highlight:function(a,d,e){return c.stringify(b.tokenize(a,d),e)},tokenize:function(a,c){var e=b.Token,f=[a],g=c.rest;if(g){for(var h in g)c[h]=g[h];delete c.rest}a:for(var h in c)if(c.hasOwnProperty(h)&&c[h]){var i=c[h],j=i.inside,k=!!i.lookbehind,l=0;i=i.pattern||i;for(var m=0;m<f.length;m++){var n=f[m];if(f.length>a.length)break a;if(!(n instanceof e)){i.lastIndex=0;var o=i.exec(n);if(o){k&&(l=o[1].length);var p=o.index-1+l,o=o[0].slice(l),q=o.length,r=p+q,s=n.slice(0,p+1),t=n.slice(r+1),u=[m,1];s&&u.push(s);
var v=new e(h,j?b.tokenize(o,j):o);u.push(v),t&&u.push(t),Array.prototype.splice.apply(f,u)}}}}return f},hooks:{all:{},add:function(a,c){var d=b.hooks.all;d[a]=d[a]||[],d[a].push(c)},run:function(a,c){var d=b.hooks.all[a];if(d&&d.length)for(var f,e=0;f=d[e++];)f(c)}}},c=b.Token=function(a,b){this.type=a,this.content=b};if(c.stringify=function(a,d,e){if("string"==typeof a)return a;if("[object Array]"==Object.prototype.toString.call(a))return a.map(function(b){return c.stringify(b,d,a)}).join("");var f={type:a.type,content:c.stringify(a.content,d,e),tag:"span",classes:["token",a.type],attributes:{},language:d,parent:e};
"comment"==f.type&&(f.attributes.spellcheck="true"),b.hooks.run("wrap",f);var g="";for(var h in f.attributes)g+=h+'="'+(f.attributes[h]||"")+'"';return"<"+f.tag+' class="'+f.classes.join(" ")+'" '+g+">"+f.content+"</"+f.tag+">"},!self.document)return self.addEventListener("message",function(a){var c=JSON.parse(a.data),d=c.language,e=c.code;self.postMessage(JSON.stringify(b.tokenize(e,b.languages[d]))),self.close()},!1),void 0;var d=document.getElementsByTagName("script");d=d[d.length-1],d&&(b.filename=d.src,document.addEventListener&&!d.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",b.highlightAll))
}(),Prism.languages.markup={comment:/&lt;!--[\w\W]*?-->/g,prolog:/&lt;\?.+?\?>/,doctype:/&lt;!DOCTYPE.+?>/,cdata:/&lt;!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?>/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|>|"/g}},punctuation:/\/?>/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi},Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))
}),Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*{))/gi,inside:{punctuation:/[;:]/g}},url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\};]*(?=\s*\{)/g,property:/(\b|\B)[\w-]+(?=\s*:)/gi,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g},Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/gi,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/gi,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}}),Prism.languages.css.selector={pattern:/[^\{\}\s][^\{\}]*(?=\s*\{)/g,inside:{"pseudo-element":/:(?:after|before|first-letter|first-line|selection)|::[-\w]+/g,"pseudo-class":/:[-\w]+(?:\(.*\))?/g,"class":/\.[-:\.\w]+/g,id:/#[-:\.\w]+/g}},Prism.languages.insertBefore("css","ignore",{hexcode:/#[\da-f]{3,6}/gi,entity:/\\[\da-f]{1,8}/gi,number:/[\d%\.]+/g,"function":/(attr|calc|cross-fade|cycle|element|hsla?|image|lang|linear-gradient|matrix3d|matrix|perspective|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|rgba?|rotatex|rotatey|rotatez|rotate3d|rotate|scalex|scaley|scalez|scale3d|scale|skewx|skewy|skew|steps|translatex|translatey|translatez|translate3d|translate|url|var)/gi}),Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|(^|[^:])\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/gi,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,"function":{pattern:/[a-z0-9_]+\(/gi,inside:{punctuation:/\(/}},number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,operator:/[-+]{1,2}|!|&lt;=?|>=?|={1,3}|(&amp;){1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|throw|catch|finally|null|break|continue)\b/g,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/gi,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/gi,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}}),Prism.languages.php=Prism.languages.extend("clike",{keyword:/\b(and|or|xor|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|return|static|switch|use|require|require_once|var|while|abstract|interface|public|implements|extends|private|protected|parent|static|throw|null|echo|print|trait|namespace|use|final|yield|goto|instanceof|finally|try|catch)\b/gi,constant:/\b[A-Z0-9_]{2,}\b/g}),Prism.languages.insertBefore("php","keyword",{delimiter:/(\?>|&lt;\?php|&lt;\?)/gi,variable:/(\$\w+)\b/gi,"package":{pattern:/(\\|namespace\s+|use\s+)[\w\\]+/g,lookbehind:!0,inside:{punctuation:/\\/}}}),Prism.languages.insertBefore("php","operator",{property:{pattern:/(->)[\w]+/g,lookbehind:!0}}),Prism.languages.markup&&(Prism.hooks.add("before-highlight",function(a){"php"===a.language&&(a.tokenStack=[],a.code=a.code.replace(/(?:&lt;\?php|&lt;\?|<\?php|<\?)[\w\W]*?(?:\?&gt;|\?>)/gi,function(b){return a.tokenStack.push(b),"{{{PHP"+a.tokenStack.length+"}}}"
}))}),Prism.hooks.add("after-highlight",function(a){if("php"===a.language){for(var c,b=0;c=a.tokenStack[b];b++)a.highlightedCode=a.highlightedCode.replace("{{{PHP"+(b+1)+"}}}",Prism.highlight(c,a.grammar,"php"));a.element.innerHTML=a.highlightedCode}}),Prism.hooks.add("wrap",function(a){"php"===a.language&&"markup"===a.type&&(a.content=a.content.replace(/(\{\{\{PHP[0-9]+\}\}\})/g,'<span class="token php">$1</span>'))}),Prism.languages.insertBefore("php","comment",{markup:{pattern:/(&lt;|<)[^?]\/?(.*?)(>|&gt;)/g,inside:Prism.languages.markup},php:/\{\{\{PHP[0-9]+\}\}\}/g})),Prism.languages.insertBefore("php","variable",{"this":/\$this/g,global:/\$_?(GLOBALS|SERVER|GET|POST|FILES|REQUEST|SESSION|ENV|COOKIE|HTTP_RAW_POST_DATA|argc|argv|php_errormsg|http_response_header)/g,scope:{pattern:/\b[\w\\]+::/g,inside:{keyword:/(static|self|parent)/,punctuation:/(::|\\)/}}}),Prism.languages.coffeescript=Prism.languages.extend("javascript",{"block-comment":/([#]{3}\s*\r?\n(.*\s*\r*\n*)\s*?\r?\n[#]{3})/g,comment:/(\s|^)([#]{1}[^#^\r^\n]{2,}?(\r?\n|$))/g,keyword:/\b(this|window|delete|class|extends|namespace|extend|ar|let|if|else|while|do|for|each|of|return|in|instanceof|new|with|typeof|try|catch|finally|null|undefined|break|continue)\b/g}),Prism.languages.insertBefore("coffeescript","keyword",{"function":{pattern:/[a-z|A-z]+\s*[:|=]\s*(\([.|a-z\s|,|:|{|}|\"|\'|=]*\))?\s*-&gt;/gi,inside:{"function-name":/[_?a-z-|A-Z-]+(\s*[:|=])| @[_?$?a-z-|A-Z-]+(\s*)| /g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g}},"attr-name":/[_?a-z-|A-Z-]+(\s*:)| @[_?$?a-z-|A-Z-]+(\s*)| /g}),Prism.languages.scss=Prism.languages.extend("css",{comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},atrule:/@[\w-]+(?=\s+(\(|\{|;))/gi,url:/([-a-z]+-)*url(?=\()/gi,selector:/([^@;\{\}\(\)]?([^@;\{\}\(\)]|&amp;|\#\{\$[-_\w]+\})+)(?=\s*\{(\}|\s|[^\}]+(:|\{)[^\}]+))/gm}),Prism.languages.insertBefore("scss","atrule",{keyword:/@(if|else if|else|for|each|while|import|extend|debug|warn|mixin|include|function|return)|(?=@for\s+\$[-_\w]+\s)+from/i}),Prism.languages.insertBefore("scss","property",{variable:/((\$[-_\w]+)|(#\{\$[-_\w]+\}))/i}),Prism.languages.insertBefore("scss","ignore",{placeholder:/%[-_\w]+/i,statement:/\B!(default|optional)\b/gi,"boolean":/\b(true|false)\b/g,"null":/\b(null)\b/g,operator:/\s+([-+]{1,2}|={1,2}|!=|\|?\||\?|\*|\/|\%)\s+/g}),Prism.languages.bash=Prism.languages.extend("clike",{comment:{pattern:/(^|[^"{\\])(#.*?(\r?\n|$))/g,lookbehind:!0},string:{pattern:/("|')(\\?[\s\S])*?\1/g,inside:{property:/\$([a-zA-Z0-9_#\?\-\*!@]+|\{[^\}]+\})/g}},keyword:/\b(if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)\b/g}),Prism.languages.insertBefore("bash","keyword",{property:/\$([a-zA-Z0-9_#\?\-\*!@]+|\{[^}]+\})/g}),Prism.languages.insertBefore("bash","comment",{important:/(^#!\s*\/bin\/bash)|(^#!\s*\/bin\/sh)/g}),Prism.languages.c=Prism.languages.extend("clike",{keyword:/\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/g,operator:/[-+]{1,2}|!=?|&lt;{1,2}=?|&gt;{1,2}=?|\-&gt;|={1,2}|\^|~|%|(&amp;){1,2}|\|?\||\?|\*|\//g}),Prism.languages.insertBefore("c","keyword",{property:/#\s*[a-zA-Z]+/g}),Prism.languages.cpp=Prism.languages.extend("c",{keyword:/\b(alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|delete\[\]|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|new\[\]|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/g,operator:/[-+]{1,2}|!=?|&lt;{1,2}=?|&gt;{1,2}=?|\-&gt;|:{1,2}|={1,2}|\^|~|%|(&amp;){1,2}|\|?\||\?|\*|\/|\b(and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/g}),Prism.languages.sql={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|((--)|(\/\/)).*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,keyword:/\b(ACTION|ADD|AFTER|ALGORITHM|ALTER|ANALYZE|APPLY|AS|AS|ASC|AUTHORIZATION|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADE|CASCADED|CASE|CHAIN|CHAR VARYING|CHARACTER VARYING|CHECK|CHECKPOINT|CLOSE|CLUSTERED|COALESCE|COLUMN|COLUMNS|COMMENT|COMMIT|COMMITTED|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS|CONTAINSTABLE|CONTINUE|CONVERT|CREATE|CROSS|CURRENT|CURRENT_DATE|CURRENT_TIME|CURRENT_TIMESTAMP|CURRENT_USER|CURSOR|DATA|DATABASE|DATABASES|DATETIME|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DOUBLE PRECISION|DROP|DUMMY|DUMP|DUMPFILE|DUPLICATE KEY|ELSE|ENABLE|ENCLOSED BY|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPE|ESCAPED BY|EXCEPT|EXEC|EXECUTE|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR|FOR EACH ROW|FORCE|FOREIGN|FREETEXT|FREETEXTTABLE|FROM|FULL|FUNCTION|GEOMETRY|GEOMETRYCOLLECTION|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|IDENTITY|IDENTITY_INSERT|IDENTITYCOL|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTO|INVOKER|ISOLATION LEVEL|JOIN|KEY|KEYS|KILL|LANGUAGE SQL|LAST|LEFT|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONGBLOB|LONGTEXT|MATCH|MATCHED|MEDIUMBLOB|MEDIUMINT|MEDIUMTEXT|MERGE|MIDDLEINT|MODIFIES SQL DATA|MODIFY|MULTILINESTRING|MULTIPOINT|MULTIPOLYGON|NATIONAL|NATIONAL CHAR VARYING|NATIONAL CHARACTER|NATIONAL CHARACTER VARYING|NATIONAL VARCHAR|NATURAL|NCHAR|NCHAR VARCHAR|NEXT|NO|NO SQL|NOCHECK|NOCYCLE|NONCLUSTERED|NULLIF|NUMERIC|OF|OFF|OFFSETS|ON|OPEN|OPENDATASOURCE|OPENQUERY|OPENROWSET|OPTIMIZE|OPTION|OPTIONALLY|ORDER|OUT|OUTER|OUTFILE|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREV|PRIMARY|PRINT|PRIVILEGES|PROC|PROCEDURE|PUBLIC|PURGE|QUICK|RAISERROR|READ|READS SQL DATA|READTEXT|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEATABLE|REPLICATION|REQUIRE|RESTORE|RESTRICT|RETURN|RETURNS|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROWCOUNT|ROWGUIDCOL|ROWS?|RTREE|RULE|SAVE|SAVEPOINT|SCHEMA|SELECT|SERIAL|SERIALIZABLE|SESSION|SESSION_USER|SET|SETUSER|SHARE MODE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|START|STARTING BY|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLE|TABLES|TABLESPACE|TEMPORARY|TEMPTABLE|TERMINATED BY|TEXT|TEXTSIZE|THEN|TIMESTAMP|TINYBLOB|TINYINT|TINYTEXT|TO|TOP|TRAN|TRANSACTION|TRANSACTIONS|TRIGGER|TRUNCATE|TSEQUAL|TYPE|TYPES|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNPIVOT|UPDATE|UPDATETEXT|USAGE|USE|USER|USING|VALUE|VALUES|VARBINARY|VARCHAR|VARCHARACTER|VARYING|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH|WITH ROLLUP|WITHIN|WORK|WRITE|WRITETEXT)\b/gi,"boolean":/\b(TRUE|FALSE|NULL)\b/gi,number:/\b-?(0x)?\d*\.?[\da-f]+\b/g,operator:/\b(ALL|AND|ANY|BETWEEN|EXISTS|IN|LIKE|NOT|OR|IS|UNIQUE|CHARACTER SET|COLLATE|DIV|OFFSET|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b|[-+]{1}|!|=?&lt;|=?&gt;|={1}|(&amp;){1,2}|\|?\||\?|\*|\//gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[;[\]()`,.]/g},Prism.languages.http={"request-line":{pattern:/^(POST|GET|PUT|DELETE|OPTIONS|PATCH|TRACE|CONNECT)\b\shttps?:\/\/\S+\sHTTP\/[0-9.]+/g,inside:{property:/^\b(POST|GET|PUT|DELETE|OPTIONS|PATCH|TRACE|CONNECT)\b/g,"attr-name":/:\w+/g}},"response-status":{pattern:/^HTTP\/1.[01] [0-9]+.*/g,inside:{property:/[0-9]+[A-Z\s-]+$/g}},keyword:/^[\w-]+:(?=.+)/gm};
var c={"application/json":Prism.languages.javascript,"application/xml":Prism.languages.markup,"text/xml":Prism.languages.markup,"text/html":Prism.languages.markup};for(var d in c)if(c[d]){var e={};e[d]={pattern:new RegExp("(content-type:\\s*"+d+"[\\w\\W]*?)\\n\\n[\\w\\W]*","gi"),lookbehind:!0,inside:{rest:c[d]}},Prism.languages.insertBefore("http","keyword",e)}Prism.languages.ruby=Prism.languages.extend("clike",{comment:/#[^\r\n]*(\r?\n|$)/g,keyword:/\b(alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/g,builtin:/\b(Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|File|Fixnum|Fload|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/,constant:/\b[A-Z][a-zA-Z_0-9]*[?!]?\b/g}),Prism.languages.insertBefore("ruby","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0},variable:/[@$&]+\b[a-zA-Z_][a-zA-Z_0-9]*[?!]?\b/g,symbol:/:\b[a-zA-Z_][a-zA-Z_0-9]*[?!]?\b/g}),Prism.languages.csharp=Prism.languages.extend("clike",{keyword:/\b(abstract|as|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|virtual|void|volatile|while|add|alias|ascending|async|await|descending|dynamic|from|get|global|group|into|join|let|orderby|partial|remove|select|set|value|var|where|yield)\b/g,string:/@?("|')(\\?.)*?\1/g,preprocessor:/^\s*#.*/gm,number:/\b-?(0x)?\d*\.?\d+\b/g}),Prism.highlightAll(),b.resolve()
}),EasySocial.module("privacy",function(){var b=this;EasySocial.require().library("dialog").view("admin/profiles/form.privacy.custom.item").done(function(a){EasySocial.Controller("Profiles.Form.Privacy",{defaultOptions:{path:"admin","{selection}":".privacySelection","{browseButton}":".browseButton","{userDeleteButton}":".userDeleteButton","{customContainer}":".customContainer",view:{customItem:"admin/profiles/form.privacy.custom.item"}}},function(b){return{init:function(){},"{selection} change":function(c){{var e=a(c).val();
a(c).attr("name")}"custom"==e?b.customContainer().show():b.customContainer().hide()},"{userDeleteButton} click":function(b){a(b).parents("li").remove()},"{browseButton} click":function(c){var e=a(c).attr("id"),f=a(c).data("index"),g=a.rootPath+"administrator/index.php?option=com_easysocial&view=users&layout=listing&show=iframe";"site"==b.options.path&&(g=a.rootPath+"index.php?option=com_easysocial&view=friends&layout=listing&show=iframe"),a.dialog({title:"Browse Users & Groups",content:g,body:{css:{width:400,height:300}},buttons:[{name:"Assign",click:function(){var c=a(".foundryDialog").find("iframe").contents().find("input:checked");
if(c.length>0)for(var d=0;d<c.length;d++){var g=a(c[d]).attr("name");if("toggle"!=g){var h=a(c[d]).val(),i=a(".foundryDialog").find("iframe").contents().find('input[name="user_'+h+'"]').val(),j=a("ul#privacy_ul"+f+" input:hidden"),k=!0;if(j.length>0)for(var l=0;l<j.length;l++)if(a(j[l]).val()==h){k=!1;break}k&&(html=b.view.customItem({userName:i,eleName:e,userId:h}),a("ul#privacy_ul"+f).append(html))}}a.dialog().close()}},{name:"Close",click:function(){a.dialog().close()}}]})}}}),b.resolve()})}),EasySocial.module("sharing",function(a){var b=this;
EasySocial.require().library("textboxlist").done(function(){EasySocial.Controller("Sharing",{defaultOptions:{"{vendors}":"[data-sharing-vendor]","{emailForm}":"[data-sharing-email]"}},function(b){return{init:function(){b.initLinks(),b.initEmail()},initLinks:function(){a.each(b.vendors(),function(b,c){if(c=a(c),!c.data("loaded")){var d=c.attr("href");c.data("href",d),c.attr("href","javascript:void(0);"),c.attr("loaded",!0)}})},initEmail:function(){a.each(b.emailForm(),function(c,d){d=a(d),d.data("loaded")||(b.addPlugin("email"),d.attr("loaded",!0))
})},"{vendors} click":function(a){var c=a.data("options")||"";window.open(a.data("href"),"",c)}}}),a.template("sharing/recipientContent",'[%= title %]<input type="hidden" name="items" value="[%= title %]" />'),EasySocial.Controller("Sharing.Email",{defaultOptions:{token:"","{container}":"[data-sharing-email]","{frames}":"[data-sharing-email-frame]","{recipients}":"[data-sharing-email-recipients]","{input}":"[data-sharing-email-input]","{content}":"[data-sharing-email-content]","{send}":"[data-sharing-email-send]","{frames}":"[data-sharing-email-frame]","{frameForm}":"[data-sharing-email-form]","{frameSending}":"[data-sharing-email-sending]","{frameDone}":"[data-sharing-email-done]","{frameFail}":"[data-sharing-email-fail]","{failMsg}":"[data-sharing-email-fail-msg]"}},function(b){return{init:function(){b.options.token=b.container().data("token");
b.recipients().textboxlist({component:"es",view:{itemContent:"sharing/recipientContent"}});b.originalPosition=b.container().css("position")},getRecipients:function(){var c=b.recipients().controller("textboxlist").getAddedItems(),d=[];a.each(c,function(a,b){d.push(b.title)});var e=b.input().val();return d.length<1&&!a.isEmpty(e)&&d.push(e),d},getContent:function(){return b.content().val()},"{send} click":function(a){if(a.enabled()){a.disabled(!0),b.frames().hide(),b.frameSending().show();var d=b.options.token,e=b.getRecipients(),f=b.getContent();
b.submitForm(d,e,f).done(function(){b.frames().hide(),b.frameDone().show(),setTimeout(function(){b.recipients().controller("textboxlist").clearItems(),b.content().val(""),b.frameDone().hide(),b.frameForm().show()},1e3)}).fail(function(a){b.frames().hide(),b.frameFail().show(),b.frameForm().show(),void 0!==a&&b.failMsg().html(a)}).always(function(){a.enabled(!0)})}},"{input} keypress":function(a,c){return 44===c.which?(b.recipients().controller("textboxlist").addItem(a.val()),a.val(""),!1):void 0},submitForm:function(a,b,c){return EasySocial.ajax("site/controllers/sharing/send",{token:a,recipients:b,content:c})
}}}),b.resolve()})}),EasySocial.module("site/activities/activities",function(){var b=this;EasySocial.require().script("site/activities/sidebar","site/activities/sidebar.item").view("site/loading/small").done(function(){EasySocial.Controller("Activities",{defaultOptions:{items:null,"{container}":"[data-activities]","{contentTitle}":"[data-activities-content-title]","{content}":"[data-activities-content]","{sidebar}":"[data-activities-sidebar]","{sidebarItem}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){a.sidebar().implement(EasySocial.Controller.Activities.Sidebar,{"{parent}":a}),a.sidebarItem().implement(EasySocial.Controller.Activities.Sidebar.Item,{"{parent}":a})
},updatingContents:function(){a.content().html(a.view.loadingContent())},updateContent:function(b,c){a.content().html(b),a.contentTitle().html(c)}}}),b.resolve()})}),EasySocial.module("site/activities/sidebar",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Activities.Sidebar",{defaultOptions:{"{menuItem}":"[data-sidebar-menu]"}},function(b){return{init:function(){},"{menuItem} click":function(c){b.menuItem().removeClass("active"),a(c).addClass("active")}}}),b.resolve()})}),EasySocial.module("site/activities/sidebar.item",function(){var b=this;
EasySocial.require().library("history").done(function(){EasySocial.Controller("Activities.Sidebar.Item",{defaultOptions:{}},function(a){return{init:function(){},"{self} click":function(){{var d=a.element.data("type"),e=a.element.data("url"),f=a.element.data("title");a.element.data("description")}History.pushState({state:1},f,e),a.parent.updatingContents(),EasySocial.ajax("site/controllers/activities/getActivities",{type:d}).done(function(b){a.parent.updateContent(b,f)}).fail(function(a){console.log(a)}),a.parent.updateContent()
}}}),b.resolve()})}),EasySocial.module("site/activities/apps",function(){var b=this;EasySocial.require().view("site/loading/small").language("COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY").done(function(a){EasySocial.Controller("Activities.Apps.List",{defaultOptions:{"{item}":"[data-hidden-app-item]","{actorItem}":"[data-hidden-actor-item]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Activities.Apps.Item),a.actorItem().implement(EasySocial.Controller.Activities.Actors.Item)
}}}),EasySocial.Controller("Activities.Actors.Item",{defaultOptions:{id:"",actor:"","{unhideLink}":"[data-hidden-actor-unhide]","{content}":"[data-hidden-actor-content]",view:{loadingContent:"site/loading/small"}}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.actor=b.element.data("actor")},"{unhideLink} click":function(){EasySocial.ajax("site/controllers/activities/unhideactor",{actor:b.options.actor,id:b.options.id}).done(function(){b.content().html(a.language("COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY"))
}).fail(function(a){console.log(a)})}}}),EasySocial.Controller("Activities.Apps.Item",{defaultOptions:{id:"",context:"","{unhideLink}":"[data-hidden-app-unhide]","{content}":"[data-hidden-app-content]",view:{loadingContent:"site/loading/small"}}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.context=b.element.data("context")},"{unhideLink} click":function(){EasySocial.ajax("site/controllers/activities/unhideapp",{context:b.options.context,id:b.options.id}).done(function(){b.content().html(a.language("COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY"))
}).fail(function(a){console.log(a)})}}}),b.resolve()})}),EasySocial.module("site/activities/item",function(){var b=this;EasySocial.require().script().done(function(a){EasySocial.Controller("Activities.Item",{defaultOptions:{"{toggle}":"[data-activity-toggle]","{deleteBtn}":"[data-activity-delete]"}},function(b){return{init:function(){},"{toggle} click":function(c){EasySocial.ajax("site/controllers/activities/toggle",{id:b.element.data("id"),curState:b.element.data("current-state")}).done(function(d,e){a(c).text(d),b.element.data("current-state",e),e?b.element.children("div.es-stream").addClass("isHidden"):b.element.children("div.es-stream").removeClass("isHidden")
}).fail(function(a){console.log(a)})},"{deleteBtn} click":function(){var a=b.element.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/activities/confirmDelete"),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/activities/delete",{id:a}).done(function(){b.element.fadeOut(),EasySocial.dialog().close()})}}})}}}),b.resolve()})}),EasySocial.module("site/activities/list",function(){var b=this;EasySocial.require().view("site/loading/small","site/activities/loadbutton").language("COM_EASYSOCIAL_ACTIVITY_LOG_LOAD_PREVIOUS_STREAM_ITEMS").script("site/activities/item").done(function(a){EasySocial.Controller("Activities.List",{defaultOptions:{"{item}":"[data-activity-item]","{pagination}":"[data-activity-pagination]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/activities/loadbutton"}}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Activities.Item),b.on("scroll.activities",window,a._.debounce(function(){b.loading||b.pagination().visible()&&b.loadMore()
},250))},"{pagination} click":function(){b.loadMore()},loadMore:function(){var c=a("[data-sidebar-menu].active").data("type"),d=b.pagination().data("startlimit");""!=d&&(b.loading=!0,b.pagination().html(b.view.loadingContent({content:""})),EasySocial.ajax("site/controllers/activities/getActivities",{limitstart:d,loadmore:"1",type:c}).done(function(a,c){b.pagination().data("startlimit",c),b.pagination().before(a),b.item().implement(EasySocial.Controller.Activities.Item),""==c?b.pagination().html(""):b.pagination().html(b.view.loadmoreContent())
}).fail(function(a){return a}).always(function(){b.loading=!1}))}}}),b.resolve()})}),EasySocial.module("site/albums/all",function(){var b=this;EasySocial.require().library("history").done(function(a){EasySocial.Controller("Albums.All.Browser",{defaultOptions:{"{sort}":"[data-albums-sort]","{contents}":"[data-albums-content]"}},function(b){return{init:function(){},setActiveSort:function(c){b.sort().removeClass("active"),a(c).addClass("active")},"{sort} click":function(c,d){d.preventDefault(),b.setActiveSort(c),a(c).route(),b.contents().addClass("is-loading"),b.contents().html("&nbsp;");
var e=c.data("albums-sort-type");EasySocial.ajax("site/controllers/albums/getAlbums",{sort:e}).done(function(a){b.contents().html(a)})}}}),b.resolve()})}),EasySocial.module("site/apps/apps",function(){var b=this;EasySocial.require().library("history").view("site/loading/small").done(function(a){EasySocial.Controller("Apps",{defaultOptions:{requireTerms:!0,"{content}":"[data-apps-listing]","{sort}":"[data-apps-sort]","{filter}":"[data-apps-filter]","{filterLink}":"[data-apps-filter-link]","{item}":"[data-apps-item]","{sorting}":"[data-apps-sorting]","{title}":"[data-page-apps-title]",view:{loading:"site/loading/small"}}},function(b){return{init:function(){b.initAppItem()
},initAppItem:function(){b.item().implement(EasySocial.Controller.Apps.Item,{requireTerms:b.options.requireTerms})},"{filterLink} click":function(a,b){b.preventDefault()},"{filter} click":function(c){b.sort().removeClass("active"),b.filter().removeClass("active"),c.addClass("active"),c.find("a").route();var e=c.data("apps-filter-type"),f=c.data("apps-filter-group"),g=c.find("a").attr("title");b.title().html(g),b.options.filter=e,"mine"==e?b.sorting().hide():b.sorting().show(),EasySocial.ajax("site/controllers/apps/getApps",{filter:e,group:f},{beforeSend:function(){b.sort(".alphabetical").addClass("active"),b.content().html(b.view.loading())
}}).done(function(c){b.content().toggleClass("is-empty",a(c).hasClass("empty")),b.content().html(c),b.initAppItem()})},"{sort} click":function(a){var d=a.data("apps-sort-type"),e=a.data("apps-sort-url"),f=a.data("apps-sort-group");History.pushState({state:1},"",e),b.sort().removeClass("active"),a.addClass("active"),EasySocial.ajax("site/controllers/apps/getApps",{sort:d,filter:b.options.filter,group:f},{beforeSend:function(){b.content().html(b.view.loading())}}).done(function(a){b.content().html(a),b.initAppItem()
})}}}),EasySocial.Controller("Apps.Item",{defaultOptions:{id:null,requireTerms:!0,"{install}":"[data-apps-item-install]","{installed}":"[data-apps-item-installed]","{settings}":"[data-apps-item-settings]",view:{installAppForm:"site/apps/dialog.install",uninstallAppForm:"site/apps/dialog.uninstall"}}},function(a){return{init:function(){a.element.data("id")&&(a.options.id=a.element.data("id"))},"{install} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/apps/getTnc"),bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()
},"{installButton} click":function(){var c=!a.options.requireTerms||this.agreeCheckbox().is(":checked");c?(this.termsError().hide(),a.installApp()):this.termsError().show()}}})},installApp:function(){var b=EasySocial.ajax("site/controllers/apps/installApp",{id:a.options.id});EasySocial.dialog({content:b,bindings:{"{closeButton} click":function(){EasySocial.dialog().close()}}}),b.done(function(){a.install().enabled(!0),a.install().hide(),a.installed().show(),a.settings().hide()})},"{settings} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/apps/settings",{id:a.options.id}),bindings:{}})
},"{installed} click":function(b){b.enabled()&&(b.disabled(!0),EasySocial.dialog({content:EasySocial.ajax("site/views/apps/confirmUninstall"),bindings:{"{parent.closeButton} click":function(){a.installed().enabled(!0)},"{cancelButton} click":function(){a.installed().enabled(!0),EasySocial.dialog().close()},"{uninstallButton} click":function(){a.uninstallApp()}}}))},uninstallApp:function(){var b=EasySocial.ajax("site/controllers/apps/uninstallApp",{id:a.options.id});EasySocial.dialog({content:b,bindings:{"{closeButton} click":function(){EasySocial.dialog().close()
}}}),b.done(function(){a.installed().enabled(!0),a.installed().hide(),a.settings().hide(),a.install().show()})}}}),b.resolve()})}),EasySocial.module("site/badges/badge",function(){var b=this;EasySocial.Controller("Badges.Badge",{defaultOptions:{id:0,total:0,"{achieversList}":"[data-badge-achievers-list]","{achiever}":"[data-badge-achievers-achiever]","{loadIndicator}":"[data-badge-achievers-loading]","{loadButton}":"[data-badge-achievers-load]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.total=a.element.data("total-achievers")
},"{loadButton} click":function(b){var c=a.achiever().length;b.enabled()&&c<a.options.total&&(b.disabled(!0),b.hide(),a.loadIndicator().show(),EasySocial.ajax("site/controllers/badges/loadAchievers",{id:a.options.id,start:c}).done(function(c){a.achieversList().append(c),b.enabled(!0),a.loadIndicator().hide(),a.achiever().length<a.options.total&&b.show()}).fail(function(){}))},loadAchievers:function(){}}}),b.resolve()}),EasySocial.module("site/comments/control",function(a){var b=this;EasySocial.Controller("CommentsControl",{defaultOptions:{interval:30}},function(b){return{init:function(){b.startUpdate()
},$Blocks:{},startUpdate:function(){b.options.monitoring=!0,b.updateBlocks()},stopUpdate:function(){b.options.monitoring=!1},updateBlocks:function(){(b.updateBlocks=a._.debounce(function(){var c=b.populate();return b.options.monitoring?(EasySocial.ajax("site/controllers/comments/getUpdates",{data:c}).done(function(c){a.each(c,function(c,d){a.each(d,function(a,d){var e=b.$Blocks[c][a];e._destroyed||e.updateComment(d)})})}).always(function(){b.updateBlocks()}),void 0):!1},1e3*b.options.interval))()},register:function(a){var c=a.options.group,d=a.options.element,e=a.options.streamid,f=a.options.uid,g=a.options.verb;
""==e&&(e="0");var h=d+"."+c+"."+g;void 0===b.$Blocks[h]&&(b.$Blocks[h]={});var i=e+"."+f;b.$Blocks[h][i]=a,a.trigger("commentBlockRegistered")},populate:function(){var c={};return a.each(b.$Blocks,function(b,d){c[b]={},a.each(d,function(a,d){c[b][a]=d._export()})}),c}}}),EasySocial.ready(function(){EasySocial.Comments=a("body").addController("EasySocial.Controller.CommentsControl"),b.resolve()})}),EasySocial.module("site/comments/frame",function(a){var b=this;EasySocial.require().library("mentions").script("site/comments/item","uploader/uploader").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language("COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL","COM_EASYSOCIAL_COMMENTS_STATUS_SAVING","COM_EASYSOCIAL_COMMENTS_STATUS_SAVED").done(function(){EasySocial.Controller("Comments",{defaultOptions:{group:"user",element:"stream",verb:"null",uid:0,enterkey:"submit",url:"",streamid:"","{actionContent}":"[data-action-contents-comments]","{actionLink}":"[data-stream-action-comments]","{stat}":"[data-comments-stat]","{load}":"[data-comments-load]","{list}":"[data-comments-list]","{item}":"[data-comments-item]","{form}":"[data-comments-form]"}},function(b){return{init:function(){b.options.uid=b.element.data("uid")||b.options.uid,b.options.element=b.element.data("element")||b.options.element,b.options.group=b.element.data("group")||b.options.group,b.options.verb=b.element.data("verb")||b.options.verb,b.options.url=b.element.data("url")||b.options.url,b.options.streamid=b.element.data("streamid")||b.options.streamid,b.$Stat=b.addPlugin("stat"),b.$Load=b.addPlugin("load"),b.$List=b.addPlugin("list"),b.$Form=b.addPlugin("form"),EasySocial.require().script("site/comments/control").done(function(){EasySocial.Comments.register(b)
}),b.trigger("commentInit",[b])},$Comments:{},registerComment:function(a){var c=a.options.id;b.$Comments[c]=a},"{actionLink} click":function(){b.actionContent().toggle()},_export:function(){var c={total:b.$Stat.total(),count:b.$Stat.count(),ids:a._.keys(b.$Comments)};return c},updateComment:function(c){var d=[];a.each(c.ids,function(c,e){if(e!==!0)if(e===!1)b.trigger("commentDeleted",[c]);else{var f=!1;a.each(b.$Comments,function(a){return a>c?(b.$List.addToList(e,a,!1),f=!0,!1):void 0}),f||b.$List.addToList(e,"append",!1),d.push(e)
}}),b.$Stat.total(c.total),b.trigger("oldCommentsLoaded",[d])},"{self} show":function(){b.element.show(),b.$Form.input().focus()}}}),EasySocial.Controller("Comments.List",{defaultOptions:{"{list}":"[data-comments-list]","{item}":"[data-comments-item]"}},function(b){return{init:function(){b.initItemController(b.item(),!1)},initItemController:function(a,c){return a.addController("EasySocial.Controller.Comments.Item",{controller:{parent:b.parent},isNew:c}),a},"{parent} newCommentSaved":function(a,c,d){b.addToList(d)
},addToList:function(c,d,e){if(d=void 0===d?"append":d,e=void 0===e?!0:e,c=a(c),b.initItemController(c,e),"append"==d||"prepend"==d){var f="append"==d?":last":":first",g="append"==d?"after":"before";0===b.item().length?b.list().html(c):b.item(f)[g](c)}else{var h=b.parent.$Comments[d];void 0!==h&&h.element.before(c)}b.parent.actionContent().show()},"{parent} commentDeleted":function(a,c,d){void 0!==b.parent.$Comments[d]&&(b.parent.$Comments[d].element.remove(),delete b.parent.$Comments[d])}}}),EasySocial.Controller("Comments.Stat",{defaultOptions:{"{stats}":"[data-comments-stats]",count:0,total:0,limit:10}},function(b){return{init:function(){b.options.count=b.element.data("count"),b.options.total=b.element.data("total")
},total:function(c){return void 0!==c&&(b.options.total=parseInt(c),b.stats().text(a.language("COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL",b.count(),b.total()))),b.options.total},count:function(c){return void 0!==c&&(b.options.count=parseInt(c),b.stats().text(a.language("COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL",b.count(),b.total()))),b.options.count},getNextCycle:function(){var a=Math.max(b.total()-b.count()-b.options.limit,0),c=b.total()-b.count()-a;return{start:a,limit:c}},"{parent} oldCommentsLoaded":function(a,c,d){var e=d.length;
b.count(b.count()+e)},"{parent} newCommentSaved":function(){b.total(b.total()+1),b.count(b.count()+1)},"{parent} commentDeleted":function(){b.total(b.total()-1),b.count(b.count()-1)}}}),EasySocial.Controller("Comments.Load",{defaultOptions:{"{load}":"[data-comments-load]","{loadMore}":"[data-comments-load-loadMore]"}},function(b){return{init:function(){},"{loadMore} click":function(c){if(c.enabled()){c.disabled(!0);var e=b.parent.$Stat.getNextCycle();if(0==e.limit)return!1;b.loadComments(e.start,e.limit).done(function(d){var f=d.slice().reverse();
a.each(f,function(a,c){b.parent.$List.addToList(c,"prepend",!1)}),b.parent.trigger("oldCommentsLoaded",[d]),c.enabled(!0),0==e.start&&b.load().hide()}).fail(function(a){b.parent.trigger("oldCommentsLoadError",[a])})}},loadComments:function(a,c){return c=c||10,EasySocial.ajax("site/controllers/comments/load",{uid:b.parent.options.uid,element:b.parent.options.element,group:b.parent.options.group,verb:b.parent.options.verb,start:a,length:c})}}}),EasySocial.Controller("Comments.Form",{defaultOptions:{"{editorHeader}":"[data-comment-form-header]","{editorArea}":"[data-comment-form-editor-area]","{input}":"[data-comments-form-input]","{submit}":"[data-comments-form-submit]","{status}":"[data-comments-form-status]","{smileyLink}":"[data-comment-smileys]","{smileyItem}":"[data-comment-smiley-item]","{attachmentQueue}":"[data-comment-attachment-queue]","{attachmentProgress}":"[data-comment-attachment-progress-bar]","{attachmentBackground}":"[data-comment-attachment-background]","{attachmentRemove}":"[data-comment-attachment-remove]","{attachmentItem}":"[data-comment-attachment-item]","{attachmentDelete}":"[data-comment-attachment-delete]","{uploaderForm}":"[data-uploader-form]","{itemTemplate}":"[data-comment-attachment-template]",attachmentIds:[],view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(b,c,d,e){return{init:function(){e=b.parent,b.setMentionsLayout(),e.options.attachments&&b.implementAttachments()
},attachmentTemplate:null,getAttachmentTemplate:function(){b.attachmentTemplate||(b.attachmentTemplate=b.itemTemplate().detach());var c=a(b.attachmentTemplate).clone().html();return a(c)},implementAttachments:function(){b.editorArea().implement(EasySocial.Controller.Uploader,{temporaryUpload:!0,query:"type=comments",type:"comments",extensionsAllowed:"jpg,png,gif"})},"{smileyItem} click":function(a){var d=a.data("comment-smiley-value"),e=a.parents("[data-comments-item-editframe]").length>0,f=b.input();e&&(f=a.parents("[data-comments-item-editframe]").find("[data-comments-item-edit-input]"));
var g=f.val();g+=" "+d,f.val(g)},"{smileyLink} click":function(a){return a.hasClass("active")?(a.removeClass("active"),void 0):(a.addClass("active"),void 0)},"{attachmentDelete} click":function(a){var d=a.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/comments/confirmDeleteCommentAttachment",{id:d}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/comments/deleteAttachment",{id:d}).done(function(){var c=a.parents(b.attachmentItem.selector);c.remove(),EasySocial.dialog().close()
})}}})},"{attachmentRemove} click":function(d){var f=d.parents(b.attachmentItem.selector);c.attachmentIds=a.without(c.attachmentIds,f.data("id")),f.remove(),b.attachmentItem().length<1&&b.attachmentQueue().removeClass("has-attachments")},"{uploaderForm} FilesAdded":function(c,d,e,f){a.each(f,function(a,c){var d=b.getAttachmentTemplate();b.attachmentQueue().addClass("has-attachments"),d.attr("id",c.id).addClass("is-uploading").prependTo(b.attachmentQueue())})},"{uploaderForm} FileUploaded":function(d,e,f,g,h){var i=a("#"+g.id);
b.attachmentBackground.inside(i).css("background-image","url("+h.preview+")"),i.removeClass("is-uploading"),i.data("id",h.id),c.attachmentIds.push(h.id)},"{uploaderForm} UploadProgress":function(c,d,e,f){var g=a("#"+f.id),h=b.attachmentProgress.inside(g);h.css("width",f.percent+"%")},"{input} keypress":function(a,c){13==c.keyCode&&("submit"!==b.parent.options.enterkey||c.shiftKey||c.altKey||c.ctrlKey||c.metaKey||b.submitComment(),"newline"===b.parent.options.enterkey&&(c.shiftKey||c.altKey||c.ctrlKey||c.metaKey)&&b.submitComment())
},"{submit} click":function(a){a.enabled()&&b.submitComment()},setMentionsLayout:function(){var d=(a.Deferred(),b.editorArea()),e=d.controller("mentions");if(e)return e.cloneLayout(),void 0;var f=b.editorHeader();d.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:a.View("easysocial/site/friends/suggest.hint.search"),emptyHint:a.View("easysocial/site/friends/suggest.hint.empty"),data:function(c){var d=a.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:c}).done(function(c){a.isArray(c)||d.reject();
var c=a.map(c,function(a){return a.title=a.screenName,a.type="user",a.menuHtml=b.view.suggestItem(!0,{item:a,name:"uid[]"}),a});d.resolve(c)}).fail(d.reject),d},use:function(a){return a.type+":"+a.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:a.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:a.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(c){var d=a.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:c}).done(function(c){a.isArray(c)||d.reject();
var c=a.map(c,function(a){return a.title="#"+a.title,a.type="hashtag",a.menuHtml=b.view.tagSuggestItem(!0,{item:a,name:"uid[]"}),a});d.resolve(c)}).fail(d.reject),d}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:"left top",at:"left bottom",of:f,collision:"none"},size:{width:function(){return f.width()}}}}})},submitComment:function(){var c=b.input().val();return""==a.trim(c)?!1:(b.parent.trigger("newCommentSaving"),b.save().done(function(a){b.parent.trigger("newCommentSaved",[a]),b.submit().enabled(!0);
var c=b.editorArea(),d=c.controller("mentions");d&&d.reset(),""!=b.parent.options.streamid&&b.updateStreamExcludeIds(b.parent.options.streamid)}).fail(function(a){b.parent.trigger("newCommentSaveError",[a.message])}),void 0)},save:function(){var d=b.editorArea().controller("mentions"),e={url:b.parent.options.url,mentions:d?d.toArray():[]};return e.mentions=a.map(e.mentions,function(b){return"hashtag"===b.type&&a.isPlainObject(b.value)&&(b.value=b.value.title.slice(1)),JSON.stringify(b)}),EasySocial.ajax("site/controllers/comments/save",{uid:b.parent.options.uid,element:b.parent.options.element,group:b.parent.options.group,verb:b.parent.options.verb,streamid:b.parent.options.streamid,input:b.input().val(),attachmentIds:c.attachmentIds,data:e})
},updateStreamExcludeIds:function(b){ids=a("[data-streams-wrapper]").data("excludeids"),newIds="",newIds=""!=ids&&void 0!=ids?ids+","+b:b,a("[data-streams-wrapper]").data("excludeids",newIds)},disableForm:function(){b.input().attr("disabled",!0),b.submit().disabled(!0)},enableForm:function(){b.input().removeAttr("disabled"),b.submit().enabled(!0)},"{parent} newCommentSaving":function(){b.status().show(),b.status().removeClass("label-important label-success label-info"),b.status().addClass("label-info"),b.status().text(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVING")),b.disableForm()
},"{parent} newCommentSaved":function(){b.status().show(),b.status().text(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVED")),b.status().removeClass("label-important label-success label-info"),b.status().addClass("label-success"),setTimeout(function(){b.status().fadeOut("fast")},2e3),b.enableForm(),c.attachmentIds=[];var d=b.attachmentItem.inside(b.attachmentQueue.selector);d.remove(),b.attachmentQueue().removeClass("has-attachments"),b.input().val("")},"{parent} newCommentSaveError":function(a,c,d){b.status().show(),b.status().removeClass("label-important label-success label-info"),b.status().addClass("label-important"),b.status().text(d),b.enableForm()
}}}),b.resolve()})}),EasySocial.module("site/comments/item",function(a){var b=this;EasySocial.require().library("mentions").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_LOADING","COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_DELETING","COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR","COM_EASYSOCIAL_LIKES_LIKE","COM_EASYSOCIAL_LIKES_UNLIKE").done(function(){EasySocial.Controller("Comments.Item",{defaultOptions:{id:0,child:0,loadedChild:0,limit:10,isNew:!1,"{frame}":"[data-comments-item-frame]","{avatar}":"[data-comments-item-avatar]","{commentFrame}":"[data-comments-item-commentFrame]","{author}":"[data-comments-item-author]","{action}":"[data-comments-item-actions]","{edit}":"[data-comments-item-actions-edit]","{delete}":"[data-comments-item-actions-delete]","{spam}":"[data-comments-item-actions-spam]","{comment}":"[data-comments-item-comment]","{meta}":"[data-comments-item-meta]","{date}":"[data-comments-item-date] a","{like}":"[data-comments-item-like]","{likeCount}":"[data-comments-item-likeCount]","{editFrame}":"[data-comments-item-editFrame]","{editInput}":"[data-comments-item-edit-input]","{editCancel}":"[data-comments-item-edit-cancel]","{editSubmit}":"[data-comments-item-edit-submit]","{editStatus}":"[data-comments-item-edit-status]","{statusFrame}":"[data-comments-item-statusFrame]","{loadReplies}":"[data-comments-item-loadReplies]","{readMore}":"[data-es-comment-readmore]","{fullContent}":"[data-es-comment-full]",view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.child=b.element.data("child"),b.parent.registerComment(b),b.status=b.element.addController("EasySocial.Controller.Comments.Item.Status",{controller:{parent:b.parent,item:b}})
},"{like} click":function(c){c.enabled()&&(c.disabled(!0),b.likeComment().done(function(d,e,f){c.enabled(!0),b.likeCount().text(e),f=a("<div></div>").html(f).text(),b.likeCount().attr("data-original-title",f),b.like().find("a").text(a.language(d?"COM_EASYSOCIAL_LIKES_UNLIKE":"COM_EASYSOCIAL_LIKES_LIKE"))}).fail(function(){}))},likeComment:function(){return EasySocial.ajax("site/controllers/comments/like",{id:b.options.id})},"{likeCount} click":function(){EasySocial.dialog({content:b.getLikedUsers()})},getLikedUsers:function(){return EasySocial.ajax("site/controllers/comments/likedUsers",{id:b.options.id})
},"{edit} click":function(a){if(a.enabled()){var c=b.editFrame(),d=c.controller("mentions");c.html(""),d&&d.destroy(),a.disabled(!0),b.trigger("commentEditLoading",[b.options.id]),b.getEditComment().done(function(a){b.trigger("commentEditLoaded",[b.options.id,a]),b.editFrame().html(a).show(),b.setMentionsLayout(),b.editInput().focus()}).fail(function(a){b.trigger("commentEditLoadError",[b.options.id,a])})}},setMentionsLayout:function(){var c=b.editFrame(),d=c.controller("mentions");if(d)return d.cloneLayout(),void 0;
var e=b.editFrame();c.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:a.View("easysocial/site/friends/suggest.hint.search"),emptyHint:a.View("easysocial/site/friends/suggest.hint.empty"),data:function(c){var d=a.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:c}).done(function(c){a.isArray(c)||d.reject();var c=a.map(c,function(a){return a.title=a.screenName,a.type="user",a.menuHtml=b.view.suggestItem(!0,{item:a,name:"uid[]"}),a
});d.resolve(c)}).fail(d.reject),d},use:function(a){return a.type+":"+a.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!1,searchHint:a.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:a.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(c){var d=a.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:c}).done(function(c){a.isArray(c)||d.reject();var c=a.map(c,function(a){return a.title="#"+a.title,a.type="hashtag",a.menuHtml=b.view.tagSuggestItem(!0,{item:a,name:"uid[]"}),a
});d.resolve(c)}).fail(d.reject),d}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:"left top",at:"left bottom",of:e,collision:"none"},size:{width:function(){return e.width()}}}}})},getRawComment:function(){return EasySocial.ajax("site/controllers/comments/getRawComment",{id:b.options.id})},getEditComment:function(){return EasySocial.ajax("site/controllers/comments/getEditComment",{id:b.options.id})},"{editCancel} click":function(){b.trigger("commentEditCancel",[b.options.id]),b.edit().enabled(!0)
},"{editSubmit} click":function(){b.submitEdit()},submitEdit:function(){var a=b.editInput().val();return""==a?!1:(b.trigger("commentEditSaving",[b.options.id,a]),b.saveEdit().done(function(a){b.trigger("commentEditSaved",[b.options.id,a]),b.comment().html(a),b.edit().enabled(!0)}).fail(function(a){b.trigger("commentEditSaveError",[b.options.id,a])}),void 0)},saveEdit:function(){var a=b.editFrame().mentions("controller");return EasySocial.ajax("site/controllers/comments/update",{id:b.options.id,input:b.editInput().val(),mentions:a?a.toArray():[]})
},"{delete} click":function(){b.frame().hide(),b.commentFrame().show(),EasySocial.dialog({content:EasySocial.ajax("site/views/comments/confirmDelete",{id:b.options.id}),selectors:{"{deleteButton}":"[data-delete-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{deleteButton} click":function(){EasySocial.dialog().close(),b.parent.trigger("commentDeleting",[b.options.id]),b.trigger("commentDeleting"),b.deleteComment().done(function(){b.parent.trigger("commentDeleted",[b.options.id])}).fail(function(a){b.parent.trigger("commentDeleteError",[b.options.id,a]),b.trigger("commentDeleteError",[b.options.id,a])
})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})},deleteComment:function(){return EasySocial.ajax("site/controllers/comments/delete",{id:b.options.id})},"{loadReplies} click":function(c){c.hide();var d=Math.max(b.options.child-b.options.loadedChild-b.options.limit,0);EasySocial.ajax().done(function(c){a.each(c,function(a,c){b.parent.$List.addToList(c,"child",!1)}),b.parent.trigger("oldCommentsLoaded",[c]),d>0&&b.loadMoreReplies().show()})},"{readMore} click":function(){b.comment().html(b.fullContent().html())
}}}),EasySocial.Controller("Comments.Item.Status",{defaultOptions:{"{frame}":"[data-comments-item-frame]","{statusFrame}":"[data-comments-item-statusFrame]","{statusContent}":"[data-comments-item-statusFrame] div","{commentFrame}":"[data-comments-item-commentFrame]","{editFrame}":"[data-comments-item-editFrame]"}},function(b){return{init:function(){},setStatus:function(c){b.frame().hide(),a.isPlainObject(c)&&void 0!==c.message&&(c=c.message),b.statusContent().html(c),b.statusFrame().show()},"{self} commentEditLoading":function(){b.setStatus(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_LOADING"))
},"{self} commentEditLoaded":function(){b.frame().hide(),b.editFrame().show()},"{self} commentEditLoadError":function(){b.setStatus(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR"))},"{self} commentEditCancel":function(){b.frame().hide(),b.commentFrame().show()},"{self} commentEditSaving":function(){b.setStatus(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVING"))},"{self} commentEditSaved":function(){b.frame().hide(),b.commentFrame().show()},"{self} commentEditSaveError":function(){b.setStatus(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR"))
},"{self} commentDeleting":function(){b.setStatus(a.language("COM_EASYSOCIAL_COMMENTS_STATUS_DELETING"))},"{self} commentDeleteError":function(c,d,e,f){f=f||a.language("COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR"),b.setStatus(f)}}}),b.resolve()})}),EasySocial.module("site/conversations/conversations",function(){var b=this;EasySocial.require().script("site/conversations/mailbox","site/conversations/item","site/conversations/filter").language("COM_EASYSOCIAL_NO_BUTTON").done(function(a){EasySocial.Controller("Conversations",{defaultOptions:{"{mailbox}":"[data-conversations-mailbox]","{list}":"[data-conversations-list]","{content}":"[data-conversations-content]","{item}":"[data-conversations-item]","{actions}":"[data-conversations-actions]","{filterItem}":"[data-conversations-filter]","{checkAll}":"[data-conversations-checkAll]","{checkbox}":"[data-conversationItem-checkbox]","{delete}":"[data-conversations-delete]","{archive}":"[data-conversations-archive]","{unarchive}":"[data-conversations-unarchive]","{unread}":"[data-conversations-unread]","{read}":"[data-conversations-read]"}},function(b){return{init:function(){b.mailbox().implement(EasySocial.Controller.Conversations.Mailbox,{"{parent}":b}),b.item().implement(EasySocial.Controller.Conversations.Item,{"{parent}":b}),b.filterItem().implement(EasySocial.Controller.Conversations.Filter,{"{parent}":b})
},"{filterItem} click":function(c){b.filterItem().removeClass("active"),a(c).addClass("active")},"{checkbox} change":function(a){return b.checkbox(":checked").length<=0&&!a.is(":checked")?b.actions().removeClass("is-checked"):(b.actions().addClass("is-checked"),void 0)},"{checkAll} click":function(c){return b.checkbox().length<=0?(a(c).prop("checked",!1),!1):(c.is(":checked")?b.checkbox(":not(:checked)").click():b.checkbox(":checked").click(),void 0)},showEmpty:function(){b.content().addClass("is-empty")},hideEmpty:function(){b.content().removeClass("is-empty")
},toggleLoading:function(){b.content().removeClass("is-empty").toggleClass("is-loading")},updateContent:function(a,c){void 0!=c?b.content().addClass("layout-"+c):b.content().removeClass("layout-archives"),b.actions().removeClass("is-checked"),b.checkAll().removeAttr("checked"),b.list().html(a)},getSelectedConversations:function(){if(b.checkbox(":checked").length<=0)return!1;var c=new Array;return b.checkbox(":checked").each(function(b,d){c.push(a(d).val())}),c},"{archive} click":function(){var c=b.getSelectedConversations();
EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmArchive",{ids:c}),bindings:{"{confirmButton} click":function(){a("[data-conversation-archive-form]").submit()}}})},"{unarchive} click":function(){var c=b.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmUnarchive",{ids:c}),bindings:{"{confirmButton} click":function(){a("[data-conversation-archive-form]").submit()}}})},"{delete} click":function(){var c=b.getSelectedConversations();
EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmDelete",{ids:c}),bindings:{"{deleteButton} click":function(){a("[data-conversation-delete-form]").submit()}}})},"{read} click":function(){if(b.checkbox(":checked").length<=0)return!1;var c=new Array;b.checkbox(":checked").each(function(b,d){c.push(a(d).val())}),EasySocial.ajax("site/controllers/conversations/markRead",{ids:c}).done(function(){b.checkbox().parents("[data-conversations-item]").removeClass("unread").addClass("read"),b.mailbox().controller().updateCounters()
}).fail(function(a){b.setMessage(a)})},"{unread} click":function(){if(b.checkbox(":checked").length<=0)return!1;var c=new Array;b.checkbox(":checked").each(function(b,d){c.push(a(d).val())}),EasySocial.ajax("site/controllers/conversations/markUnread",{ids:c}).done(function(){b.checkbox().parents("[data-conversations-item]").removeClass("read").addClass("unread"),b.mailbox().controller().updateCounters()}).fail(function(a){console.log(a)})}}}),b.resolve()})}),EasySocial.module("site/conversations/mailbox",function(){var b=this;
EasySocial.require().library("history").done(function(){EasySocial.Controller("Conversations.Mailbox",{defaultOptions:{"{item}":"[data-mailboxItem]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Conversations.Mailbox.Item,{"{parent}":a})},updateCounters:function(){a.item(".active").controller().updateCounter()},updateContent:function(b,c){a.parent.updateContent(b,c)},showEmpty:function(){a.parent.showEmpty()},hideEmpty:function(){a.parent.hideEmpty()},toggleLoading:function(){a.parent.toggleLoading()
}}}),EasySocial.Controller("Conversations.Mailbox.Item",{defaultOptions:{"{counter}":"[data-mailboxItem-counter]",view:{emptyTemplate:"site/conversations/default.item.empty"}}},function(a){return{init:function(){},updateCounter:function(){EasySocial.ajax("site/controllers/conversations/getCount",{mailbox:a.element.data("mailbox")}).done(function(b){return 0>=b?(a.counter().html(""),void 0):(a.counter().html("("+b+")"),void 0)})},toggleLoading:function(){a.element.toggleClass("loading")},"{self} click":function(){var b=a.element.data("url"),c=a.element.data("title"),d=a.element.data("mailbox");
a.parent.item().removeClass("active"),a.element.addClass("active"),History.pushState({state:1},c,b),EasySocial.ajax("site/views/conversations/getItems",{mailbox:d,limitstart:0},{beforeSend:function(){a.toggleLoading(),a.parent.toggleLoading()}}).done(function(b){return a.toggleLoading(),a.parent.toggleLoading(),b.length<=0?(a.parent.updateContent(""),a.parent.showEmpty()):(a.parent.hideEmpty(),a.parent.updateContent(b,a.element.data("mailbox")),void 0)})}}}),b.resolve()})}),EasySocial.module("site/conversations/item",function(){var b=this;
EasySocial.require().script("site/conversations/mailbox").done(function(a){EasySocial.Controller("Conversations.Item",{defaultOptions:{"{checkbox}":"[data-conversationItem-checkbox]"}},function(b){return{init:function(){},"{checkbox} change":function(c){var d=a(c).is(":checked");return d?b.element.addClass("selected"):b.element.removeClass("selected")}}}),b.resolve()})}),EasySocial.module("site/conversations/filter",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Conversations.Filter",{defaultOptions:{}},function(b){return{init:function(){},"{self} click":function(){{var c=b.element.data("filter"),d="."+c;
b.parent.item(d).length}if(1==a("[data-mailboxitem]").filter(".active").length){var f=a("[data-mailboxitem]").filter(".active"),g=f.data("url"),h=f.data("title"),i=f.data("mailbox");History.pushState({state:1},h,g),EasySocial.ajax("site/views/conversations/getItems",{mailbox:i,filter:c,limitstart:0},{beforeSend:function(){b.parent.toggleLoading()}}).done(function(a){return b.parent.toggleLoading(),a.length<=0?(b.parent.updateContent(""),b.parent.showEmpty()):(b.parent.hideEmpty(),b.parent.updateContent(a,i),void 0)
})}}}}),b.resolve()})}),EasySocial.module("site/conversations/read",function(){var b=this;EasySocial.require().library("dialog").script("site/conversations/composer","site/friends/suggest").language("COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY","COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY").done(function(a){EasySocial.Controller("Conversations.Read",{defaultOptions:{id:"",attachments:!0,location:!1,maxSize:"3mb",extensionsAllowed:"",attachmentController:null,composerController:null,"{item}":"[data-readConversation-item]","{items}":"[data-readConversation-items]","{composer}":"[data-readConversation-composer]","{replyButton}":"[data-readConversation-replyButton]","{addParticipant}":"[data-readConversation-addParticipant]","{leaveConversation}":"[data-readConversation-leaveConversation]","{delete}":"[data-readConversation-delete]","{attachments}":"[data-uploaderQueue-id]","{replyNotice}":"[data-readConversation-replyNotice]","{readLoadMore}":"[data-readconversation-load-more]",view:{messageItem:"site/conversations/read.message"}}},function(b){return{init:function(){b.composer().implement(EasySocial.Controller.Conversations.Composer,{"{uploader}":"[data-readConversation-attachment]","{location}":"[data-readConversation-location]",maxSize:b.options.maxSize,extensionsAllowed:b.options.extensionsAllowed}),b.options.composerController=b.composer().controller(),b.options.attachments&&(b.options.attachmentController=b.options.composerController.uploader().controller()),b.options.location&&(b.options.locationController=b.options.composerController.location().controller()),b.item().implement(EasySocial.Controller.Conversations.Read.Item),b.options.id=b.element.data("id")
},resetForm:function(){b.options.composerController.resetForm();var a=b.composer().controller().editorArea().mentions("controller");a.reset(),b.options.location&&b.options.locationController.removeLocation(),b.options.attachments&&b.options.attachmentController.reset()},"{readLoadMore} click":function(c){var d=a(c).data("id"),e=a(c).data("limitstart");b.readLoadMore().hide(),a(".loading-indicator").show();var f={id:d,limitstart:e};EasySocial.ajax("site/controllers/conversations/loadPrevious",f).done(function(d,e){a.buildHTML(d).prependTo(b.items()).addController("EasySocial.Controller.Conversations.Read.Item"),0==e?b.readLoadMore().hide():(b.readLoadMore().show(),a(c).data("limitstart",e))
}).always(function(){a(".loading-indicator").hide()})},"{replyButton} click":function(c,d){d.preventDefault();var e=b.options.composerController.editor().val(),f=new Array;if(e.length<=0)return b.replyNotice().html(a.language("COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY")).addClass("alert alert-error").removeClass("alert-success"),!1;b.options.attachments&&b.attachments().each(function(b,c){f.push(a(c).val())});var g={id:b.options.id,message:e};return b.options.attachments&&(g["upload-id"]=f),b.options.location&&(g.address=b.options.locationController.locationInput().val(),g.latitude=b.options.locationController.locationLatitude().val(),g.longitude=b.options.locationController.locationLongitude().val()),g.tags=b.composer().controller().editorArea().mentions("controller").toArray(),b.replyButton().attr("disabled",!0),EasySocial.ajax("site/controllers/conversations/reply",g).done(function(c){b.replyNotice().html(a.language("COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY")).addClass("alert alert-success").removeClass("alert-error");
var d=a(c);d.implement(EasySocial.Controller.Conversations.Read.Item),b.items().append(d),b.resetForm()}).always(function(){b.replyButton().attr("disabled",!1)}),!1},"{leaveConversation} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmLeave",{id:b.options.id})})},"{addParticipant} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/addParticipantsForm",{id:b.options.id})})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmDelete",{ids:[b.options.id]}),bindings:{"{deleteButton} click":function(){a("[data-conversation-delete-form]").submit()
}}})},addItem:function(a){b.messageList().append(b.view.messageItem({item:a})),b.textMessage().val("").focus()}}}),EasySocial.Controller("Conversations.Read.Item",{defaultOptions:{id:null,"{attachmentsWrapper}":"[data-conversation-attachment-wrapper]","{attachments}":"[data-conversation-attachment]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.attachments().implement(EasySocial.Controller.Conversations.Read.Item.Attachment,{"{parent}":b})},removeAttachment:function(c){a(c).remove(),0==b.attachments().length&&b.attachmentsWrapper().hide()
}}}),EasySocial.Controller("Conversations.Read.Item.Attachment",{defaultOptions:{"{deleteAttachment}":"[data-attachment-delete]"}},function(b){return{init:function(){},"{deleteAttachment} click":function(c){var e=a(c).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmDeleteAttachment",{id:e}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/conversations/deleteAttachment",{id:e}).done(function(){b.parent.removeAttachment(b.element),EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/attachmentDeleted",{})})
}).fail(function(a){b.setMessage(a)})}}})}}}),b.resolve()})}),EasySocial.module("site/dashboard/apps",function(){var b=this;EasySocial.require().library("history").done(function(a){EasySocial.Controller("Dashboard.Apps",{defaultOptions:{parent:null,pageTitle:null,"{item}":"[data-dashboardApps-item]"}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Dashboard.Apps.Item,{"{parent}":a,"{dashboard}":a.parent,pageTitle:a.options.pageTitle})}}}),EasySocial.Controller("Dashboard.Apps.Item",{defaultOptions:{}},function(b){return{init:function(){},"{self} click":function(c,d){d.preventDefault();
var e=b.element.data("layout"),f=b.element.data(e+"-url"),g=b.element.data("title"),h=b.element.data("description"),i=b.element.data("id");return"canvas"==e?(window.location=f,void 0):(g=a._.isEmpty(b.options.pageTitle)?g:b.options.pageTitle,History.pushState({state:1},g,f),b.dashboard.content().html(""),b.dashboard.updatingContents(),b.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getAppContents",{appId:i}).done(function(a){b.dashboard.updateHeading(g,h),b.dashboard.updateContents(a)
}).fail(function(a){return a}).always(function(){b.element.removeClass("loading")}),void 0)}}}),b.resolve()})}),EasySocial.module("site/dashboard/dashboard",function(){var b=this;EasySocial.require().script("site/dashboard/apps","site/dashboard/feeds","site/dashboard/sidebar","site/stream/filter","site/dashboard/groups","site/dashboard/events").done(function(a){EasySocial.Controller("Dashboard",{defaultOptions:{currentTitle:null,pageTitle:null,"{heading}":"[data-dashboard-heading]","{sidebar}":"[data-dashboard-sidebar]","{content}":"[data-dashboard-real-content]","{feeds}":"[data-dashboard-feeds]","{groups}":"[data-dashboard-groups]","{events}":"[data-dashboard-events]","{groupItems}":"[data-dashboard-group-item]","{eventItems}":"[data-dashboard-event-item]","{showAllFilters}":"[data-app-filters-showall]","{showAllGroups}":"[data-groups-filters-showall]","{showAllEvents}":"[data-events-filters-showall]","{appFilters}":"[data-sidebar-app-filter]","{apps}":"[data-dashboard-apps]","{saveHashTag}":"[data-hashtag-filter-save]"}},function(b){return{init:function(){b.sidebar().implement(EasySocial.Controller.Dashboard.Sidebar,{"{parent}":b}),b.feedsController=b.feeds().addController(EasySocial.Controller.Dashboard.Feeds,{"{parent}":b}),b.apps().implement(EasySocial.Controller.Dashboard.Apps,{"{parent}":b,pageTitle:b.options.pageTitle}),b.groups().implement(EasySocial.Controller.Dashboard.Groups,{"{parent}":b}),b.events().implement(EasySocial.Controller.Dashboard.Events,{"{parent}":b})
},"{showAllGroups} click":function(c){a(c).hide(),b.groupItems().removeClass("hide")},"{showAllEvents} click":function(c){a(c).hide(),b.eventItems().removeClass("hide")},"{showAllFilters} click":function(c){a(c).hide(),b.appFilters().removeClass("hide")},updateHeading:function(a,c){b.heading().find("[data-heading-title]").html(a),b.heading().find("[data-heading-desc]").html(c)},updatingContents:function(){b.element.addClass("loading")},updateContents:function(c){b.element.removeClass("loading"),a.buildHTML(c).appendTo(b.content())
},"{saveHashTag} click":function(c){var d=c.data("tag");EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmSaveFilter",{tag:d}),bindings:{"{saveButton} click":function(){return this.inputWarning().hide(),filterName=this.inputTitle().val(),""==filterName?(this.inputWarning().show(),void 0):(EasySocial.ajax("site/controllers/stream/addFilter",{title:filterName,tag:d}).done(function(c,d){var e=a.buildHTML(c);b.feedsController.addFilterItem(e),EasySocial.dialog(d),setTimeout(function(){EasySocial.dialog().close()
},2e3)}),void 0)}}})}}}),b.resolve()})}),EasySocial.module("site/dashboard/feeds",function(){var b=this;EasySocial.require().library("history").done(function(a){EasySocial.Controller("Dashboard.Feeds",{defaultOptions:{"{item}":"[data-dashboardFeeds-item]","{filter}":"[data-dashboardFeeds-Filter-edit]"}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Dashboard.Feeds.Item,{"{parent}":b,"{dashboard}":b.parent})},addFilterItem:function(c){c.find("[data-dashboardFeeds-item]").implement(EasySocial.Controller.Dashboard.Feeds.Item,{"{parent}":b,"{dashboard}":b.parent}),a(b.element).find(".widget-filter-group").length>0?c.insertBefore(a(b.element).find(".widget-filter-group")):c.appendTo(b.element)
}}}),EasySocial.Controller("Dashboard.Feeds.Item",{defaultOptions:{}},function(b){return{clicked:!1,init:function(){},"{self} click":function(){a(".es-streams").removeClass("no-stream");var c=b.element.data("type"),d=b.element.data("id"),e=b.element.data("url"),f=b.element.data("title"),g=b.element.data("description");if(!b.clicked){b.clicked=!0;var h="[data-stream-counter-";"list"==c?h=h+c+"-"+d:h+=c,h+="]",a(h).html("0"),b.element.removeClass("has-notice");var i=a.joomla.appendTitle;"before"===i&&(f=a.joomla.sitename+(f?" - "+f:"")),"after"===i&&(f=(f?f+" - ":"")+a.joomla.sitename),History.pushState({state:1},f,e),b.dashboard.content().html(""),b.dashboard.updatingContents(),b.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getStream",{type:c,id:d,view:"dashboard"}).done(function(d,e){b.dashboard.updateHeading(f,g),0==e&&a(".es-streams").addClass("no-stream"),b.trigger("onStreamUpdate",[c]),window.streamFilter=c,b.dashboard.updateContents(d);
try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(h){}}).fail(function(a){return a}).always(function(){b.clicked=!1,b.element.removeClass("loading")})}}}}),b.resolve()})}),EasySocial.module("site/dashboard/sidebar",function(){var b=this;EasySocial.require().library("history").done(function(){EasySocial.Controller("Dashboard.Sidebar",{defaultOptions:{"{menuItem}":"[data-dashboardSidebar-menu]","{filterBtn}":"[data-stream-filter-button]","{editIcon}":"[data-dashboardFeeds-Filter-edit]"}},function(a){return{init:function(){},"{menuItem} click":function(b){a.menuItem().removeClass("active"),b.addClass("active")
},"{editIcon} click":function(b,c){c.preventDefault(),b.route();var d=b.data("id");a.parent.content().html(""),a.parent.updatingContents(),EasySocial.ajax("site/controllers/stream/getFilter",{id:d}).done(function(b){a.parent.updateContents(b)}).fail(function(a){return a})},"{filterBtn} click":function(b,c){c.preventDefault(),b.route(),a.parent.content().html(""),a.parent.updatingContents(),EasySocial.ajax("site/controllers/stream/getFilter",{id:0}).done(function(b){a.parent.updateContents(b)}).fail(function(a){return a
})}}}),b.resolve()})}),EasySocial.module("site/stream/filter",function(){var b=this;EasySocial.require().script("site/stream/sidebar").language("COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY").done(function(a){EasySocial.Controller("Stream.Filter",{defaultOptions:{"{heading}":"[data-filter-heading]","{sidebar}":"[data-sidebar-item]","{content}":"[data-filter-real-content]"}},function(a){return{init:function(){a.sidebar().implement(EasySocial.Controller.Stream.Filter.Sidebar,{"{parent}":a})
},updateHeading:function(b,c){a.heading().find("[data-heading-title]").html(b),a.heading().find("[data-heading-desc]").html(c)},updatingContents:function(){a.element.addClass("loading")},updateContents:function(b){a.element.removeClass("loading"),a.content().html(b)}}}),EasySocial.Controller("Stream.Filter.Item",{defaultOptions:{"{title}":"[data-filter-name]","{hashtag}":"[data-filter-hashtag]","{saveBtn}":"[data-stream-filter-save]","{deleteBtn}":"[data-stream-filter-delete]","{form}":"[data-filter-inputForm]","{notice}":"[filter-form-notice]"}},function(b){return{init:function(){},"{deleteBtn} click":function(a){var c=a.data("id"),d=a.data("uid"),e=a.data("utype"),f="site/controllers/stream/deleteFilter";
if(d)var f="site/controllers/"+e+"s/deleteFilter";EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmFilterDelete"),bindings:{"{deleteButton} click":function(){EasySocial.ajax(f,{id:c,uid:d,utype:e}).done(function(){b.element.fadeOut(),EasySocial.dialog().close()})}}})},"{saveBtn} click":function(){return a("div.control-group").removeClass("error"),b.notice().html(),b.notice().hide(),""==b.title().val()?(b.title().parents("div.control-group").addClass("error"),b.notice().html(a.language("COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY")),b.notice().show(),!1):""==b.hashtag().val()?(b.hashtag().parents("div.control-group").addClass("error"),b.notice().html(a.language("COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY")),b.notice().show(),!1):(b.form().submit(),void 0)
}}}),b.resolve()})}),EasySocial.module("site/stream/sidebar",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Stream.Filter.Sidebar",{defaultOptions:{}},function(b){return{init:function(){},"{self} click":function(){a("[data-sidebar-item]").removeClass("active loading"),b.element.addClass("active");var c=b.element.data("id"),d=b.element.data("url"),e=b.element.data("title");History.pushState({state:1},e,d),b.parent.content().html(""),b.parent.updatingContents(),b.element.addClass("loading"),EasySocial.ajax("site/controllers/stream/getFilter",{id:c}).done(function(a){b.parent.updateContents(a)
}).fail(function(a){return a}).always(function(){b.element.removeClass("loading")})}}}),b.resolve()})}),EasySocial.module("site/dashboard/groups",function(){var b=this;EasySocial.require().library("history").done(function(a){EasySocial.Controller("Dashboard.Groups",{defaultOptions:{"{item}":"[data-dashboard-group-item]","{itemLink}":"[data-dashboard-group-item] > a"}},function(b){return{init:function(){},"{item} click":function(c,d){d.preventDefault(),a(".es-streams").removeClass("no-stream");{var e=a(c).data("type"),f=a(c).data("id");
a(c).data("description")}b.element.removeClass("has-notice"),a(c).find("a").route(),b.parent.content().html(""),b.parent.updatingContents(),b.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getStream",{type:e,id:f,view:"dashboard"}).done(function(a){b.parent.updateContents(a)})}}}),b.resolve()})}),EasySocial.module("site/dashboard/events",function(){var b=this;EasySocial.require().library("history").done(function(a){EasySocial.Controller("Dashboard.Events",{defaultOptions:{"{item}":"[data-dashboard-event-item]","{itemLink}":"[data-dashboard-event-item] > a"}},function(b){return{init:function(){},"{item} click":function(c,d){d.preventDefault(),a(".es-streams").removeClass("no-stream");
{var e=a(c).data("type"),f=a(c).data("id");a(c).data("description")}b.element.removeClass("has-notice"),a(c).find("a").route(),b.parent.content().html(""),b.parent.updatingContents(),b.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getStream",{type:e,id:f,view:"dashboard"}).done(function(a){b.parent.updateContents(a)})}}}),b.resolve()})}),EasySocial.module("site/events/browser",function(a){var b=this;EasySocial.require().library("popbox").script("site/events/guestState").language("COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION").view("site/loading/small").done(function(){EasySocial.Controller("Events.Browser",{defaultOptions:{"{filters}":"[data-events-filters] > li","{content}":"[data-events-content]","{list}":"[data-events-list]","{items}":"[data-events-item]","{sort}":"[data-events-sorting] a","{calendar}":"[data-events-calendar]","{pastFilter}":"[data-events-past]","{pastLink}":"[data-events-past-link]","{prevDate}":"[data-events-nav-prevdate]","{nextDate}":"[data-events-nav-nextdate]","{radius}":"[data-events-radius]","{nearbyTitle}":"[data-events-nearby-title]",filter:null,categoryid:0,delayed:!1,includePast:!1,ordering:"start",hasLocation:!1,userLatitude:"",userLongitude:"",distance:10,group:null,view:{loadingContent:"site/loading/small"}}},function(b){return{init:function(){b.options.filter=b.element.data("filter"),b.options.categoryid=b.element.data("categoryid"),b.renderCalendar(),b.initItems(),b.options.delayed&&b.delayedInit()
},delayedInit:function(){if("nearby"===b.options.filter){var c=function(){EasySocial.ajax("site/controllers/events/getEvents",{filter:b.options.filter,latitude:b.options.userLatitude,longitude:b.options.userLongitude,distance:b.options.distance,ordering:b.options.ordering,includePast:b.options.includePast}).done(function(a){b.element.removeClass("loading"),b.content().html(a),b.initItems()})};if(b.options.hasLocation&&b.options.userLatitude&&b.options.userLongitude)return c();EasySocial.require().library("gmaps").done(function(){a.GMaps.geolocate({success:function(a){return b.options.userLatitude=a.coords.latitude,b.options.userLongitude=a.coords.longitude,c()
}})})}},renderCalendar:function(){EasySocial.ajax("site/views/events/renderCalendar",{}).done(function(a){b.calendar().html(a).addController("EasySocial.Controller.Events.Browser.Calendar",{"{parent}":b}),b.calendar().trigger("calendarLoaded")})},initItems:function(){b.items().addController("EasySocial.Controller.Events.Browser.Item",{"{parent}":b})},"{filters} click":function(a,c){return c.preventDefault(),b.filters().removeClass("active"),a.addClass("active"),b.content().html("&nbsp;"),a.find("a").route(),b.options.filter=a.data("events-filters-type"),b.options.categoryid=a.data("events-filters-categoryid"),"nearby"==b.options.filter?b.filterByNearby():(b.element.addClass("loading"),EasySocial.ajax("site/controllers/events/getEvents",{filter:b.options.filter,categoryid:b.options.categoryid}).done(function(a){b.element.removeClass("loading"),b.content().html(a),b.initItems()
}),void 0)},filterByNearby:function(){var c=function(){EasySocial.ajax("site/controllers/events/getEvents",{filter:b.options.filter,latitude:b.options.userLatitude,longitude:b.options.userLongitude}).done(function(a){b.element.removeClass("loading"),b.content().html(a),b.initItems()})};return b.options.hasLocation&&b.options.userLatitude&&b.options.userLongitude?(b.element.addClass("loading"),c()):(b.content().html('<div class="es-detecting-location"><i class="fa fa-globe es-muted"></i> '+a.language("COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION")+' <i class="icon-loader"></i></div>'),EasySocial.require().library("gmaps").done(function(){a.GMaps.geolocate({success:function(a){return b.options.userLatitude=a.coords.latitude,b.options.userLongitude=a.coords.longitude,b.options.hasLocation=!0,c()
}})}),void 0)},"{sort} click":function(a,c){c.preventDefault(),b.sort().removeClass("active"),a.addClass("active"),b.list().html(b.view.loadingContent());var d=a.data("ordering"),e=a.data("filter"),f=a.data("categoryid"),g=b.pastFilter().is(":checked")?1:0;return b.setPastLink(),b.setSortLink(),a.route(),"nearby"===e?(EasySocial.ajax("site/controllers/events/getEvents",{filter:b.options.filter,latitude:b.options.userLatitude,longitude:b.options.userLongitude,distance:b.options.distance,ordering:d,sort:1,includePast:g}).done(function(a){b.list().html(a),b.initItems()
}),void 0):(EasySocial.ajax("site/controllers/events/getEvents",{filter:e,categoryid:f,ordering:d,sort:1,includePast:g,group:b.options.group}).done(function(a){b.list().html(a),b.initItems()}),void 0)},"{pastFilter} change":function(a){var c=b.sort(".active"),d=a.is(":checked")?1:0,e=c.data("ordering"),f=c.data("filter"),g=c.data("categoryid");return b.list().html(b.view.loadingContent()),b.pastLink().route(),b.setPastLink(),b.setSortLink(),"nearby"===f?(EasySocial.ajax("site/controllers/events/getEvents",{filter:b.options.filter,latitude:b.options.userLatitude,longitude:b.options.userLongitude,distance:b.options.distance,ordering:e,sort:1,includePast:d}).done(function(a){b.list().html(a),b.initItems()
}),void 0):(EasySocial.ajax("site/controllers/events/getEvents",{filter:f,categoryid:g,ordering:e,sort:1,includePast:d,group:b.options.group}).done(function(a){b.list().html(a),b.initItems()}),void 0)},"{pastLink} click":function(a,c){c.preventDefault(),b.pastFilter().trigger("click")},setPastLink:function(){var a=b.pastLink(),c=b.pastFilter().is(":checked")?1:0,d=b.sort(".active").data("ordering"),e=a.data(d+"-"+(c?"nopast":"past"));a.attr("href",e)},setSortLink:function(){var c=b.pastFilter().is(":checked")?1:0;
a.each(b.sort(),function(d,e){var e=a(e);e.attr("href",b.pastLink().data(e.data("ordering")+"-"+(c?"past":"nopast")))})},"{prevDate} click":function(a,c){c.preventDefault(),a.route(),b.filters().removeClass("active"),b.element.addClass("loading"),b.content().html("&nbsp;"),EasySocial.ajax("site/controllers/events/getEvents",{filter:"date",date:a.data("events-nav-prevdate")}).done(function(a,c){b.element.removeClass("loading"),b.content().html(a),b.initItems(),c.isToday&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="date"]').addClass("active")),c.isTomorrow&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="tomorrow"]').addClass("active")),c.isCurrentMonth&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="month"]').addClass("active")),c.isCurrentYear&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="year"]').addClass("active"))
})},"{nextDate} click":function(a,c){c.preventDefault(),a.route(),b.filters().removeClass("active"),b.element.addClass("loading"),b.content().html("&nbsp;"),EasySocial.ajax("site/controllers/events/getEvents",{filter:"date",date:a.data("events-nav-nextdate")}).done(function(a,c){b.element.removeClass("loading"),b.content().html(a),b.initItems(),c.isToday&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="date"]').addClass("active")),c.isTomorrow&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="tomorrow"]').addClass("active")),c.isCurrentMonth&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="month"]').addClass("active")),c.isCurrentYear&&(b.filters().removeClass("active"),b.filters('[data-events-filters-type="year"]').addClass("active"))
})},"{radius} change":function(c){var e=b.sort(".active"),f=b.pastFilter().is(":checked")?1:0,g=e.data("ordering"),j=(e.data("filter"),e.data("categoryid"),c.val());b.options.distance=j,b.list().html(b.view.loadingContent()),EasySocial.ajax("site/controllers/events/getEvents",{filter:"nearby",latitude:b.options.userLatitude,longitude:b.options.userLongitude,distance:b.options.distance,ordering:g,includePast:f,sort:1}).done(function(c,d){b.list().html(c),b.initItems(),History.pushState({state:1},document.title,d.hrefs[g][f?"past":"nopast"]),b.pastLink().attr("href",d.hrefs[g][f?"nopast":"past"]),a.each(b.sort(),function(c,e){var e=a(e);
e.attr("href",d.hrefs[e.data("ordering")][f?"past":"nopast"]),b.pastLink().attr("data-"+e.data("ordering")+"-past",d.hrefs[e.data("ordering")].past),b.pastLink().attr("data-"+e.data("ordering")+"-nopast",d.hrefs[e.data("ordering")].nopast)}),b.nearbyTitle().text(d.title)})}}}),EasySocial.Controller("Events.Browser.Item",{defaultOptions:{id:null,"{action}":"[data-item-action]","{unfeature}":"[data-item-unfeature]","{feature}":"[data-item-feature]","{unpublish}":"[data-item-unpublish]","{delete}":"[data-item-delete]","{guestStateWrap}":"[data-guest-state-wrap]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.initGuestStates()
},initGuestStates:function(){a.guestStateWrap().addController("EasySocial.Controller.Events.GuestState")},"{action} click":function(b){EasySocial.dialog({content:EasySocial.ajax("site/views/events/itemActionDialog",{id:a.options.id,action:b.data("item-action"),from:"list"})})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/events/deleteEventDialog",{id:a.options.id})})}}}),EasySocial.Controller("Events.Browser.Calendar",{defaultOptions:{"{nav}":"[data-calendar-nav]","{day}":".day","{month}":"[data-month]",view:{loading:"site/loading/small"}}},function(b){return{init:function(){},"{self} calendarLoaded":function(){b.day(".has-events").each(function(b,c){c=a(c);
var d=c.find(".event-details").html();c.popbox({content:d,id:"fd",component:"es",type:"events-calendar-filter",position:"bottom-left",toggle:"hover"})});var c=b.month(".has-events");if(c.length>0){var d=c.find(".event-details").html();c.popbox({content:d,id:"fd",component:"es",type:"events-calendar-filter",position:"bottom-left",toggle:"hover"})}},"{nav} click":function(a){var d=a.data("calendar-nav");b.element.html(b.view.loading()),EasySocial.ajax("site/views/events/renderCalendar",{date:d}).done(function(a){b.element.html(a).trigger("calendarLoaded")
})},"{day} click":function(a,c){c.preventDefault(),a.find("a[data-route]:first").route(),b.loadEvents(a.data("date"))},"{day} popboxActivate":function(c,d,e){e.tooltip.find("a[data-route]").on("click",function(c){c.preventDefault(),a(this).route(),b.loadEvents(a(this).data("date"))})},"{month} click":function(a,c){c.preventDefault(),a.find("a[data-route]:first").route(),b.loadEvents(a.data("month"))},"{month} popboxActivate":function(c,d,e){e.tooltip.find("a[data-route]").on("click",function(c){c.preventDefault(),a(this).route(),b.loadEvents(a(this).data("month"))
})},loadEvents:function(a){b.parent.filters().removeClass("active"),b.parent.element.addClass("loading"),b.parent.content().html("&nbsp;"),EasySocial.ajax("site/controllers/events/getEvents",{filter:"date",date:a}).done(function(a,c){b.parent.element.removeClass("loading"),b.parent.content().html(a),b.parent.initItems(),c.isToday&&(b.parent.filters().removeClass("active"),b.parent.filters('[data-events-filters-type="date"]').addClass("active")),c.isTomorrow&&(b.parent.filters().removeClass("active"),b.parent.filters('[data-events-filters-type="tomorrow"]').addClass("active")),c.isCurrentMonth&&(b.parent.filters().removeClass("active"),b.parent.filters('[data-events-filters-type="month"]').addClass("active")),c.isCurrentYear&&(b.parent.filters().removeClass("active"),b.parent.filters('[data-events-filters-type="year"]').addClass("active"))
})}}}),b.resolve()})}),EasySocial.module("site/events/guestState",function(){var b=this;EasySocial.require().language("COM_EASYSOCIAL_EVENTS_GUEST_PENDING").done(function(a){EasySocial.Controller("Events.GuestState",{defaultOptions:{id:null,allowMaybe:1,allowNotGoingGuest:1,hidetext:1,refresh:!1,"{guestAction}":"[data-guest-action]","{guestState}":"[data-guest-state]","{request}":"[data-guest-request]","{withdraw}":"[data-guest-withdraw]","{respond}":"[data-guest-respond]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.allowMaybe=b.element.data("allowmaybe"),b.options.allowNotGoingGuest=b.element.data("allownotgoingguest"),b.options.hidetext=b.element.data("hidetext"),b.options.refresh=b.element.is("[data-refresh]")
},showError:function(a){EasySocial.dialog({content:a})},stateClasses:{going:"btn-es-success",maybe:"btn-es-info",notgoing:"btn-es-danger"},"{guestAction} click":function(c){var d=c.data("guestAction");if("state"===d){var e=c.data("guestState");b.guestAction().removeClass("btn-es-success btn-es-info btn-es-danger"),c.addClass(b.stateClasses[e]),"notgoing"!==e||b.options.allowNotGoingGuest?b.response(e).done(function(){return b.options.refresh?location.reload():void 0}).fail(function(a){c.removeClass(b.stateClasses[d]),b.showError(a.message)
}):EasySocial.dialog({content:EasySocial.ajax("site/views/events/notGoingDialog",{id:b.options.id}),bindings:{"{closeButton} click":function(){EasySocial.ajax("site/views/events/refreshGuestState",{id:b.options.id,hidetext:b.options.hidetext}).done(function(a){b.element.html(a),EasySocial.dialog().close()})},"{submitButton} click":function(){b.response("notgoing").done(function(){return b.options.refresh?location.reload():(EasySocial.ajax("site/views/events/refreshGuestState",{id:b.options.id,hidetext:b.options.hidetext}).done(function(a){b.element.html(a),EasySocial.dialog().close()
}),void 0)})}}})}"request"===d&&EasySocial.dialog({content:EasySocial.ajax("site/views/events/requestDialog",{id:b.options.id}),bindings:{"{submitButton} click":function(){c.attr("data-guest-action","withdraw").data("guestAction","withdraw").removeAttr("data-guest-request").attr("data-guest-withdraw","").text(a.language("COM_EASYSOCIAL_EVENTS_GUEST_PENDING")),b.response(d),EasySocial.dialog().close()}}}),"withdraw"===d&&EasySocial.dialog({content:EasySocial.ajax("site/views/events/withdrawDialog",{id:b.options.id}),bindings:{"{submitButton} click":function(){b.response("withdraw").done(function(){EasySocial.ajax("site/views/events/refreshGuestState",{id:b.options.id,hidetext:b.options.hidetext}).done(function(a){b.element.html(a),EasySocial.dialog().close()
})})}}}),"attend"===d&&b.response("going").done(function(){EasySocial.ajax("site/views/events/refreshGuestState",{id:b.options.id,hidetext:b.options.hidetext}).done(function(a){return b.options.refresh?location.reload():(void 0!==a&&(b.element.html(a),EasySocial.dialog().close()),void 0)})})},response:function(a){return EasySocial.ajax("site/controllers/events/guestResponse",{id:b.options.id,state:a})}}}),b.resolve()})}),EasySocial.module("site/events/buttonState",function(){var b=this;EasySocial.require().language("COM_EASYSOCIAL_EVENTS_GUEST_PENDING").done(function(a){EasySocial.Controller("Events.ButtonState",{defaultOptions:{id:null,allowMaybe:1,allowNotGoingGuest:1,hidetext:1,refresh:!1,isPopbox:0,"{guestAction}":"[data-guest-action]","{guestState}":"[data-guest-state]","{request}":"[data-guest-request]","{withdraw}":"[data-guest-withdraw]","{respond}":"[data-guest-respond]","{rsvpButton}":"[data-event-rsvp-button]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.allowMaybe=b.element.data("allowmaybe"),b.options.allowNotGoingGuest=b.element.data("allownotgoingguest"),b.options.hidetext=b.element.data("hidetext"),b.options.isPopbox=b.element.data("ispopbox")
},showError:function(a){EasySocial.dialog({content:a.message})},stateClasses:{going:"btn-es-success",maybe:"btn-es-info",notgoing:"btn-es-danger"},refreshButton:function(){EasySocial.ajax("site/views/events/refreshButtonState",{id:b.options.id,hidetext:b.options.hidetext,isPopbox:b.options.isPopbox}).done(function(a){b.element.replaceWith(a)})},"{rsvpButton} popboxActivate":function(c,d,e){var f="div#"+e.id+".popbox-"+e.type+" [data-event-button-container]";a(f).addController("EasySocial.Controller.Events.ButtonState.Popbox",{"{parent}":b})
},"{guestAction} click":function(a){b.doAction(a)},doAction:function(c){var d=c.data("guestAction");if("state"===d){var e=c.data("guestState");"notgoing"!==e||b.options.allowNotGoingGuest?b.response(e).done(function(){b.refreshButton()}).fail(function(a){c.removeClass(b.stateClasses[d]),b.showError(a)}):EasySocial.dialog({content:EasySocial.ajax("site/views/events/notGoingDialog",{id:b.options.id}),bindings:{"{closeButton} click":function(){b.refreshButton(),EasySocial.dialog().close()},"{submitButton} click":function(){b.response("notgoing").done(function(){b.refreshButton(),EasySocial.dialog().close()
})}}})}"request"===d&&EasySocial.dialog({content:EasySocial.ajax("site/views/events/requestDialog",{id:b.options.id}),bindings:{"{submitButton} click":function(){c.attr("data-guest-action","withdraw").data("guestAction","withdraw").removeAttr("data-guest-request").attr("data-guest-withdraw","").text(a.language("COM_EASYSOCIAL_EVENTS_GUEST_PENDING")),b.response(d),EasySocial.dialog().close()}}}),"withdraw"===d&&EasySocial.dialog({content:EasySocial.ajax("site/views/events/withdrawDialog",{id:b.options.id}),bindings:{"{submitButton} click":function(){b.response("withdraw").done(function(){b.refreshButton(),EasySocial.dialog().close()
})}}}),"attend"===d&&b.response("going").done(function(){b.refreshButton(),EasySocial.dialog().close()})},response:function(a){return EasySocial.ajax("site/controllers/events/guestResponse",{id:b.options.id,state:a})}}}),EasySocial.Controller("Events.ButtonState.Popbox",{defaultOptions:{"{guestAction}":"[data-guest-action]"}},function(a){return{init:function(){console.log("Events.ButtonState.Popbox")},"{guestAction} click":function(b){a.parent.doAction(b)}}}),b.resolve()})}),EasySocial.module("site/events/create",function(){var b=this;
EasySocial.require().script("validate","field").done(function(){EasySocial.Controller("Events.Create",{defaultOptions:{previousLink:null,"{fields}":"[data-create-field]","{previous}":"[data-create-previous]","{next}":"[data-create-submit]"}},function(a){return{init:function(){a.fields().addController("EasySocial.Controller.Field.Base")},"{previous} click":function(){window.location=a.options.previousLink},"{next} click":function(b){b.enabled()&&(b.disabled(!0),b.addClass("btn-loading"),a.element.validate().done(function(){b.removeClass("btn-loading"),b.enabled(!0),a.element.submit()
}).fail(function(){b.removeClass("btn-loading"),b.enabled(!0),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}))}}}),b.resolve()})}),EasySocial.module("site/events/createRecurring",function(){var b=this;EasySocial.Controller("Events.CreateRecurring",{defaultOptions:{schedule:[],eventId:null,"{progress}":"[data-progress-bar]","{form}":"[data-form]"}},function(a){return{init:function(){a.start()},counter:0,start:function(){return void 0===a.options.schedule[a.counter]?a.completed():(a.create(a.options.schedule[a.counter]).done(function(){a.counter++;
var b=Math.ceil(a.counter/a.options.schedule.length*100);a.progress().css({width:b+"%"}),a.start()}).fail(function(a){console.log(a)}),void 0)},create:function(b){return EasySocial.ajax("site/controllers/events/createRecurring",{eventId:a.options.eventId,datetime:b})},completed:function(){a.progress().parent().removeClass("progress-info").addClass("progress-success"),a.form().submit()}}}),b.resolve()}),EasySocial.module("site/events/edit",function(a){var b=this;EasySocial.require().script("validate","field").done(function(){EasySocial.Controller("Events.Edit",{defaultOptions:{id:null,isRecurring:0,hasRecurring:0,"{form}":"[data-form]","{nav}":"[data-step-nav]","{content}":"[data-step-content]","{fields}":"[data-edit-field]","{saveButton}":"[data-edit-save]","{saveApply}":'input[name="applyRecurring"]'}},function(b){return{init:function(){b.fields().addController("EasySocial.Controller.Field.Base",{mode:"edit"})
},errorFields:[],"{nav} click":function(c){var e=a(c).data("for");b.content().hide(),b.nav().removeClass("active"),c.addClass("active"),b.content().filterBy("id",e).show().find(b.fields.selector).trigger("show")},"{nav} error":function(a){a.addClass("error")},"{nav} clear":function(a){b.errorFields.length<1&&a.removeClass("error")},"{fields} error":function(a){b.triggerStepError(a)},"{fields} clear":function(a){b.clearStepError(a)},"{fieldItem} onError":function(a){b.triggerStepError(a)},triggerStepError:function(c){var d=c.data("id"),e=c.parents(b.content.selector).data("id");
a.inArray(d,b.errorFields)<0&&b.errorFields.push(d),b.nav().filterBy("for",e).trigger("error")},clearStepError:function(c){var d=c.data("id"),e=c.parents(b.content.selector).data("id");b.errorFields=a.without(b.errorFields,d),b.nav().filterBy("for",e).trigger("clear")},"{saveButton} click":function(a,c){c.preventDefault(),a.addClass("btn-loading"),b.form().validate().done(function(){"all"===a.data("editSave")&&b.saveApply().val(1),b.form().submit()}).fail(function(){a.removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})
})}}}),b.resolve()})}),EasySocial.module("site/events/item",function(){var b=this;EasySocial.template("info/item",'<li data-sidebar-item><a class="ml-20" href="[%= url %]" title="[%= title %]" data-info-item data-info-index="[%= index %]"><i class="fa fa-info-circle mr-5"></i> [%= title %]</a></li>'),EasySocial.require().script("site/friends/suggest","site/events/guestState").view("site/loading/small").library("history").done(function(a){EasySocial.Controller("Events.Item",{defaultOptions:{id:null,"{filterStreamList}":"[data-filter-stream-list]","{sidebarItem}":"[data-sidebar-item]","{addFilter}":"[data-filter-add]","{editFilter}":"[data-filter-edit]","{filterStream}":"[data-filter-stream]","{filterApp}":"[data-filter-app]","{showAllFilters}":"[data-filter-showall]","{apps}":"[data-app-item]","{content}":"[data-content]","{saveHashtag}":"[data-hashtag-filter-save]","{invite}":"[data-action-invite]","{unpublish}":"[data-action-unpublish]","{delete}":"[data-action-delete]","{guestStateWrap}":"[data-guest-state-wrap]","{info}":"[data-info]","{infoItem}":"[data-info-item]","{menuItem}":"[data-dashboardSidebar-menu]",view:{infoItem:"info/item",loading:"site/loading/small"}}},function(b){return{init:function(){b.initGuestStates()
},initGuestStates:function(){b.guestStateWrap().addController("EasySocial.Controller.Events.GuestState")},setActive:function(a){b.sidebarItem().removeClass("active"),a.parents(b.sidebarItem.selector).addClass("active")},setLoading:function(){b.content().html(""),b.element.addClass("loading")},updateContents:function(a){b.element.removeClass("loading"),b.content().html(a)},"{showAllFilters} click":function(a){a.hide(),b.sidebarItem().show()},"{editFilter} click":function(a,c){c.preventDefault(),a.route(),b.setLoading(),b.getFilter(a.data("id")),b.setActive(a.parents("[data-sidebar-item]"))
},"{addFilter} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading(),b.getFilter(0)},getFilter:function(a){EasySocial.ajax("site/controllers/events/getFilter",{filterId:a,eventId:b.options.id}).always(function(a){b.updateContents(a)})},"{filterApp} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading(),b.getStream(a.data("id"),"apps")},"{filterStream} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading(),b.getStream(a.data("id"),a.data("type"))
},"{menuItem} click":function(c){b.menuItem().removeClass("active"),a(c).addClass("active")},getStream:function(a,c){EasySocial.ajax("site/controllers/events/getStream",{id:a,type:c,view:"events",eventId:b.options.id}).always(function(a){b.updateContents(a)})},"{saveHashtag} click":function(c){var d=c.data("tag");EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmSaveFilter",{tag:d}),bindings:{"{saveButton} click":function(){this.inputWarning().hide();var c=this.inputTitle().val();return""==c?(this.inputWarning().show(),void 0):(EasySocial.ajax("site/controllers/events/addFilter",{title:c,tag:d,id:b.options.id}).done(function(c,d){var e=a.buildHTML(c);
b.filterStreamList().append(e),EasySocial.dialog(d),setTimeout(function(){EasySocial.dialog().close()},2e3)}),void 0)}}})},"{apps} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading(),EasySocial.ajax("site/controllers/events/getAppContents",{appId:a.data("app-id"),eventId:b.options.id}).always(function(a){b.updateContents(a)})},"{info} click":function(c,d){d.preventDefault(),c.route(),b.setActive(c),b.setLoading();var e=c.data("loaded");return e?(b.infoItem().eq(0).trigger("click"),void 0):(c.enabled()&&(c.disabled(!0),EasySocial.ajax("site/controllers/events/initInfo",{eventId:b.options.id}).done(function(d){c.data("loaded",1);
var e=c.parent("[data-sidebar-item]");a.each(d.reverse(),function(a,c){c.hide||e.after(b.view.infoItem({url:c.url,title:c.title,index:c.index})),c.html&&(b.updateContents(c.html),b.content().find("[data-field]").trigger("onShow"))});var f=b.infoItem().eq(0);b.setActive(f),a(document).prop("title",f.attr("title")),c.enabled(!0)}).fail(function(a){c.enabled(!0),b.updateContents(a.message)})),void 0)},"{infoItem} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading();var d=a.data("info-index");
EasySocial.ajax("site/controllers/events/getInfo",{eventId:b.options.id,index:d}).done(function(a){b.updateContents(a),b.content().find("[data-field]").trigger("onShow")}).fail(function(a){b.updateContents(a.message)})},"{invite} click":function(){EasySocial.dialog({content:b.view.loading(),width:400,heigth:150}),EasySocial.ajax("site/views/events/inviteFriendsDialog",{id:b.options.id}).done(function(a){EasySocial.dialog({content:a})})},"{unpublish} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/events/unpublishEventDialog",{id:b.options.id})})
},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/events/deleteEventDialog",{id:b.options.id})})}}}),b.resolve()})}),EasySocial.module("site/events/update",function(a){var b=this;EasySocial.Controller("Events.Update",{defaultOptions:{postdata:{},updateids:[],schedule:[],eventId:null,"{progress}":"[data-progress-bar]","{form}":"[data-form]"}},function(b){return{init:function(){b.startUpdate()},updateCounter:0,createCounter:0,updateProgressBar:function(){var a=Math.ceil((b.updateCounter+b.createCounter)/(b.options.updateids.length+b.options.schedule.length)*100);
b.progress().css({width:a+"%"})},startUpdate:function(){return void 0===b.options.updateids[b.updateCounter]?b.startCreate():(b.update(b.options.updateids[b.updateCounter]).done(function(){b.updateCounter++,b.updateProgressBar(),b.startUpdate()}).fail(function(a,b){console.log(a,b)}),void 0)},update:function(c){var d=a.extend({},b.options.postdata,{id:c,applyRecurring:1});return EasySocial.ajax("site/controllers/events/update",d)},startCreate:function(){return void 0===b.options.schedule[b.createCounter]?b.completed():(b.create(b.options.schedule[b.createCounter]).done(function(){b.createCounter++,b.updateProgressBar(),b.startCreate()
}).fail(function(a,b){console.log(a,b)}),void 0)},create:function(a){return EasySocial.ajax("site/controllers/events/createRecurring",{eventId:b.options.eventId,datetime:a})},completed:function(){b.progress().parent().removeClass("progress-info").addClass("progress-success"),b.form().submit()}}}),b.resolve()}),EasySocial.module("site/explorer",function(a){var b=this,c="is-selected",d=".is-selected",f=".is-checked",g=":not(.is-selected)",h="is-active",i=".is-active",j="fileSelect",k="fileDeselect",l="folderActivate",m="folderDeactivate",n="fileInsert",o="folderInsert",p="fileRemove",q="folderRemove",r="fileUse",s="serviceRequest";
a.template("explorer/folder",'<div class="fd-explorer-folder" data-id="[%== data.id %]">[%== data.name %]<a href="javascript: void(0);" class="fd-folder-remove-button" data-fd-explorer-delete-folder-button><i class="fa fa-remove"></i></a></div>'),a.template("explorer/fileGroup",'<div class="fd-explorer-file-group" data-folder="[%== data.id %]" data-plupload-dropsite></div>'),a.template("explorer/file",'<div class="fd-explorer-file" data-id="[%== data.id %]">[%== data.name %]</div>'),EasySocial.require().script("site/explorer/uploader").done(),a.Controller("Explorer",{pluginName:"explorer",hostname:"explorer",defaultOptions:{view:{folder:"explorer/folder",fileGroup:"explorer/fileGroup",file:"explorer/file"},layout:{fileItemHeight:52},uid:null,type:null,disableValidation:!1,mockError:!1,controllerName:null,"{browser}":".fd-explorer-browser","{viewport}":".fd-explorer-viewport","{folderGroup}":".fd-explorer-folder-group","{folder}":".fd-explorer-folder","{fileGroup}":".fd-explorer-file-group","{file}":".fd-explorer-file","{button}":"[data-fd-explorer-button]","{mockError}":"[name=mock_error]","{disableValidation}":"[name=disable_validation]","{fileInput}":"[name=file]","{logs}":"[data-alertlog]","{togglefunky}":".togglefunky","{funky}":".fd-explorer-funky","{serviceState}":".service-state","{selectAllCheckbox}":"[data-fd-explorer-select-all]","{selectCheckbox}":"[data-fd-explorer-select]","{deleteButton}":"[data-fd-explorer-delete-button]","{deleteFolderButton}":"[data-fd-explorer-delete-folder-button]"}},function(b,e,t){return{init:function(){b.options.type=b.element.data("type"),b.options.uid=b.element.data("uid"),b.options.controllerName=b.element.data("controller-name"),a.module("easysocial/site/explorer/uploader").done(function(a){b.addPlugin("uploader",a)
}),b.services.getFolders().done(function(a){b.insertFolder(a),b.folder(":first").click()}),b.viewport().on("scroll",a.debounce(b.viewportScroll,250))},baseParams:function(){return{uid:t.data("uid"),type:t.data("type")}},exception:function(c){var d=b.logs();switch(a.isPlainObject(c)||(c={message:c,type:"error"}),c.type){case"error":d.switchClass("alert-error").html(c.message),EasySocial.debug&&console.error(c.message);break;case"warning":d.switchClass("alert-warning").html(c.message),EasySocial.debug&&console.warn(c.message);
break;case"success":d.switchClass("alert-success").html(c.message),EasySocial.debug&&console.log(c.message);break;case"info":default:d.switchClass("alert-info").html(c.message),EasySocial.debug&&console.log(c.message)}return c},library:{file:{},folder:{}},data:function(a,c){return b.library[a][c]},addData:function(c,d){return a.isPlainObject(d)&&(d=[d]),a.isArray(d)?(a.each(d,function(d){a.isPlainObject(this)||b.exception("Skipping invalid "+c+" data at index "+d+"."),null===this.id&&(this.id=0),b.library[c][this.id]=this
}),void 0):b.exception("Unable to add "+c+" to library due to invalid data given.")},removeData:function(a,c){delete b.library[a][c]},"{folder} click":function(a){b.activateFolder(a.data("id"))},currentFolder:function(){return b.folder(i).data("id")},activateFolder:function(a){var c=b.folder().filterBy("id",a),d=b.data("folder",a);c.length<1||(b.deactivateFolder(b.folder(i).data("id")),c.addClass(h),b.trigger(l,[a,c,d]))},deactivateFolder:function(a){var c=b.folder().filterBy("id",a),d=c.data("folder");c.length<1||(c.removeClass(h),b.trigger(m,[a,c,d]))
},selectedFolder:function(){return b.currentFolder()},"{file} click":function(a,c){var d=c.metaKey||c.ctrlKey;d||b.deselectAllFiles(),b.toggleFile(a.data("id"))},toggleFile:function(a){var d=b.file().filterBy("id",a),e=d.hasClass(c)?"deselectFile":"selectFile";d.length<1||b[e](a)},selectFile:function(a){var d=b.file().filterBy("id",a),e=b.data("file",a);d.length<1||(d.addClass(c),b.trigger(j,[a,d,e]))},deselectFile:function(a){var d=b.file().filterBy("id",a),e=d.data("file",a);d.length<1||(d.removeClass(c),b.trigger(k,[a,d,e]))
},selectAllFiles:function(){b.file(g).each(function(){b.selectFile(a(this).data("id"))})},deselectAllFiles:function(){b.file(d).each(function(){b.deselectFile(a(this).data("id"))})},selectedFile:function(){return b.selectedFiles()[0]},selectedFiles:function(){var e,c=[],e=b.file(f);return e.length<1&&(e=b.file(d)),e.each(function(){var b=a(this).data("id");c.push(b)}),c},insertFolder:function(c){a.isArray(c)||(c=[c]);var d=c[0];if(!a.isPlainObject(d))return b.exception("Invalid folder data given to be inserted into the folder group.");
var e=b.folderGroup();if(e.length<1)return b.exception("Could not locate folder group element.");var f="";a.each(c,function(){null===this.id&&(this.id=0),f+=b.view.folder(!0,{data:this})}),f=a.buildHTML(f).appendTo(e),b.trigger(o,[f,c])},prependFile:function(c){if(!a.isPlainObject(c))return b.exception("Invalid file data given to be inserted.");var d=b.fileGroup().filterBy("folder",c.folder);if(d.length<1)return b.exception("Could not locate file group element for folder id "+c.folder+".");var e=c.html||b.view.file(!0,{data:c});
a.buildHTML(e).data("finalized",!0).prependTo(d)},insertFile:function(c,d){if(a.isArray(c)||(c=[c]),void 0===d){var e=c[0];if(!a.isPlainObject(e))return b.exception("Invalid file data given to be inserted.");d=e.folder}var f=b.fileGroup().filterBy("folder",d);if(f.length<1)return b.exception("Could not locate file group element for folder id "+c.folder+".");var g=[];a.each(c,function(){var c=this;b.file().filterBy("id",this.id).each(function(){var d=a(this);if(!d.data("finalized")){var e=a.buildHTML(c.html||b.view.file(!0,{data:c})).data("finalized",!0);
d.replaceWith(e)}})}),b.trigger(n,[g,c])},removeFolder:function(a){var d,c=b.folder().filterBy("id",a);c.length<1&&(d=b.exception("Could not locate to remove folder element for folder id "+a+".")),c.remove();var e=b.fileGroup().filterBy("folder",a);e.length<1&&(d=b.exception("Could not locate to remove file group element for folder id "+a+".")),e.remove(),b.trigger(q,[a,d])},removeFile:function(a){var d,c=b.file().filterBy("id",a);c.length<1&&(d=b.exception("Could not locate to remove file element for file id "+a+".")),c.remove(),b.trigger(p,[a,d])
},service:function(c,d,f){b.serviceState().switchClass("state-busy");var g=EasySocial.ajax(t.data("url"),a.extend({hook:c,error:e.mockError},d),f).always(function(){b.serviceState().switchClass("state-idle")}).fail(function(a){b.exception(a)});return b.trigger(s,[c,g,d]),g},"{button} click":function(a){var c=a.attr("data-fd-explorer-button"),d=b.services[c];d&&d()},services:{getFolders:function(c){var d={start:0,limit:100},e=b.service("getFolders",a.extend(b.baseParams(),d,c)).done(function(a){b.addData("folder",a)
});return e},addFolder:function(c){c||(c={name:prompt(a.language("COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME"))});var d={name:""};if(c=a.extend(b.baseParams(),d,c),!c.name&&!e.disableValidation)return b.exception({message:a.language("COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME"),type:"error"}),void 0;var f=b.service("addFolder",c).done(function(a){b.addData("folder",a),b.insertFolder(a)});return f},removeFolder:function(c){var d={id:b.selectedFolder()};if(!e.disableValidation&&void 0===b.selectedFolder())return b.exception("No folder selected"),void 0;
var f=b.service("removeFolder",a.extend(b.baseParams(),d,c)).done(function(a){b.removeFolder(a)});return f},getFiles:function(c){var d={start:0,limit:100},e=b.service("getFiles",a.extend(b.baseParams(),d,c)).done(function(a){b.addData("file",a)});return e},addFile:function(c){var d={id:b.currentFolder(),files:b.fileInput()};if(!e.disableValidation&&!b.fileInput().val())return b.exception("No file chosen yet."),void 0;var f=b.service("addFile",a.extend(b.baseParams(),d,c),{type:"iframe"}).done(function(a){console.log("Upload returned data:",a),b.addData("file",a),b.prependFile(a),b.exception({message:"Added file "+a.name,type:"success"})
});return f},removeFile:function(c){var d={id:b.selectedFiles()},c=a.extend(b.baseParams(),d,c);if(!e.disableValidation&&a.isArray(c.id)&&c.length<1)return b.exception("No file selected"),void 0;var f=b.service("removeFile",c).done(function(c){a.isArray(c)?a.each(c,function(){b.removeFile(this)}):b.removeFile(c),b.selectAllCheckbox().prop("checked",!1)});return f},useFile:function(){var a=b.selectedFile(),c=b.file().filterBy("id",a),d=b.data("file",a);c.length<1||b.trigger(r,[a,c,d])},previewFile:function(){var a=b.selectedFile(),c=b.file().filterBy("id",a),e=(b.data("file",a),c.data("previewUri"));
e&&window.open(e,"_blank")}},"{self} folderActivate":function(a,c,d,e,f){var g=b.fileGroup(),i=g.filterBy("folder",d);if(g.removeClass(h),i.length<1){f.map||(f.map=[]);var j='<div class="fd-explorer-file" data-id="'+f.map.join('">&nbsp;</div><div class="fd-explorer-file" data-id="')+'">&nbsp;</div>';i=b.view.fileGroup({data:f}).html(j).appendTo(b.viewport()),b.services.getFiles({id:d}).done(function(a){b.insertFile(a,d)})}i.addClass("is-active")},viewportScroll:function(){var a=b.viewport()[0],e=(b.viewport().height(),a.scrollHeight,a.scrollTop),g=b.file(":nth(2)").outerHeight(!0),h=Math.floor(e/g),i=3,j=b.fileGroup(".is-active"),k=j.data("folder");
b.services.getFiles({id:k,start:h-i}).done(function(a){b.insertFile(a,k)}).always(function(){})},"{togglefunky} click":function(){b.funky().toggle()},"{disableValidation} change":function(a){e.disableValidation=!!a.prop("checked"),b.exception({message:"Client-side validation is "+(e.disableValidation?"OFF!":"ON!"),type:"info"})},"{mockError} change":function(a){e.mockError=!!a.prop("checked"),b.exception({message:"Error mocking is "+(e.mockError?"ON!":"OFF!"),type:"info"})},"{selectAllCheckbox} click":function(a){var c=a.prop("checked");
b.fileGroup(i).find(b.selectCheckbox.selector).prop("checked",c).trigger("change")},"{selectCheckbox} change":function(a){var c=b.file.of(a),e=(c.data("id"),a.prop("checked"));c.toggleClass("is-checked",e)},"{deleteButton} click":function(a){var c=b.file.of(a),d=c.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/explorer/confirmDeleteFile",{id:d}),bindings:{"{deleteButton} click":function(){EasySocial.dialog().close(),b.services.removeFile({id:d})}}})},"{deleteFolderButton} click":function(a,c){c.preventDefault();
var d=b.folder.of(a),e=d.data("id");0!==e&&EasySocial.dialog({content:EasySocial.ajax("site/views/explorer/confirmDeleteFolder",{id:e}),bindings:{"{deleteButton} click":function(){EasySocial.dialog().close(),b.services.removeFolder({id:e})}}})}}}),EasySocial.require().language("COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME","COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME").done(function(){b.resolve()})}),EasySocial.module("site/explorer/uploader",function(a){var b=this;a.require().library("plupload").done(function(){var c=a.Controller("Explorer/Uploader",{defaultOptions:{settings:{},"{uploadItemGroup}":"[data-fd-explorer-upload-item-group]","{uploadItem}":"[data-fd-explorer-upload-item]"}},function(b,c,d){return{init:function(){d.plupload(c.settings),b.plupload=d.plupload("controller").plupload
},settings:function(a,c){var d=b.plupload.settings;return void 0!==c&&(d[a]=c),a?d[a]:d},"{self} folderActivate":function(){},"{self} BeforeUpload":function(){var h=a.uri(EasySocial.ajaxUrl).addQueryParam("controller",b.explorer.options.controllerName).addQueryParam("task","explorer").addQueryParam("id",b.explorer.currentFolder()).addQueryParam("no_html",1).addQueryParam("format","json").addQueryParam("hook","addFile").addQueryParam("tmpl","component").addQueryParam("uid",d.data("uid")).addQueryParam("type",d.data("type")).addQueryParam(EasySocial.token(),1).toString();
b.settings("url",h)},"{self} FilesAdded":function(){b.plupload.start()},"{self} UploadFile":function(){clearTimeout(b.loadTimer),d.addClass("is-loading")},"{self} FileUploaded":function(c,e,f,g,h){b.loadTimer=setTimeout(function(){d.removeClass("is-loading")},1e3);var i=b.explorer;return a.isPlainObject(h)?(i.addData("file",h),i.prependFile(h),void 0):(b.setMessage("Server did not return proper data after uploading.","error"),void 0)},"{self} FileError":function(c,e,f,g,h){d.removeClass("is-loading"),a.isPlainObject(h)&&b.setMessage(h.message,"error")
},"{self} Error":function(a,c,e,f){d.removeClass("is-loading"),b.setMessage(f.message,"error")}}});b.resolve(c)})}),EasySocial.module("site/explorer/popup",function(a){var b=this;EasySocial.require().view("site/explorer/popup").done(function(){a.Controller("Explorer/Popup",{defaultOptions:{view:{popup:"easysocial/site/explorer/popup"},"{popup}":"[data-explorer-popup]","{viewport}":"[data-popup-viewport]","{explorer}":"[data-explorer-popup] .fd-explorer","{closeButton}":".fd-explorer .close-button"}},function(b,c,d){return{init:function(){},"{window} resize":a.debounce(function(){},100),show:function(){var c,e=b.popup.node;
e||(c=b.view.popup(),e=b.popup.node=c[0]),a.contains(d,e)||(c=a(e).appendTo(d)),c.is(":visible")||c.show().trigger("show")},hide:function(){b.popup().hide().trigger("hide").detach()},open:function(c){b.show();var d=a.Deferred(),e=b.explorer();return e.length>0&&e.data("uid")===c.uid&&e.data("type")===c.type?d.resolve(e.explorer("controller"),b):(EasySocial.ajax("site/views/explorer/browser",c).done(function(c){var e=a.buildHTML(c);b.viewport().empty().append(e);var f=e.filter(".fd-explorer").explorer("controller");
d.resolve(f,b)}).fail(function(){d.reject()}),d)},"{self} click":function(a,c){c.target===b.popup()[0]&&b.hide()},"{closeButton} click":function(){b.hide()}}});var c=EasySocial.explorer=a("body").addController("Explorer/Popup");b.resolve(c)})}),EasySocial.module("site/followers/followers",function(){var b=this;EasySocial.require().view("site/loading/small").script("site/conversations/composer").done(function(a){EasySocial.Controller("Followers",{defaultOptions:{"{content}":"[data-followers-content]","{filter}":"[data-followers-filter]","{items}":"[data-followers-item]","{followingCounter}":"[data-following-count]","{suggestionCounter}":"[data-suggest-count]",view:{loader:"site/loading/small"}}},function(b){return{init:function(){b.initItemController()
},initItemController:function(){b.items().implement(EasySocial.Controller.Followers.Item,{"{parent}":b})},updateFollowingCounter:function(a){var c=b.followingCounter().html(),d=parseInt(c)+a;b.followingCounter().html(d)},updateSuggestionCounter:function(a){var c=b.suggestionCounter().html(),d=parseInt(c)+a;b.suggestionCounter().html(d)},updateContents:function(a){b.content().replaceWith(a)},updatePagination:function(b){a("[data-followers-pagination]").html(b)},"{filter} click":function(a){var d=a.data("followers-filter-type"),e=a.data("followers-filter-title"),f=a.data("followers-filter-id"),g=a.data("followers-filter-url");
b.filter().removeClass("active"),a.addClass("active"),History.pushState({state:1},e,g),EasySocial.ajax("site/controllers/followers/filter",{id:f,type:d}).done(function(a,c){b.updateContents(a),b.updatePagination(c),b.initItemController()})}}}),EasySocial.Controller("Followers.Item",{defaultOptions:{"{unfollowButton}":"[data-followers-item-unfollow]","{followButton}":"[data-followers-item-follow]","{composer}":"[data-followers-item-compose]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.initComposer()
},initComposer:function(){a.composer().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:a.options.id}})},"{unfollowButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/followers/confirmUnfollow",{id:a.options.id}),bindings:{"{unfollowButton} click":function(){EasySocial.ajax("site/controllers/followers/unfollow",{id:a.options.id}).done(function(){a.parent.updateFollowingCounter(-1),a.element.remove(),EasySocial.dialog().close()})}}})},"{followButton} click":function(){EasySocial.ajax("site/controllers/followers/follow",{id:a.options.id}).done(function(b){a.parent.updateSuggestionCounter(-1),a.parent.updateFollowingCounter(1),a.element.html(b)
}).fail(function(a){EasySocial.dialog({content:a.message})})}}}),b.resolve()})}),EasySocial.module("site/friends/friends",function(){var b=this;EasySocial.require().script("site/friends/list","site/friends/item","site/friends/suggest","site/conversations/composer").view("site/loading/small","site/friends/default.empty","site/friends/list.assign").done(function(a){EasySocial.Controller("Friends.Birthday",{defaultOptions:{"{messageButton}":"[data-upcoming-birthday-message-button]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.name=a.element.data("name"),a.options.avatar=a.element.data("avatar"),a.messageButton().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:a.options.id,name:a.options.name,avatar:a.options.avatar}})
}}}),EasySocial.Controller("Friends",{defaultOptions:{activeList:null,"{friendList}":"[data-friends-list]","{content}":"[data-friends-content]","{friendItems}":"[data-friends-items]","{friendItem}":"[data-friends-item]","{emptyList}":"[data-friends-emptyItems]","{activeTitle}":"[data-friends-activeTitle]","{filterItem}":"[data-friends-filter]","{friendListActions}":"[data-friendList-actions]","{addFriendToList}":"[data-friends-add]","{friendsCounter}":"[data-total-friends]","{pendingCounter}":"[data-total-friends-pending]","{suggestionCounter}":"[data-total-friends-suggestion]","{requestCount}":"[data-frields-request-sent-count]",view:{loader:"site/loading/small",emptyFriendItems:"site/friends/default.empty",addUserForm:"site/friends/list.assign"}}},function(b){return{init:function(){b.friendList().implement(EasySocial.Controller.Friends.List,{"{parent}":b}),b.initFriendItems()
},initFriendItems:function(){b.friendListActions().implement(EasySocial.Controller.Friends.List.Actions,{"{parent}":b}),b.friendItem().implement(EasySocial.Controller.Friends.Item,{"{parent}":b})},updateFriendsCounter:function(){EasySocial.ajax("site/controllers/friends/getCounters").done(function(a,c,d,e){b.friendsCounter().html(a),b.pendingCounter().html(c),b.requestCount().html(d),b.suggestionCounter().html(e)})},updateListCounters:function(){EasySocial.ajax("site/controllers/friends/getListCounts",{}).done(function(b){a(b).each(function(b,c){var d=a("[data-list-"+c.id+"]").controller();
d.updateCounter(c.count)})})},insertItem:function(c){b.emptyList().hide(),b.updateListCounters(),a(c).implement(EasySocial.Controller.Friends.Item,{"{parent}":b}).prependTo(b.friendItems())},removeItem:function(a){b.friendItem("[data-friendItem-"+a+"]").remove(),b.friendItem().length<=0&&b.emptyList().show(),b.updateListCounters()},updateFriendRequestCount:function(a){curCount=parseInt(b.requestCount().text(),10),0/0!=curCount&&(curCount+=a,b.requestCount().text(curCount))},updateContent:function(a){b.content().replaceWith(a),b.initFriendItems()
},removeActiveFilter:function(){b.filterItem().removeClass("active")},"{filterItem} click":function(a){var d=a.data("filter"),e=a.data("title"),f=a.data("userid"),g=a.data("url");b.friendList().length>0&&b.friendList().controller().removeActiveList(),b.filterItem().removeClass("active"),a.addClass("active"),History.pushState({state:1},e,g),a.addClass("loading"),EasySocial.ajax("site/controllers/friends/filter",{filter:d,userid:f}).done(function(a){b.updateContent(a)}).always(function(){a.removeClass("loading")
})}}}),b.resolve()})}),EasySocial.module("site/friends/list",function(){var b=this;EasySocial.require().view("site/loading/small").library("history").script("site/friends/suggest").done(function(a){EasySocial.Controller("Friends.List",{defaultOptions:{parent:null,"{item}":"[data-friends-listItem]","{items}":"[data-friends-listItems]","{loadMoreButton}":".loadMoreButton","{loadMore}":".loadMore",view:{loader:"site/loading/small",items:"site/friends/default.lists"}}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Friends.List.Item,{"{parent}":b})
},removeActiveList:function(){b.item().removeClass("active")},setDefault:function(a){b.item().removeClass("default"),b.item(".item-"+a).addClass("default")},"{item} click":function(c){var d=a(c).data("title"),e=a(c).data("url");History.pushState({state:1},d,e),b.parent.removeActiveFilter(),b.item().removeClass("active"),b.item(c).addClass("active");var f=a(c).data("id");b.parent.options.activeList=f,EasySocial.ajax("site/controllers/friends/getListFriends",{id:f},{beforeSend:function(){a(c).addClass("loading")
}}).done(function(d){a(c).removeClass("loading"),b.parent.updateContent(d)})},"{loadMoreButton} click":function(){var a=b.loadMoreButton().data("limitstart");b.loadMore().html(b.view.loader()),EasySocial.ajax("site/controllers/friends/getLists",{limitstart:a}).done(function(a){b.loadMore().hide(),b.view.items({items:a}).appendTo(b.items())})}}}),EasySocial.Controller("Friends.List.Item",{defaultOptions:{id:null,"{counter}":"[data-list-counter]"}},function(a){return{init:function(){a.options.id=a.element.data("id")
},updateCounter:function(b){a.counter().html(b)}}}),EasySocial.Controller("Friends.List.Actions",{defaultOptions:{"{delete}":"[data-friendListActions-delete]","{add}":"[data-friendListActions-add]","{default}":"[data-friendListActions-default]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.title=b.element.data("title"),b.options.userId=b.element.data("userid")},"{default} click":function(){EasySocial.ajax("site/controllers/friends/setDefault",{id:b.options.id}).done(function(){b.parent.friendList().controller().setDefault(b.options.id)
})},"{add} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/assignList",{id:b.options.id}),bindings:{"{insertButton} click":function(){var c=this.suggest().textboxlist("controller").getAddedItems();EasySocial.ajax("site/controllers/friends/assign",{uid:a.pluck(c,"id"),userId:b.options.userId,listId:b.options.id}).done(function(c){a("[data-assignFriends-notice]").hide(),a(c).each(function(c,d){b.parent.insertItem(d),a("[data-friends-items]").removeClass("is-empty"),EasySocial.dialog().close()
})}).fail(function(b){a("[data-assignFriends-notice]").addClass("alert alert-error").html(b.message)})}}})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmDeleteList",{id:b.options.id}),bindings:{"{deleteButton} click":function(){a("[data-friends-list-delete-form]").submit()}}})}}}),b.resolve()})}),EasySocial.module("site/friends/item",function(){var b=this;EasySocial.require().script("site/conversations/composer").language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL","COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE","COM_EASYSOCIAL_FRIENDS_CANCEL_REQUEST_DIALOG_CANCELLED","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT").done(function(a){EasySocial.Controller("Friends.Item",{defaultOptions:{id:null,name:null,friendId:null,"{removeFromList}":"[data-lists-removeFriend]","{unfriend}":"[data-friends-unfriend]","{addfriend}":"[data-friends-addfriend]","{block}":"[data-friends-block]","{message}":"[data-friendItem-message]","{reject}":"[data-friendItem-reject]","{approve}":"[data-friendItem-approve]","{addContainer}":"[data-friendItem-addbutton]","{addButton}":"[data-friendItem-add]","{cancelRequest}":"[data-friendItem-cancel-request]"}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.options.name=b.element.data("name"),b.options.friendId=b.element.data("friendid"),b.options.avatar=b.element.data("avatar"),b.initConversation()
},"{addButton} click":function(){EasySocial.ajax("site/controllers/friends/request",{id:b.options.id}).done(function(){b.addContainer().html(a.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT")),b.addContainer().addClass("btn btn-es-success btn-sm mt-20")}).fail(function(a){EasySocial.dialog({width:450,height:180,content:a.message})})},initConversation:function(){b.message().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{name:b.options.name,id:b.options.id,avatar:b.options.avatar}})},"{removeFromList} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmRemoveFromList",{id:b.options.id}),bindings:{"{removeButton} click":function(){EasySocial.ajax("site/controllers/friends/removeFromList",{listId:b.parent.options.activeList,userId:b.options.id}).done(function(){b.parent.removeItem(b.options.id),EasySocial.dialog({title:"User removed from list",content:"The user has been removed from the list.",buttons:[{name:"Done",classNames:"btn btn-es",click:function(){EasySocial.dialog().close()
}}]})}).fail(function(a){console.log(a)})}}})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmReject",{id:b.options.id}),bindings:{"{rejectButton} click":function(){EasySocial.ajax("site/controllers/friends/reject",{id:b.options.friendId}).done(function(){b.parent.removeItem(b.options.id),b.parent.updateFriendsCounter(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/friendRejected")})})}}})},"{unfriend} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmUnfriend",{id:b.options.id}),bindings:{"{unfriendButton} click":function(){EasySocial.ajax("site/controllers/friends/unfriend",{id:b.options.friendId}).done(function(){b.parent.removeItem(b.options.id),b.parent.updateFriendsCounter(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/friendRemoved",{id:b.options.id})})
})}}})},"{cancelRequest} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmCancelRequest",{id:b.options.id}),bindings:{"{cancelRequestButton} click":function(){EasySocial.ajax("site/controllers/friends/cancelRequest",{id:b.options.friendId}).done(function(){b.parent.removeItem(b.options.id),b.parent.updateFriendRequestCount(-1),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/requestCancelled",{id:b.options.id})})})}}})},"{approve} click":function(){EasySocial.ajax("site/controllers/friends/approve",{id:b.options.friendId}).done(function(){b.parent.updateFriendsCounter(),b.element.remove()
})},"{addfriend} click":function(){EasySocial.ajax("site/controllers/friends/request",{id:b.options.id}).done(function(){b.parent.updateFriendRequestCount(1),EasySocial.dialog({title:a.language("COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE"),content:a.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL",b.options.name)}),b.parent.removeItem(b.options.id)}).fail(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")})})},"{block} click":function(){console.log("block")}}
}),b.resolve()})}),EasySocial.module("site/groups/groups",function(){var b=this;EasySocial.require().view("site/loading/small").script("validate","field").done(function(a){EasySocial.Controller("Groups.Browser",{defaultOptions:{"{filters}":"[data-es-groups-filters] > li","{sort}":"[data-groups-sort]","{categories}":"[data-es-groups-categories] >li","{content}":"[data-es-groups-content]","{items}":"[data-groups-item]","{featured}":"[data-groups-featured-item]","{listContents}":"[data-es-groups-list]",view:{loader:"site/loading/small"}}},function(b){return{init:function(){b.initGroupController()
},initGroupController:function(){b.filters().implement(EasySocial.Controller.Groups.Filter,{"{parent}":b}),b.sort().implement(EasySocial.Controller.Groups.Sort,{"{parent}":b}),b.categories().implement(EasySocial.Controller.Groups.Filter.Category,{"{parent}":b}),b.featured().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":b}),b.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":b})},setActive:function(c){b.categories().removeClass("active"),b.filters().removeClass("active"),a(c).addClass("active"),b.content().html("&nbsp;"),b.element.addClass("loading")
},setListContent:function(a){b.listContents().html(a),b.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":b})},setContent:function(a,c){b.element.removeClass("loading"),c?b.content().html(a):b.listContents().html(a),b.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":b})}}}),EasySocial.Controller("Groups.Browser.Item",{defaultOptions:{"{joinGroup}":"[data-groups-item-join]","{leaveGroup}":"[data-groups-leave]","{respond}":"[data-groups-item-respond]","{setFeatured}":"[data-groups-item-set-featured]","{removeFeatured}":"[data-groups-item-remove-featured]","{deleteGroup}":"[data-groups-item-delete]","{unpublishGroup}":"[data-groups-item-unpublish]","{footer}":"[data-groups-item-footer]"}},function(a,b,c){return{init:function(){b.id=a.element.data("id"),b.type=a.element.data("type")
},"{deleteGroup} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmDelete",{id:a.options.id})})},"{unpublishGroup} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmUnpublishGroup",{id:a.options.id})})},"{setFeatured} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/setFeatured",{id:a.options.id})})},"{removeFeatured} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/removeFeatured",{id:a.options.id})})
},"{respond} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmRespondInvitation",{id:a.options.id}),bindings:{"{rejectButton} click":function(){c.switchClass("is-loading"),EasySocial.ajax("site/controllers/groups/respondInvitation",{id:b.id,action:"reject"}).done(function(){c.switchClass("is-guest"),EasySocial.dialog().close()})},"{acceptButton} click":function(){c.switchClass("is-loading"),EasySocial.ajax("site/controllers/groups/respondInvitation",{id:b.id,action:"accept"}).done(function(){c.switchClass("is-member"),EasySocial.dialog().close()
})}}})},"{leaveGroup} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmLeaveGroup",{id:b.id}),bindings:{"{leaveButton} click":function(){c.switchClass("is-loading"),EasySocial.ajax("site/controllers/groups/leaveGroup",{id:b.id}).done(function(){c.switchClass("is-guest"),EasySocial.dialog().close()})}}})},"{joinGroup} click":function(){return"open"==b.type?(c.switchClass("is-loading"),EasySocial.ajax("site/controllers/groups/joingroup",{id:b.id}).done(function(){c.switchClass("is-member")
}),void 0):(EasySocial.dialog({content:EasySocial.ajax("site/controllers/groups/joinGroup",{id:b.id})}),void 0)}}}),EasySocial.Controller("Groups.Edit",{defaultOptions:{id:null,"{stepContent}":"[data-group-edit-fields-content]","{stepItem}":"[data-group-edit-fields-step]","{profileForm}":"[data-group-fields-form]","{profileContent}":"[data-group-edit-fields]","{fieldItem}":"[data-group-edit-fields-item]","{save}":"[data-group-fields-save]"}},function(b){return{init:function(){b.fieldItem().addController("EasySocial.Controller.Field.Base",{mode:"edit"})
},errorFields:[],"{fieldItem} error":function(a){b.triggerStepError(a)},"{fieldItem} clear":function(a){b.clearStepError(a)},"{fieldItem} onError":function(a){b.triggerStepError(a)},triggerStepError:function(c){var d=c.data("id"),e=c.parents(b.stepContent.selector).data("id");a.inArray(d,b.errorFields)<0&&b.errorFields.push(d),b.stepItem().filterBy("for",e).trigger("error")},clearStepError:function(c){var d=c.data("id"),e=c.parents(b.stepContent.selector).data("id");b.errorFields=a.without(b.errorFields,d),b.stepItem().filterBy("for",e).trigger("clear")
},"{stepItem} click":function(c){var e=a(c).data("for");b.profileContent().show(),b.stepContent().hide(),b.stepItem().removeClass("active"),c.addClass("active");var f=b.stepContent(".step-"+e);f.show(),f.find(b.fieldItem.selector).trigger("show")},"{stepItem} error":function(a){a.addClass("error")},"{stepItem} clear":function(a){b.errorFields.length<1&&a.removeClass("error")},"{save} click":function(a,c){return c.preventDefault(),a.addClass("btn-loading"),b.profileForm().validate().fail(function(){a.removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})
}).done(function(){b.profileForm().submit()}),!1}}}),EasySocial.Controller("Groups.Filter",{defaultOptions:{}},function(b){return{init:function(){},"{self} click":function(c,d){d.preventDefault(),b.parent.setActive(c),a(c).find("a").route(),EasySocial.ajax("site/controllers/groups/getGroups",{filter:b.element.data("es-groups-filters-type")}).done(function(a){b.parent.setContent(a,!0),b.parent.initGroupController()})}}}),EasySocial.Controller("Groups.Sort",{defaultOptions:{}},function(b){return{init:function(){},"{self} click":function(c,d){d.preventDefault();
var e=c.data("type"),f=c.data("filter"),g=c.data("categoryid");a("<a>").attr({title:document.title,href:c.attr("href")}).route(),b.parent.sort().removeClass("active"),c.addClass("active"),b.parent.listContents().html(b.parent.view.loader()),EasySocial.ajax("site/controllers/groups/getGroups",{ordering:e,filter:f,categoryId:g}).done(function(a){b.parent.setContent(a,!1),b.parent.initGroupController()})}}}),EasySocial.Controller("Groups.Filter.Category",{defaultOptions:{id:null}},function(b){return{init:function(){b.options.id=b.element.data("es-groups-category-id")
},"{self} click":function(c,d){d.preventDefault(),b.parent.setActive(c),a(c).find("a").route(),EasySocial.ajax("site/controllers/groups/getGroups",{categoryId:b.options.id}).done(function(a){b.parent.setContent(a,!0),b.parent.initGroupController()})}}}),EasySocial.Controller("Groups.Create",{defaultOptions:{previousLink:null,"{fieldItem}":"[data-groups-create-fields-item]","{previousButton}":"[data-groups-create-previous]","{nextButton}":"[data-groups-create-submit]"}},function(a){return{init:function(){a.fieldItem().addController("EasySocial.Controller.Field.Base")
},"{previousButton} click":function(){window.location=a.options.previousLink},"{nextButton} click":function(b){b.enabled()&&(b.disabled(!0),b.addClass("btn-loading"),a.element.validate().done(function(){b.removeClass("btn-loading"),b.enabled(!0),a.element.submit()}).fail(function(){b.removeClass("btn-loading"),b.enabled(!0),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}))}}}),b.resolve()})}),EasySocial.module("site/groups/item",function(){var b=this;EasySocial.template("info/item",'<li data-es-group-filter><a class="ml-20" href="[%= url %]" title="[%= title %]" data-info-item data-info-index="[%= index %]"><i class="fa fa-info-circle mr-5"></i> [%= title %]</a></li>'),EasySocial.require().script("site/friends/suggest").library("history").done(function(a){EasySocial.Controller("Groups.Item",{defaultOptions:{"{content}":"[data-es-group-item-content]","{apps}":"[data-es-group-item-app]","{filters}":"[data-es-group-filter]","{filterStream}":"[data-es-group-stream]","{appFilter}":"[data-es-group-app-filter]","{appFilterShowAll}":"[data-app-filters-showall]","{filterBtn}":"[data-stream-filter-button]","{filterEditBtn}":"[data-dashboardFeeds-Filter-edit]","{filterModeration}":"[data-filter-moderation]","{saveHashTag}":"[data-hashtag-filter-save]","{filterUL}":"[data-es-group-ul]","{joinGroup}":"[data-es-group-join]","{leaveGroup}":"[data-es-group-leave]","{invite}":"[data-es-group-invite]","{respond}":"[data-es-group-respond]","{withdraw}":"[data-es-group-withdraw]","{info}":"[data-info]","{infoItem}":"[data-info-item]",view:{infoItem:"info/item"}}},function(b,c,d){return{init:function(){c.type=d.data("type"),c.id=d.data("id"),b.apps().implement(EasySocial.Controller.Groups.Item.App,{"{parent}":b,groupId:c.id})
},setActive:function(a){b.filters().removeClass("active"),a.parent().addClass("active")},setLoading:function(){b.content().html(""),b.element.addClass("loading")},updateContents:function(a){b.element.removeClass("loading"),b.content().html(a)},"{appFilterShowAll} click":function(a){a.hide(),b.filters().removeClass("hide")},"{filterEditBtn} click":function(a,c){c.preventDefault(),a.route(),b.setLoading(),b.setActive(a),EasySocial.ajax("site/controllers/groups/getFilter",{id:a.data("id"),clusterId:b.options.id}).done(function(a){b.updateContents(a)
}).fail(function(a){return a}).always(function(){})},"{filterBtn} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading(),EasySocial.ajax("site/controllers/groups/getFilter",{id:0,clusterId:b.options.id}).done(function(a){b.updateContents(a)}).fail(function(a){return a}).always(function(){})},"{appFilter} click":function(a,c){c.preventDefault();var d=a.data("url"),e=a.data("title");History.pushState({state:1},e,d),b.setActive(a),b.setLoading(),b.setActive(a);var f=a.data("id");EasySocial.ajax("site/controllers/groups/getStream",{id:b.options.id,app:f,view:"groups"}).done(function(a){b.updateContents(a)
})},"{filterModeration} click":function(a,d){d.preventDefault(),a.route(),b.setActive(a),EasySocial.ajax("site/controllers/groups/getStream",{id:c.id,view:"groups",moderation:1}).done(function(a){b.updateContents(a)})},"{filterStream} click":function(c,d){d.preventDefault(),b.setActive(c),c.route(),b.setLoading();var e=a("[data-dashboardSidebar-menu].active"),f=e.data("fid");EasySocial.ajax("site/controllers/groups/getStream",{id:b.options.id,filterId:f,view:"groups",layout:"item"}).done(function(a){b.updateContents(a)
})},"{saveHashTag} click":function(c){var d=c.data("tag"),e=c.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmSaveFilter",{tag:d}),bindings:{"{saveButton} click":function(){return this.inputWarning().hide(),filterName=this.inputTitle().val(),""==filterName?(this.inputWarning().show(),void 0):(EasySocial.ajax("site/controllers/groups/addFilter",{title:filterName,tag:d,id:e}).done(function(c,d){var e=a.buildHTML(c);b.filterUL().append(e),EasySocial.dialog(d),setTimeout(function(){EasySocial.dialog().close()
},2e3)}),void 0)}}})},"{withdraw} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmWithdraw",{id:b.options.id})})},"{invite} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/inviteFriends",{id:b.options.id}),position:{my:"center top",at:"center top",of:window}})},"{respond} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmRespondInvitation",{id:b.options.id}),bindings:{"{rejectButton} click":function(){this.responseValue().val("reject"),this.form().submit()
},"{acceptButton} click":function(){this.responseValue().val("accept"),this.form().submit()}}})},"{joinGroup} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/controllers/groups/joinGroup",{id:b.options.id})})},"{leaveGroup} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmLeaveGroup",{id:b.options.id}),bindings:{"{leaveButton} click":function(){this.leaveForm().submit()}}})},"{info} click":function(c,d){d.preventDefault(),c.route(),b.setActive(c),b.setLoading();
var e=c.data("loaded");return e?(b.infoItem().eq(0).trigger("click"),void 0):(c.enabled()&&(c.disabled(!0),EasySocial.ajax("site/controllers/groups/initInfo",{groupId:b.options.id}).done(function(d){c.data("loaded",1);var e=c.parent("[data-es-group-filter]");a.each(d.reverse(),function(a,c){c.hide||e.after(b.view.infoItem({url:c.url,title:c.title,index:c.index})),c.html&&(b.updateContents(c.html),b.content().find("[data-field]").trigger("onShow"))});var f=b.infoItem().eq(0);b.setActive(f),a(document).prop("title",f.attr("title")),c.enabled(!0)
}).fail(function(a){c.enabled(!0),b.updateContents(a.message)})),void 0)},"{infoItem} click":function(a,c){c.preventDefault(),a.route(),b.setActive(a),b.setLoading();var d=a.data("info-index");EasySocial.ajax("site/controllers/groups/getInfo",{groupId:b.options.id,index:d}).done(function(a){b.updateContents(a),b.content().find("[data-field]").trigger("onShow")}).fail(function(a){b.updateContents(a.message)})}}}),EasySocial.Controller("Groups.Item.App",{defaultOptions:{}},function(a){return{init:function(){a.options.id=a.element.data("app-id")
},"{self} click":function(b,c){c.preventDefault(),b.route(),a.parent.setActive(b),a.parent.setLoading(),EasySocial.ajax("site/controllers/groups/getAppContents",{appId:a.options.id,groupId:a.options.groupId}).done(function(b){a.parent.updateContents(b)}).fail(function(a){return a})}}}),EasySocial.Controller("Groups.Item.Members",{defaultOptions:{"{items}":"[data-group-members-item]","{filters}":"[data-group-members-filter]","{content}":"[data-group-members-content]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.items().implement(EasySocial.Controller.Groups.Item.Members.Record)
},"{filters} click":function(b){a.filters().removeClass("active"),b.addClass("active");var d=b.data("filter");a.content().html("&nbsp;"),a.content().addClass("is-loading"),EasySocial.ajax("apps/group/members/controllers/groups/filterMembers",{id:a.options.id,filter:d}).done(function(b){a.content().removeClass("is-loading"),a.content().html(b),a.items().implement(EasySocial.Controller.Groups.Item.Members.Record)})}}}),EasySocial.Controller("Groups.Item.Members.Record",{defaultOptions:{"{makeAdmin}":"[data-members-make-admin]","{revokeAdmin}":"[data-members-revoke-admin]","{approve}":"[data-members-approve]","{reject}":"[data-members-reject]","{removeMember}":"[data-members-remove]","{cancelInvitation}":"[data-members-cancel-invitation]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.groupId=a.element.data("groupid"),a.options.redirect=a.element.data("redirect")
},"{approve} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmApprove",{id:a.options.groupId,userId:a.options.id,"return":a.options.redirect})})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmReject",{id:a.options.groupId,userId:a.options.id})})},"{cancelInvitation} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmCancelInvitation",{id:a.options.groupId,userId:a.options.id})})},"{revokeAdmin} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmRevokeAdmin",{id:a.options.groupId,userId:a.options.id}),bindings:{"{revokeButton} click":function(){EasySocial.ajax("site/controllers/groups/revokeAdmin",{id:a.options.groupId,userId:a.options.id}).done(function(){EasySocial.dialog().close(),a.element.removeClass("is-admin").addClass("is-member")
})}}})},"{removeMember} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmRemoveMember",{id:a.options.groupId,userId:a.options.id})})},"{makeAdmin} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmMakeAdmin",{id:a.options.id}),bindings:{"{makeAdminButton} click":function(){EasySocial.ajax("site/controllers/groups/makeAdmin",{id:a.options.groupId,userId:a.options.id}).done(function(){EasySocial.dialog().close(),a.element.removeClass("is-member").addClass("is-admin")
})}}})}}}),EasySocial.Controller("Groups.Item.Discussions",{defaultOptions:{"{filter}":"[data-group-discussions-filter]","{contents}":"[data-group-discussion-contents]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},setContent:function(b){a.contents().removeClass("is-loading"),a.contents().html(b)},setActiveFilter:function(b){a.filter().removeClass("active"),b.addClass("active")},"{filter} click":function(b){var d=b.data("filter");a.contents().html("&nbsp;").addClass("is-loading"),a.setActiveFilter(b),EasySocial.ajax("apps/group/discussions/controllers/discussion/getDiscussions",{id:a.options.id,filter:d}).done(function(b,c){c?a.contents().addClass("is-empty"):a.contents().removeClass("is-empty"),a.setContent(b)
})}}}),EasySocial.Controller("Groups.Item.Discussion",{defaultOptions:{"{form}":"[data-reply-form]","{list}":"[data-reply-list]","{replies}":"[data-reply-item]","{repliesWrap}":"[data-replies-wrapper]","{replyCounter}":"[data-reply-count]","{lock}":"[data-discussion-lock]","{unlock}":"[data-discussion-unlock]","{delete}":"[data-discussion-delete]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.groupId=a.element.data("groupid"),a.implementReply(a.replies()),a.form().implement(EasySocial.Controller.Groups.Item.Discussion.Form,{"{parent}":a})
},implementReply:function(){a.replies().implement(EasySocial.Controller.Groups.Item.Discussion.Reply,{"{parent}":a})},insertReply:function(b){a.element.removeClass("is-unanswered"),a.repliesWrap().removeClass("is-empty"),a.list().append(b),a.implementReply()},updateReplyCounter:function(b){0==b&&a.repliesWrap().addClass("is-empty"),a.replyCounter().html(b)},setResolved:function(){a.element.addClass("is-resolved")},"{unlock} click":function(){EasySocial.ajax("apps/group/discussions/controllers/discussion/unlock",{id:a.options.id}).done(function(){a.element.removeClass("is-locked")
})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/discussions/controllers/discussion/confirmDelete",{id:a.options.id,groupId:a.options.groupId})})},"{lock} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/discussions/controllers/discussion/confirmLock"),bindings:{"{lockButton} click":function(){EasySocial.ajax("apps/group/discussions/controllers/discussion/lock",{id:a.options.id}).done(function(){EasySocial.dialog().close(),a.element.addClass("is-locked")
})}}})}}}),EasySocial.Controller("Groups.Item.Discussion.Reply",{defaultOptions:{"{acceptAnswer}":"[data-reply-accept-answer]","{delete}":"[data-reply-delete]","{edit}":"[data-reply-edit]","{cancelEdit}":"[data-reply-edit-cancel]","{update}":"[data-reply-edit-update]","{textarea}":"[data-reply-content]","{content}":"[data-reply-display-content]","{alertDiv}":"div.alert-error"}},function(a){return{init:function(){a.options.id=a.element.data("id")},"{acceptAnswer} click":function(){EasySocial.ajax("apps/group/discussions/controllers/reply/accept",{id:a.options.id}).done(function(){a.parent.setResolved()
})},cancelEditing:function(){a.element.removeClass("is-editing")},"{cancelEdit} click":function(){a.cancelEditing()},"{edit} click":function(){a.element.addClass("is-editing")},"{update} click":function(){var b=a.textarea().val();return""==b?(a.element.addClass("is-empty"),a.alertDiv().show(),!1):(EasySocial.ajax("apps/group/discussions/controllers/reply/update",{id:a.options.id,content:b}).done(function(b){a.content().html(b),a.element.removeClass("is-empty"),a.alertDiv().hide(),a.cancelEditing()}),void 0)},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/discussions/controllers/reply/confirmDelete",{id:a.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/discussions/controllers/reply/delete",{id:a.options.id}).done(function(b){a.parent.updateReplyCounter(b.total_replies),EasySocial.dialog().close(),a.element.remove()
})}}})}}}),EasySocial.Controller("Groups.Item.Discussion.Form",{defaultOptions:{"{textarea}":"[data-reply-content]","{submitReply}":"[data-reply-submit]"}},function(a){return{init:function(){},"{submitReply} click":function(){var d=a.textarea().val();return""==d?(a.element.addClass("is-empty"),!1):(EasySocial.ajax("apps/group/discussions/controllers/reply/submit",{id:a.parent.options.id,groupId:a.parent.options.groupId,content:d}).done(function(b){a.parent.insertReply(b),a.textarea().val("")}),void 0)}}}),EasySocial.Controller("Groups.Item.News",{defaultOptions:{"{delete}":"[data-news-delete]","{likes}":"[data-likes-action]","{counter}":"[data-news-counter]","{likeContent}":"[data-likes-content]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.groupId=a.element.data("group-id")
},"{likes} onLiked":function(){a.counter().removeClass("hide")},"{likes} onUnliked":function(){var e=a.likeContent().hasClass("hide");e&&a.counter().addClass("hide")},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/news/controllers/news/confirmDelete",{id:a.options.id,groupId:a.options.groupId})})}}}),b.resolve()})}),EasySocial.module("site/notifications/list",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("NotificationsList",{defaultOptions:{"{item}":"[data-notifications-list-item]","{list}":"[data-notifications-list]","{allread}":"[data-notification-all-read]","{allclear}":"[data-notification-all-clear]","{notiLoadMoreBtn}":"[data-notification-loadmore-btn]"}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.NotificationsList.Item,{"{parent}":b})
},"{allread} click":function(){EasySocial.ajax("site/controllers/notifications/setAllState",{state:"read"}).done(function(){b.item().removeClass("is-read is-hidden is-unread").addClass("is-read")})},"{allclear} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/notifications/clearAllConfirm"),bindings:{"{clearButton} click":function(){EasySocial.ajax("site/controllers/notifications/setAllState",{state:"clear"}).done(function(){b.item().removeClass("is-read is-hidden is-unread is-read").addClass("is-remove"),EasySocial.dialog().close()
})}}})},"{notiLoadMoreBtn} click":function(c){var e=a(c).data("startlimit");0>e||EasySocial.ajax("site/controllers/notifications/loadmore",{startlimit:e}).done(function(d,e){a(c).data("startlimit",e),d.length>0&&(a.buildHTML(d).insertBefore(b.notiLoadMoreBtn()),b.item().implement(EasySocial.Controller.NotificationsList.Item)),0>e&&b.notiLoadMoreBtn().hide()}).fail(function(a){return a}).always(function(){})}}}),EasySocial.Controller("NotificationsList.Item",{defaultOptions:{"{unread}":"[data-notifications-list-item-unread]","{read}":"[data-notifications-list-item-read]","{delete}":"[data-notifications-list-item-delete]"}},function(a){return{init:function(){a.options.id=a.element.data("id")
},"{unread} click":function(){EasySocial.ajax("site/controllers/notifications/setState",{id:a.options.id,state:"unread"}).done(function(){a.element.removeClass("is-read is-hidden is-unread").addClass("is-unread	")})},"{read} click":function(){EasySocial.ajax("site/controllers/notifications/setState",{id:a.options.id,state:"read"}).done(function(){a.element.removeClass("is-read is-hidden is-unread").addClass("is-read")})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/notifications/clearConfirm"),bindings:{"{clearButton} click":function(){EasySocial.ajax("site/controllers/notifications/setState",{id:a.options.id,state:"clear"}).done(function(){a.element.removeClass("is-read is-hidden is-unread is-read").addClass("is-remove"),EasySocial.dialog().close()
}).fail(function(a){EasySocial.dialog({content:a.message})})}}})}}}),b.resolve()})}),EasySocial.module("site/points/history",function(){var a=this;EasySocial.require().done(function(b){EasySocial.Controller("Points.History",{defaultOptions:{"{loadMore}":"[data-points-history-pagination]","{timeline}":"[data-points-history-timeline]"}},function(a){return{init:function(){},"{loadMore} click":function(c){var e=b(c).data("current");EasySocial.ajax("site/views/points/getHistory",{limitstart:e,id:a.options.id}).done(function(d,e,f){a.timeline().append(d),b(c).data("current",e),f&&b(c).hide()
})}}}),a.resolve()})}),EasySocial.module("site/polls/polls",function(){var b=this,c=EasySocial.options.momentLang;EasySocial.require().library("datetimepicker","moment/"+c).view("site/loading/small").done(function(a){EasySocial.Controller("Polls",{defaultOptions:{interval:30,checknew:null,source:null,sourceId:null,autoload:!0,"{itemList}":"[data-polls-list]","{copiedItem}":"[data-polls-item-copied]","{pollTitle}":"[data-polls-title]","{pollItemList}":"[data-polls-item]","{pollItem}":"[data-polls-item-text]","{pollMultiple}":"[data-polls-multiple]","{pollExpiry}":"[data-polls-expirydate]","{itemTobeRemoved}":"[data-polls-tobe-removed]","{pollSourceId}":"[data-polls-sourceid]","{pollId}":"[data-polls-id]","{pollUid}":"[data-polls-uid]","{pollElement}":"[data-polls-element]","{addItem}":"[data-polls-add]","{deleteItem}":"[data-polls-item-delete]",view:{loadingContent:"site/loading/small"}}},function(b){return{init:function(){b.pollExpiry().addController("EasySocial.Controller.Polls.Datetime",{"{parent}":b})
},"{deleteItem} click":function(c){var e=b.pollItemList().length;if(!(1>=e)){var f=a(c).closest("[data-polls-item]"),g=f.attr("data-id");if("undefined"!=typeof g&&g!==!1){var h=f.data("id");if((void 0!=h||""!=h)&&b.itemTobeRemoved){var i=b.itemTobeRemoved().val();i=""==i?h:i+","+h,b.itemTobeRemoved().val(i)}}f.remove()}},"{addItem} click":function(){var d=b.copiedItem().clone();d.removeAttr("data-polls-item-copied").attr("data-polls-item","").show(),d.find("input[name='copied']").attr("name","items[]").attr("data-polls-item-text",""),b.itemList().append(d)
},toData:function(){var c=[],d={id:b.pollId().val(),uid:b.pollUid().val(),element:b.pollElement().val(),title:b.pollTitle().val(),items:c,multiple:b.pollMultiple().is(":checked")?1:0,toberemove:"",sourceid:b.pollSourceId().val()};if(b.pollExpiry().trigger("datetimeExport",[d]),b.pollItem().length>0){if(a.each(b.pollItem(),function(b,d){var e=a(d),f=a(d).closest("[data-polls-item]"),g=f.attr("data-id"),h="0";"undefined"!=typeof g&&g!==!1&&(h=f.data("id")),""!=e.val()&&(finalItem={id:h,text:e.val()},c.push(finalItem))
}),b.itemTobeRemoved){var e=b.itemTobeRemoved().val();d.toberemove=e}d.items=c}return d},validateForm:function(){var c=b.toData();return a.isEmpty(c.title)||0==c.items.length?!1:c.items.length<=0?!1:!0}}}),EasySocial.Controller("Polls.Vote",{defaultOptions:{isMultiple:!1,"{itemList}":"[data-polls-list]","{resultList}":"[data-polls-results-list]","{voteItem}":"[data-vote-item]","{voteOption}":"[data-vote-item-option]","{voteNotice}":"[data-polls-notice]","{resultBtnContainer}":"[data-polls-result-button-div]","{editBtn}":"[data-polls-edit-button]","{viewVoterBtn}":"[data-poll-count-button]",view:{loadingContent:"site/loading/small"}}},function(b,c,d){return{init:function(){c.id=d.data("id")
},updateProgressBar:function(){var c=b.voteItem(),d=0;a.each(c,function(b,c){var e=a(c).data("count");d+=e}),a.each(c,function(c,e){var f=a(e).data("count"),g=a(e).data("id"),h=f/d*100,i="[data-poll-bar-"+g+"] .progress-bar",j="[data-poll-count-label-"+g+"]";a(i).css("width",h+"%"),a(j).text(f),b.viewVoterBtn().removeClass("hide")})},showResults:function(){b.resultList().removeClass("hide"),b.resultBtnContainer().addClass("hide")},toData:function(){var c=[],d={title:b.pollTitle().val(),items:c,multiple:b.pollMultiple().is(":checked")?1:0,sourceid:b.pollSourceId().val()};
return b.pollExpiry().trigger("datetimeExport",[d]),b.pollItem().length>0&&(a.each(b.pollItem(),function(b,d){var e=a(d);""!=e.val()&&c.push(e.val())}),d.items=c),d},"{voteOption} change":function(c){var e=a(c),f=e.is(":checked")?!0:!1,g=e.data("id");f?b.updateVote(g,"vote",c):b.updateVote(g,"unvote",c),f&&!b.options.isMultiple&&a.each(b.voteOption(),function(c,d){var e=a(d);e.data("id")!=g&&e.is(":checked")&&(selectItem=e.data("id"),e.prop("checked",!1),b.updateVote(selectItem,"unvote",e))})},"{viewVoterBtn} click":function(c){var e=a(c).closest("[data-vote-item]"),f=a(e).data("id");
EasySocial.ajax("site/views/polls/voters",{id:b.options.id,itemid:f}).done(function(b){if(""!=a.trim(b)){var c="[data-poll-voters-"+f+"]";a(c).html(b).removeClass("hide")}}).fail(function(){})},updateVote:function(c,d,e){EasySocial.ajax("site/controllers/polls/vote",{id:b.options.id,itemId:c,act:d}).done(function(){var g=a(e).closest("[data-vote-item]"),h=a(g).data("count");"vote"==d?h+=1:"unvote"==d&&(h-=1),a(g).data("count",h),b.updateProgressBar()}).fail(function(a){b.voteNotice().removeClass("hide").text(a.message)
})},"{editBtn} click":function(){},"{resultBtn} click":function(){b.showResults()},"{voteBtn} click":function(){var e=[];a.each(b.voteOption(),function(b,c){var d=a(c);d.is(":checked")&&e.push(d.data("id"))}),0!=e.length&&(b.voteBtn().hide(),b.showResults(),EasySocial.ajax("site/controllers/polls/vote",{id:b.options.id,items:e}).done(function(a,c){b.updateProgressBar(c),b.viewBtn().removeClass("hide"),b.voteNotice().removeClass("hide").addClass("alert-success").text(a).delay(5e3).fadeOut()}).fail(function(a){b.voteNotice().removeClass("hide").text(a.message)
}))}}}),EasySocial.Controller("Polls.Datetime",{defaultOptions:{"{picker}":"[data-picker]","{toggle}":"[data-picker-toggle]","{datetime}":"[data-datetime]"}},function(b){return{init:function(){var d=new a.moment,e=(new Date).getFullYear()+10,f="DD-MM-YYYY hh:mm A";d.date(d.date()-1),b.picker()._datetimepicker({component:"es",useCurrent:!1,format:f,minDate:d,maxDate:new a.moment({y:e}),icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!1,pickTime:1,minuteStepping:1,language:c});
var g=b.element.data("value");if(""!=g){var h=a.moment(g);b.datetimepicker("setDate",h)}},datetimepicker:function(a,c){return b.picker().data("DateTimePicker")[a](c)},"{toggle} click":function(){b.picker().focus()},"{picker} dp.change":function(a,c){b.setDateValue(c.date.toDate())},setDateValue:function(a){b.datetime().val(a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2)+" "+("00"+a.getHours()).slice(-2)+":"+("00"+a.getMinutes()).slice(-2)+":"+("00"+a.getSeconds()).slice(-2))
},"{self} datetimeExport":function(a,c,d){d.expirydate=b.datetime().val()}}}),b.resolve()})}),EasySocial.module("site/profile/about",function(){var b=this;EasySocial.require().script("field").library("history").done(function(){EasySocial.Controller("Profile.About",{defaultOptions:{"{stepItem}":"[data-profile-about-step-item]","{stepContent}":"[data-profile-about-step-content]","{fieldItem}":"[data-field]"}},function(a){return{init:function(){a.fieldItem().addController("EasySocial.Controller.Field.Base",{mode:"display"})
},"{stepItem} click":function(b,c){c.preventDefault(),b.find("a").route();var d=b.data("for");a.stepItem().removeClass("active"),b.addClass("active"),a.stepContent().filterBy("id",d).trigger("activateTab")},"{stepContent} activateTab":function(b){a.stepContent().removeClass("active"),b.addClass("active"),b.find(a.fieldItem.selector).trigger("onShow")}}}),b.resolve()})}),EasySocial.module("site/profile/admintool",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Profile.Admin",{defaultOptions:{"{deleteUser}":"[data-admintool-delete]","{banUser}":"[data-admintool-ban]","{unban}":"[data-admintool-unban]"}},function(){return{init:function(){},"{unban} click":function(a){var b=a.data("id");
EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmUnban",{id:b}),bindings:{"{unbanButton} click":function(){EasySocial.ajax("site/controllers/profile/unbanUser",{id:b}).done(function(a){EasySocial.dialog({content:a})})},"{closeButton} click":function(){EasySocial.dialog().close()}}})},"{deleteUser} click":function(a){var b=a.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmDeleteUser",{id:b}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/profile/deleteUser",{id:b}).done(function(a){EasySocial.dialog({content:a})
})},"{closeButton} click":function(){EasySocial.dialog().close()}}})},"{banUser} click":function(b){var c=b.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmBanUser",{id:c}),bindings:{"{banButton} click":function(){var b=a("[data-ban-period]").val();EasySocial.ajax("site/controllers/profile/banUser",{id:c,period:b}).done(function(a){EasySocial.dialog({content:a})})},"{closeButton} click":function(){EasySocial.dialog().close()}}})}}}),b.resolve()})}),EasySocial.module("site/profile/edit",function(){var b=this;
EasySocial.require().script("validate","field","oauth/facebook").done(function(a){EasySocial.Controller("Profile.Edit",{defaultOptions:{userid:null,"{stepContent}":"[data-profile-edit-fields-content]","{stepItem}":"[data-profile-edit-fields-step]","{profileForm}":"[data-profile-fields-form]","{profileContent}":"[data-profile-edit-fields]","{fieldItem}":"[data-profile-edit-fields-item]","{save}":"[data-profile-fields-save]","{saveClose}":"[data-profile-fields-save-close]","{deleteProfile}":"[data-profile-edit-delete]","{taskInput}":'input[name="task"]'}},function(b){return{init:function(){b.fieldItem().addController("EasySocial.Controller.Field.Base",{userid:b.options.userid,mode:"edit"})
},errorFields:[],"{fieldItem} error":function(a){b.triggerStepError(a)},"{fieldItem} clear":function(a){b.clearStepError(a)},"{fieldItem} onError":function(a){b.triggerStepError(a)},triggerStepError:function(c){var d=c.data("id"),e=c.parents(b.stepContent.selector).data("id");a.inArray(d,b.errorFields)<0&&b.errorFields.push(d),b.stepItem().filterBy("for",e).trigger("error")},clearStepError:function(c){var d=c.data("id"),e=c.parents(b.stepContent.selector).data("id");b.errorFields=a.without(b.errorFields,d),b.stepItem().filterBy("for",e).trigger("clear")
},"{stepItem} click":function(c){var e=a(c).data("for");b.profileContent().show(),b.stepItem().removeClass("active"),c.addClass("active"),b.stepContent().removeClass("active");var f=b.stepContent().filterBy("id",e);f.addClass("active"),f.find(b.fieldItem.selector).trigger("show")},"{stepItem} error":function(a){a.addClass("error")},"{stepItem} clear":function(a){b.errorFields.length<1&&a.removeClass("error")},"{save} click":function(c,d){return d.preventDefault(),a(c).addClass("btn-loading"),b.profileForm().validate().fail(function(){a(c).removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})
}).done(function(){b.taskInput().val("save"),b.profileForm().submit()}),!1},"{saveClose} click":function(c,d){return d.preventDefault(),a(c).addClass("btn-loading"),b.profileForm().validate().fail(function(){a(c).removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}).done(function(){b.taskInput().val("saveclose"),b.profileForm().submit()}),!1},"{deleteProfile} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmDelete")})
}}}),b.resolve()})}),EasySocial.module("site/profile/feeds",function(){var b=this;EasySocial.require().library("history").done(function(a){EasySocial.Controller("Profile.Feeds",{defaultOptions:{"{menuItem}":"[data-profileSidebar-menu]","{item}":"[data-profileFeeds-item]","{filter}":"[data-profileFeeds-Filter-edit]"}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Profile.Feeds.Item,{"{parent}":b,"{profile}":b.parent})},"{menuItem} click":function(c){b.menuItem().removeClass("active"),a(c).addClass("active")
},addFilterItem:function(a){a.find("[data-profileFeeds-item]").implement(EasySocial.Controller.Profile.Feeds.Item,{"{parent}":b,"{profile}":b.parent}),a.appendTo(b.element)}}}),EasySocial.Controller("Profile.Feeds.Item",{defaultOptions:{}},function(b){return{clicked:!1,init:function(){},"{self} click":function(){a(".es-streams").removeClass("no-stream");{var c=b.element.data("type"),d=b.element.data("filterid"),e=b.element.data("user"),f=b.element.data("url"),g=b.element.data("title");b.element.data("description")
}if(!b.clicked){b.clicked=!0;var i="[data-stream-counter-";"list"==c?i=i+c+"-"+id:i+=c,i+="]",a(i).html("0"),b.element.removeClass("has-notice");var j=a.joomla.appendTitle;"before"===j&&(g=a.joomla.sitename+(g?" - "+g:"")),"after"===j&&(g=(g?g+" - ":"")+a.joomla.sitename),History.pushState({state:1},g,f),b.profile.contents().html(""),b.profile.updatingContents(),b.element.addClass("loading"),EasySocial.ajax("site/controllers/profile/getStream",{type:c,filterId:d,id:e,view:"profile"}).done(function(d,e){0==e&&a(".es-streams").addClass("no-stream"),b.trigger("onStreamUpdate",[c]),window.streamFilter=c,b.profile.updateContent(d);
try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(f){}}).fail(function(a){return a}).always(function(){b.clicked=!1,b.element.removeClass("loading")})}}}}),b.resolve()})}),EasySocial.module("site/profile/friends",function(){var b=this;EasySocial.require().view("site/loading/small").language("COM_EASYSOCIAL_FRIENDS_DIALOG_CANCEL_REQUEST","COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_YES_CANCEL_MY_REQUEST_BUTTON").done(function(a){EasySocial.Controller("Profile.Friends.Request",{defaultOptions:{id:null,callback:null,"{addButton}":"[data-profileFriends-add]","{manageButton}":"[data-profileFriends-manage]","{pendingButton}":"[data-profileFriends-pending]","{respondButton}":"[data-profileFriends-respond]","{cancelRequest}":"[data-profileFriends-cancelRequest]","{unfriend}":"[data-profile-friends-unfriend]","{approve}":"[data-friends-response-approve]","{reject}":"[data-friends-response-reject]","{button}":"[data-profileFriends-button]","{dropdown}":"[data-profileFriends-dropdown]",view:{loader:"site/loading/small"}}},function(b){return{init:function(){b.options.id=b.element.data("friend"),b.options.target=b.element.data("id"),b.options.callback=b.element.data("callback")
},showDropDown:function(){b.element.addClass("open")},hideDropDown:function(){b.element.removeClass("open")},"{addButton} click":function(){var c=b.button();c.addClass("loading"),EasySocial.ajax("site/controllers/friends/request",{id:b.options.target}).done(function(a,c){b.dropdown().remove(),b.options.id=a,b.button().replaceWith(c)}).fail(function(a){EasySocial.dialog({content:a.message}),c.removeClass("loading")})},"{cancelRequest} click":function(){b.options.id;b.hideDropDown(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmCancel"),bindings:{"{confirmButton} click":function(){EasySocial.ajax("site/controllers/friends/cancelRequest",{id:b.options.id}).done(function(a){b.dropdown().remove(),b.button().replaceWith(a),EasySocial.dialog().close()
})}}})},"{unfriend} click":function(c){var e=a(c).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmUnfriend",{id:e}),bindings:{"{unfriendButton} click":function(){EasySocial.ajax("site/controllers/friends/unfriend",{id:b.options.id}).done(function(a){b.dropdown().remove(),b.button().replaceWith(a),EasySocial.dialog().close()})}}})},"{approve} click":function(){var d=b.options.id;b.hideDropDown(),EasySocial.ajax("site/controllers/friends/approve",{id:d}).done(function(a){b.button().replaceWith(a)
})},"{reject} click":function(){var d=b.options.id;b.hideDropDown(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmReject"),bindings:{"{rejectButton} click":function(){EasySocial.ajax("site/controllers/friends/reject",{id:d}).done(function(a){b.button().replaceWith(a),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/friendRejected")})})}}})},"{dropdown} click":function(a,b){b.stopPropagation()},"{approveRequest} click":function(){b.respondForm().find("input[name=task]").val("approve"),b.respondForm().find("input[name=id]").val(b.options.friendId),b.respondForm().find("input[name=return]").val(b.options.callback),b.respondForm().submit()
}}}),b.resolve()})}),EasySocial.module("site/profile/header",function(){var b=this;EasySocial.require().script("site/profile/friends","site/profile/subscriptions","site/conversations/composer").done(function(){EasySocial.Controller("Profile.Header",{defaultOptions:{id:null,"{friendRequest}":"[data-profile-friends]","{subscribe}":"[data-profile-followers]","{conversation}":"[data-profile-conversation]"}},function(a){return{init:function(){a.options.id=a.element.data("id"),a.options.name=a.element.data("name"),a.options.avatar=a.element.data("avatar"),a.friendRequest().implement(EasySocial.Controller.Profile.Friends.Request,{"{parent}":a}),a.subscribe().implement(EasySocial.Controller.Profile.Subscriptions,{"{parent}":a}),a.conversation().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:a.options.id,name:a.options.name,avatar:a.options.avatar}})
}}}),b.resolve()})}),EasySocial.module("site/profile/subscriptions",function(){var b=this;EasySocial.Controller("Profile.Subscriptions",{defaultOptions:{id:null,"{follow}":"[data-subscription-follow]","{unfollow}":"[data-subscription-unfollow]","{message}":"[data-subscription-message]","{button}":"[data-subscription-button]"}},function(a){return{init:function(){a.options.id=a.element.data("id")},toggleDropDown:function(){a.element.toggleClass("open")},"{unfollow} click":function(){a.toggleDropDown(),EasySocial.ajax("site/controllers/profile/unfollow",{id:a.options.id,type:"user"}).done(function(b){a.button().replaceWith(b)
})},"{follow} click":function(){a.toggleDropDown(),EasySocial.ajax("site/controllers/profile/follow",{id:a.options.id,type:"user"}).done(function(b){a.button().replaceWith(b)})}}}),b.resolve()}),EasySocial.module("site/profile/miniheader",function(){var b=this;EasySocial.require().library("scrollTo").done(function(a){EasySocial.Controller("Profile.MiniHeader",{defaultOptions:{"{viewport}":"[data-appscroll-viewport]","{content}":"[data-appscroll-content]","{apps}":"[data-appscroll-content] li","{buttons}":"[data-appscroll-buttons]","{nextButton}":"[data-appscroll-next-button]","{prevButton}":"[data-appscroll-prev-button]"}},function(b){return{init:function(){b.setLayout(),b.viewport().scrollTo(0)
},"{window} resize":a.debounce(function(){b.setLayout()},300),setLayout:function(){var c=b.viewport(),d=5;return a(".es-main").hasClass("w480")?(b.content().css({width:"auto"}),b.enabled=!1,void 0):(b.apps().each(function(){d+=a(this).outerWidth(!0)}),d>c.width()&&(b.content().css({width:d,"float":"none"}),b.buttons().css("opacity",1),b.enabled=!0),void 0)},enabled:!1,"{nextButton} click":function(){if(b.enabled){var a=b.viewport(),c=a.width()-80;a.scrollTo("+="+c+"px",800,{axis:"x",easing:"easeInOutCubic"})
}},"{prevButton} click":function(){if(b.enabled){var a=b.viewport(),c=a.width()-80;a.scrollTo("-="+c+"px",800,{axis:"x",easing:"easeInOutCubic"})}}}}),b.resolve()})}),EasySocial.module("site/profile/notifications",function(){var b=this;EasySocial.require().script("site/profile/header").done(function(){EasySocial.Controller("Profile.Notifications",{defaultOptions:{"{sidebarItem}":"[data-notification-item]","{contentItem}":"[data-notification-content]","{notificationForm}":"[data-notifications-form]"}},function(a){return{init:function(){},"{sidebarItem} click":function(b){a.sidebarItem().removeClass("active"),b.addClass("active"),a.contentItem().hide();
var d=b.data("alert-element");a.contentItem('[data-alert-element="'+d+'"]').show()}}}),b.resolve()})}),EasySocial.module("site/profile/privacy",function(){var b=this;EasySocial.require().script("site/profile/header").library("history","textboxlist").view("site/loading/small").done(function(a){EasySocial.Controller("Profile.Privacy",{defaultOptions:{"{sidebarItem}":"[data-profile-privacy-item]","{contentItem}":"[data-privacy-content]","{privacyItem}":"[data-privacy-item]","{privacyForm}":"[data-profile-privacy-form]","{formActions}":"[data-form-actions]",view:{loading:"site/loading/small"}}},function(b){return{init:function(){b.sidebarItem().implement(EasySocial.Controller.Profile.Privacy.Sidebar,{"{parent}":b}),b.privacyItem().implement(EasySocial.Controller.Profile.Privacy.Item,{"{parent}":b})
},updateContent:function(c){b.contentItem().hide(),a(".privacy-content-"+c).show(),"blocked"==c?b.formActions().hide():b.formActions().show()}}}),EasySocial.Controller("Profile.Privacy.Sidebar",{defaultOptions:{"{sidebarItem}":"[data-profile-privacy-item]"}},function(b){return{init:function(){},"{self} click":function(c){a("[data-profile-privacy-item]").removeClass("active"),a(c).addClass("active");var d=b.element.data("group");b.parent.updateContent(d)}}}),EasySocial.Controller("Profile.Privacy.Item",{defaultOptions:{"{selection}":"[data-privacy-select]","{hiddenCustom}":"[data-hidden-custom]","{customForm}":"[data-privacy-custom-form]","{customTextInput}":"[data-textfield]","{customItems}":"input[]","{customHideBtn}":"[data-privacy-custom-hide-button]","{customInputItem}":"[data-textboxlist-item]","{customEditBtn}":"[data-privacy-custom-edit-button]"}},function(b){return{init:function(){b.customTextInput().textboxlist({component:"es",unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:2,cache:!1,query:function(a){var c=b.getTaggedUsers(),d=EasySocial.ajax("site/views/privacy/getfriends",{q:a,exclude:c});
return d}}}}),b.textboxlistLib=b.customTextInput().textboxlist("controller")},getTaggedUsers:function(){var c=[],d=b.customInputItem();return d.length>0&&a.each(d,function(b,d){c.push(a(d).data("id"))}),c},"{customTextInput} addItem":function(a,c,d){var e=b.hiddenCustom().val(),f="";if(""==e)f=d.id;else{var g=e.split(",");g.push(d.id),f=g.join(",")}b.hiddenCustom().val(f)},"{customTextInput} removeItem":function(a,c,d){for(var e=b.hiddenCustom().val(),f="",g=[],h=e.split(","),i=0;i<h.length;i++)h[i]!=d.id&&g.push(h[i]);
f=g.length<=0?"":g.join(","),b.hiddenCustom().val(f)},"{customEditBtn} click":function(){b.customForm().toggle()},"{selection} change":function(a){var c=a.val();"custom"==c?(b.customForm().show(),b.customEditBtn().show()):(b.customForm().hide(),b.customEditBtn().hide())},"{customHideBtn} click":function(){b.customForm().hide(),b.customEditBtn().show(),b.textboxlistLib.autocomplete.hide()}}}),b.resolve()})}),EasySocial.module("site/profile/profile",function(){var b=this;EasySocial.template("info/item",'<li data-profile-apps-item data-layout="custom"><a class="ml-20" href="[%= url %]" title="[%= title %]" data-info-item data-info-index="[%= index %]"><i class="fa fa-info-circle mr-5"></i> [%= title %]</a></li>'),EasySocial.require().script("site/profile/header","site/profile/feeds").library("history").done(function(a){EasySocial.Controller("Profile",{defaultOptions:{id:null,"{header}":"[data-profile-header]","{feeds}":"[data-profile-feeds]","{app}":"[data-profile-apps-item]","{action}":"[data-profile-apps-menu]","{showAllFilters}":"[data-app-filters-showall]","{appFilters}":"[data-sidebar-app-filter]","{contents}":"[data-profile-real-content]","{sidebar}":"[data-sidebar]","{sidebarToggle}":"[data-sidebar-toggle]","{info}":"[data-info]","{infoItem}":"[data-info-item]",view:{infoItem:"info/item"}}},function(b){return{init:function(){b.options.id=b.element.data("id"),b.header().implement(EasySocial.Controller.Profile.Header,{"{parent}":b}),b.feedsController=b.feeds().addController(EasySocial.Controller.Profile.Feeds,{"{parent}":b}),a(function(){b.setLayout()
}),a(".es-responsive").on("responsive",function(){b.setLayout()})},setLayout:function(){var c=b.sidebar(),d=b.sidebarToggle();if(d.is(":visible")){a('<div class="es-container responsive">').append(c).insertAfter(d)}else a(".es-profile .es-container:not(.responsive)").prepend(c),a(".es-profile .es-container.responsive").remove()},"{sidebarToggle} sidebarToggle":function(){b.setLayout()},"{app} click":function(c,d){b.app().removeClass("active"),a(c).addClass("active"),d.preventDefault();var e=c.data();if("canvas"===e.layout)return window.location=e[e.layout+"Url"],void 0;
if("custom"!==e.layout){var f=e.title;if("site/controllers/profile/getStream"==e.namespace){var g=a.joomla.appendTitle;"before"===g&&(f=a.joomla.sitename+(f?" - "+f:"")),"after"===g&&(f=(f?f+" - ":"")+a.joomla.sitename)}History.pushState({state:1},f,e[e.layout+"Url"]),b.sidebarToggle().is(":visible")&&a.scrollTo(b.contents()),EasySocial.ajax(e.namespace,{id:e.id,view:"profile",appId:e.appId},{beforeSend:function(){b.loading()}}).done(function(a){b.updateContent(a)}).fail(function(a){return a})}},"{showAllFilters} click":function(c){a(c).hide(),b.appFilters().removeClass("hide")
},updateContent:function(a){b.element.removeClass("loading"),b.contents().html(a)},updatingContents:function(){b.element.addClass("loading")},loading:function(){b.contents().html(""),b.element.addClass("loading")},"{info} click":function(c,d){d.preventDefault(),c.route(),b.loading();var e=c.data("loaded");return e?(b.infoItem().eq(0).trigger("click"),void 0):(EasySocial.ajax("site/controllers/profile/initInfo",{id:b.options.id}).done(function(d){c.data("loaded",1);var e=c.parent("[data-profile-apps-item]");a.each(d.reverse(),function(a,c){c.hide||e.after(b.view.infoItem({url:c.url,title:c.title,index:c.index})),c.html&&(b.updateContent(c.html),b.contents().find("[data-field]").trigger("onShow"))
});var f=b.infoItem().eq(0).parent("[data-profile-apps-item]");b.app().removeClass("active"),f.addClass("active")}),void 0)},"{infoItem} click":function(a,c){c.preventDefault(),a.route(),b.loading();var d=a.data("info-index");EasySocial.ajax("site/controllers/profile/getInfo",{id:b.options.id,index:d}).done(function(c){b.updateContent(c),b.contents().find("[data-field]").trigger("onShow"),b.app().removeClass("active"),a.parent("[data-profile-apps-item]").addClass("active")}).fail(function(a){b.updateContent(a.message)
})}}}),b.resolve()})}),EasySocial.module("site/registrations/registrations",function(){var b=this;EasySocial.require().script("validate","field").view("site/registration/dialog.error").language("COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE").done(function(a){EasySocial.Controller("Registrations.Form",{defaultOptions:{previousLink:null,"{submit}":"[data-registration-submit]","{field}":"[data-registration-fields-item ]","{previous}":"[data-registration-previous]",view:{formError:"site/registration/dialog.error"}}},function(b){return{init:function(){b.field().addController("EasySocial.Controller.Field.Base",{mode:"register"})
},"{previous} click":function(a,c){return c.preventDefault(),window.location.href=b.options.previousLink,!1},"{submit} click":function(c,d){return d.preventDefault(),a(c).addClass("btn-loading"),a(b.element).validate().fail(function(){a(c).removeClass("btn-loading"),EasySocial.dialog({title:a.language("COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE"),content:b.view.formError(!0),width:400,height:150,buttons:[{name:a.language("COM_EASYSOCIAL_CLOSE_BUTTON"),classNames:"btn btn-es-primary",click:function(){EasySocial.dialog().close()
}}]})}).done(function(){b.element.submit()}),!1}}}),b.resolve()})}),EasySocial.module("site/search/advanced.criteria",function(){var a=this;EasySocial.require().view("site/loading/small").script("site/search/map").language("COM_EASYSOCIAL_ADVANCED_SEARCH_ADDRESS_DISTANCE_NOTICE").done(function(b){EasySocial.Controller("Search.Advanced.Criteria",{defaultOptions:{"{addButton}":"[data-criteria-add-button]","{removeButton}":"[data-criteria-remove-button]","{itemConditionDiv}":"[data-itemConditionDiv]","{itemCriteria}":"[data-itemCriteria]","{itemDataKey}":"[data-itemDataKey]","{itemOperator}":"[data-itemOperator]","{itemCondition}":"[data-itemCondition]","{dateStart}":"[data-start]","{dateEnd}":"[data-end]","{dataCondition}":"[data-condition]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]","{dataNotice}":"[data-criteria-notice]","{locationLabel}":"[data-location-label]","{textField}":"[data-location-textfield]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){a.element.addController(EasySocial.Controller.Search.Map),void 0!=a.frmAddress().val()&&""!=a.frmAddress().val()&&(a.textField().val(a.frmAddress().val()),a.locationLabel().removeClass("hide"))
},"{itemOperator} change":function(){criteria=a.itemCriteria().find("select"),f=a.itemDataKey().find("select"),operator=a.itemOperator().find("select");var b=criteria.val().split("|"),d=(b[0],b[1]),e=operator.val(),f=f.val();"blank"==e||"notblank"==e?a.itemCondition().hide():("between"==e?a.getConditions(d,e,f):("datetime"==d||"birthday"==d)&&a.dateStart().length>0&&a.getConditions(d,e,f),a.itemCondition().is(":hidden")&&a.itemCondition().show())},getConditions:function(c,d,e){EasySocial.ajax("site/controllers/search/getConditions",{element:c,operator:d,datakey:e}).done(function(c){a.itemCondition().show(),a.itemCondition().remove();
var d=b.buildHTML(c);d.insertAfter(a.itemOperator())}).fail(function(a){return a}).always(function(){})},"{frmDistance} change":function(){var b=a.frmDistance().val(),c=a.frmAddress().val(),d=a.frmLatitude().val(),e=a.frmLongitude().val(),f=b+"|"+d+"|"+e+"|"+c;a.dataCondition().val(f)},"{dateStart} change":function(){start=a.dateStart().val(),end=a.dateEnd().val();var c=start;end.length>0&&(c=c+"|"+end),a.dataCondition().val(c)},"{dateEnd} change":function(){start=a.dateStart().val(),end=a.dateEnd().val();var b=start;
b=b+"|"+end,a.dataCondition().val(b)},"{itemCriteria} change":function(){if(select=a.itemCriteria().find("select"),""!=select.val()){var c=select.val().split("|"),d=c[0],e=c[1];a.dataNotice().addClass("hide"),EasySocial.ajax("site/controllers/search/getDataKeys",{key:d,element:e}).done(function(c,d,e){a.itemDataKey().remove(),a.itemOperator().remove(),a.itemCondition().remove();var f=b.buildHTML(d);if(f.insertAfter(a.itemConditionDiv()),""!=c){var f=b.buildHTML(c);f.insertAfter(a.itemConditionDiv())}var f=b.buildHTML(e);
f.insertAfter(a.itemOperator())}).fail(function(a){return a}).always(function(){})}},"{itemDataKey} change":function(){if(select=a.itemCriteria().find("select"),""!=select.val()){var c=select.val().split("|"),d=c[0],e=c[1],f=a.itemDataKey().find("select"),g=f.val();EasySocial.ajax("site/controllers/search/getOperators",{key:d,element:e,datakey:g}).done(function(c,d){a.itemOperator().remove();var e=b.buildHTML(c);e.insertAfter(a.itemDataKey()),a.itemCondition().remove();var e=b.buildHTML(d);e.insertAfter(a.itemOperator()),"distance"==g?a.locationLabel().removeClass("hide"):a.locationLabel().addClass("hide")
}).fail(function(a){return a}).always(function(){})}},"{removeButton} click":function(){a.element.remove()}}}),a.resolve()})}),EasySocial.module("site/search/map",function(a){var b=this;a.template("easysocial/maps.suggestion",'<div class="es-location-suggestion" data-location-suggestion><span class="formatted_address">[%= location.formatted_address %]</span></div>'),EasySocial.require().library("gmaps").done(function(){var c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};
EasySocial.Controller("Search.Map",{defaultOptions:{"{icon}":"[data-loaction-icon]","{locationLabel}":"[data-location-label]","{textField}":"[data-location-textfield]","{detectButton}":"[data-location-detect]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-location-suggestion]","{autocomplete}":"[data-location-autocomplete]","{dataCondition}":"[data-condition]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]",view:{suggestion:"maps.suggestion"}}},function(b){return{init:function(){},locations:{},lastQueryAddress:null,results:[],result:null,"{detectButton} click":function(){b.icon().removeClass("fa fa-flash").addClass("btn-loading"),clearTimeout(b.detectTimer),a.GMaps.geolocate({success:function(c){a.GMaps.geocode({lat:c.coords.latitude,lng:c.coords.longitude,callback:function(a,c){"OK"==c&&b.suggest(a)
}})},error:function(b){var c="";switch(b.code){case 1:c=a.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:c=a.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:c=a.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR")}EasySocial.dialog({content:c})},always:function(){clearTimeout(b.detectTimer),b.icon().removeClass("btn-loading").addClass("fa fa-flash")}})},lookup:a.debounce(function(c){a.GMaps.geocode({address:c,callback:function(a,d){"OK"==d&&(b.locations[c]=a,b.suggest(a),b.lastQueryAddress=c)
}})},250),"{textField} keypress":function(d,e){switch(e.keyCode){case c.UP:var f=a(b.suggestion(".active").prev(b.suggestion.selector)[0]||b.suggestion(":last")[0]);b.suggestion().removeClass("active"),f.addClass("active").trigger("activate"),b.suggestions().scrollTo(f,{offset:-1*f.height()}),e.preventDefault();break;case c.DOWN:var g=a(b.suggestion(".active").next(b.suggestion.selector)[0]||b.suggestion(":first")[0]);b.suggestion().removeClass("active"),g.addClass("active").trigger("activate"),b.suggestions().scrollTo(g,{offset:-1*g.height()}),e.preventDefault();
break;case c.ENTER:var h=b.suggestion(".active"),i=h.data("location");b.set(i),b.hideSuggestions(),e.preventDefault();break;case c.ESCAPE:b.hideSuggestions(),e.preventDefault()}},"{textField} keyup":function(d,e){switch(e.keyCode){case c.UP:case c.DOWN:case c.LEFT:case c.RIGHT:case c.ENTER:case c.ESCAPE:break;default:var f=a.trim(d.val());""===f&&b.hideSuggestions();var g=b.locations[f];g?(b.lastQueryAddress=f,b.suggest(g)):b.lookup(f)}},set:function(a){var c=a.geometry.location.lat(),d=a.geometry.location.lng(),e=a.formatted_address,f=b.frmDistance().val();
b.frmAddress().val(e),b.frmLatitude().val(c),b.frmLongitude().val(d);var g=f+"|"+c+"|"+d+"|"+e;b.dataCondition().val(g),b.textField().val(e),b.hideSuggestions()},"{suggestion} click":function(a){var d=a.data("location");b.set(d)},suggest:function(c){b.hideSuggestions();var d=b.suggestions();c.length<0||(b.results=c,a.each(c,function(a,c){b.view.suggestion({location:c}).data("location",c).appendTo(d)}),b.showSuggestions())},showSuggestions:function(){b.focusSuggestion=!0,setTimeout(function(){b.autocomplete().addClass("active");
var c=a(document),d="click.es.advancedsearch.location";c.off(d).on(d,function(e){var f=a(e.target).parents().andSelf();f.filter(b.element).length>0||(c.off(d),b.hideSuggestions())})},500)},hideSuggestions:function(){b.suggestions().empty(),b.focusSuggestion=!1,b.autocomplete().removeClass("active"),a(document).off("click.es.advancedsearch.location")}}}),b.resolve()})}),EasySocial.module("site/search/advanced",function(){var a=this;EasySocial.require().script("site/search/advanced.criteria").view("site/loading/small").language("COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS").done(function(b){EasySocial.Controller("Search.Advanced",{defaultOptions:{"{sidebar}":"[data-advsearch-sidebar]","{sidebarItem}":"[data-sidebar-item]","{item}":"[data-adv-search-item]","{list}":"[data-advsearch-list]","{searchForm}":"[data-adv-search-form]","{savefilterBtn}":"[data-advsearch-savefilter]","{deletefilterBtn}":"[data-advsearch-deletefilter]","{content}":"[data-advsearch-content]","{addCriteria}":"[data-adv-search-add-criteria]","{criteriaTemplate}":"[data-adv-search-criteria-template]","{resultlist}":"[data-advsearch-result-list]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){a.sidebarController=a.sidebar().addController(EasySocial.Controller.Search.Advanced.Sidebar,{"{parent}":a}),a.item().addController(EasySocial.Controller.Search.Advanced.Criteria,{"{parent}":a})
},updatingContents:function(){a.element.addClass("loading")},updateContents:function(b){a.element.removeClass("loading"),a.content().html(b)},"{deletefilterBtn} click":function(c){var d=b(c).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/search/confirmFilterDelete",{fid:d}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/search/deleteFilter",{fid:d}).done(function(){b("[data-search-filter-"+d+"]").remove(),b("[data-search-filter-0]").addClass("active"),a.content().html(""),a.updatingContents(),EasySocial.ajax("site/controllers/search/getFilterResults",{fid:"0"}).done(function(c){var c=b.buildHTML(c);
c.addController("EasySocial.Controller.Search.Advanced.Criteria",{"{parent}":a}),a.updateContents(c)}).fail(function(a){return a}),EasySocial.dialog().close()})}}})},"{savefilterBtn} click":function(){var c=a.searchForm().serializeJSON();EasySocial.dialog({content:EasySocial.ajax("site/views/search/confirmSaveFilter"),bindings:{"{saveButton} click":function(){return this.inputWarning().hide(),filterName=this.inputTitle().val(),filterSitewide=this.inputSitewide().is(":checked")?1:0,""==filterName?(this.inputWarning().show(),void 0):(EasySocial.ajax("site/controllers/search/addFilter",{title:filterName,sitewide:filterSitewide,data:c}).done(function(c,d){var e=b.buildHTML(c);
a.sidebarController.addFilterItem(e),EasySocial.dialog(d),setTimeout(function(){EasySocial.dialog().close()},2e3)}),void 0)}}})},"{addCriteria} click":function(){var e=a.criteriaTemplate().clone();b(e).removeClass("hide").removeAttr("data-adv-search-criteria-template").addController(EasySocial.Controller.Search.Advanced.Criteria,{"{parent}":a}),a.list().append(e)}}}),EasySocial.Controller("Search.Advanced.Sidebar",{defaultOptions:{"{item}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){a.item().implement(EasySocial.Controller.Search.Advanced.Sidebar.Item,{"{parent}":a,"{root}":a.parent})
},addFilterItem:function(c){c.implement(EasySocial.Controller.Search.Advanced.Sidebar.Item,{"{parent}":a,"{root}":a.parent}),c.appendTo(b("[data-advsearch-sidebar-ul]"))}}}),EasySocial.Controller("Search.Advanced.Sidebar.Item",{defaultOptions:{"{filterDeleteBtn}":"[data-search-filter-delete]","{filterItem}":"[data-search-filter-item]","{item}":"[data-adv-search-item]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){},"{filterItem} click":function(c,d){d.preventDefault(),b("[data-sidebar-item]").removeClass("active loading"),a.element.addClass("active");
{var e=a.element.data("id");a.element.data("url"),a.element.data("title")}b(c).route(),a.root.content().html(""),a.root.updatingContents(),a.element.addClass("loading"),EasySocial.ajax("site/controllers/search/getFilterResults",{fid:e}).done(function(c){var c=b.buildHTML(c);c.find(a.item.selector).addController("EasySocial.Controller.Search.Advanced.Criteria",{"{parent}":a.root}),a.root.updateContents(c)}).fail(function(a){return a}).always(function(){a.element.removeClass("loading")})}}}),a.resolve()})}),EasySocial.module("site/search/advanced.list.group",function(){var b=this;
EasySocial.require().view("site/loading/small","site/search/loadbutton").script("site/groups/groups").language("COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS").done(function(a){EasySocial.Controller("Search.Advanced.List.Group",{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]","{searchForm}":"[data-adv-search-form]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Groups.Browser.Item),b.on("scroll.advsearch",window,a._.debounce(function(){b.loading||b.pagination().visible()&&b.loadMore()
},250))},"{loadmorebutton} click":function(){b.loadMore()},loadMore:function(){var a=b.pagination().data("last-limit"),c=b.searchForm().serializeJSON();return"-1"==a?(b.loadmorebutton().hide(),void 0):(b.loading=!0,EasySocial.ajax("site/controllers/search/loadmore",{data:c,nextlimit:a},{beforeSend:function(){b.pagination().html(b.view.loadingContent())}}).done(function(a,c){b.pagination().data("last-limit",c),b.pagination().before(a),b.item().implement(EasySocial.Controller.Groups.Browser.Item),"-1"==c?b.pagination().html(""):b.pagination().html(b.view.loadmoreContent())
}).fail(function(a){return a}).always(function(){b.loading=!1}),void 0)}}}),b.resolve()})}),EasySocial.module("site/search/advanced.list",function(){var b=this;EasySocial.require().view("site/loading/small","site/search/loadbutton").script("site/search/item").language("COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS").done(function(a){EasySocial.Controller("Search.Advanced.List",{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]","{searchForm}":"[data-adv-search-form]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Search.Item),b.on("scroll.advsearch",window,a._.debounce(function(){b.loading||b.pagination().visible()&&b.loadMore()
},250))},"{loadmorebutton} click":function(){b.loadMore()},loadMore:function(){var a=b.pagination().data("last-limit"),c=b.searchForm().serializeJSON();return"-1"==a?(b.loadmorebutton().hide(),void 0):(b.loading=!0,EasySocial.ajax("site/controllers/search/loadmore",{data:c,nextlimit:a},{beforeSend:function(){b.pagination().html(b.view.loadingContent())}}).done(function(a,c){b.pagination().data("last-limit",c),b.pagination().before(a),b.item().implement(EasySocial.Controller.Search.Item),"-1"==c?b.pagination().html(""):b.pagination().html(b.view.loadmoreContent())
}).fail(function(a){return a}).always(function(){b.loading=!1}),void 0)}}}),b.resolve()})}),EasySocial.module("site/search/item",function(){var b=this;EasySocial.require().view("site/loading/small").language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE").done(function(a){EasySocial.Controller("Search.Item",{defaultOptions:{"{toggle}":"[data-activity-toggle]","{deleteBtn}":"[data-activity-delete]","{addFriendButton}":"[data-search-friend-button]","{pendingFriendButton}":"[data-search-friend-pending-button]","{dropdown}":"[data-profileFriends-dropdown]",view:{loader:"site/loading/small"}}},function(b){return{init:function(){},"{pendingFriendButton} click":function(){b.dropdown().html(a.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE"))
},"{addFriendButton} click":function(c){var d=b.element.data("friend-uid");a(c).addClass("btn-loading"),EasySocial.ajax("site/controllers/friends/request",{viewCallback:"usersRequest",id:d}).done(function(d){a(c).replaceWith(d),b.dropdown().remove(),a(c).removeClass("btn-loading")}).fail(function(a){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")}),b.dropdown().html(a)})}}}),b.resolve()})}),EasySocial.module("site/search/dating",function(){var b=this;EasySocial.require().script("site/search/map").done(function(){EasySocial.Controller("Search.Dating",{defaultOptions:{"{itemCriteria}":"[data-itemCriteria]","{itemDataKey}":"[data-itemDataKey]","{itemOperator}":"[data-itemOperator]","{itemCondition}":"[data-itemCondition]","{dateStart}":"[data-start]","{dateEnd}":"[data-end]","{dataCondition}":"[data-condition]","{dataGender}":"[data-gender-radio]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]","{locationLabel}":"[data-location-label]","{textField}":"[data-location-textfield]"}},function(a){return{init:function(){a.element.addController(EasySocial.Controller.Search.Map),""!=a.frmAddress().val()&&a.textField().val(a.frmAddress().val())
},"{frmDistance} change":function(){var b=a.frmDistance().val(),c=a.frmAddress().val(),d=a.frmLatitude().val(),e=a.frmLongitude().val(),f=b+"|"+d+"|"+e+"|"+c;a.dataCondition().val(f)},"{dataGender} click":function(b){a.dataCondition().val(b.val())},"{dateStart} change":function(){start=a.dateStart().val(),end=a.dateEnd().val();var b=start;end.length>0&&(b=b+"|"+end),a.dataCondition().val(b)},"{dateEnd} change":function(){start=a.dateStart().val(),end=a.dateEnd().val();var b=end;start.length>0&&(b=start+"|"+b),a.dataCondition().val(b)
}}}),b.resolve()})}),EasySocial.module("site/search/list",function(){var b=this;EasySocial.require().view("site/loading/small","site/search/loadbutton").script("site/search/item").language("COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS").done(function(a){EasySocial.Controller("Search.List",{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(b){return{init:function(){b.item().implement(EasySocial.Controller.Search.Item),b.on("scroll.search",window,a._.debounce(function(){b.loading||b.pagination().visible()&&b.loadMore()
},250))},"{loadmorebutton} click":function(){b.loadMore()},loadMore:function(){var c=a("[data-search-query]").val(),d=a("[data-sidebar-menu].active").data("type"),e=b.pagination().data("last-limit"),f=b.pagination().data("last-type"),g=[];return a("[data-search-filtertypes]:checked").each(function(b,c){g.push(a(c).val())}),"-1"==e?(b.loadmorebutton().hide(),void 0):(b.loading=!0,EasySocial.ajax("site/controllers/search/getItems",{next_limit:e,last_type:f,type:d,q:c,loadmore:"1",filtertypes:g},{beforeSend:function(){b.pagination().html(b.view.loadingContent())
}}).done(function(a,c,d){b.pagination().data("last-limit",d),b.pagination().data("last-type",c),b.pagination().before(a),b.item().implement(EasySocial.Controller.Search.Item),"-1"==d?b.pagination().html(""):b.pagination().html(b.view.loadmoreContent())}).fail(function(a){return a}).always(function(){b.loading=!1}),void 0)}}}),b.resolve()})}),EasySocial.module("site/search/search",function(){var b=this;EasySocial.require().library("history").script("site/search/sidebar","site/profile/friends").view("site/loading/small").done(function(){EasySocial.Controller("Search",{defaultOptions:{items:null,"{container}":"[data-search]","{contentTitle}":"[data-search-content-title]","{content}":"[data-search-content]","{sidebar}":"[data-search-sidebar]","{sidebarItem}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(a){return{init:function(){a.sidebar().implement(EasySocial.Controller.Search.Sidebar,{"{parent}":a}),a.sidebarItem().implement(EasySocial.Controller.Search.Sidebar.Item,{"{parent}":a})
},updatingContents:function(){a.content().html(a.view.loadingContent())},updateContent:function(b){a.content().html(b)}}}),b.resolve()})}),EasySocial.module("site/search/sidebar",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Search.Sidebar",{defaultOptions:{"{menuItem}":"[data-sidebar-menu]"}},function(b){return{init:function(){},"{menuItem} click":function(c){b.menuItem().removeClass("active"),a(c).addClass("active")}}}),EasySocial.Controller("Search.Sidebar.Item",{defaultOptions:{}},function(b){return{init:function(){},"{self} click":function(){var e=b.element.data("type"),f=b.element.data("url"),g=a("[data-search-query]").val(),h=[];
a("[data-search-filtertypes]").each(function(b,c){a(c).prop("checked",!1)}),""!=e&&(h.push(e),a("[data-search-filtertypes]").each(function(b,c){a(c).val()==e&&a(c).prop("checked",!0)})),History.pushState({state:1},"",f),b.parent.updatingContents(),EasySocial.ajax("site/controllers/search/getItems",{type:e,q:g,filtertypes:h}).done(function(a){b.parent.updateContent(a)}).fail(function(a){console.log(a)}),b.parent.updateContent()}}}),b.resolve()})}),EasySocial.module("site/search/toolbar",function(a){var b=this;
EasySocial.Controller("Search.Toolbar",{defaultOptions:{showadvancedlink:!0,"{textfield}":"[data-nav-search-input]"}},function(b,c,d){return{init:function(){b.options.showadvancedlink=0==b.element.data("showadvancedlink")?0:1,b.element.siblings("[data-nav-search-filter]").addController(EasySocial.Controller.Search.Toolbar.Filter,{"{parent}":b})},cache:{},showPopBox:!1,rePopBox:null,search:a.debounce(function(c){if(!b.loading&&c&&(c=a.trim(c))&&!(c.length<=2)){var e=b.textfield();e.popbox("widget").hide(),e.popbox("widget").destroy();
var g=[];a("[data-search-filtertypes]:checked").each(function(b,c){filterValue=a(c).val(),g.push(filterValue)});var h=EasySocial.ajax("site/controllers/search/getItems",{q:c,mini:"1",showadvancedlink:b.options.showadvancedlink,filtertypes:g}).done(function(){});h.fail(function(a){console.log(a)}).always(function(){b.loading=!1}),b.hide(),d.popbox({content:h,id:"fd",component:"es",type:"search",toggle:"click",cache:!1,offset:0});var i=d.popbox("widget");i.show(),i.keyword=c}},250),reSearch:function(c){if(!b.loading&&c&&(c=a.trim(c))&&!(c.length<=2)){{b.textfield()
}b.textfield().popbox("widget").hide(),b.textfield().popbox("widget").destroy();var g=[];a("[data-search-filtertypes]:checked").each(function(b,c){filterValue=a(c).val(),g.push(filterValue)});var h=EasySocial.ajax("site/controllers/search/getItems",{q:c,mini:"1",showadvancedlink:b.options.showadvancedlink,filtertypes:g}).done(function(){});h.fail(function(a){console.log(a)}).always(function(){b.loading=!1,b.showPopBox=!0}),b.hide(),d.popbox({content:h,id:"fd",component:"es",type:"search",toggle:"click",cache:!1,offset:0})
}},hide:function(){var a=d.popbox("widget");a&&a.hide()},show:function(){var a=d.popbox("widget");a.show()},"{textfield} keydown":function(){b.hide()},"{textfield} keyup":function(a,c){if(27!==c.which){var d=a.val();b.search(d)}},"{self} popboxLoading":function(a,b,c){c.loader.width(d.width()),c.loader.position(c.position),d.addClass("is-active")},"{self} popboxActivate":function(a,b,c){c.tooltip.width(d.width()),c.tooltip.position(c.position),d.addClass("is-active")},"{self} popboxDeactivate":function(){d.removeClass("is-active")
}}}),EasySocial.Controller("Search.Toolbar.Filter",{defaultOptions:{"{filterButton}":"[data-filter-button]","{filterDropdown}":".dropdown-menu","{filterDropdownInput}":".dropdown-menu input","{filterDropdownLabel}":".dropdown-menu label","{filterBox}":"[data-search-filtertypes]","{selectAllBtn}":"[data-filter-selectall]","{deselectAllBtn}":"[data-filter-deselectall]"}},function(a){return{init:function(){},"{self} blur":function(){console.log("test"),a.parent.showPopBox&&a.parent.show()},"{selectAllBtn} click":function(b,c){c.stopPropagation(),a.filterBox().prop("checked",!0)
},"{deselectAllBtn} click":function(b,c){c.stopPropagation(),a.filterBox().prop("checked",!1)},"{filterButton} click":function(){if(a.element.hasClass("open")){var d=a.parent.textfield().val();a.parent.search(d)}else a.parent.hide()},"{filterDropdownInput} click":function(a,b){b.stopPropagation()},"{filterDropdownLabel} click":function(a,b){b.stopPropagation()}}}),b.resolve()}),EasySocial.module("site/stream/item",function(){var a=this;EasySocial.require().library("mentions","placeholder","dialog").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").done(function(b){EasySocial.Controller("Stream.Item",{defaultOptions:{view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"},id:"",context:"","{deleteFeed}":"[data-stream-delete]","{editStream}":"[data-stream-edit]","{updateStream}":"[data-stream-edit-update]","{cancelEditStream}":"[data-stream-edit-cancel]","{editPoll}":"[data-stream-polls-edit]","{cancelEditPoll}":"[data-stream-polls-edit-cancel]","{updatePoll}":"[data-stream-polls-edit-update]","{publishItem}":"[data-stream-publish]","{addBookmark}":"[data-stream-bookmark-add]","{removeBookmark}":"[data-stream-bookmark-remove]","{addSticky}":"[data-stream-sticky-add]","{removeSticky}":"[data-stream-sticky-remove]","{hideLink}":"[data-stream-hide]","{unHideLink}":"[data-stream-show]","{hideAppLink}":"[data-stream-hide-app]","{unHideAppLink}":"[data-stream-show-app]","{hideActorLink}":"[data-stream-hide-actor]","{unHideActorLink}":"[data-stream-show-actor]","{hideNotice}":"[data-stream-hide-notice]","{actions}":"[data-streamItem-actions]","{contents}":"[data-streamItem-contents]","{streamContent}":"[data-stream-content]","{streamEditor}":"[data-stream-editor]","{streamData}":"[data-stream-item]","{likes}":"[data-likes-action]","{counterBar}":"[data-stream-counter]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{share}":"[data-repost-action]","{translateLink}":"[data-stream-translate]","{translateLoader}":"[data-stream-translate-loader]","{streamCommentLink}":"[data-stream-action-comments]","{streamCommentBlock}":"[data-comments]"}},function(a,c,d){return{init:function(){c.id=d.data("id"),c.context=d.data("context"),c.ishidden=d.data("ishidden"),c.actor=d.data("actor")
},plugins:{},"{translateLink} click":function(){var d=a.streamContent().html();a.element.addClass("is-translating"),EasySocial.ajax("site/controllers/stream/translate",{contents:d}).done(function(b){a.streamContent().html(b)}).always(function(){a.element.removeClass("is-translating"),a.element.addClass("is-translated")})},"{addBookmark} click":function(){a.element.addClass("is-bookmarked"),EasySocial.ajax("site/controllers/stream/bookmark",{id:a.options.id}).done(function(){}).fail(function(b){a.element.removeClass("is-bookmarked"),a.setMessage(b)
})},"{removeBookmark} click":function(){var d=window.streamFilter||!1;"bookmarks"!=d&&a.element.removeClass("is-bookmarked"),EasySocial.ajax("site/controllers/stream/removeBookmark",{id:a.options.id}).done(function(b){"bookmarks"==d&&a.element.html(b)})},"{addSticky} click":function(){EasySocial.ajax("site/controllers/stream/addSticky",{id:a.options.id}).done(function(){a.element.addClass("is-sticky")}).fail(function(a){EasySocial.dialog({content:a.message})})},"{removeSticky} click":function(){var d=window.streamFilter||!1;
"sticky"!=d&&a.element.removeClass("is-sticky"),EasySocial.ajax("site/controllers/stream/removeSticky",{id:a.options.id}).done(function(b){"sticky"==d&&a.element.html(b)})},"{publishItem} click":function(){var e=c.id;EasySocial.ajax("site/controllers/stream/publish",{id:e}).done(function(){d.switchClass("is-published")})},"{likes} onLiked":function(){a.counterBar().removeClass("hide")},"{likes} onUnliked":function(){var e=a.likeContent().hasClass("hide"),f=a.repostContent().hasClass("hide");e&&f&&a.counterBar().addClass("hide")
},"{share} create":function(){a.counterBar().removeClass("hide")},"{streamCommentLink} click":function(){a.streamCommentBlock().trigger("show")},"{actions} click":function(c){a.actions().removeClass("active"),b(c).addClass("active")},"{deleteFeed} click":function(){var b=a.options.id;EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmDelete"),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/stream/delete",{id:b}).done(function(b){EasySocial.dialog({content:b}),a.element.fadeOut(),setTimeout(function(){EasySocial.dialog().close()
},2e3)}).fail(function(a){EasySocial.dialog({content:a})})}}})},"{editPoll} click":function(){var b=a.options.id,c="stream";EasySocial.ajax("site/views/polls/edit",{uid:b,element:c,source:"stream"}).done(function(b){a.element.addClass("is-editing"),a.streamContent().hide(),a.streamEditor().html(b)})},"{cancelEditPoll} click":function(){a.element.removeClass("is-editing"),a.streamEditor().html(""),a.streamContent().show()},"{updatePoll} click":function(){var b=a.element.find("[data-polls-edit]").controller("EasySocial.Controller.Polls"),c=b.validateForm();
if(!c)return task.reject("Error validating polls inputs. Please make sure all the required fields are filled in.");var d=b.toData();EasySocial.ajax("site/controllers/polls/update",d).done(function(b){a.streamContent().html(b),a.cancelEditPoll().click()})},"{cancelEditStream} click":function(){a.element.removeClass("is-editing"),a.streamEditor().html(""),a.streamContent().show()},"{editStream} click":function(){var c=a.options.id;EasySocial.ajax("site/views/stream/edit",{id:c}).done(function(c){a.element.addClass("is-editing"),a.streamContent().hide(),a.streamEditor().html(c);
var d=a.streamEditor().find("[data-story-textbox]"),e=d.controller("mentions");return e?(e.cloneLayout(),void 0):(d.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:b.View("easysocial/site/friends/suggest.hint.search"),emptyHint:b.View("easysocial/site/friends/suggest.hint.empty"),data:function(c){var d=b.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:c}).done(function(c){b.isArray(c)||d.reject();var c=b.map(c,function(b){return b.title=b.screenName,b.type="user",b.menuHtml=a.view.suggestItem(!0,{item:b,name:"uid[]"}),b
});d.resolve(c)}).fail(d.reject),d},use:function(a){return a.type+":"+a.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:b.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:b.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(c){var d=b.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:c}).done(function(c){b.isArray(c)||d.reject();var c=b.map(c,function(b){return b.title="#"+b.title,b.type="hashtag",b.menuHtml=a.view.tagSuggestItem(!0,{item:b,name:"uid[]"}),b
});d.resolve(c)}).fail(d.reject),d}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:"left top",at:"left bottom",of:a.streamEditor().find(".es-story-text"),collision:"none"}}}}),void 0)})},"{updateStream} click":function(){var c=a.streamEditor().find("[data-story-textbox]"),d=a.streamEditor().find("[data-story-textfield]"),e=c.mentions("controller").toArray(),f=a.element.data("storyHashtags"),f=f?f.split(","):[],g=!1,h={};if(f.length>0){var i=b.map(e,function(a){return"hashtag"===a.type&&b.inArray(a.value,f)>-1?a:void 0
});g=i.length<1}h.mentions=b.map(e,function(a){return"hashtag"===a.type&&b.isPlainObject(a.value)&&(a.value=a.value.title.slice(1)),JSON.stringify(a)}),h.content=d.val(),h.id=a.options.id,EasySocial.ajax("site/controllers/story/update",h).done(function(b){a.streamContent().html(b),a.cancelEditStream().click()})},"{hideLink} click":function(){a.streamData().addClass("es-feed-loading"),EasySocial.ajax("site/controllers/stream/hide",{id:a.options.id}).done(function(b){a.streamData().removeClass("es-feed-loading"),a.streamData().hide(),a.element.append(b)
}).fail(function(){})},"{hideActorLink} click":function(){EasySocial.ajax("site/controllers/stream/hideactor",{actor:a.options.actor}).done(function(c){a.streamData().hide(),b(".stream-actor-"+a.options.actor).addClass("hide-stream"),a.element.append(c)}).fail(function(a){console.log(a)})},"{unHideActorLink} click":function(){EasySocial.ajax("site/controllers/stream/unhideactor",{actor:a.options.actor}).done(function(){a.hideNotice().remove(),a.streamData().show(),b(".stream-actor-"+a.options.actor).removeClass("hide-stream")
}).fail(function(a){console.log(a)})},"{hideAppLink} click":function(){EasySocial.ajax("site/controllers/stream/hideapp",{context:a.options.context}).done(function(c){a.streamData().hide(),b(".stream-context-"+a.options.context).addClass("hide-stream"),a.element.append(c)}).fail(function(a){console.log(a)})},"{unHideLink} click":function(){EasySocial.ajax("site/controllers/stream/unhide",{id:a.options.id}).done(function(){a.hideNotice().remove(),a.streamData().show()}).fail(function(a){console.log(a)})},"{unHideAppLink} click":function(){EasySocial.ajax("site/controllers/stream/unhideapp",{context:a.options.context}).done(function(){a.hideNotice().remove(),a.streamData().show(),b(".stream-context-"+a.options.context).removeClass("hide-stream")
}).fail(function(a){console.log(a)})}}}),a.resolve()})}),EasySocial.module("site/stream/stream",function(){var a=this;EasySocial.require().script("site/stream/item").view("site/loading/small","site/stream/loadbutton").language("COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS").done(function(b){EasySocial.Controller("Stream",{defaultOptions:{interval:30,checknew:null,source:null,sourceId:null,autoload:!0,"{story}":"[data-story]","{share}":"[data-repost-action]","{list}":"[data-stream-list]","{newNotiBar}":"[data-stream-notification-bar]","{newNotiButton}":"[data-stream-notification-button]","{item}":"[data-streamItem]","{pagination}":"[data-stream-pagination]","{paginationGuest}":"[data-stream-pagination-guest]","{paginationCluster}":"[data-stream-pagination-cluster]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/stream/loadbutton"}}},function(a){return{init:function(){a.item().addController(EasySocial.Controller.Stream.Item,{"{parent}":a}),"stream"!=a.options.source&&"unity"!=a.options.source&&1==a.options.checknew&&a.startMonitoring(),1==a.options.autoload&&a.on("scroll.stream",window,b._.debounce(function(){if(!a.loading)if("unity"==a.options.source)a.paginationGuest().visible()&&a.loadMoreGuest();
else{iscluster="dashboard"==a.options.source||"profile"==a.options.source?!1:!0;var b=iscluster===!0?a.paginationCluster():a.pagination();b.visible()&&a.loadMore(iscluster)}},250)),a.setLayout()},setLayout:function(){},"{window} resize":b.debounce(function(){a.setLayout()},500),"{story} create":function(c,d,e,f){""!=f&&a.updateExcludeIds(f),a.updateCurrentDate(),b.buildHTML(e).prependTo(a.list()).addController("EasySocial.Controller.Stream.Item"),a.list().children("li.empty").remove()},"{share} create":function(c,d,e){b.buildHTML(e).prependTo(a.list()).addController("EasySocial.Controller.Stream.Item"),a.list().children("li.empty").remove(),a.updateCurrentDate()
},updateCurrentDate:function(){EasySocial.ajax("site/controllers/stream/getCurrentDate",{}).done(function(b){a.element.data("currentdate",b)}).fail(function(){})},updateExcludeIds:function(b){ids=a.element.data("excludeids"),newIds="",newIds=""!=ids&&void 0!=ids?ids+","+b:b,a.element.data("excludeids",newIds)},clearExcludeIds:function(){a.element.data("excludeids","")},startMonitoring:function(){if(a._destroyed)return a.stopMonitoring();var b=1e3*a.options.interval;EasySocial.debug,a.options.state=setTimeout(a.check,b)
},stopMonitoring:function(){clearTimeout(a.options.state)},"{self} destroyed":function(){a.stopMonitoring()},check:function(){a.stopMonitoring();{var d=(1e3*a.options.interval,b("[data-dashboardSidebar-menu].active").data("type")),e=b("[data-dashboardSidebar-menu].active").data("id"),f=a.element.data("currentdate"),g=a.element.data("excludeids");b.trim(a.newNotiBar().html())}void 0==d&&void 0==e&&"profile"==a.options.source&&(d="me",e=a.options.sourceId),EasySocial.ajax("site/controllers/stream/checkUpdates",{type:d,id:e,currentdate:f,exclude:g,source:a.options.source,view:a.options.source}).done(function(c,d,e){if(a._destroyed)return a.stopMonitoring();
if(a.element.data("currentdate",e),c.length>0){for(var f=0;f<c.length;f++)if(item=c[f],item.cnt>0){var g="[data-stream-counter-"+item.type+"]";curCount=b(g).text(),newCount=""==curCount?item.cnt:parseInt(curCount,10)+parseInt(item.cnt,10),b(g).html(newCount),b(g).parents("li").addClass("has-notice")}d=b.trim(d),curContents=b.trim(a.newNotiBar().text()),d.length>0&&0==curContents.length&&a.newNotiBar().html(d)}a.startMonitoring()})},"{newNotiButton} click":function(c){var e=b(c).data("type"),f=b(c).data("uid"),g=b(c).data("since");
EasySocial.ajax("site/controllers/stream/getUpdates",{type:e,id:f,currentdate:g,source:a.options.source,view:a.options.source}).done(function(c,d,g){var h="[data-stream-counter-";"list"==e?h=h+e+"-"+f:h+=e,h+="]",b(h).parents("li").removeClass("has-notice"),b(h).html("0"),b.each(g,function(b,c){a.item().where("id",c).remove()});var i=g.length,j="";j=a.paginationGuest().length>0?a.paginationGuest():a.pagination();var k=j.data("nextlimit");k+=i,j.data({nextlimit:k}),a.newNotiBar().html(""),b.buildHTML(c).prependTo(a.list()).addController("EasySocial.Controller.Stream.Item"),a.clearExcludeIds(),a.element.data("currentdate",d)
})},"{paginationGuest} click":function(){a.loadMoreGuest()},loadMoreGuest:function(){var c=a.paginationGuest(),d=c.data("nextlimit"),e=a.options.source;d&&(a.loading=!0,c.html(a.view.loadingContent({content:""})),EasySocial.ajax("site/controllers/stream/loadmoreGuest",{startlimit:d,view:e}).done(function(d,e){c.data({nextlimit:e});var d=b.buildHTML(d);d.insertBefore(c).filter(a.item.selector).addController("EasySocial.Controller.Stream.Item");try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(f){}""==e?c.html(""):c.html(a.view.loadmoreContent())
}).fail(function(a){return a}).always(function(){a.loading=!1}))},"{paginationCluster} click":function(){a.loadMore(!0)},"{pagination} click":function(){a.loadMore()},loadMore:function(c){var d=b("[data-dashboardSidebar-menu].active"),e=d.data("type"),f=d.data("id");tag=d.data("tag"),fid=d.data("fid");var g=c===!0?a.paginationCluster():a.pagination(),h=g.data("nextlimit"),i=g.data("context"),j=a.options.source;h&&(void 0==e&&void 0==f&&"profile"==a.options.source&&(e="me",f=a.options.sourceId),a.loading=!0,g.html(a.view.loadingContent({content:""})),EasySocial.ajax("site/controllers/stream/loadmore",{id:f,type:e,startlimit:h,view:j,tag:tag,filterId:fid,context:i,iscluster:c}).done(function(c,d){g.data({nextlimit:d});
var c=b.buildHTML(c);c.insertBefore(g).filter(a.item.selector).addController("EasySocial.Controller.Stream.Item"),a.setLayout();try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(e){}""==d?g.html(""):g.html(a.view.loadmoreContent())}).fail(function(a){return a}).always(function(){a.loading=!1}))}}}),a.resolve()})}),EasySocial.module("site/subscriptions/follow",function(){var a=this;EasySocial.require().language("COM_EASYSOCIAL_SUBSCRIPTION_INFO").done(function(b){EasySocial.Controller("Follow",{defaultOptions:{}},function(a){return{init:function(){},"{self} click":function(){EasySocial.ajax("site/controllers/subscriptions/toggle",{uid:a.element.data("id"),type:a.element.data("type"),notify:"1"}).done(function(c,d){a.element.text(d),EasySocial.dialog({title:b.language("COM_EASYSOCIAL_SUBSCRIPTION_INFO"),content:c})
}).fail(function(b){a.setMessage(b,"error")})}}}),a.resolve()})}),EasySocial.module("site/system/broadcast",function(){var b=this;EasySocial.require().library("gritter").done(function(a){EasySocial.Controller("System.Broadcast",{defaultOptions:{interval:30,sticky:!1,period:8}},function(b){return{init:function(){b.startMonitoring()},startMonitoring:function(){var a=1e3*b.options.interval;b.options.state=setTimeout(b.check,a)},stopMonitoring:function(){clearTimeout(b.options.state)},check:function(){b.stopMonitoring();
var c=1e3*b.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/getBroadcasts").done(function(c){c&&a(c).each(function(c,d){a.gritter.add({title:d.title,text:d.content,image:d.authorAvatar,sticky:b.options.sticky,time:1e3*b.options.period,class_name:"es-broadcast"})}),b.startMonitoring()})},c)}}}),b.resolve()})}),EasySocial.module("site/toolbar/conversations",function(){var b=this;EasySocial.require().library("tinyscrollbar").done(function(){EasySocial.Controller("Notifications.Conversations",{defaultOptions:{interval:30,"{counter}":"[data-notificationConversation-counter]"}},function(a){return{init:function(){a.startMonitoring()
},startMonitoring:function(){var b=1e3*a.options.interval;EasySocial.debug,a.options.state=setTimeout(a.check,b)},stopMonitoring:function(){EasySocial.debug,clearTimeout(a.options.state)},check:function(){a.stopMonitoring();var b=1e3*a.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/getConversationCounter").done(function(b){b>0?(a.element.addClass("has-notice"),a.counter().html(b)):a.element.removeClass("has-notice"),a.startMonitoring()})},b)}}}),b.resolve()})}),EasySocial.module("site/toolbar/friends",function(){var b=this;
EasySocial.require().library("tinyscrollbar").language("COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED").done(function(a){EasySocial.Controller("Notifications.Friends",{defaultOptions:{interval:3,returnURL:"","{counter}":"[data-notificationFriends-counter]","{loadRequestsButton}":".loadRequestsButton"}},function(a){return{init:function(){a.startMonitoring()},startMonitoring:function(){var b=1e3*a.options.interval;EasySocial.debug,a.options.state=setTimeout(a.check,b)},stopMonitoring:function(){EasySocial.debug,clearTimeout(a.options.state)
},check:function(){a.stopMonitoring();var b=1e3*a.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/friendsCounter").done(function(b){b>0?(a.element.addClass("has-notice"),a.counter().html(b)):a.element.removeClass("has-notice"),a.startMonitoring()})},b)}}}),EasySocial.Controller("Notifications.Friends.Item",{defaultOptions:{"{actionsWrapper}":"[data-friend-item-actions]","{acceptFriend}":"[data-friend-item-accept]","{rejectFriend}":"[data-friend-item-reject]","{actions}":"[data-friend-item-action]","{title}":"[data-friend-item-title]","{mutual}":"[data-friend-item-mutual]",view:{loader:"site/loading/small"}}},function(b){return{init:function(){},"{acceptFriend} click":function(c,d){d.stopPropagation();
var e=a("[data-notifications-friends]").controller();b.actionsWrapper().addClass("friend-adding"),EasySocial.ajax("site/controllers/friends/approve",{viewCallback:"notificationsApprove",id:a(c).data("id")}).done(function(a,c){if(b.actionsWrapper().removeClass("friend-adding").addClass("added-friends"),b.title().html(a),b.mutual().html(c),e){var d=e.counter().html(),d=parseInt(d),d=d-1;d=d.toString(),e.counter().html(d),0==d&&e.element.removeClass("has-notice")}}).fail(function(a){b.element.html(a.message)})},"{rejectFriend} click":function(c,d){d.stopPropagation(),EasySocial.ajax("site/controllers/friends/reject",{id:a(c).data("id")}).done(function(){b.actionsWrapper().html(a.language("COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED"))
}).fail(function(a){b.element.html(a.message)})}}}),b.resolve()})}),EasySocial.module("site/toolbar/login",function(){var b=this;EasySocial.require().library("popbox").done(function(a){EasySocial.Controller("Toolbar.Login",{defaultOptions:{"{dropdown}":"[data-toolbar-login-dropdown]"}},function(){return{init:function(){},"{self} popboxActivate":function(b,c,d){a(d.tooltip).find("label").on("click",function(b){b.preventDefault(),b.stopPropagation();var c=a(this).attr("for"),d=a("[data-popbox-content] #"+c);d.is(":checkbox")?d.click():d.focus()
})}}}),b.resolve()})}),EasySocial.module("site/toolbar/notifications",function(){var b=this;EasySocial.require().script("site/toolbar/friends","site/toolbar/story","site/toolbar/system","site/toolbar/profile","site/toolbar/login","site/toolbar/conversations").done(function(a){EasySocial.Controller("Notifications",{defaultOptions:{friendsInterval:30,systemInterval:30,conversationsInterval:30,"{friendNotifications}":"[data-notifications-friends]","{conversationNotifications}":"[data-notifications-conversations]","{systemNotifications}":"[data-notifications-system]","{profileItem}":"[data-toolbar-profile]","{storyForm}":"[data-toolbar-story]","{login}":"[data-toolbar-login]","{item}":"[data-toolbar-item]"}},function(b,c){return{init:function(){b.login().addController(EasySocial.Controller.Toolbar.Login),c.guest||(b.profileItem().addController(EasySocial.Controller.Toolbar.Profile,{interval:b.options.systemInterval}),b.systemNotifications().addController(EasySocial.Controller.Notifications.System,{interval:c.systemInterval}),b.friendNotifications().addController(EasySocial.Controller.Notifications.Friends,{interval:b.options.friendsInterval}),b.conversationNotifications().addController(EasySocial.Controller.Notifications.Conversations,{interval:b.options.conversationsInterval}),b.storyForm().addController(EasySocial.Controller.Notifications.Story)),b.setLayout(),a("body").on("click.out-of-dropdown",function(){b.item().removeClass("open")
})},"{window} resize":a.debounce(function(){b.setLayout()},250),setLayout:function(){var c=b.element,d=c.outerWidth(!0)-80,e=0;b.item().each(function(){e+=a(this).outerWidth(!0)});var f=e>d;c.toggleClass("narrow",f).toggleClass("wide",!f)}}}),b.resolve()})}),EasySocial.module("site/toolbar/story",function(){var b=this;EasySocial.require().done(function(){EasySocial.Controller("Notifications.Story",{defaultOptions:{"{loadFormButton}":".loadFormButton","{dropdown}":".dropdown-menu"}},function(){return{init:function(){},"{dropdown} click":function(){},"{self} hideDropdown":function(){},"{dropdown} click":function(a,b){b.stopPropagation()
}}}),b.resolve()})}),EasySocial.module("site/toolbar/system",function(){var b=this;EasySocial.require().view("site/notifications/system.empty").library("tinyscrollbar").done(function(a){EasySocial.Controller("Notifications.System",{defaultOptions:{pageTitle:null,interval:30,"{counter}":"[data-notificationSystem-counter]"}},function(b,c){return{init:function(){c.pageTitle=a(document).attr("title"),b.startMonitoring()},startMonitoring:function(){var a=1e3*b.options.interval;b.options.state=setTimeout(b.check,a)
},stopMonitoring:function(){clearTimeout(b.options.state)},check:function(){b.stopMonitoring();var c=1e3*b.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/getSystemCounter").done(function(c){c>0?(a(document).attr("title",b.options.pageTitle+" ("+c+")"),b.element.addClass("has-notice"),b.counter().html(c)):(b.element.removeClass("has-notice"),a(document).attr("title",b.options.pageTitle)),b.startMonitoring()})},c)},"{window} easysocial.clearSystemNotification":function(){b.element.removeClass("has-notice"),b.counter().html(0)
}}}),EasySocial.Controller("Notifications.System.Popbox",{defaultOptions:{"{readall}":"[data-notificationsystem-readall]","{items}":"[data-notificationsystem-items]",view:{empty:"site/notifications/system.empty"}}},function(b){return{init:function(){},"{readall} click":function(){a("[data-notificationSystem-counter]").parents("li").removeClass("has-notice"),a("[data-notificationSystem-counter]").html(0),EasySocial.ajax("site/controllers/notifications/setAllState",{state:"read"}).done(function(){b.items().html(""),b.items().append(b.view.empty()),b.items().addClass("is-empty"),a(window).trigger("easysocial.clearSystemNotification")
})}}}),b.resolve()})}),EasySocial.module("site/toolbar/profile",function(){var b=this;EasySocial.require().library("popbox").done(function(a){EasySocial.Controller("Toolbar.Profile",{defaultOptions:{"{dropdown}":"[data-toolbar-profile-dropdown]"}},function(){return{init:function(){},"{self} popboxActivate":function(b,c,d){a(d.tooltip).implement(EasySocial.Controller.Toolbar.Profile.Logout)}}}),EasySocial.Controller("Toolbar.Profile.Logout",{defaultOptions:{"{logoutForm}":"[data-toolbar-logout-form]","{logoutButton}":"[data-toolbar-logout-button]"}},function(a){return{logout:function(){a.logoutForm().submit()
},"{logoutButton} click":function(){console.log("debug"),a.logout()}}}),b.resolve()})}),EasySocial.module("site/users/popbox",function(){var b=this;EasySocial.require().library("popbox").done(function(){EasySocial.module("users/popbox",function(){this.resolve(function(a){var b=a.button.data("ids"),c=a.button.attr("data-popbox-position")||"top-left";return{content:EasySocial.ajax("site/views/users/popbox",{ids:b}),id:"fd",component:"es",type:"users",position:c}})})}),b.resolve()}),EasySocial.module("site/users/users",function(){var b=this;
EasySocial.require().library("history").view("site/loading/small","site/users/button.following").done(function(a){EasySocial.Controller("Users",{defaultOptions:{"{content}":"[data-users-content]","{listing}":"[data-users-listing]","{sort}":"[data-users-sort]","{filter}":"[data-users-filter]","{items}":"[data-users-item]","{pagination}":"[data-users-pagination]","{profile}":"[data-users-filter-profile]","{search}":"[data-users-filter-search]",view:{loading:"site/loading/small"}}},function(b){return{init:function(){b.initUserController()
},initUserController:function(){b.items().implement(EasySocial.Controller.Users.Item,{"{parent}":b})},removeActiveFilter:function(){b.filter().each(function(){a(this).parent().removeClass("active")}),b.profile().each(function(){a(this).parent().removeClass("active")}),b.search().each(function(){a(this).parent().removeClass("active")})},"{profile} click":function(c,d){d.preventDefault();var e=a(c).data("id");b.removeActiveFilter(),a(c).parent().addClass("active"),a(c).route(),b.listing().html(b.view.loading()),EasySocial.ajax("site/controllers/users/getUsersByProfile",{id:e}).done(function(a){b.content().html(a),b.initUserController()
})},"{search} click":function(c,d){d.preventDefault();var e=a(c).data("id");b.removeActiveFilter(),a(c).parent().addClass("active"),a(c).route(),b.listing().html(b.view.loading()),EasySocial.ajax("site/controllers/users/getUsersByFilter",{id:e}).done(function(a){b.content().html(a),b.initUserController()})},"{filter} click":function(c,d){d.preventDefault(),b.sort().removeClass("active"),b.removeActiveFilter(),a(c).parent().addClass("active");var e=a(c).data("filter");b.options.filter=e,a(c).route(),b.listing().html(b.view.loading()),b.sort(":first").addClass("active"),EasySocial.ajax("site/controllers/users/getUsers",{filter:e,showpagination:1}).done(function(a){b.content().html(a),b.initUserController()
})},"{sort} click":function(c,d){d.preventDefault();var e=a(c).data("type");a("<a>").attr({title:document.title,href:a(c).attr("href")}).route(),b.sort().removeClass("active"),a(c).addClass("active"),b.listing().html(b.view.loading()),b.pagination().remove(),EasySocial.ajax("site/controllers/users/getUsers",{sort:e,filter:b.options.filter,isSort:!0,showpagination:1}).done(function(a){b.listing().html(a),b.initUserController()})}}}),EasySocial.Controller("Users.Item",{defaultOptions:{id:null,"{followUser}":"[data-es-followers-follow]","{addFriend}":"[data-users-add-friend]","{friendsButton}":"[data-users-friends-button]","{compose}":"[data-users-friends-compose]","{unfriend}":"[data-users-friends-unfriend]",view:{followingButton:"site/users/button.following"}}},function(b){return{init:function(){b.options.id=b.element.data("id")
},"{followUser} following":function(c){a(c).popbox("hide"),a(c).replaceWith(b.view.followingButton())},"{addFriend} click":function(c){a(c).addClass("btn-loading"),EasySocial.ajax("site/controllers/friends/request",{viewCallback:"usersRequest",id:b.options.id}).done(function(b){a(c).replaceWith(b),a(c).removeClass("btn-loading")}).fail(function(b){EasySocial.dialog({content:b.message}),a(c).removeClass("btn-loading")})}}}),b.resolve()})}),EasySocial.module("story",function(a){var b=this;EasySocial.require().language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_STREAM_META_JOINER").view("apps/user/links/story/attachment.item","site/location/story.suggestion","site/albums/upload.item","site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").done(),EasySocial.require().script("story/locations","story/friends","story/mood"),EasySocial.require().library("mentions","placeholder").script("site/stream/item").language("COM_EASYSOCIAL_STORY_SUBMIT_ERROR","COM_EASYSOCIAL_STORY_CONTENT_EMPTY","COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER").done(function(){EasySocial.Controller("Story",{defaultOptions:{view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"},plugin:{text:{id:"text",name:"text",selector:"[data-story-plugin-name=photos]",type:"panel"}},sourceView:null,attachment:{limit:1,lifo:!0},enterToSubmit:!1,"{header}":"[data-story-header]","{body}":"[data-story-body]","{footer}":"[data-story-footer]","{form}":"[data-story-form]","{textbox}":"[data-story-textbox]","{textField}":"[data-story-textField]","{target}":"[data-story-target]","{cluster}":"[data-story-cluster]","{clusterType}":"[data-story-clustertype]","{submitButton}":"[data-story-submit]","{resetButton}":"[data-story-reset]","{privacyButton}":"[data-story-privacy]","{panelContents}":"[data-story-panel-contents]","{panelContent}":"[data-story-panel-content]","{panelButton}":"[data-story-panel-button]","{streamContainer}":"[data-streams]","{streamItem}":"[data-streamItem]","{friends}":"[data-story-friends]","{location}":"[data-story-location]","{mood}":"[data-story-mood]","{mentionsOverlay}":"[data-mentions-overlay]","{meta}":"[data-story-meta]","{metaContents}":"[data-story-meta-contents]","{metaContent}":"[data-story-meta-content]","{metaButtons}":"[data-story-meta-buttons]","{metaButton}":"[data-story-meta-button]"},hostname:"story"},function(b,c,d){return{init:function(){b.id=d.data("story"),a.each(b.options.plugin,function(a,c){var d=b.plugins[a]=c;
"attachment"==d.type&&b.attachments.max++,d.selector=b.getPluginSelector(a)}),b.setMentionsLayout(),b.friends().length>0&&EasySocial.module("story/friends").done(function(){b.addPlugin("friends")}),b.location().length>0&&EasySocial.module("story/locations").done(function(){b.addPlugin("locations")}),b.mood().length>0&&EasySocial.module("story/mood").done(function(){b.addPlugin("mood")}),b.placeholder=b.textField().attr("placeholder"),b._setMessage=b.setMessage,b.setMessage=function(){d.hasClass("is-collapsed")||d.hasClass("is-resizing")||(this.element.find("[data-message-group]").remove(),b._setMessage.apply(this,arguments))
},navigator.userAgent.match(/MSIE 9.0/i)&&d.addClass("is-ie"),b.checkResetButton(),a.module("story-"+b.id).resolve(b)},checkResetButton:function(){var a=b.textField(),c=a.attr("data-default");c&&b.resetButton().toggle(a.val()!==c)},"{textField} keyup":a.debounce(function(){b.checkResetButton()},250,{leading:!0}),"{self} click":function(c,d){a(d.target).parents().andSelf().filter(b.resetButton()[0]).length>0||b.expand()},"{textField} touchstart":function(){b.expand()},"{textField} keydown":function(){b.expand()
},"{textField} click":function(){b.expand()},"{textField} mousedown":function(){b.expand()},"{textField} keypress":function(a,d){c.enterToSubmit&&13==d.keyCode&&!(d.shiftKey||d.altKey||d.ctrlKey||d.metaKey)&&(b.save(),d.preventDefault())},expand:a.debounce(function(){if(!d.hasClass("is-expanded")&&!d.hasClass("is-resizing")){var c=a.support&&a.support.transition&&a.support.transition.end,e=(c||"transitionend")+".es.story",f=a.debounce(function(){d.off(e).addClass("is-expanded").removeClass("is-resizing"),b.setMentionsLayout(),b.submitButton().removeAttr("data-disabled"),b.textField().focus()
},1);c?d.on(e,f):setTimeout(f,600),d.removeClass("is-collapsed").addClass("is-resizing")}},1),collapse:function(){d.hasClass("is-collapsed")||d.hasClass("is-resizing")||(d.addClass("is-resizing").removeClass("is-expanded"),setTimeout(function(){d.addClass("is-collapsed").removeClass("is-resizing")},1))},reset:function(a){b.clear(),""===b.textField().val()&&a&&b.collapse()},setMentionsLayout:function(){var c=b.textbox(),d=c.controller("mentions");if(d)return d.cloneLayout(),void 0;var e=b.body();c.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:a.View("easysocial/site/friends/suggest.hint.search"),emptyHint:a.View("easysocial/site/friends/suggest.hint.empty"),data:function(c){var d=a.Deferred();
return EasySocial.ajax("site/controllers/friends/suggest",{search:c}).done(function(c){if(!a.isArray(c))return d.reject(),void 0;var c=a.map(c,function(a){return a.title=a.screenName,a.type="user",a.menuHtml=b.view.suggestItem(!0,{item:a,name:"uid[]"}),a});d.resolve(c)}).fail(d.reject),d},use:function(a){return a.type+":"+a.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:a.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:a.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(c){var d=a.Deferred();
return EasySocial.ajax("site/controllers/hashtags/suggest",{search:c}).done(function(c){if(!a.isArray(c))return d.reject(),void 0;var c=a.map(c,function(a){return a.title="#"+a.title,a.type="hashtag",a.menuHtml=b.view.tagSuggestItem(!0,{item:a,name:"uid[]"}),a});d.resolve(c)}).fail(d.reject),d}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:"left top",at:"left bottom",of:c.parent(),collision:"none"},size:{width:function(){return e.width()
}}}}})},plugins:{},getPluginName:function(b){return a(b).data("story-plugin-name")},getPluginSelector:function(a){return"[data-story-plugin-name="+a+"]"},hasPlugin:function(a,c){var d=b.plugins[a];return d?c?d.type===c:!0:!1},buildPluginSelectors:function(c,d,e){var f={};return a.each(c,function(a,c){var g=b[c].selector+d.selector;"function"==e?f[c]=function(){return b.find(g)}:f["{"+c+"}"]=g}),f},"{self} addPlugin":function(c,d,e,f,g,h){if(b.hasPlugin(e)){var i=b.plugins[e],j={};switch(i.type){case"panel":var k=["panelButton","panelContent"];
j=b.buildPluginSelectors(k,i,h)}a.extend(g,j)}},"{self} registerPlugin":function(a,c,d,e){if(b.hasPlugin(d)){var f=b.plugins[d];f.instance=e}},panels:{},currentPanel:"text",getPanel:function(a){if(b.hasPlugin(a,"panel")){var c=b.plugins[a];return b.panels[c.name]||(b.panels[c.name]={plugin:c,button:b.panelButton(c.selector),content:b.panelContent(c.selector)})}},activatePanel:function(a){var c=b.getPanel(a);if(c){b.deactivatePanel(b.currentPanel),b.currentPanel=a;var e=b.panelContents();e.addClass("active"),c.button.addClass("active"),c.content.appendTo(e).addClass("active"),d.addClass("plugin-"+a),b.invokePlugin(a,"activatePanel",[c]),b.trigger("activatePanel",[a]),b.textField().focus()
}},deactivatePanel:function(a){var c=b.getPanel(a);c&&(c.button.removeClass("active"),c.content.removeClass("active"),d.removeClass("plugin-"+a),b.panelContents().removeClass("active"),b.invokePlugin(a,"deactivatePanel",[c]),b.trigger("deactivatePanel",[a]))},addPanelCaption:function(a,c){var d=b.getPanel(a);d&&d.button.addClass("has-data").find(".with-data").html(c)},removePanelCaption:function(a){var c=b.getPanel(a);c&&c.button.removeClass("has-data").find(".with-data").empty()},"{panelButton} click":function(a){var d=b.getPluginName(a);
b.activatePanel(d)},saving:!1,save:function(){if(!b.saving){b.saving=!0;var c=a.Deferred();c.data={},c.tasks=[],c.addData=function(d,e){{var f=d.options.name;d.options.type}f===b.currentPanel&&(c.data.attachment=b.currentPanel,a.isPlainObject(e)?a.each(e,function(a,b){c.data[f+"_"+a]=b}):c.data[f]=e)},c.addTask=function(b){var d=a.Deferred();return d.name=b,d.save=c,c.tasks.push(d),d},c.process=function(){return"pending"===c.state()&&a.when.apply(a,c.tasks).done(function(){return a.trim(c.data.content)||c.data.attachment?(c.resolve(),void 0):(c.reject(a.language("COM_EASYSOCIAL_STORY_CONTENT_EMPTY"),"warning"),void 0)
}).fail(c.reject),c},c.currentPanel=b.currentPanel,b.trigger("save",[c]),b.element.addClass("saving"),c.process().done(function(){var d=b.textbox().mentions("controller").toArray(),e=b.element.data("storyHashtags"),e=e?e.split(","):[],f=!1;if(e.length>0){var g=a.map(d,function(b){return"hashtag"===b.type&&a.inArray(b.value,e)>-1?b:void 0});f=g.length<1}b.trigger("beforeSubmit",[c]),EasySocial.ajax("site/controllers/story/create",c.data).done(function(c,d){f&&(c=b.setMessage(a.language("COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER"))),b.trigger("create",[c,d]),b.clear(),b.reset()
}).fail(function(a){b.trigger("fail",arguments),a&&b.setMessage(a.message,a.type)}).always(function(){b.trigger("afterSubmit",[c]),b.element.removeClass("saving"),b.saving=!1})}).fail(function(c,d){c||(c=a.language("COM_EASYSOCIAL_STORY_SUBMIT_ERROR"),d="error"),b.setMessage(c,d),b.element.removeClass("saving"),b.saving=!1})}},clear:function(){b.textField().val(""),b.clearMessage(),b.activatePanel("text"),b.deactivateMeta(b.currentMeta),b.trigger("clear");var a=b.textbox().mentions("controller");a.reset(),b.checkResetButton(),setTimeout(function(){a.cloneLayout()
},500),b.textField().focus()},"{self} save":function(c,d,e){var f=b.textField().val(),g=e.data;g.view=b.options.sourceView,g.content=f,g.target=b.target().val(),g.cluster=b.cluster().val(),g.clusterType=b.clusterType().val(),g.privacy=b.find("[data-privacy-hidden]").val(),g.privacyCustom=b.find("[data-privacy-custom-hidden]").val();var h=b.textbox().mentions("controller").toArray();g.mentions=a.map(h,function(b){return"hashtag"===b.type&&a.isPlainObject(b.value)&&(b.value=b.value.title.slice(1)),JSON.stringify(b)
})},"{submitButton} click":function(){b.save()},"{resetButton} click":function(){b.reset(!0)},"{privacyButton} click":function(a){setTimeout(function(){a.find("[data-es-privacy-container]").hasClass("active")},1)},metas:{friends:"",location:"",mood:""},currentMeta:null,getMeta:function(a){var c={name:a,button:b.metaButton().filterBy("storyMetaButton",a),content:b.metaContent().filterBy("storyMetaContent",a)};return c.button.length<1||c.content.length<1?null:c},activateMeta:function(a){var c=b.getMeta(a);c&&(b.deactivateMeta(b.currentMeta),c.button.addClass("active"),c.content.appendTo(b.metaContents()).addClass("active"),b.currentMeta=a,b.trigger("activateMeta",[c]),d.addClass("has-meta"))
},deactivateMeta:function(a){var c=b.getMeta(a);c&&(c.button.removeClass("active"),c.content.removeClass("active"),b.currentMeta=null,b.trigger("deactivateMeta",[c]),d.removeClass("has-meta"))},toggleMeta:function(a){b.currentMeta==a?b.deactivateMeta(a):b.activateMeta(a)},getMetaText:function(){var c=b.metas,d=[],e=a.language("COM_EASYSOCIAL_STREAM_META_JOINER");return a.each(["friends","location","mood"],function(a,b){var e=c[b];e&&d.push(e)}),d.join(e)},setMeta:function(a,c){b.metas[a]=c,b.updateMeta()},updateMeta:a.debounce(function(){var c=b.getMetaText(),d=b.meta(),e=b.textField();
if(a.each(b.metas,function(a,c){var d=b.getMeta(a);d&&d.button.toggleClass("has-content",!!c)}),!c)return d.remove(),e.attr("placeholder",b.placeholder),void 0;var f=b.mentionsOverlay();d.length<1&&(d=a('<u class="es-story-meta" data-story-meta data-ignore></u>').appendTo(f));var g="rtl"==f.css("direction")?"&#8207;":"";d.html(g+" &mdash; "+c),e.attr("placeholder",""),b.setMentionsLayout()},1),refreshMeta:function(){b.trigger("refreshMeta"),b.updateMeta()},"{textbox} triggerClear":function(){b.refreshMeta()},"{meta} click":function(c,d){a(d.target).is("a")||b.textField().focus()
},"{metaButton} click":function(a){var c=a.attr("data-story-meta-button");b.toggleMeta(c)}}}),b.resolve()})}),EasySocial.module("story/blog",function(){var b=this;EasySocial.require().done(function(){EasySocial.Controller("Story.Blog",{defaultOptions:{"{title}":"[data-blog-title]","{content}":"[data-blog-content]","{category}":"[data-story-blog-category]"}},function(a){return{init:function(){},"{story} save":function(b,c,d){var e=a.category().val(),f=a.title().val(),g=a.content().val(),h={categoryId:e,title:f,content:g};
d.addData(a,h)}}}),b.resolve()})}),EasySocial.module("story/broadcast",function(){var b=this;EasySocial.require().done(function(){EasySocial.Controller("Story.Broadcast",{defaultOptions:{"{profile}":"[data-broadcast-profile]","{title}":"[data-broadcast-title]","{link}":"[data-broadcast-link]","{message}":"[data-broadcast-message]","{type}":"[data-broadcast-type]"}},function(a){return{init:function(){},"{story} save":function(b,c,d){var e=a.profile().val(),f=a.title().val(),g=a.link().val(),h=a.type().val(),i={broadcast:"1",profileId:e,title:f,link:g,type:h};
d.addData(a,i)},"{story} beforeSubmit":function(b,c,d){"broadcast"==d.currentPanel&&(d.data.content=a.message().val())}}}),b.resolve()})}),EasySocial.module("story/event",function(a){var b=this,c=EasySocial.options.momentLang;EasySocial.require().library("datetimepicker","moment/"+c).view("site/loading/small").language("COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA","COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME").done(function(){EasySocial.Controller("Story.Event",{defaultOptions:{"{base}":"[data-story-event-base]","{category}":"[data-story-event-category]","{form}":"[data-story-event-form]","{timezone}":"[data-event-timezone]","{datetimeForm}":"[data-event-datetime-form]","{datetime}":"[data-event-datetime]","{title}":"[data-event-title]","{description}":"[data-event-description]",view:{loading:"site/loading/small"}}},function(b){return{init:function(){},"{category} change":function(c){c.val()?(b.form().show().html(b.view.loading()),b.loadStoryForm(c.val()).done(function(c){b.form().html(c);
var e,d=b.datetimeForm().htmlData();e=a.isEmpty(d.yearto)?(new Date).getFullYear()+100:parseInt(d.yearto)+1,a.extend(b.options,{yearfrom:d.yearfrom||1930,yearto:e,allowTime:d.allowtime,allowTimezone:d.allowtimezone,dateFormat:d.dateformat,disallowPast:d.disallowpast,minuteStepping:parseInt(d.minutestepping)}),b.datetime().addController("EasySocial.Controller.Story.Events.Datetime",{"{parent}":b})})):b.form().hide().html("")},loadStoryForm:a.memoize(function(a){return EasySocial.ajax("apps/user/events/controllers/events/loadStoryForm",{id:a})
}),"{story} save":function(a,c,d){if("event"==d.currentPanel){var e={title:b.title().val(),description:b.description().val(),category:b.category().val()};b.options.allowTimezone&&(e.timezone=b.timezone().val()),b.datetime().trigger("datetimeExport",[e]),b.options.name="event";var f=d.addTask("validateEventForm");b.save(f,e)}},save:function(c,d){return a.isEmpty(d.title)||a.isEmpty(d.category)||a.isEmpty(d.start)?c.reject(a.language("COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA")):!a.isEmpty(d.start)&&!a.isEmpty(d.end)&&d.end<d.start?c.reject(a.language("COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME")):(c.save.addData(b,d),c.resolve(),void 0)
}}}),EasySocial.Controller("Story.Events.Datetime",{defaultOptions:{type:null,"{picker}":"[data-picker]","{toggle}":"[data-picker-toggle]","{datetime}":"[data-datetime]"}},function(b){return{init:function(){b.options.type=b.element.data("event-datetime");var d=new a.moment;b.parent.options.disallowPast?d.date(d.date()-1):d.year(b.parent.options.yearfrom),b.picker()._datetimepicker({component:"es",useCurrent:!1,format:b.parent.options.dateFormat,minDate:d,maxDate:new a.moment({y:b.parent.options.yearto}),icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!1,pickTime:1==b.parent.options.allowTime,minuteStepping:b.parent.options.minuteStepping,language:c});
var e=a.moment();e.minute(0),e.second(0),"end"==b.options.type&&e.hour(e.hour()+1),b.datetimepicker("setDate",e)},datetimepicker:function(a,c){return b.picker().data("DateTimePicker")[a](c)},"{toggle} click":function(){b.picker().focus()},"{picker} dp.change":function(c,d){b.setDateValue(d.date.toDate()),b.parent.element.trigger("event"+a.String.capitalize(b.options.type),[d.date])},setDateValue:function(a){b.datetime().val(a.getFullYear()+"-"+("00"+(a.getMonth()+1)).slice(-2)+"-"+("00"+a.getDate()).slice(-2)+" "+("00"+a.getHours()).slice(-2)+":"+("00"+a.getMinutes()).slice(-2)+":"+("00"+a.getSeconds()).slice(-2))
},"{parent} eventStart":function(){"start"===b.options.type},"{parent} eventEnd":function(){"end"===b.options.type},"{self} datetimeExport":function(a,c,d){d[b.options.type]=b.datetime().val()}}}),b.resolve()})}),EasySocial.module("story/files",function(a){var b=this;EasySocial.require().library("plupload").view("apps/user/files/story/attachment.item","apps/user/files/story/progress").done(function(){EasySocial.Controller("Story.Files",{defaultOptions:{"{canvas}":"[data-files-canvas]","{dropsite}":"[data-files-dropsite]","{upload}":"[data-files-upload]","{uploadGroup}":"[data-files-items]","{fileItem}":"[data-files-item]","{removeItem}":"[data-files-item-remove]","{uploadItem}":"[data-files-upload-item]",settings:{url:null,max_file_size:null,filters:[]},view:{attachment:"apps/user/files/story/attachment.item",progress:"apps/user/files/story/progress"}}},function(b){return{items:{},init:function(){var c=a.extend({"{uploadButton}":b.upload.selector,"{uploadDropsite}":b.dropsite.selector},{settings:b.options.settings});
b.uploader=b.canvas().addController("plupload",c),b.plupload=b.uploader.plupload,b.addPlugin("uploader",b.uploader),a.IE||"html5"!=b.plupload.runtime||b.canvas().addClass("can-drop-file"),b.canvas().addClass("can-upload"),b.setLayout()},hasItems:function(){var a=b.fileItem().length>0,c=b.uploadItem().length>0;return a||c},setLayout:function(){b.canvas().toggleClass("has-items",b.hasItems())},removeFile:function(a){b.fileItem().where("id",a).remove(),b.setLayout()},clearFiles:function(){b.fileItem().remove(),b.uploadItem().remove(),b.setLayout()
},removeFileItem:function(a){var c=b.getItem(a);c&&(b.plupload.removeFile(c.file()),c.element.remove(),delete b.items[a],b.setLayout())},getItem:function(c){var d;return a.isString(c)&&(d=c),c&&c.id&&(d=c.id),b.items[d]},createItem:function(a){var c=b.view.progress({file:a});return b.uploadGroup().append(c),b.items[a.id]=c,b.setLayout(),b.trigger("QueueCreated",[c]),c},"{uploader} FilesAdded":function(c,d,e,f){try{f.reverse(),a.each(f,function(a,c){b.getItem(c)||b.createItem(c)})}catch(g){console.error(g)}b.setLayout(),b.uploader.plupload.start()
},"{uploader} FileUploaded":function(a,c,d,e,f){var g=b.getItem(e),h=b.view.attachment({file:e,id:f.id});h.data("file-id",f.id).addClass("new-item").insertAfter(g),g.remove(),b.setLayout(),setTimeout(function(){h.removeClass("new-item")},1)},"{uploader} UploadProgress":function(c,d,e,f){var g=b.getItem(f);if(g){var h=void 0===f.size||"N/A"==f.size;f.percentage=f.percent+"%",f.filesize=h?"":a.plupload.formatSize(f.size),f.remaining=h?"":a.plupload.formatSize(f.size-(f.loaded||0));var i=f.percentage;"100%"==i&&(i="99%"),"0%"==i&&(i="1%"),g.find(".upload-progress-bar").width(i),g.find(".upload-percentage").html(i)
}},"{uploader} FileError":function(a,c,d,e,f){b.story.setMessage(f.message,"error");var g=b.uploadingFile;g&&(g.reject(),delete b.uploadingFile),b.setLayout()},"{uploader} Error":function(a,c,d,e){b.story.setMessage(e.message,"error");var f=b.uploadingFile;f&&(f.reject(),delete b.uploadingFile),b.removeItem().click(function(){setTimeout(function(){b.setLayout()},1)}),b.setLayout()},"{removeItem} click":function(a){var c=a.parent(b.fileItem.selector).data("id");b.removeFile(c)},"{story} save":function(a,c,d){b.hasItems()&&(b.uploadingFile=d.addTask("uploadingFile"),b.save())
},save:function(){var c=b.uploadingFile;if(c){var d=b.fileItem();if(d.length){var e=[];save=c.save,d.each(function(){e.push(a(this).data("id"))}),save.addData(b,e),c.resolve(),delete b.uploadingFile}}},"{story} clear":function(){b.clearFiles()}}}),b.resolve()})}),EasySocial.module("story/friends",function(a){var b=this;EasySocial.require().library("textboxlist").language("COM_EASYSOCIAL_STREAM_STORY_WITH","COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER","COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER","COM_EASYSOCIAL_AND").done(function(){EasySocial.Controller("Story.Friends",{defaultOptions:{"{friendList}":".es-story-friends-textbox","{textField}":".es-story-friends-textbox [data-textboxlist-textfield]"}},function(b){return{init:function(){b.textField().placeholder(),b.friendList().textboxlist({component:"es",plugin:{autocomplete:{exclusive:!0,cache:!1,query:b.search,filterItem:b.createMenuItem,component:"es",modifier:"es-story-friends-autocomplete",sticky:!0,shadow:!0}}})
},search:function(a){var c=b.getTaggedUsers();return EasySocial.ajax("site/controllers/friends/suggest",{search:a,exclude:c})},getTaggedUsers:function(){var b=[],c=a("[data-textboxlist-item]");return c.length>0&&a.each(c,function(c,d){b.push(a(d).data("id"))}),b},createMenuItem:function(b){b.title=b.screenName;var d=a(new Image).addClass("textboxlist-menu-avatar").attr({src:b.avatar}).toHTML();return b.html=d+" "+b.title,b.menuHtml=d+" "+b.title,b},mention:function(c,d,e){b.search(d).done(function(b){var c=[];
a.each(b,function(a,b){c.push({id:b.id,name:b.screenName,avatar:b.avatar,type:"contact"})}),e(c)})},updateMeta:function(){var c=b.friendList().controller("textboxlist"),d=c.getAddedItems();if(d.length<1)return b.story.setMeta("friends",""),void 0;var e=d.length-1,f=a.language("COM_EASYSOCIAL_STREAM_STORY_WITH")+" ";a.each(d,function(b,c){if(f+='<a href="'+c.permalink+'" target="_blank">'+c.screenName+"</a>",b!=e){var d=a.language("COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER");b==e-1&&(d=a.language("COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER")),f+=d
}}),b.story.setMeta("friends",f)},"{friendList} addItem":function(){b.updateMeta()},"{friendList} removeItem":function(){b.updateMeta()},"{story} activateMeta":function(a,c,d){"friends"===d.name&&setTimeout(function(){b.textField().focus()},1)},"{story} save":function(a,c,d){var e=b.friendList().controller("textboxlist"),f=e.getAddedItems().map(function(a){return a.id});d.data.friends_tags=f},"{story} clear":function(){var a=b.friendList().controller("textboxlist");a.clearItems()}}}),b.resolve()})}),EasySocial.module("story/links",function(a){var b=this;
EasySocial.require().view("site/links/story/attachment.item").done(function(){EasySocial.Controller("Story.Links",{defaultOptions:{view:{linkItem:"site/links/story/attachment.item"},urlParser:/(^|\s)(https?:\/\/)?(([a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.([a-z]{2,7}))|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))(:[0-9]{1,5})?(\/.*)?/gi,validateUrl:!1,"{linkForm}":"[data-story-link-form]","{linkInput}":"[data-story-link-input]","{linkContent}":"[data-story-link-content]","{linkItem}":"[data-story-link-item]","{linkTitle}":"[data-story-link-title]","{linkDescription}":"[data-story-link-description]","{linkImages}":"[data-story-link-images]","{linkImage}":"[data-story-link-image]","{imageWrapper}":"[data-story-link-image-wrapper]","{linkVideo}":"[data-story-link-video]","{titleTextfield}":"[data-story-link-title-textfield]","{descriptionTextfield}":"[data-story-link-description-textfield]","{panelButton}":"[data-story-link-panel-button]","{attachButton}":"[data-story-link-attach-button]","{removeButton}":"[data-story-link-remove-button]","{removeThumbnail}":"[data-story-link-remove-image]"}},function(b){return{init:function(){b.linkInput().placeholder()
},activateAttachment:function(){b.doNotFocus||setTimeout(function(){b.linkInput().focus(),b.doNotFocus=!1},500)},links:{},currentLink:null,crawling:!1,extractUrls:function(c){var d=b.options.urlParser,e=c.match(d);return a.isArray(e)?a.map(e,function(b){return a.trim(b)}):[]},fixUrl:function(b){var b=a.uri(b);return/http|https/.test(b.protocol())||b.setProtocol("http"),b.toString()},getLink:function(c){if(a.isString(c)&&(c=b.extractUrls(c)),!(c.length<0)){var d=c[0];return link=b.links[d]||b.createLink(d)}},createLink:function(c){var d=b.links[c]=a.Deferred();
return d.url=c,b.crawling=!0,EasySocial.ajax("site/controllers/crawler/fetch",{urls:[c]}).done(function(e){var f=e[c];f||d.reject(),d.info=f;var g=f.opengraph||{},h=f.oembed||{},i=[];h.thumbnail&&i.push(h.thumbnail),g.image&&i.push(g.image),f.images&&a.merge(i,f.images),d.data={title:h.title||g.title||f.title,desc:h.description||g.desc||f.description,url:c,images:i,video:g.video?g.video:f.videos},d.item=b.view.linkItem(d.data).data("link",d),d.item.addController("EasySocial.Controller.Story.Links.Item"),d.resolve(d)
}).fail(function(){d.reject()}).always(function(){b.crawling=!1}),d},addLink:function(a){b.linkContent().empty().append(a.item),b.linkForm().hide(),b.currentLink=a},removeLink:function(){b.linkItem().detach(),b.linkForm().show(),b.currentLink=null},"{attachButton} click":function(){var d=(b.linkInput(),b.linkForm()),e=a.trim(b.linkInput().val());""!==e&&(e=b.fixUrl(e),b.linkInput().val(e),d.addClass("busy"),b.getLink(e).done(function(a){b.addLink(a)}).always(function(){d.removeClass("busy")}))},"{removeButton} click":function(){b.currentLink.disabled=!0,b.removeLink()
},"{story.textField} input":a._.debounce(function(a){if(!b.currentLink&&!b.crawling){var d=a.val(),e=b.extractUrls(d),f=e[e.length-1];if(f){var f=b.fixUrl(f),g=b.links[f];if(!g||!g.disabled){if(b.options.validateUrl){return EasySocial.ajax("site/controllers/crawler/validate",{url:f}).done(function(){console.log("valid"),b.linkInput().val(f),b.doNotFocus=!0,b.panelButton().click(),b.attachButton().click()}),void 0}b.linkInput().val(f),b.doNotFocus=!0,b.panelButton().click(),b.attachButton().click()}}}},950),"{story} save":function(a,c,d){if(b.currentLink){var e={title:b.titleTextfield().val(),description:b.descriptionTextfield().val(),url:b.currentLink.url,video:b.linkVideo().val()};
b.removeThumbnail().is(":checked")||(e.image=b.imageWrapper(".active").find("img").attr("src")),d.addData(b,e)}},"{story} clear":function(){b.linkInput().val(""),b.removeLink()}}}),EasySocial.Controller("Story.Links.Item",{defaultOptions:{"{previousImage}":"[data-story-link-image-prev]","{nextImage}":"[data-story-link-image-next]","{image}":"[data-story-link-image]","{imageWrapper}":"[data-story-link-image-wrapper]","{imagesWrapper}":"[data-story-link-images]","{imageIndex}":"[data-story-link-image-index]","{removeThumbnail}":"[data-story-link-remove-image]","{imageDimensions}":"[data-story-link-image-dimensions]","{imageWidth}":"[data-image-width]","{imageHeight}":"[data-image-height]","{title}":"[data-story-link-title]","{description}":"[data-story-link-description]","{titleTextfield}":"[data-story-link-title-textfield]","{descriptionTextfield}":"[data-story-link-description-textfield]"}},function(b){return{init:function(){b.initDimensions()
},initDimensions:function(){b.image().on("load",function(){var c=this.naturalWidth,d=this.naturalHeight,e=a(this).parent();e.find(b.imageWidth.selector).html(c),e.find(b.imageHeight.selector).html(d)})},"{removeThumbnail} click":function(){var a=b.removeThumbnail().is(":checked");a?b.imagesWrapper().hide():b.imagesWrapper().show(),b.element.toggleClass("has-images",!a)},"{previousImage} click":function(){var a=b.imageWrapper(".active"),c=a.prev(),d=parseInt(b.imageIndex().html()),e=d-1;c.length>0&&(a.removeClass("active"),c.addClass("active"),b.imageIndex().html(e))
},"{nextImage} click":function(){var a=b.imageWrapper(".active"),c=a.next(),d=parseInt(b.imageIndex().html()),e=d+1;c.length>0&&(a.removeClass("active"),c.addClass("active"),b.imageIndex().html(e))},"{title} click":function(){var a=b.element.hasClass("editing-title");b.element.toggleClass("editing-title",!a),a||b.editTitle()},editTitleEvent:"click.es.story.editLinkTitle",editTitle:function(){b.element.addClass("editing-title"),setTimeout(function(){b.titleTextfield().val(b.title().text()).focus()[0].select(),a(document).on(b.editTitleEvent,function(a){a.target!==b.titleTextfield()[0]&&b.saveTitle("save")
})},1)},saveTitle:function(c){c||(c=save);var d=b.titleTextfield().val();"save"==c&&(""===d&&(d=b.title().data("default")),b.title().html(d)),b.element.removeClass("editing-title"),a(document).off(b.editTitleEvent)},"{titleTextfield} keyup":function(a,c){27==c.keyCode&&b.saveTitle("revert")},"{description} click":function(){var a=b.element.hasClass("editing-description");b.element.toggleClass("editing-description",!a),a||b.editDescription()},editDescriptionEvent:"click.es.story.editLinkDescription",editDescription:function(){b.element.addClass("editing-description"),setTimeout(function(){var c=b.description().clone(),d=c.hasClass("no-description");
c.wrapInner(b.descriptionTextfield()),d&&b.descriptionTextfield().val(""),b.descriptionTextfield().focus()[0].select(),a(document).on(b.editDescriptionEvent,function(a){a.target!==b.descriptionTextfield()[0]&&b.saveDescription("save")})},1)},saveDescription:function(c){c||(c=save);var d=b.descriptionTextfield().val().replace(/\n/g,"<br//>");switch(c){case"save":var e=""===d;b.description().toggleClass("no-description",e),e&&(d=b.descriptionTextfield().attr("placeholder")),b.description().html(d);break;case"revert":}b.element.find(".textareaClone").remove(),b.element.removeClass("editing-description"),a(document).off(b.editDescriptionEvent)
},"{descriptionTextfield} keyup":function(a,c){27==c.keyCode&&b.saveDescription("revert")}}}),b.resolve()})}),EasySocial.module("story/locations",function(a){var b=this;EasySocial.require().library("gmaps","scrollTo","image").view("site/location/story.suggestion").language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT").done(function(){var c={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};
EasySocial.Controller("Story.Locations",{defaultOptions:{view:{suggestion:"site/location/story.suggestion"},map:{lat:0,lng:0},"{base}":"[data-story-location]","{form}":"[data-story-location-form]","{textField}":"[data-story-location-textField]","{detectButton}":"[data-story-location-detect-button]","{autocomplete}":"[data-story-location-autocomplete]","{suggestions}":"[data-story-location-suggestions]","{suggestion}":"[data-story-location-suggestion]","{textbox}":"[data-story-location-textbox]","{removeButton}":"[data-story-location-remove-button]","{map}":"[data-story-location-map]","{mapImage}":"[data-story-location-map-image]","{meta}":"[data-story-meta-location]"}},function(b){return{init:function(){navigator.geolocation&&b.base().addClass("is-detectable"),b.textField().placeholder(),b.textField().removeAttr("disabled")
},"{window} resize":a.debounce(function(){var a=b.currentLocation;if(a){var c=b.mapImage();if(c.data("width")!==c.width()){var d=a.geometry.location,e=d.lat(),f=d.lng();b.navigate(e,f)}}},250),navigate:function(c,d){var e=b.mapImage(),f=e.width(),g=e.height(),h=a.GMaps.staticMapURL({size:[f,g],lat:c,lng:d,sensor:!0,scale:2,markers:[{lat:c,lng:d}]});a.Image.get(h).done(function(){e.css({backgroundImage:a.cssUrl(h),backgroundSize:"cover",backgroundPosition:"center center"}),b.base().addClass("has-location")})},locations:{},lastQueryAddress:null,"{textField} keypress":function(d,e){switch(e.keyCode){case c.UP:var f=a(b.suggestion(".active").prev(b.suggestion.selector)[0]||b.suggestion(":last")[0]);
b.suggestion().removeClass("active"),f.addClass("active").trigger("activate"),b.suggestions().scrollTo(f,{offset:-1*f.height()}),e.preventDefault();break;case c.DOWN:var g=a(b.suggestion(".active").next(b.suggestion.selector)[0]||b.suggestion(":first")[0]);b.suggestion().removeClass("active"),g.addClass("active").trigger("activate"),b.suggestions().scrollTo(g,{offset:-1*g.height()}),e.preventDefault();break;case c.ENTER:var h=b.suggestion(".active"),i=h.data("location");b.set(i),b.hideSuggestions();break;case c.ESCAPE:b.hideSuggestions()
}},"{textField} keyup":function(d,e){switch(e.keyCode){case c.UP:case c.DOWN:case c.LEFT:case c.RIGHT:case c.ENTER:case c.ESCAPE:break;default:var f=a.trim(d.val());""===f&&(b.base().removeClass("has-location"),b.hideSuggestions());var g=b.locations[f];g?(b.lastQueryAddress=f,b.suggest(g)):b.lookup(f)}},lookup:a.debounce(function(a){b.base().addClass("is-busy"),EasySocial.ajax("site/controllers/location/getLocations",{query:a}).done(function(c){b.base().removeClass("is-busy"),b.locations[a]=c,b.suggest(c),b.lastQueryAddress=a
}).fail(function(a){console.log(a)})},250),suggest:function(c){var d=b.suggestions();d.empty(),c.length<0||(a.each(c,function(a,c){b.view.suggestion({location:c}).data("location",c).appendTo(d)}),b.showSuggestions())},showSuggestions:function(){b.focusSuggestion=!0,b.element.find(".es-story-footer").addClass("swap-zindex"),b.story.clearMessage(),setTimeout(function(){b.autocomplete().addClass("active");var c=a(document),d="click.es.story.location";c.off(d).on(d,function(e){var f=a(e.target).parents().andSelf();
f.filter(b.element).length>0||(c.off(d),b.hideSuggestions())})},500)},hideSuggestions:function(){b.focusSuggestion=!1,b.autocomplete().removeClass("active"),a(document).off("click.es.story.location"),setTimeout(function(){b.focusSuggestion||b.element.find(".es-story-footer").removeClass("swap-zindex")},500)},"{suggestion} activate":function(a){var d=a.data("location");b.navigate(d.latitude,d.longitude)},"{suggestion} mouseover":function(a){b.suggestion().removeClass("active"),a.addClass("active").trigger("activate")
},"{suggestion} click":function(a){var d=a.data("location");b.set(d),b.hideSuggestions()},set:function(c){b.currentLocation=c;var d=a.Deferred();a.isEmpty(c.fulladdress)?b.getAddress(c.latitude,c.longitude).done(function(a){c.fulladdress=c.name+", "+a,d.resolve(c)}):d.resolve(c),d.done(function(c){b.navigate(c.latitude,c.longitude),b.textField().val(c.fulladdress),b.lastQueryAddress=c.address;var d=a('<a href="javascript: void(0);" data-story-meta-location>').html(c.fulladdress).toHTML(),e=a.language("COM_EASYSOCIAL_STREAM_AT")+" "+d;
b.story.setMeta("location",e),b.base().addClass("has-location")})},unset:function(){b.currentLocation=null,b.textField().val(""),b.story.removePanelCaption("locations"),b.mapImage().attr("src",""),b.story.setMeta("location",""),b.base().removeClass("has-location")},activatePanel:function(){setTimeout(function(){b.textField().focus()},500)},deactivatePanel:function(){var a=b.currentLocation;a&&b.set(a)},detectTimer:null,"{detectButton} click":function(){{var c=b.story;b.textbox()}b.base().addClass("is-busy"),clearTimeout(b.detectTimer),b.detectTimer=setTimeout(function(){c.clearMessage(),c.setMessage(a.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR")),b.base().removeClass("is-busy")
},8e3),a.GMaps.geolocate({success:function(a){EasySocial.ajax("site/controllers/location/getLocations",{latitude:a.coords.latitude,longitude:a.coords.longitude}).done(function(a){b.suggest(a),b.textField().focus()}).fail(function(a){console.log(a)})},error:function(b){c.clearMessage();var d="";switch(b.code){case 1:d=a.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:d=a.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:d=a.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR")
}c.setMessage(d)},always:function(){clearTimeout(b.detectTimer),b.base().removeClass("is-busy")}})},"{removeButton} click":function(){b.unset(),b.hideSuggestions()},"{meta} click":function(){b.story.activateMeta("location")},"{story} activateMeta":function(a,c,d){"location"===d.name&&setTimeout(function(){b.textField().focus()},1)},"{story} save":function(c,d,e){var f=b.currentLocation;if(f){var g=e.addTask("saveLocation");a.isEmpty(f.fulladdress)?b.getAddress(f.latitude,f.longitude).done(function(a){f.fulladdress=f.name+", "+a,b.save(g,f)
}):b.save(g,f)}},getAddress:a.memoize(function(b,c){var d=a.Deferred(),e=new google.maps.Geocoder,f=new google.maps.LatLng(b,c);return e.geocode({latLng:f},function(a,b){b==google.maps.GeocoderStatus.OK&&d.resolve(a[0].formatted_address)}),d},function(a,b){return a+","+b}),save:function(a,b){a.save.data.locations_short_address=b.name,a.save.data.locations_lat=b.latitude,a.save.data.locations_lng=b.longitude,a.save.data.locations_formatted_address=b.fulladdress,a.save.data.locations_data=JSON.stringify(b),a.resolve()
},"{story} clear":function(){b.unset(),b.hideSuggestions()}}}),b.resolve()})}),EasySocial.module("story/mood",function(a){var b=this;EasySocial.require().language("COM_EASYSOCIAL_MOOD_FEELING_CUSTOM").done(function(){EasySocial.Controller("Story.Mood",{defaultOptions:{"{base}":"[data-story-mood]","{presets}":"[data-story-mood-presets]","{preset}":"[data-story-mood-preset]","{verb}":"[data-story-mood-verb]","{verbType}":"[data-story-mood-verb-type]","{textField}":"[data-story-mood-textfield]","{removeButton}":"[data-story-mood-remove-button]"}},function(b){return{init:function(){b.reset(),b.textField().placeholder()
},setLayout:function(){var a=b.base(),c=b.textField();a.toggleClass("is-empty",""===c.val())},currentMood:{},resetMood:function(){b.currentMood={icon:"",verb:"",subject:"",text:"",custom:!1},b.preset().removeClass("is-disabled"),b.story.setMeta("mood","")},setMood:function(c,d){var e=b.currentMood;a.isPlainObject(c)?a.extend(e,c):e[c]=d,b.base().toggleClass("using-preset",!e.custom),b.updateMeta(),b.setLayout()},getVerb:function(){return b.verbType(".active").data("storyMoodVerbType")||"feeling"},reset:function(){b.selecting=!0,b.resetMood(),b.preset().removeClass("is-disabled"),b.textField().val("").focus(),b.setLayout(),b.base().removeClass("using-preset hide-preset"),b.selecting=!1
},updateMeta:function(){var a=b.currentMood,c=a.icon?'<i class="es-emoticon '+a.icon+'"></i> ':"";b.verbType().removeClass("active").filterBy("storyMoodVerbType",a.verb).addClass("active"),b.story.setMeta("mood",c+a.text)},"{preset} click":function(a){var c={icon:a.data("storyMoodIcon"),verb:a.data("storyMoodVerb"),subject:a.data("storyMoodSubject"),text:a.data("storyMoodText"),subjectText:a.data("storyMoodSubjectText"),custom:!1};b.selecting=!0,b.textField().val(c.subjectText).focus(),b.setMood(c),b.selecting=!1
},"{textField} keydown":function(){b.update()},"{textField} keyup":function(){b.update()},"{textField} input":function(c){if(!b.selecting){var e=c.val();if(!e)return b.reset(),void 0;var f=b.currentMood,g=!f.custom&&e!==f.subjectText;g&&b.setMood("custom",!0);var h=b.preset().filter(function(){var b=a(this),c=0!==b.data("storyMoodSubjectText").indexOf(e);return b.toggleClass("is-disabled",c),!c});b.base().toggleClass("hide-preset",h.length<1);var i=b.getVerb(),j={verb:i,subject:"",custom:!0,text:a.language("COM_EASYSOCIAL_MOOD_"+i.toUpperCase()+"_CUSTOM",e)};
b.setMood(j)}},"{removeButton} click":function(){b.reset()},"{story} activateMeta":function(a,c,d){"mood"===d.name&&setTimeout(function(){b.textField().focus()},1)},"{story} save":function(a,c,d){var e=b.currentMood;e.verb&&(d.data.mood_icon=e.icon,d.data.mood_verb=e.verb,d.data.mood_subject=e.subject,d.data.mood_custom=e.custom,d.data.mood_text=e.text)},"{story} clear":function(){b.reset()}}}),b.resolve()})}),EasySocial.module("story/photos",function(a){var b=this;EasySocial.require().script("albums/uploader").done(function(){EasySocial.Controller("Story.Photos",{defaultOptions:{"{albumView}":"[data-album-view]","{albumContent}":"[data-album-content]","{uploadButton}":"[data-album-upload-button]","{photoItemGroup}":"[data-photo-item-group]","{photoItem}":"[data-photo-item]","{photoImage}":"[data-photo-image]","{photoRemoveButton}":"[data-photo-remove-button]","{uploadItem}":"[data-photo-upload-item]","{uploadRemoveButton}":".upload-remove-button"}},function(b){return{init:function(){b.uploader=b.albumView().addController(EasySocial.Controller.Albums.Uploader,a.extend({"{uploadButton}":b.uploadButton.selector,"{uploadItemGroup}":b.photoItemGroup.selector,"{uploadDropsite}":b.albumContent.selector},{settings:b.options.uploader})),b.photoItemGroup().css("opacity",1),b.addPlugin("uploader",b.uploader),b.setLayout()
},hasItems:function(){var a=b.photoItem().length>0,c=b.uploadItem().length>0;return a||c},setLayout:function(){b.albumView().toggleClass("has-photos",b.hasItems())},activateAttachment:function(){},removePhoto:function(a){b.photoItem().filterBy("photoId",a).remove(),b.setLayout()},clearPhoto:function(){b.photoItem().remove(),b.uploadItem().remove(),b.setLayout()},"{uploader} FilesAdded":function(){b.setLayout(),b.uploader.start()},"{uploader} FileUploaded":function(c,d,e,f,g){var h=b.uploader.getItem(f),i=a(a.parseHTML(a.trim(g.html)));
photoData=g.data,i.data("photo",photoData).addClass("new-item").insertAfter(h.element),b.uploader.removeItem(f.id),b.setLayout(),setTimeout(function(){i.removeClass("new-item")},1),b.save()},"{uploader} FileError":function(a,c,d,e,f){b.story.setMessage(f.message,"error");var g=b.uploadingPhoto;g&&(g.reject(),delete b.uploadingPhoto),b.uploader.removeItem(e.id),b.setLayout()},"{uploader} Error":function(a,c,d,e){b.story.setMessage(e.message,"error");var f=b.uploadingPhoto;f&&(f.reject(),delete b.uploadingPhoto),b.uploadRemoveButton().click(function(){setTimeout(function(){b.setLayout()
},1)}),b.setLayout()},"{photoRemoveButton} click":function(a){var c=a.parent(b.photoItem.selector).data("photoId");b.removePhoto(c)},"{story} save":function(a,c,d){b.hasItems()&&(b.uploadingPhoto=d.addTask("uploadingPhoto"),b.save())},save:function(){var c=b.uploadingPhoto;if(c){var d=b.uploadItem();if(d.length<1){var e=[],f=c.save;b.photoItem().each(function(){e.push(a(this).data("photoId"))}),f.addData(b,e),c.resolve(),delete b.uploadingPhoto}}},"{story} clear":function(){b.clearPhoto()}}}),b.resolve()})}),EasySocial.module("story/polls",function(){var b=this;
EasySocial.require().library("datetimepicker").view("site/loading/small").language("COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA","COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME").done(function(){EasySocial.Controller("Story.Polls",{defaultOptions:{"{base}":"[data-story-event-base]","{category}":"[data-story-event-category]","{form}":"[data-story-event-form]","{timezone}":"[data-event-timezone]","{datetimeForm}":"[data-event-datetime-form]","{datetime}":"[data-event-datetime]","{title}":"[data-event-title]","{description}":"[data-event-description]",view:{loading:"site/loading/small"}}},function(a){return{init:function(){},"{story} save":function(b,c,d){if("polls"==d.currentPanel){var e=b.find("[data-polls]").controller("EasySocial.Controller.Polls");
a.options.name="polls";var f=d.addTask("validatePollsForm");a.save(f,e)}},save:function(b,c){var d=c.validateForm();if(!d)return b.reject("Error validating polls inputs. Please make sure all the required fields are filled in.");var e=c.toData();b.save.addData(a,e),b.resolve()}}}),b.resolve()})}),EasySocial.module("story/quickpost",function(){var b=this;EasySocial.Controller("Story.Quickpost",{defaultOptions:{"{submitButton}":"[data-quickpost-submit]","{content}":"[data-quickpost-content]","{message}":"[data-quickpost-message]","{privacyButton}":"[data-story-privacy]","{footer}":"[data-story-footer]"}},function(a){return{init:function(){},"{submitButton} click":function(b){id=b.data("quickpost-userid"),content=a.content().val(),EasySocial.ajax("site/controllers/story/createFromModule",{target:id,privacy:"public",content:content}).done(function(b,c,d,e){return b?(a.message().html(c).addClass("alert fade in alert-success"),a.content().val(""),a.trigger("create",[d,e]),void 0):(a.message().html(c).addClass("alert fade in alert-warning"),void 0)
}).fail(function(b){a.message().html(b.message),a.message().addClass("alert fade in alert-warning")})},"{privacyButton} click":function(b){setTimeout(function(){var c=b.find("[data-es-privacy-container]").hasClass("active");a.footer().toggleClass("allow-overflow",c)},1)}}}),b.resolve()}),EasySocial.module("story/tasks",function(a){var b=this;EasySocial.require().view("apps/group/tasks/story/attachment.item").done(function(){EasySocial.Controller("Story.Tasks",{defaultOptions:{view:{taskItem:"apps/group/tasks/story/attachment.item"},"{form}":"[data-story-tasks-form]","{input}":"[data-story-tasks-input]","{list}":"[data-story-tasks-list]","{milestone}":"[data-story-tasks-milestone]"}},function(b){return{init:function(){b.implementForm()
},implementForm:function(){b.form().implement(EasySocial.Controller.Story.Tasks.Form,{"{parent}":b})},createInputRow:function(){var d=b.view.taskItem();a(d).implement(EasySocial.Controller.Story.Tasks.Form,{"{parent}":b}).appendTo(b.list()),a(d).find("input").focus()},"{story} save":function(c,d,e){var f=new Array;a.each(b.input(),function(b,c){""!=a(c).val()&&f.push(a(c).val())});var g={items:f,milestone:b.milestone().val()};e.addData(b,g)},"{story} clear":function(){}}}),EasySocial.Controller("Story.Tasks.Form",{defaultOptions:{"{input}":"[data-story-tasks-input]","{remove}":"[data-story-tasks-remove]"}},function(a){return{init:function(){},"{input} keyup":function(b,c){13==c.keyCode&&a.parent.createInputRow(a.element)
},"{remove} click":function(){a.element.remove()}}}),b.resolve()})}),EasySocial.module("story/videos",function(){var b=this;EasySocial.require().library("image","plupload").language("COM_EASYSOCIAL_VIDEOS_STORY_SELECT_CATEGORY","COM_EASYSOCIAL_VIDEOS_STORY_ENTER_VIDEO","COM_EASYSOCIAL_VIDEOS_STORY_PROCESSING_VIDEO","COM_EASYSOCIAL_VIDEOS_STORY_CLICK_INSERT_VIDEO","COM_EASYSOCIAL_VIDEOS_STORY_NO_VIDEO_DETECTED").done(function(a){EasySocial.Controller("Story.Videos",{defaultOptions:{"{form}":"[data-video-form]","{insertVideo}":"[data-insert-video]","{videoLink}":"[data-video-link]","{videoCategory}":"[data-video-category]","{uploaderForm}":"[data-video-uploader]","{uploaderButton}":"[data-video-uploader-button]","{uploaderDropsite}":"[data-video-uploader-dropsite]","{uploaderProgressBar}":"[data-video-uploader-progress-bar]","{uploaderProgressText}":"[data-video-uploader-progress-text]","{removeButton}":"[data-remove-video]","{previewImageWrapper}":"[data-video-preview-image]","{previewTitle}":"[data-video-preview-title]","{title}":"[data-video-title]","{previewDescription}":"[data-video-preview-description]","{description}":"[data-video-description]"}},function(b,c){return{init:function(){0!=b.uploaderForm().length&&(b.uploader=b.uploaderForm().addController("plupload",a.extend({"{uploadButton}":b.uploaderButton.selector,"{uploadDropsite}":b.uploaderDropsite.selector},c.uploader)),b.plupload=b.uploader.plupload)
},isProcessed:function(){b.form().switchClass("is-processed"),b.processing=!1},isUploading:function(){b.form().switchClass("is-uploading")},isProcessing:function(){b.form().switchClass("is-processing"),b.processing=!0},isInitial:function(){b.form().switchClass("is-waiting")},currentCategory:null,processing:!1,video:null,videoType:null,updatePreview:function(c,d,e){b.video={type:c,title:d.title,description:d.description,link:d.link,id:d.id?d.id:"",isEncoding:!1},d.title&&b.previewTitle().html(d.title),d.description&&b.previewDescription().html(d.description),a.Image.get(e).done(function(a){a.appendTo(b.previewImageWrapper())
})},resetProgress:function(){b.uploaderProgressBar().css("width","0%"),b.uploaderProgressText().html("0%")},clearForm:function(a){a&&(b.video=null),b.isInitial(),b.videoLink().val(""),b.previewImageWrapper().html(""),b.previewTitle().html(""),b.title().val(""),b.previewDescription().html(""),b.description().val("")},editTitleEvent:"click.es.story.video.editLinkTitle",editDescriptionEvent:"click.es.story.video.editLinkDescription",editTitle:function(){b.form().addClass("editing-title"),setTimeout(function(){b.title().val(b.previewTitle().text()).focus()[0].select(),a(document).on(b.editTitleEvent,function(a){a.target!==b.title()[0]&&b.saveTitle("save")
})},1)},saveTitle:function(c){c||(c="save");var d=b.title().val();"save"==c&&b.previewTitle().html(d),b.form().removeClass("editing-title"),b.video.title=d,a(document).off(b.editTitleEvent)},checkVideoStatus:function(a){EasySocial.ajax("site/controllers/videos/status",{id:a,uid:c.video.uid,type:c.video.type,createStream:0}).done(function(c,d,e,f){if("done"===d)return b.processing=!1,b.uploaderProgressBar().css("width","100%"),b.uploaderProgressText().html("100%"),b.isProcessed(),b.updatePreview("upload",e,f),b.resetProgress(),void 0;
var d=d+"%";b.uploaderProgressBar().css("width",d),b.uploaderProgressText().html(d),b.checkVideoStatus(a)})},editDescription:function(){b.form().addClass("editing-description"),setTimeout(function(){var c=b.previewDescription().clone(),d=c.hasClass("no-description");c.wrapInner(b.description()),d&&b.description().val(""),b.description().val(b.previewDescription().text()).focus()[0].select(),a(document).on(b.editDescriptionEvent,function(a){a.target!==b.description()[0]&&b.saveDescription("save")})},1)},saveDescription:function(c){c||(c="save");
var d=b.description().val().replace(/\n/g,"<br//>");switch(c){case"save":var e=""===d;b.previewDescription().toggleClass("no-description",e),e&&(d=b.description().attr("placeholder")),b.previewDescription().html(d),b.video.description=d;break;case"revert":}b.form().find(".textareaClone").remove(),b.form().removeClass("editing-description"),a(document).off(b.editDescriptionEvent)},"{uploaderForm} FilesAdded":function(){b.isUploading(),b.plupload.start()},"{uploaderForm} FileUploaded":function(a,c,d,e,f){return f.error?(b.clearMessage(),b.setMessage(f.error),b.clearForm(!0),!1):f.isEncoding?(b.processing=!0,b.checkVideoStatus(f.data.id),void 0):(b.processing=!1,b.uploaderProgressBar().css("width","100%"),b.uploaderProgressText().html("100%"),b.isProcessed(),b.updatePreview("upload",f.data,f.thumbnail),b.video.isEncoding=!0,b.resetProgress(),void 0)
},"{uploaderForm} Error":function(a,d,e,f){var g=c.errors[f.code];b.story.setMessage(g,"error")},"{previewTitle} click":function(){var a=b.form().hasClass("editing-title");b.form().toggleClass("editing-title",!a),a||b.editTitle()},"{previewDescription} click":function(){var a=b.form().hasClass("editing-description");b.form().toggleClass("editing-description",!a),a||b.editDescription()},"{videoCategory} change":function(a){b.currentCategory=a.val()},"{insertVideo} click":function(){var a=b.videoLink().val();a&&!b.processing&&(b.isProcessing(),EasySocial.ajax("ajax:/apps/user/videos/controllers/process/process",{type:"link",link:a}).done(function(c,d){b.isProcessed(),c.link=a,b.updatePreview("link",c,d)
}))},"{removeButton} click":function(){b.clearForm(!0)},"{story} save":function(c,d,e){if("videos"==e.currentPanel){var f=b.videoLink().val();if(f&&!b.video)return e.reject(a.language("COM_EASYSOCIAL_VIDEOS_STORY_CLICK_INSERT_VIDEO")),void 0;if(!f&&!b.video)return e.reject(a.language("COM_EASYSOCIAL_VIDEOS_STORY_NO_VIDEO_DETECTED")),void 0;b.uploadingVideo=e.addTask("uploadingVideo"),b.save(e)}},"{story} afterSubmit":function(){var a=b.uploadingVideo;if(a)return b.clearForm(!0),delete b.uploadingVideo,b.video&&b.video.isEncoding?(EasySocial.dialog({content:EasySocial.ajax("site/views/videos/showEncodingMessage")}),delete b.video,void 0):(delete b.video,void 0)
},save:function(c){var d=b.uploadingVideo;if(d){if(b.processing)return c.reject(a.language("COM_EASYSOCIAL_VIDEOS_STORY_PROCESSING_VIDEO")),void 0;if(b.video.category=b.videoCategory().val(),!b.video.category||0==b.video.category)return c.reject(a.language("COM_EASYSOCIAL_VIDEOS_STORY_SELECT_CATEGORY")),void 0;c.addData(b,b.video),d.resolve(),b.videoType=b.video.type}},"{story} clear":function(){b.clearForm(!1)}}}),b.resolve()})}),EasySocial.module("stream",function(){var a=this;EasySocial.require().library("dialog").script("comment").view("site/likes/item").language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBSCRIBE","COM_EASYSOCIAL_STREAM_DIALOG_FEED","COM_EASYSOCIAL_STREAM_BUTTON_CLOSE").done(function(b){EasySocial.Controller("Stream.Item",{defaultOptions:{id:"","{streamItem}":".streamItem","{streamData}":".streamData","{streamResponds}":".stream-responds","{likeItem}":".likeItem","{likeItemList}":".likeItemList","{commentLink}":".commentLink","{commentFrame}":".commentFrame","{commentInput}":".commentInput","{followItem}":".followItem","{unfollowItem}":".unfollowItem","{hideItem}":".hideItem","{unhideItem}":".unhideItem"}},function(a){return{init:function(){a.commentFrame().implement("EasySocial.Controller.Comments",{uid:a.element.data("id"),pagination:new CommentPagination({total:a.commentFrame().data("total")}),commentlist:new Comment.List})
},"{likeItem} click":function(){EasySocial.ajax("site:/controllers/likes/toggle",{id:a.element.data("id"),type:"stream"},{success:function(b){var c="";b.likeCount>0&&(c=a.view.likeitem({likeCount:b.likeCount}),c.find(".likeText").html(b.message)),a.likeItemList().html(c),a.likeItem().text(b.label)},fail:function(){}})},"{unfollowItem} click":function(){var c=a.element.data("sid");c&&b.dialog({title:b.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE"),content:b.language("COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE"),buttons:[{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE"),click:function(){EasySocial.ajax("site:/controllers/subscriptions/remove",{id:c},{success:function(c){b.dialog({title:b.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE"),content:c.message,buttons:[{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK"),click:function(){a.unfollowItem().removeClass("unfollowItem"),b.dialog().close()
}}]})},fail:function(){}})}},{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL"),click:function(){b.dialog().close()}}]})},"{followItem} click":function(){EasySocial.ajax("site:/controllers/subscriptions/form",{contentId:a.element.data("id"),contentType:"stream"},{success:function(c){return""!=c.message?(b.dialog({title:b.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE"),content:c.message,buttons:[{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL"),click:function(){b.dialog().close()
}}]}),void 0):(b.dialog({title:b.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE"),content:c.htmlform,buttons:[{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT"),click:function(){var c=b("#esfullname").val(),d=b("#email").val();EasySocial.ajax("site:/controllers/subscriptions/add",{contentId:a.element.data("id"),contentType:"stream",esfullname:c,email:d},{success:function(c){b.dialog({title:b.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE"),content:c.message,buttons:[{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK"),click:function(){a.followItem().removeClass("followItem"),b.dialog().close()
}}]})},fail:function(){}})}},{name:b.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL"),click:function(){b.dialog().close()}}]}),void 0)},fail:function(){}})},"{hideItem} click":function(){EasySocial.ajax("site:/controllers/stream/hide",{id:a.element.data("id")},{success:function(b){var c="<div>"+b.message+"</div>";a.streamData().hide(),a.element.append(c)},fail:function(a){b.dialog({title:b.language("COM_EASYSOCIAL_STREAM_DIALOG_FEED"),content:a.message,buttons:[{name:b.language("COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"),click:function(){b.dialog().close()
}}]})}})},"{unhideItem} click":function(){EasySocial.ajax("site:/controllers/stream/unhide",{id:a.element.data("id")},{success:function(){a.streamData().show(),a.element.children().last().remove()},fail:function(a){b.dialog({title:b.language("COM_EASYSOCIAL_STREAM_DIALOG_FEED"),content:a.message,buttons:[{name:b.language("COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"),click:function(){b.dialog().close()}}]})}})},"{commentLink} click":function(){a.commentInput().focus()}}}),a.resolve()})}),EasySocial.module("tab",function(a){var b=this;
EasySocial.Controller("Tab",{defaultOptions:{view:{},"{tabs}":"","{tabsContent}":"","{defaultActive}":""}},function(b){return{init:function(){b.defaultActive().click()},"{tabs} click":function(c){if(a(c).hasClass("inactive"))return!1;b.tabs(".active").removeClass("active"),a(c).addClass("active"),b.tabsContent().hide();var d=".tab-"+a(c).attr("id");b.tabsContent(d).show()}}}),b.resolve()}),EasySocial.module("toggle",function(a){var b=this;EasySocial.Controller("Toggle",{defaultOptions:{view:{},"{selector}":""}},function(){return{init:function(){},"{selector} click":function(b){a(b).next().toggle(),a(b).toggleClass("this-closed")
}}}),b.resolve()}),EasySocial.module("uploader/item",function(){var b=this;EasySocial.require().view("site/uploader/preview").done(function(a){EasySocial.Controller("Uploader.Item",{defaults:{"{uploadItem}":".uploadItem","{uploadItemPreview}":".uploadItem.preview a.itemLink","{itemLink}":".itemLink","{itemDelete}":".itemDelete",view:{preview:"site/uploader/preview"}}},function(){return{init:function(){},"{itemDelete} click":function(b){var c=a(b).data("id");EasySocial.ajax("site:/controllers/uploader/delete",{id:c},function(){a(b).parents("li.uploadItem").remove()
})},"{uploadItemPreview} click":function(b){var c=a(b).data("uri"),d=a(b).data("title");a.dialog({title:d,content:a.Image.get(c)})}}})}),b.resolve()}),EasySocial.module("videos/form",function(){var b=this;EasySocial.require().script("site/friends/suggest").library("mentions").done(function(a){EasySocial.Controller("Videos.Form",{defaultOptions:{"{videoSource}":"[data-video-source]","{forms}":"[data-form-source]","{linkForm}":"[data-form-link]","{uploadForm}":"[data-form-upload]","{mentions}":"[data-mentions]"}},function(b,c){return{init:function(){b.initMentions()
},initMentions:function(){b.mentions().addController("EasySocial.Controller.Friends.Suggest",{showNonFriend:!1,includeSelf:!0,name:"tags[]",exclusion:c.tagsExclusion})},"{videoSource} change":function(c){var e=a(c).val(),f=b[e+"Form"]();b.forms().addClass("hide"),f.removeClass("hide")}}}),b.resolve()})}),EasySocial.module("videos/item",function(){var b=this;EasySocial.require().done(function(a){EasySocial.Controller("Videos.Item",{defaultOptions:{tagAdding:null,"{tagPeople}":"[data-video-tag]","{tagsWrapper}":"[data-video-tag-wrapper]","{deleteButton}":"[data-video-delete]","{removeTag}":"[data-remove-tag]","{tagItem}":"[data-tags-item]","{featureButton}":"[data-video-feature]","{unfeatureButton}":"[data-video-unfeature]"}},function(b,c){return{init:function(){c.id=b.element.data("id")
},"{unfeatureButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/videos/confirmUnfeature",{id:c.id,callbackUrl:c.callbackUrl})})},"{featureButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/videos/confirmFeature",{id:c.id,callbackUrl:c.callbackUrl})})},"{deleteButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/videos/confirmDelete",{id:c.id}),bindings:{}})},"{removeTag} click":function(a){var d=a.parents(b.tagItem.selector),e=d.data("id");
d.remove(),1==b.tagsWrapper().children().length&&b.tagsWrapper().addClass("is-empty"),EasySocial.ajax("site/controllers/videos/removeTag",{id:e}).done(function(){})},"{tagPeople} click":function(){b.tagAdding=!1,EasySocial.dialog({content:EasySocial.ajax("site/views/videos/tagPeople",{id:c.id,exclusion:c.tagsExclusion}),bindings:{"{submit} click":function(){if(!b.tagAdding){b.tagAdding=!0;var f=this.suggest().textboxlist("controller"),g=f.getAddedItems();if(!(g.length<=0)){var h=a.pluck(g,"id");EasySocial.ajax("site/controllers/videos/tag",{ids:h,id:c.id}).done(function(d){c.tagsExclusion||(c.tagsExclusion=[]),a.each(h,function(a,b){c.tagsExclusion.push(b)
}),b.tagsWrapper().removeClass("is-empty"),b.tagsWrapper().append(d),f.clearItems(),EasySocial.dialog().close(),b.tagAdding=!1})}}}}})}}}),b.resolve()})}),EasySocial.module("videos/list",function(){var b=this;EasySocial.require().done(function(){EasySocial.Controller("Videos.List",{defaultOptions:{"{filter}":"[data-videos-filter]","{sorting}":"[data-videos-sorting]","{activeFilter}":".filter-item.active a","{result}":"[data-videos-result]","{item}":"[data-video-item]","{deleteButton}":"[data-video-delete]","{featureButton}":"[data-video-feature]","{unfeatureButton}":"[data-video-unfeature]"}},function(a,b){return{init:function(){},currentFilter:"",currentSorting:"",categoryId:null,setActiveFilter:function(b){a.filter().parent().removeClass("active"),b.parent().addClass("active")
},getVideos:function(){a.currentSorting||(a.currentSorting=a.sorting().val()),a.currentFilter||(a.currentFilter=a.activeFilter().data("type")),a.currentFilter||(a.currentFilter="all"),a.element.addClass("is-loading"),EasySocial.ajax("site/controllers/videos/getVideos",{filter:a.currentFilter,categoryId:a.categoryId,sort:a.currentSorting,uid:b.uid,type:b.type}).done(function(b){a.element.removeClass("is-loading"),a.result().html(b)})},"{sorting} change":function(b){if(a.currentSorting=b.val(),""!=b.val()){var d=a.activeFilter().prop("href");
d=d.indexOf("?")>=0?d+"&sort="+b.val():d+"?sort="+b.val(),History.pushState({state:1},a.activeFilter().prop("title"),d)}a.getVideos()},"{filter} click":function(b,c){c.preventDefault(),c.stopPropagation();var d=b.data("type");b.route(),a.setActiveFilter(b);var e=null;"category"==d&&(d="all",e=b.data("id")),a.currentFilter=d,a.categoryId=e,a.getVideos(d,e)},"{deleteButton} click":function(b){var d=b.parents(a.item.selector),e=d.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/videos/confirmDelete",{id:e})})
},"{unfeatureButton} click":function(b){var d=b.parents(a.item.selector),e=d.data("id"),f=b.data("return"),g={id:e};f.length>0&&(g.callbackUrl=f),EasySocial.dialog({content:EasySocial.ajax("site/views/videos/confirmUnfeature",g)})},"{featureButton} click":function(b){var d=b.parents(a.item.selector),e=d.data("id"),f=b.data("return"),g={id:e};f&&(g.callbackUrl=f),EasySocial.dialog({content:EasySocial.ajax("site/views/videos/confirmFeature",g)})}}}),b.resolve()})}),EasySocial.module("videos/process",function(){var b=this;
EasySocial.Controller("Videos.Process",{defaultOptions:{"{progressBar}":"[data-video-progress-bar]","{progressResult}":"[data-video-progress-result]"}},function(a,b,c){return{init:function(){b.id=c.data("id"),a.processVideo()},processVideo:function(){EasySocial.ajax("site/controllers/videos/process",{id:b.id}).done(function(){a.status(b.id)})},status:function(b){EasySocial.ajax("site/controllers/videos/status",{id:b}).done(function(c,d){if("done"==d)return a.progressBar().css("width","100%"),a.progressResult().html("100%"),window.location=c,void 0;
var e=d+"%";a.progressBar().css("width",e),a.progressResult().html(e),a.status(b)})}}}),b.resolve()})});